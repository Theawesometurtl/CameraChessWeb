var hL=Object.defineProperty;var pL=(t,e,n)=>e in t?hL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ie=(t,e,n)=>(pL(t,typeof e!="symbol"?e+"":e,n),n);function Bv(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(t,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var Cn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $u(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function rT(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var sT={exports:{}},Rp={},oT={exports:{}},Je={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pd=Symbol.for("react.element"),mL=Symbol.for("react.portal"),gL=Symbol.for("react.fragment"),yL=Symbol.for("react.strict_mode"),vL=Symbol.for("react.profiler"),xL=Symbol.for("react.provider"),bL=Symbol.for("react.context"),wL=Symbol.for("react.forward_ref"),SL=Symbol.for("react.suspense"),CL=Symbol.for("react.memo"),_L=Symbol.for("react.lazy"),Gw=Symbol.iterator;function EL(t){return t===null||typeof t!="object"?null:(t=Gw&&t[Gw]||t["@@iterator"],typeof t=="function"?t:null)}var iT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},aT=Object.assign,lT={};function ku(t,e,n){this.props=t,this.context=e,this.refs=lT,this.updater=n||iT}ku.prototype.isReactComponent={};ku.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ku.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function uT(){}uT.prototype=ku.prototype;function Uv(t,e,n){this.props=t,this.context=e,this.refs=lT,this.updater=n||iT}var zv=Uv.prototype=new uT;zv.constructor=Uv;aT(zv,ku.prototype);zv.isPureReactComponent=!0;var Hw=Array.isArray,cT=Object.prototype.hasOwnProperty,Wv={current:null},dT={key:!0,ref:!0,__self:!0,__source:!0};function fT(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)cT.call(e,r)&&!dT.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:Pd,type:t,key:o,ref:i,props:s,_owner:Wv.current}}function TL(t,e){return{$$typeof:Pd,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Vv(t){return typeof t=="object"&&t!==null&&t.$$typeof===Pd}function NL(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var qw=/\/+/g;function yg(t,e){return typeof t=="object"&&t!==null&&t.key!=null?NL(""+t.key):e.toString(36)}function rh(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Pd:case mL:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+yg(i,0):r,Hw(s)?(n="",t!=null&&(n=t.replace(qw,"$&/")+"/"),rh(s,e,n,"",function(u){return u})):s!=null&&(Vv(s)&&(s=TL(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(qw,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",Hw(t))for(var a=0;a<t.length;a++){o=t[a];var l=r+yg(o,a);i+=rh(o,e,n,l,s)}else if(l=EL(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=r+yg(o,a++),i+=rh(o,e,n,l,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function xf(t,e,n){if(t==null)return t;var r=[],s=0;return rh(t,r,"","",function(o){return e.call(n,o,s++)}),r}function $L(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var dr={current:null},sh={transition:null},kL={ReactCurrentDispatcher:dr,ReactCurrentBatchConfig:sh,ReactCurrentOwner:Wv};Je.Children={map:xf,forEach:function(t,e,n){xf(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return xf(t,function(){e++}),e},toArray:function(t){return xf(t,function(e){return e})||[]},only:function(t){if(!Vv(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Je.Component=ku;Je.Fragment=gL;Je.Profiler=vL;Je.PureComponent=Uv;Je.StrictMode=yL;Je.Suspense=SL;Je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kL;Je.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=aT({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=Wv.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)cT.call(e,l)&&!dT.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];r.children=a}return{$$typeof:Pd,type:t.type,key:s,ref:o,props:r,_owner:i}};Je.createContext=function(t){return t={$$typeof:bL,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:xL,_context:t},t.Consumer=t};Je.createElement=fT;Je.createFactory=function(t){var e=fT.bind(null,t);return e.type=t,e};Je.createRef=function(){return{current:null}};Je.forwardRef=function(t){return{$$typeof:wL,render:t}};Je.isValidElement=Vv;Je.lazy=function(t){return{$$typeof:_L,_payload:{_status:-1,_result:t},_init:$L}};Je.memo=function(t,e){return{$$typeof:CL,type:t,compare:e===void 0?null:e}};Je.startTransition=function(t){var e=sh.transition;sh.transition={};try{t()}finally{sh.transition=e}};Je.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Je.useCallback=function(t,e){return dr.current.useCallback(t,e)};Je.useContext=function(t){return dr.current.useContext(t)};Je.useDebugValue=function(){};Je.useDeferredValue=function(t){return dr.current.useDeferredValue(t)};Je.useEffect=function(t,e){return dr.current.useEffect(t,e)};Je.useId=function(){return dr.current.useId()};Je.useImperativeHandle=function(t,e,n){return dr.current.useImperativeHandle(t,e,n)};Je.useInsertionEffect=function(t,e){return dr.current.useInsertionEffect(t,e)};Je.useLayoutEffect=function(t,e){return dr.current.useLayoutEffect(t,e)};Je.useMemo=function(t,e){return dr.current.useMemo(t,e)};Je.useReducer=function(t,e,n){return dr.current.useReducer(t,e,n)};Je.useRef=function(t){return dr.current.useRef(t)};Je.useState=function(t){return dr.current.useState(t)};Je.useSyncExternalStore=function(t,e,n){return dr.current.useSyncExternalStore(t,e,n)};Je.useTransition=function(){return dr.current.useTransition()};Je.version="18.2.0";oT.exports=Je;var L=oT.exports;const An=$u(L),IL=Bv({__proto__:null,default:An},[L]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OL=L,RL=Symbol.for("react.element"),DL=Symbol.for("react.fragment"),AL=Object.prototype.hasOwnProperty,PL=OL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,LL={key:!0,ref:!0,__self:!0,__source:!0};function hT(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)AL.call(e,r)&&!LL.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:RL,type:t,key:o,ref:i,props:s,_owner:PL.current}}Rp.Fragment=DL;Rp.jsx=hT;Rp.jsxs=hT;sT.exports=Rp;var w=sT.exports,FL={exports:{}};/*!
  * Bootstrap v5.3.0 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */(function(t,e){(function(n,r){t.exports=r()})(Cn,function(){const n=new Map,r={set(T,y,C){n.has(T)||n.set(T,new Map);const k=n.get(T);k.has(y)||k.size===0?k.set(y,C):console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(k.keys())[0]}.`)},get:(T,y)=>n.has(T)&&n.get(T).get(y)||null,remove(T,y){if(!n.has(T))return;const C=n.get(T);C.delete(y),C.size===0&&n.delete(T)}},s="transitionend",o=T=>(T&&window.CSS&&window.CSS.escape&&(T=T.replace(/#([^\s"#']+)/g,(y,C)=>`#${CSS.escape(C)}`)),T),i=T=>{T.dispatchEvent(new Event(s))},a=T=>!(!T||typeof T!="object")&&(T.jquery!==void 0&&(T=T[0]),T.nodeType!==void 0),l=T=>a(T)?T.jquery?T[0]:T:typeof T=="string"&&T.length>0?document.querySelector(o(T)):null,u=T=>{if(!a(T)||T.getClientRects().length===0)return!1;const y=getComputedStyle(T).getPropertyValue("visibility")==="visible",C=T.closest("details:not([open])");if(!C)return y;if(C!==T){const k=T.closest("summary");if(k&&k.parentNode!==C||k===null)return!1}return y},c=T=>!T||T.nodeType!==Node.ELEMENT_NODE||!!T.classList.contains("disabled")||(T.disabled!==void 0?T.disabled:T.hasAttribute("disabled")&&T.getAttribute("disabled")!=="false"),d=T=>{if(!document.documentElement.attachShadow)return null;if(typeof T.getRootNode=="function"){const y=T.getRootNode();return y instanceof ShadowRoot?y:null}return T instanceof ShadowRoot?T:T.parentNode?d(T.parentNode):null},f=()=>{},h=T=>{T.offsetHeight},p=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,m=[],v=()=>document.documentElement.dir==="rtl",g=T=>{var y;y=()=>{const C=p();if(C){const k=T.NAME,q=C.fn[k];C.fn[k]=T.jQueryInterface,C.fn[k].Constructor=T,C.fn[k].noConflict=()=>(C.fn[k]=q,T.jQueryInterface)}},document.readyState==="loading"?(m.length||document.addEventListener("DOMContentLoaded",()=>{for(const C of m)C()}),m.push(y)):y()},x=(T,y=[],C=T)=>typeof T=="function"?T(...y):C,b=(T,y,C=!0)=>{if(!C)return void x(T);const k=(te=>{if(!te)return 0;let{transitionDuration:le,transitionDelay:me}=window.getComputedStyle(te);const Ce=Number.parseFloat(le),Ee=Number.parseFloat(me);return Ce||Ee?(le=le.split(",")[0],me=me.split(",")[0],1e3*(Number.parseFloat(le)+Number.parseFloat(me))):0})(y)+5;let q=!1;const K=({target:te})=>{te===y&&(q=!0,y.removeEventListener(s,K),x(T))};y.addEventListener(s,K),setTimeout(()=>{q||i(y)},k)},_=(T,y,C,k)=>{const q=T.length;let K=T.indexOf(y);return K===-1?!C&&k?T[q-1]:T[0]:(K+=C?1:-1,k&&(K=(K+q)%q),T[Math.max(0,Math.min(K,q-1))])},N=/[^.]*(?=\..*)\.|.*/,E=/\..*/,R=/::\d+$/,P={};let B=1;const F={mouseenter:"mouseover",mouseleave:"mouseout"},H=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function ee(T,y){return y&&`${y}::${B++}`||T.uidEvent||B++}function oe(T){const y=ee(T);return T.uidEvent=y,P[y]=P[y]||{},P[y]}function de(T,y,C=null){return Object.values(T).find(k=>k.callable===y&&k.delegationSelector===C)}function V(T,y,C){const k=typeof y=="string",q=k?C:y||C;let K=j(T);return H.has(K)||(K=T),[k,q,K]}function W(T,y,C,k,q){if(typeof y!="string"||!T)return;let[K,te,le]=V(y,C,k);y in F&&(te=(je=>function(Pe){if(!Pe.relatedTarget||Pe.relatedTarget!==Pe.delegateTarget&&!Pe.delegateTarget.contains(Pe.relatedTarget))return je.call(this,Pe)})(te));const me=oe(T),Ce=me[le]||(me[le]={}),Ee=de(Ce,te,K?C:null);if(Ee)return void(Ee.oneOff=Ee.oneOff&&q);const we=ee(te,y.replace(N,"")),Ve=K?function(Re,je,Pe){return function Be(yt){const _t=Re.querySelectorAll(je);for(let{target:Xe}=yt;Xe&&Xe!==this;Xe=Xe.parentNode)for(const at of _t)if(at===Xe)return ne(yt,{delegateTarget:Xe}),Be.oneOff&&A.off(Re,yt.type,je,Pe),Pe.apply(Xe,[yt])}}(T,C,te):function(Re,je){return function Pe(Be){return ne(Be,{delegateTarget:Re}),Pe.oneOff&&A.off(Re,Be.type,je),je.apply(Re,[Be])}}(T,te);Ve.delegationSelector=K?C:null,Ve.callable=te,Ve.oneOff=q,Ve.uidEvent=we,Ce[we]=Ve,T.addEventListener(le,Ve,K)}function I(T,y,C,k,q){const K=de(y[C],k,q);K&&(T.removeEventListener(C,K,!!q),delete y[C][K.uidEvent])}function O(T,y,C,k){const q=y[C]||{};for(const[K,te]of Object.entries(q))K.includes(k)&&I(T,y,C,te.callable,te.delegationSelector)}function j(T){return T=T.replace(E,""),F[T]||T}const A={on(T,y,C,k){W(T,y,C,k,!1)},one(T,y,C,k){W(T,y,C,k,!0)},off(T,y,C,k){if(typeof y!="string"||!T)return;const[q,K,te]=V(y,C,k),le=te!==y,me=oe(T),Ce=me[te]||{},Ee=y.startsWith(".");if(K===void 0){if(Ee)for(const we of Object.keys(me))O(T,me,we,y.slice(1));for(const[we,Ve]of Object.entries(Ce)){const Re=we.replace(R,"");le&&!y.includes(Re)||I(T,me,te,Ve.callable,Ve.delegationSelector)}}else{if(!Object.keys(Ce).length)return;I(T,me,te,K,q?C:null)}},trigger(T,y,C){if(typeof y!="string"||!T)return null;const k=p();let q=null,K=!0,te=!0,le=!1;y!==j(y)&&k&&(q=k.Event(y,C),k(T).trigger(q),K=!q.isPropagationStopped(),te=!q.isImmediatePropagationStopped(),le=q.isDefaultPrevented());const me=ne(new Event(y,{bubbles:K,cancelable:!0}),C);return le&&me.preventDefault(),te&&T.dispatchEvent(me),me.defaultPrevented&&q&&q.preventDefault(),me}};function ne(T,y={}){for(const[C,k]of Object.entries(y))try{T[C]=k}catch{Object.defineProperty(T,C,{configurable:!0,get:()=>k})}return T}function U(T){if(T==="true")return!0;if(T==="false")return!1;if(T===Number(T).toString())return Number(T);if(T===""||T==="null")return null;if(typeof T!="string")return T;try{return JSON.parse(decodeURIComponent(T))}catch{return T}}function Q(T){return T.replace(/[A-Z]/g,y=>`-${y.toLowerCase()}`)}const G={setDataAttribute(T,y,C){T.setAttribute(`data-bs-${Q(y)}`,C)},removeDataAttribute(T,y){T.removeAttribute(`data-bs-${Q(y)}`)},getDataAttributes(T){if(!T)return{};const y={},C=Object.keys(T.dataset).filter(k=>k.startsWith("bs")&&!k.startsWith("bsConfig"));for(const k of C){let q=k.replace(/^bs/,"");q=q.charAt(0).toLowerCase()+q.slice(1,q.length),y[q]=U(T.dataset[k])}return y},getDataAttribute:(T,y)=>U(T.getAttribute(`data-bs-${Q(y)}`))};class J{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(y){return y=this._mergeConfigObj(y),y=this._configAfterMerge(y),this._typeCheckConfig(y),y}_configAfterMerge(y){return y}_mergeConfigObj(y,C){const k=a(C)?G.getDataAttribute(C,"config"):{};return{...this.constructor.Default,...typeof k=="object"?k:{},...a(C)?G.getDataAttributes(C):{},...typeof y=="object"?y:{}}}_typeCheckConfig(y,C=this.constructor.DefaultType){for(const[q,K]of Object.entries(C)){const te=y[q],le=a(te)?"element":(k=te)==null?`${k}`:Object.prototype.toString.call(k).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(K).test(le))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${q}" provided type "${le}" but expected type "${K}".`)}var k}}class re extends J{constructor(y,C){super(),(y=l(y))&&(this._element=y,this._config=this._getConfig(C),r.set(this._element,this.constructor.DATA_KEY,this))}dispose(){r.remove(this._element,this.constructor.DATA_KEY),A.off(this._element,this.constructor.EVENT_KEY);for(const y of Object.getOwnPropertyNames(this))this[y]=null}_queueCallback(y,C,k=!0){b(y,C,k)}_getConfig(y){return y=this._mergeConfigObj(y,this._element),y=this._configAfterMerge(y),this._typeCheckConfig(y),y}static getInstance(y){return r.get(l(y),this.DATA_KEY)}static getOrCreateInstance(y,C={}){return this.getInstance(y)||new this(y,typeof C=="object"?C:null)}static get VERSION(){return"5.3.0"}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(y){return`${y}${this.EVENT_KEY}`}}const be=T=>{let y=T.getAttribute("data-bs-target");if(!y||y==="#"){let C=T.getAttribute("href");if(!C||!C.includes("#")&&!C.startsWith("."))return null;C.includes("#")&&!C.startsWith("#")&&(C=`#${C.split("#")[1]}`),y=C&&C!=="#"?C.trim():null}return o(y)},ue={find:(T,y=document.documentElement)=>[].concat(...Element.prototype.querySelectorAll.call(y,T)),findOne:(T,y=document.documentElement)=>Element.prototype.querySelector.call(y,T),children:(T,y)=>[].concat(...T.children).filter(C=>C.matches(y)),parents(T,y){const C=[];let k=T.parentNode.closest(y);for(;k;)C.push(k),k=k.parentNode.closest(y);return C},prev(T,y){let C=T.previousElementSibling;for(;C;){if(C.matches(y))return[C];C=C.previousElementSibling}return[]},next(T,y){let C=T.nextElementSibling;for(;C;){if(C.matches(y))return[C];C=C.nextElementSibling}return[]},focusableChildren(T){const y=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(C=>`${C}:not([tabindex^="-"])`).join(",");return this.find(y,T).filter(C=>!c(C)&&u(C))},getSelectorFromElement(T){const y=be(T);return y&&ue.findOne(y)?y:null},getElementFromSelector(T){const y=be(T);return y?ue.findOne(y):null},getMultipleElementsFromSelector(T){const y=be(T);return y?ue.find(y):[]}},De=(T,y="hide")=>{const C=`click.dismiss${T.EVENT_KEY}`,k=T.NAME;A.on(document,C,`[data-bs-dismiss="${k}"]`,function(q){if(["A","AREA"].includes(this.tagName)&&q.preventDefault(),c(this))return;const K=ue.getElementFromSelector(this)||this.closest(`.${k}`);T.getOrCreateInstance(K)[y]()})};class Ae extends re{static get NAME(){return"alert"}close(){if(A.trigger(this._element,"close.bs.alert").defaultPrevented)return;this._element.classList.remove("show");const y=this._element.classList.contains("fade");this._queueCallback(()=>this._destroyElement(),this._element,y)}_destroyElement(){this._element.remove(),A.trigger(this._element,"closed.bs.alert"),this.dispose()}static jQueryInterface(y){return this.each(function(){const C=Ae.getOrCreateInstance(this);if(typeof y=="string"){if(C[y]===void 0||y.startsWith("_")||y==="constructor")throw new TypeError(`No method named "${y}"`);C[y](this)}})}}De(Ae,"close"),g(Ae);const Ye='[data-bs-toggle="button"]';class ot extends re{static get NAME(){return"button"}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle("active"))}static jQueryInterface(y){return this.each(function(){const C=ot.getOrCreateInstance(this);y==="toggle"&&C[y]()})}}A.on(document,"click.bs.button.data-api",Ye,T=>{T.preventDefault();const y=T.target.closest(Ye);ot.getOrCreateInstance(y).toggle()}),g(ot);const Ft={endCallback:null,leftCallback:null,rightCallback:null},yn={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Ct extends J{constructor(y,C){super(),this._element=y,y&&Ct.isSupported()&&(this._config=this._getConfig(C),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return Ft}static get DefaultType(){return yn}static get NAME(){return"swipe"}dispose(){A.off(this._element,".bs.swipe")}_start(y){this._supportPointerEvents?this._eventIsPointerPenTouch(y)&&(this._deltaX=y.clientX):this._deltaX=y.touches[0].clientX}_end(y){this._eventIsPointerPenTouch(y)&&(this._deltaX=y.clientX-this._deltaX),this._handleSwipe(),x(this._config.endCallback)}_move(y){this._deltaX=y.touches&&y.touches.length>1?0:y.touches[0].clientX-this._deltaX}_handleSwipe(){const y=Math.abs(this._deltaX);if(y<=40)return;const C=y/this._deltaX;this._deltaX=0,C&&x(C>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(A.on(this._element,"pointerdown.bs.swipe",y=>this._start(y)),A.on(this._element,"pointerup.bs.swipe",y=>this._end(y)),this._element.classList.add("pointer-event")):(A.on(this._element,"touchstart.bs.swipe",y=>this._start(y)),A.on(this._element,"touchmove.bs.swipe",y=>this._move(y)),A.on(this._element,"touchend.bs.swipe",y=>this._end(y)))}_eventIsPointerPenTouch(y){return this._supportPointerEvents&&(y.pointerType==="pen"||y.pointerType==="touch")}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const It="next",zt="prev",Mn="left",jn="right",kr="slid.bs.carousel",vn="carousel",Ot="active",Rs={ArrowLeft:jn,ArrowRight:Mn},tr={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Io={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Ds extends re{constructor(y,C){super(y,C),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=ue.findOne(".carousel-indicators",this._element),this._addEventListeners(),this._config.ride===vn&&this.cycle()}static get Default(){return tr}static get DefaultType(){return Io}static get NAME(){return"carousel"}next(){this._slide(It)}nextWhenVisible(){!document.hidden&&u(this._element)&&this.next()}prev(){this._slide(zt)}pause(){this._isSliding&&i(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){this._config.ride&&(this._isSliding?A.one(this._element,kr,()=>this.cycle()):this.cycle())}to(y){const C=this._getItems();if(y>C.length-1||y<0)return;if(this._isSliding)return void A.one(this._element,kr,()=>this.to(y));const k=this._getItemIndex(this._getActive());if(k===y)return;const q=y>k?It:zt;this._slide(q,C[y])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(y){return y.defaultInterval=y.interval,y}_addEventListeners(){this._config.keyboard&&A.on(this._element,"keydown.bs.carousel",y=>this._keydown(y)),this._config.pause==="hover"&&(A.on(this._element,"mouseenter.bs.carousel",()=>this.pause()),A.on(this._element,"mouseleave.bs.carousel",()=>this._maybeEnableCycle())),this._config.touch&&Ct.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const C of ue.find(".carousel-item img",this._element))A.on(C,"dragstart.bs.carousel",k=>k.preventDefault());const y={leftCallback:()=>this._slide(this._directionToOrder(Mn)),rightCallback:()=>this._slide(this._directionToOrder(jn)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),500+this._config.interval))}};this._swipeHelper=new Ct(this._element,y)}_keydown(y){if(/input|textarea/i.test(y.target.tagName))return;const C=Rs[y.key];C&&(y.preventDefault(),this._slide(this._directionToOrder(C)))}_getItemIndex(y){return this._getItems().indexOf(y)}_setActiveIndicatorElement(y){if(!this._indicatorsElement)return;const C=ue.findOne(".active",this._indicatorsElement);C.classList.remove(Ot),C.removeAttribute("aria-current");const k=ue.findOne(`[data-bs-slide-to="${y}"]`,this._indicatorsElement);k&&(k.classList.add(Ot),k.setAttribute("aria-current","true"))}_updateInterval(){const y=this._activeElement||this._getActive();if(!y)return;const C=Number.parseInt(y.getAttribute("data-bs-interval"),10);this._config.interval=C||this._config.defaultInterval}_slide(y,C=null){if(this._isSliding)return;const k=this._getActive(),q=y===It,K=C||_(this._getItems(),k,q,this._config.wrap);if(K===k)return;const te=this._getItemIndex(K),le=we=>A.trigger(this._element,we,{relatedTarget:K,direction:this._orderToDirection(y),from:this._getItemIndex(k),to:te});if(le("slide.bs.carousel").defaultPrevented||!k||!K)return;const me=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(te),this._activeElement=K;const Ce=q?"carousel-item-start":"carousel-item-end",Ee=q?"carousel-item-next":"carousel-item-prev";K.classList.add(Ee),h(K),k.classList.add(Ce),K.classList.add(Ce),this._queueCallback(()=>{K.classList.remove(Ce,Ee),K.classList.add(Ot),k.classList.remove(Ot,Ee,Ce),this._isSliding=!1,le(kr)},k,this._isAnimated()),me&&this.cycle()}_isAnimated(){return this._element.classList.contains("slide")}_getActive(){return ue.findOne(".active.carousel-item",this._element)}_getItems(){return ue.find(".carousel-item",this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(y){return v()?y===Mn?zt:It:y===Mn?It:zt}_orderToDirection(y){return v()?y===zt?Mn:jn:y===zt?jn:Mn}static jQueryInterface(y){return this.each(function(){const C=Ds.getOrCreateInstance(this,y);if(typeof y!="number"){if(typeof y=="string"){if(C[y]===void 0||y.startsWith("_")||y==="constructor")throw new TypeError(`No method named "${y}"`);C[y]()}}else C.to(y)})}}A.on(document,"click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(T){const y=ue.getElementFromSelector(this);if(!y||!y.classList.contains(vn))return;T.preventDefault();const C=Ds.getOrCreateInstance(y),k=this.getAttribute("data-bs-slide-to");return k?(C.to(k),void C._maybeEnableCycle()):G.getDataAttribute(this,"slide")==="next"?(C.next(),void C._maybeEnableCycle()):(C.prev(),void C._maybeEnableCycle())}),A.on(window,"load.bs.carousel.data-api",()=>{const T=ue.find('[data-bs-ride="carousel"]');for(const y of T)Ds.getOrCreateInstance(y)}),g(Ds);const uo="show",As="collapse",Rn="collapsing",oi='[data-bs-toggle="collapse"]',Oo={parent:null,toggle:!0},Ro={parent:"(null|element)",toggle:"boolean"};class co extends re{constructor(y,C){super(y,C),this._isTransitioning=!1,this._triggerArray=[];const k=ue.find(oi);for(const q of k){const K=ue.getSelectorFromElement(q),te=ue.find(K).filter(le=>le===this._element);K!==null&&te.length&&this._triggerArray.push(q)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Oo}static get DefaultType(){return Ro}static get NAME(){return"collapse"}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let y=[];if(this._config.parent&&(y=this._getFirstLevelChildren(".collapse.show, .collapse.collapsing").filter(q=>q!==this._element).map(q=>co.getOrCreateInstance(q,{toggle:!1}))),y.length&&y[0]._isTransitioning||A.trigger(this._element,"show.bs.collapse").defaultPrevented)return;for(const q of y)q.hide();const C=this._getDimension();this._element.classList.remove(As),this._element.classList.add(Rn),this._element.style[C]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const k=`scroll${C[0].toUpperCase()+C.slice(1)}`;this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Rn),this._element.classList.add(As,uo),this._element.style[C]="",A.trigger(this._element,"shown.bs.collapse")},this._element,!0),this._element.style[C]=`${this._element[k]}px`}hide(){if(this._isTransitioning||!this._isShown()||A.trigger(this._element,"hide.bs.collapse").defaultPrevented)return;const y=this._getDimension();this._element.style[y]=`${this._element.getBoundingClientRect()[y]}px`,h(this._element),this._element.classList.add(Rn),this._element.classList.remove(As,uo);for(const C of this._triggerArray){const k=ue.getElementFromSelector(C);k&&!this._isShown(k)&&this._addAriaAndCollapsedClass([C],!1)}this._isTransitioning=!0,this._element.style[y]="",this._queueCallback(()=>{this._isTransitioning=!1,this._element.classList.remove(Rn),this._element.classList.add(As),A.trigger(this._element,"hidden.bs.collapse")},this._element,!0)}_isShown(y=this._element){return y.classList.contains(uo)}_configAfterMerge(y){return y.toggle=!!y.toggle,y.parent=l(y.parent),y}_getDimension(){return this._element.classList.contains("collapse-horizontal")?"width":"height"}_initializeChildren(){if(!this._config.parent)return;const y=this._getFirstLevelChildren(oi);for(const C of y){const k=ue.getElementFromSelector(C);k&&this._addAriaAndCollapsedClass([C],this._isShown(k))}}_getFirstLevelChildren(y){const C=ue.find(":scope .collapse .collapse",this._config.parent);return ue.find(y,this._config.parent).filter(k=>!C.includes(k))}_addAriaAndCollapsedClass(y,C){if(y.length)for(const k of y)k.classList.toggle("collapsed",!C),k.setAttribute("aria-expanded",C)}static jQueryInterface(y){const C={};return typeof y=="string"&&/show|hide/.test(y)&&(C.toggle=!1),this.each(function(){const k=co.getOrCreateInstance(this,C);if(typeof y=="string"){if(k[y]===void 0)throw new TypeError(`No method named "${y}"`);k[y]()}})}}A.on(document,"click.bs.collapse.data-api",oi,function(T){(T.target.tagName==="A"||T.delegateTarget&&T.delegateTarget.tagName==="A")&&T.preventDefault();for(const y of ue.getMultipleElementsFromSelector(this))co.getOrCreateInstance(y,{toggle:!1}).toggle()}),g(co);var rn="top",Wt="bottom",xn="right",Yt="left",ii="auto",Ir=[rn,Wt,xn,Yt],pr="start",Or="end",wl="clippingParents",X="viewport",Z="popper",se="reference",ce=Ir.reduce(function(T,y){return T.concat([y+"-"+pr,y+"-"+Or])},[]),ye=[].concat(Ir,[ii]).reduce(function(T,y){return T.concat([y,y+"-"+pr,y+"-"+Or])},[]),Ie="beforeRead",Ne="read",$e="afterRead",Se="beforeMain",Ge="main",Qt="afterMain",We="beforeWrite",ut="write",sn="afterWrite",nr=[Ie,Ne,$e,Se,Ge,Qt,We,ut,sn];function ct(T){return T?(T.nodeName||"").toLowerCase():null}function on(T){if(T==null)return window;if(T.toString()!=="[object Window]"){var y=T.ownerDocument;return y&&y.defaultView||window}return T}function Ps(T){return T instanceof on(T).Element||T instanceof Element}function dn(T){return T instanceof on(T).HTMLElement||T instanceof HTMLElement}function ts(T){return typeof ShadowRoot<"u"&&(T instanceof on(T).ShadowRoot||T instanceof ShadowRoot)}const Ls={name:"applyStyles",enabled:!0,phase:"write",fn:function(T){var y=T.state;Object.keys(y.elements).forEach(function(C){var k=y.styles[C]||{},q=y.attributes[C]||{},K=y.elements[C];dn(K)&&ct(K)&&(Object.assign(K.style,k),Object.keys(q).forEach(function(te){var le=q[te];le===!1?K.removeAttribute(te):K.setAttribute(te,le===!0?"":le)}))})},effect:function(T){var y=T.state,C={popper:{position:y.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(y.elements.popper.style,C.popper),y.styles=C,y.elements.arrow&&Object.assign(y.elements.arrow.style,C.arrow),function(){Object.keys(y.elements).forEach(function(k){var q=y.elements[k],K=y.attributes[k]||{},te=Object.keys(y.styles.hasOwnProperty(k)?y.styles[k]:C[k]).reduce(function(le,me){return le[me]="",le},{});dn(q)&&ct(q)&&(Object.assign(q.style,te),Object.keys(K).forEach(function(le){q.removeAttribute(le)}))})}},requires:["computeStyles"]};function mr(T){return T.split("-")[0]}var Fs=Math.max,ai=Math.min,Rr=Math.round;function li(){var T=navigator.userAgentData;return T!=null&&T.brands&&Array.isArray(T.brands)?T.brands.map(function(y){return y.brand+"/"+y.version}).join(" "):navigator.userAgent}function lt(){return!/^((?!chrome|android).)*safari/i.test(li())}function it(T,y,C){y===void 0&&(y=!1),C===void 0&&(C=!1);var k=T.getBoundingClientRect(),q=1,K=1;y&&dn(T)&&(q=T.offsetWidth>0&&Rr(k.width)/T.offsetWidth||1,K=T.offsetHeight>0&&Rr(k.height)/T.offsetHeight||1);var te=(Ps(T)?on(T):window).visualViewport,le=!lt()&&C,me=(k.left+(le&&te?te.offsetLeft:0))/q,Ce=(k.top+(le&&te?te.offsetTop:0))/K,Ee=k.width/q,we=k.height/K;return{width:Ee,height:we,top:Ce,right:me+Ee,bottom:Ce+we,left:me,x:me,y:Ce}}function gr(T){var y=it(T),C=T.offsetWidth,k=T.offsetHeight;return Math.abs(y.width-C)<=1&&(C=y.width),Math.abs(y.height-k)<=1&&(k=y.height),{x:T.offsetLeft,y:T.offsetTop,width:C,height:k}}function ca(T,y){var C=y.getRootNode&&y.getRootNode();if(T.contains(y))return!0;if(C&&ts(C)){var k=y;do{if(k&&T.isSameNode(k))return!0;k=k.parentNode||k.host}while(k)}return!1}function Ms(T){return on(T).getComputedStyle(T)}function h3(T){return["table","td","th"].indexOf(ct(T))>=0}function ui(T){return((Ps(T)?T.ownerDocument:T.document)||window.document).documentElement}function rf(T){return ct(T)==="html"?T:T.assignedSlot||T.parentNode||(ts(T)?T.host:null)||ui(T)}function Ab(T){return dn(T)&&Ms(T).position!=="fixed"?T.offsetParent:null}function Yu(T){for(var y=on(T),C=Ab(T);C&&h3(C)&&Ms(C).position==="static";)C=Ab(C);return C&&(ct(C)==="html"||ct(C)==="body"&&Ms(C).position==="static")?y:C||function(k){var q=/firefox/i.test(li());if(/Trident/i.test(li())&&dn(k)&&Ms(k).position==="fixed")return null;var K=rf(k);for(ts(K)&&(K=K.host);dn(K)&&["html","body"].indexOf(ct(K))<0;){var te=Ms(K);if(te.transform!=="none"||te.perspective!=="none"||te.contain==="paint"||["transform","perspective"].indexOf(te.willChange)!==-1||q&&te.willChange==="filter"||q&&te.filter&&te.filter!=="none")return K;K=K.parentNode}return null}(T)||y}function eg(T){return["top","bottom"].indexOf(T)>=0?"x":"y"}function Qu(T,y,C){return Fs(T,ai(y,C))}function Pb(T){return Object.assign({},{top:0,right:0,bottom:0,left:0},T)}function Lb(T,y){return y.reduce(function(C,k){return C[k]=T,C},{})}const Fb={name:"arrow",enabled:!0,phase:"main",fn:function(T){var y,C=T.state,k=T.name,q=T.options,K=C.elements.arrow,te=C.modifiersData.popperOffsets,le=mr(C.placement),me=eg(le),Ce=[Yt,xn].indexOf(le)>=0?"height":"width";if(K&&te){var Ee=function(vt,ft){return Pb(typeof(vt=typeof vt=="function"?vt(Object.assign({},ft.rects,{placement:ft.placement})):vt)!="number"?vt:Lb(vt,Ir))}(q.padding,C),we=gr(K),Ve=me==="y"?rn:Yt,Re=me==="y"?Wt:xn,je=C.rects.reference[Ce]+C.rects.reference[me]-te[me]-C.rects.popper[Ce],Pe=te[me]-C.rects.reference[me],Be=Yu(K),yt=Be?me==="y"?Be.clientHeight||0:Be.clientWidth||0:0,_t=je/2-Pe/2,Xe=Ee[Ve],at=yt-we[Ce]-Ee[Re],He=yt/2-we[Ce]/2+_t,et=Qu(Xe,He,at),dt=me;C.modifiersData[k]=((y={})[dt]=et,y.centerOffset=et-He,y)}},effect:function(T){var y=T.state,C=T.options.element,k=C===void 0?"[data-popper-arrow]":C;k!=null&&(typeof k!="string"||(k=y.elements.popper.querySelector(k)))&&ca(y.elements.popper,k)&&(y.elements.arrow=k)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Sl(T){return T.split("-")[1]}var p3={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Mb(T){var y,C=T.popper,k=T.popperRect,q=T.placement,K=T.variation,te=T.offsets,le=T.position,me=T.gpuAcceleration,Ce=T.adaptive,Ee=T.roundOffsets,we=T.isFixed,Ve=te.x,Re=Ve===void 0?0:Ve,je=te.y,Pe=je===void 0?0:je,Be=typeof Ee=="function"?Ee({x:Re,y:Pe}):{x:Re,y:Pe};Re=Be.x,Pe=Be.y;var yt=te.hasOwnProperty("x"),_t=te.hasOwnProperty("y"),Xe=Yt,at=rn,He=window;if(Ce){var et=Yu(C),dt="clientHeight",vt="clientWidth";et===on(C)&&Ms(et=ui(C)).position!=="static"&&le==="absolute"&&(dt="scrollHeight",vt="scrollWidth"),(q===rn||(q===Yt||q===xn)&&K===Or)&&(at=Wt,Pe-=(we&&et===He&&He.visualViewport?He.visualViewport.height:et[dt])-k.height,Pe*=me?1:-1),q!==Yt&&(q!==rn&&q!==Wt||K!==Or)||(Xe=xn,Re-=(we&&et===He&&He.visualViewport?He.visualViewport.width:et[vt])-k.width,Re*=me?1:-1)}var ft,Zt=Object.assign({position:le},Ce&&p3),Dr=Ee===!0?function(Bs,rr){var ns=Bs.x,rs=Bs.y,Vt=rr.devicePixelRatio||1;return{x:Rr(ns*Vt)/Vt||0,y:Rr(rs*Vt)/Vt||0}}({x:Re,y:Pe},on(C)):{x:Re,y:Pe};return Re=Dr.x,Pe=Dr.y,me?Object.assign({},Zt,((ft={})[at]=_t?"0":"",ft[Xe]=yt?"0":"",ft.transform=(He.devicePixelRatio||1)<=1?"translate("+Re+"px, "+Pe+"px)":"translate3d("+Re+"px, "+Pe+"px, 0)",ft)):Object.assign({},Zt,((y={})[at]=_t?Pe+"px":"",y[Xe]=yt?Re+"px":"",y.transform="",y))}const tg={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(T){var y=T.state,C=T.options,k=C.gpuAcceleration,q=k===void 0||k,K=C.adaptive,te=K===void 0||K,le=C.roundOffsets,me=le===void 0||le,Ce={placement:mr(y.placement),variation:Sl(y.placement),popper:y.elements.popper,popperRect:y.rects.popper,gpuAcceleration:q,isFixed:y.options.strategy==="fixed"};y.modifiersData.popperOffsets!=null&&(y.styles.popper=Object.assign({},y.styles.popper,Mb(Object.assign({},Ce,{offsets:y.modifiersData.popperOffsets,position:y.options.strategy,adaptive:te,roundOffsets:me})))),y.modifiersData.arrow!=null&&(y.styles.arrow=Object.assign({},y.styles.arrow,Mb(Object.assign({},Ce,{offsets:y.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:me})))),y.attributes.popper=Object.assign({},y.attributes.popper,{"data-popper-placement":y.placement})},data:{}};var sf={passive:!0};const ng={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(T){var y=T.state,C=T.instance,k=T.options,q=k.scroll,K=q===void 0||q,te=k.resize,le=te===void 0||te,me=on(y.elements.popper),Ce=[].concat(y.scrollParents.reference,y.scrollParents.popper);return K&&Ce.forEach(function(Ee){Ee.addEventListener("scroll",C.update,sf)}),le&&me.addEventListener("resize",C.update,sf),function(){K&&Ce.forEach(function(Ee){Ee.removeEventListener("scroll",C.update,sf)}),le&&me.removeEventListener("resize",C.update,sf)}},data:{}};var m3={left:"right",right:"left",bottom:"top",top:"bottom"};function of(T){return T.replace(/left|right|bottom|top/g,function(y){return m3[y]})}var g3={start:"end",end:"start"};function jb(T){return T.replace(/start|end/g,function(y){return g3[y]})}function rg(T){var y=on(T);return{scrollLeft:y.pageXOffset,scrollTop:y.pageYOffset}}function sg(T){return it(ui(T)).left+rg(T).scrollLeft}function og(T){var y=Ms(T),C=y.overflow,k=y.overflowX,q=y.overflowY;return/auto|scroll|overlay|hidden/.test(C+q+k)}function Bb(T){return["html","body","#document"].indexOf(ct(T))>=0?T.ownerDocument.body:dn(T)&&og(T)?T:Bb(rf(T))}function Zu(T,y){var C;y===void 0&&(y=[]);var k=Bb(T),q=k===((C=T.ownerDocument)==null?void 0:C.body),K=on(k),te=q?[K].concat(K.visualViewport||[],og(k)?k:[]):k,le=y.concat(te);return q?le:le.concat(Zu(rf(te)))}function ig(T){return Object.assign({},T,{left:T.x,top:T.y,right:T.x+T.width,bottom:T.y+T.height})}function Ub(T,y,C){return y===X?ig(function(k,q){var K=on(k),te=ui(k),le=K.visualViewport,me=te.clientWidth,Ce=te.clientHeight,Ee=0,we=0;if(le){me=le.width,Ce=le.height;var Ve=lt();(Ve||!Ve&&q==="fixed")&&(Ee=le.offsetLeft,we=le.offsetTop)}return{width:me,height:Ce,x:Ee+sg(k),y:we}}(T,C)):Ps(y)?function(k,q){var K=it(k,!1,q==="fixed");return K.top=K.top+k.clientTop,K.left=K.left+k.clientLeft,K.bottom=K.top+k.clientHeight,K.right=K.left+k.clientWidth,K.width=k.clientWidth,K.height=k.clientHeight,K.x=K.left,K.y=K.top,K}(y,C):ig(function(k){var q,K=ui(k),te=rg(k),le=(q=k.ownerDocument)==null?void 0:q.body,me=Fs(K.scrollWidth,K.clientWidth,le?le.scrollWidth:0,le?le.clientWidth:0),Ce=Fs(K.scrollHeight,K.clientHeight,le?le.scrollHeight:0,le?le.clientHeight:0),Ee=-te.scrollLeft+sg(k),we=-te.scrollTop;return Ms(le||K).direction==="rtl"&&(Ee+=Fs(K.clientWidth,le?le.clientWidth:0)-me),{width:me,height:Ce,x:Ee,y:we}}(ui(T)))}function zb(T){var y,C=T.reference,k=T.element,q=T.placement,K=q?mr(q):null,te=q?Sl(q):null,le=C.x+C.width/2-k.width/2,me=C.y+C.height/2-k.height/2;switch(K){case rn:y={x:le,y:C.y-k.height};break;case Wt:y={x:le,y:C.y+C.height};break;case xn:y={x:C.x+C.width,y:me};break;case Yt:y={x:C.x-k.width,y:me};break;default:y={x:C.x,y:C.y}}var Ce=K?eg(K):null;if(Ce!=null){var Ee=Ce==="y"?"height":"width";switch(te){case pr:y[Ce]=y[Ce]-(C[Ee]/2-k[Ee]/2);break;case Or:y[Ce]=y[Ce]+(C[Ee]/2-k[Ee]/2)}}return y}function Cl(T,y){y===void 0&&(y={});var C=y,k=C.placement,q=k===void 0?T.placement:k,K=C.strategy,te=K===void 0?T.strategy:K,le=C.boundary,me=le===void 0?wl:le,Ce=C.rootBoundary,Ee=Ce===void 0?X:Ce,we=C.elementContext,Ve=we===void 0?Z:we,Re=C.altBoundary,je=Re!==void 0&&Re,Pe=C.padding,Be=Pe===void 0?0:Pe,yt=Pb(typeof Be!="number"?Be:Lb(Be,Ir)),_t=Ve===Z?se:Z,Xe=T.rects.popper,at=T.elements[je?_t:Ve],He=function(rr,ns,rs,Vt){var fo=ns==="clippingParents"?function(bt){var sr=Zu(rf(bt)),ss=["absolute","fixed"].indexOf(Ms(bt).position)>=0&&dn(bt)?Yu(bt):bt;return Ps(ss)?sr.filter(function(ci){return Ps(ci)&&ca(ci,ss)&&ct(ci)!=="body"}):[]}(rr):[].concat(ns),ho=[].concat(fo,[rs]),_l=ho[0],bn=ho.reduce(function(bt,sr){var ss=Ub(rr,sr,Vt);return bt.top=Fs(ss.top,bt.top),bt.right=ai(ss.right,bt.right),bt.bottom=ai(ss.bottom,bt.bottom),bt.left=Fs(ss.left,bt.left),bt},Ub(rr,_l,Vt));return bn.width=bn.right-bn.left,bn.height=bn.bottom-bn.top,bn.x=bn.left,bn.y=bn.top,bn}(Ps(at)?at:at.contextElement||ui(T.elements.popper),me,Ee,te),et=it(T.elements.reference),dt=zb({reference:et,element:Xe,strategy:"absolute",placement:q}),vt=ig(Object.assign({},Xe,dt)),ft=Ve===Z?vt:et,Zt={top:He.top-ft.top+yt.top,bottom:ft.bottom-He.bottom+yt.bottom,left:He.left-ft.left+yt.left,right:ft.right-He.right+yt.right},Dr=T.modifiersData.offset;if(Ve===Z&&Dr){var Bs=Dr[q];Object.keys(Zt).forEach(function(rr){var ns=[xn,Wt].indexOf(rr)>=0?1:-1,rs=[rn,Wt].indexOf(rr)>=0?"y":"x";Zt[rr]+=Bs[rs]*ns})}return Zt}function y3(T,y){y===void 0&&(y={});var C=y,k=C.placement,q=C.boundary,K=C.rootBoundary,te=C.padding,le=C.flipVariations,me=C.allowedAutoPlacements,Ce=me===void 0?ye:me,Ee=Sl(k),we=Ee?le?ce:ce.filter(function(je){return Sl(je)===Ee}):Ir,Ve=we.filter(function(je){return Ce.indexOf(je)>=0});Ve.length===0&&(Ve=we);var Re=Ve.reduce(function(je,Pe){return je[Pe]=Cl(T,{placement:Pe,boundary:q,rootBoundary:K,padding:te})[mr(Pe)],je},{});return Object.keys(Re).sort(function(je,Pe){return Re[je]-Re[Pe]})}const Wb={name:"flip",enabled:!0,phase:"main",fn:function(T){var y=T.state,C=T.options,k=T.name;if(!y.modifiersData[k]._skip){for(var q=C.mainAxis,K=q===void 0||q,te=C.altAxis,le=te===void 0||te,me=C.fallbackPlacements,Ce=C.padding,Ee=C.boundary,we=C.rootBoundary,Ve=C.altBoundary,Re=C.flipVariations,je=Re===void 0||Re,Pe=C.allowedAutoPlacements,Be=y.options.placement,yt=mr(Be),_t=me||(yt!==Be&&je?function(bt){if(mr(bt)===ii)return[];var sr=of(bt);return[jb(bt),sr,jb(sr)]}(Be):[of(Be)]),Xe=[Be].concat(_t).reduce(function(bt,sr){return bt.concat(mr(sr)===ii?y3(y,{placement:sr,boundary:Ee,rootBoundary:we,padding:Ce,flipVariations:je,allowedAutoPlacements:Pe}):sr)},[]),at=y.rects.reference,He=y.rects.popper,et=new Map,dt=!0,vt=Xe[0],ft=0;ft<Xe.length;ft++){var Zt=Xe[ft],Dr=mr(Zt),Bs=Sl(Zt)===pr,rr=[rn,Wt].indexOf(Dr)>=0,ns=rr?"width":"height",rs=Cl(y,{placement:Zt,boundary:Ee,rootBoundary:we,altBoundary:Ve,padding:Ce}),Vt=rr?Bs?xn:Yt:Bs?Wt:rn;at[ns]>He[ns]&&(Vt=of(Vt));var fo=of(Vt),ho=[];if(K&&ho.push(rs[Dr]<=0),le&&ho.push(rs[Vt]<=0,rs[fo]<=0),ho.every(function(bt){return bt})){vt=Zt,dt=!1;break}et.set(Zt,ho)}if(dt)for(var _l=function(bt){var sr=Xe.find(function(ss){var ci=et.get(ss);if(ci)return ci.slice(0,bt).every(function(gf){return gf})});if(sr)return vt=sr,"break"},bn=je?3:1;bn>0&&_l(bn)!=="break";bn--);y.placement!==vt&&(y.modifiersData[k]._skip=!0,y.placement=vt,y.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function Vb(T,y,C){return C===void 0&&(C={x:0,y:0}),{top:T.top-y.height-C.y,right:T.right-y.width+C.x,bottom:T.bottom-y.height+C.y,left:T.left-y.width-C.x}}function Gb(T){return[rn,xn,Wt,Yt].some(function(y){return T[y]>=0})}const Hb={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(T){var y=T.state,C=T.name,k=y.rects.reference,q=y.rects.popper,K=y.modifiersData.preventOverflow,te=Cl(y,{elementContext:"reference"}),le=Cl(y,{altBoundary:!0}),me=Vb(te,k),Ce=Vb(le,q,K),Ee=Gb(me),we=Gb(Ce);y.modifiersData[C]={referenceClippingOffsets:me,popperEscapeOffsets:Ce,isReferenceHidden:Ee,hasPopperEscaped:we},y.attributes.popper=Object.assign({},y.attributes.popper,{"data-popper-reference-hidden":Ee,"data-popper-escaped":we})}},qb={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(T){var y=T.state,C=T.options,k=T.name,q=C.offset,K=q===void 0?[0,0]:q,te=ye.reduce(function(Ee,we){return Ee[we]=function(Ve,Re,je){var Pe=mr(Ve),Be=[Yt,rn].indexOf(Pe)>=0?-1:1,yt=typeof je=="function"?je(Object.assign({},Re,{placement:Ve})):je,_t=yt[0],Xe=yt[1];return _t=_t||0,Xe=(Xe||0)*Be,[Yt,xn].indexOf(Pe)>=0?{x:Xe,y:_t}:{x:_t,y:Xe}}(we,y.rects,K),Ee},{}),le=te[y.placement],me=le.x,Ce=le.y;y.modifiersData.popperOffsets!=null&&(y.modifiersData.popperOffsets.x+=me,y.modifiersData.popperOffsets.y+=Ce),y.modifiersData[k]=te}},ag={name:"popperOffsets",enabled:!0,phase:"read",fn:function(T){var y=T.state,C=T.name;y.modifiersData[C]=zb({reference:y.rects.reference,element:y.rects.popper,strategy:"absolute",placement:y.placement})},data:{}},Kb={name:"preventOverflow",enabled:!0,phase:"main",fn:function(T){var y=T.state,C=T.options,k=T.name,q=C.mainAxis,K=q===void 0||q,te=C.altAxis,le=te!==void 0&&te,me=C.boundary,Ce=C.rootBoundary,Ee=C.altBoundary,we=C.padding,Ve=C.tether,Re=Ve===void 0||Ve,je=C.tetherOffset,Pe=je===void 0?0:je,Be=Cl(y,{boundary:me,rootBoundary:Ce,padding:we,altBoundary:Ee}),yt=mr(y.placement),_t=Sl(y.placement),Xe=!_t,at=eg(yt),He=at==="x"?"y":"x",et=y.modifiersData.popperOffsets,dt=y.rects.reference,vt=y.rects.popper,ft=typeof Pe=="function"?Pe(Object.assign({},y.rects,{placement:y.placement})):Pe,Zt=typeof ft=="number"?{mainAxis:ft,altAxis:ft}:Object.assign({mainAxis:0,altAxis:0},ft),Dr=y.modifiersData.offset?y.modifiersData.offset[y.placement]:null,Bs={x:0,y:0};if(et){if(K){var rr,ns=at==="y"?rn:Yt,rs=at==="y"?Wt:xn,Vt=at==="y"?"height":"width",fo=et[at],ho=fo+Be[ns],_l=fo-Be[rs],bn=Re?-vt[Vt]/2:0,bt=_t===pr?dt[Vt]:vt[Vt],sr=_t===pr?-vt[Vt]:-dt[Vt],ss=y.elements.arrow,ci=Re&&ss?gr(ss):{width:0,height:0},gf=y.modifiersData["arrow#persistent"]?y.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},Dw=gf[ns],Aw=gf[rs],yf=Qu(0,dt[Vt],ci[Vt]),oL=Xe?dt[Vt]/2-bn-yf-Dw-Zt.mainAxis:bt-yf-Dw-Zt.mainAxis,iL=Xe?-dt[Vt]/2+bn+yf+Aw+Zt.mainAxis:sr+yf+Aw+Zt.mainAxis,pg=y.elements.arrow&&Yu(y.elements.arrow),aL=pg?at==="y"?pg.clientTop||0:pg.clientLeft||0:0,Pw=(rr=Dr==null?void 0:Dr[at])!=null?rr:0,lL=fo+iL-Pw,Lw=Qu(Re?ai(ho,fo+oL-Pw-aL):ho,fo,Re?Fs(_l,lL):_l);et[at]=Lw,Bs[at]=Lw-fo}if(le){var Fw,uL=at==="x"?rn:Yt,cL=at==="x"?Wt:xn,ma=et[He],vf=He==="y"?"height":"width",Mw=ma+Be[uL],jw=ma-Be[cL],mg=[rn,Yt].indexOf(yt)!==-1,Bw=(Fw=Dr==null?void 0:Dr[He])!=null?Fw:0,Uw=mg?Mw:ma-dt[vf]-vt[vf]-Bw+Zt.altAxis,zw=mg?ma+dt[vf]+vt[vf]-Bw-Zt.altAxis:jw,Ww=Re&&mg?function(dL,fL,gg){var Vw=Qu(dL,fL,gg);return Vw>gg?gg:Vw}(Uw,ma,zw):Qu(Re?Uw:Mw,ma,Re?zw:jw);et[He]=Ww,Bs[He]=Ww-ma}y.modifiersData[k]=Bs}},requiresIfExists:["offset"]};function v3(T,y,C){C===void 0&&(C=!1);var k,q,K=dn(y),te=dn(y)&&function(we){var Ve=we.getBoundingClientRect(),Re=Rr(Ve.width)/we.offsetWidth||1,je=Rr(Ve.height)/we.offsetHeight||1;return Re!==1||je!==1}(y),le=ui(y),me=it(T,te,C),Ce={scrollLeft:0,scrollTop:0},Ee={x:0,y:0};return(K||!K&&!C)&&((ct(y)!=="body"||og(le))&&(Ce=(k=y)!==on(k)&&dn(k)?{scrollLeft:(q=k).scrollLeft,scrollTop:q.scrollTop}:rg(k)),dn(y)?((Ee=it(y,!0)).x+=y.clientLeft,Ee.y+=y.clientTop):le&&(Ee.x=sg(le))),{x:me.left+Ce.scrollLeft-Ee.x,y:me.top+Ce.scrollTop-Ee.y,width:me.width,height:me.height}}function x3(T){var y=new Map,C=new Set,k=[];function q(K){C.add(K.name),[].concat(K.requires||[],K.requiresIfExists||[]).forEach(function(te){if(!C.has(te)){var le=y.get(te);le&&q(le)}}),k.push(K)}return T.forEach(function(K){y.set(K.name,K)}),T.forEach(function(K){C.has(K.name)||q(K)}),k}var Xb={placement:"bottom",modifiers:[],strategy:"absolute"};function Yb(){for(var T=arguments.length,y=new Array(T),C=0;C<T;C++)y[C]=arguments[C];return!y.some(function(k){return!(k&&typeof k.getBoundingClientRect=="function")})}function af(T){T===void 0&&(T={});var y=T,C=y.defaultModifiers,k=C===void 0?[]:C,q=y.defaultOptions,K=q===void 0?Xb:q;return function(te,le,me){me===void 0&&(me=K);var Ce,Ee,we={placement:"bottom",orderedModifiers:[],options:Object.assign({},Xb,K),modifiersData:{},elements:{reference:te,popper:le},attributes:{},styles:{}},Ve=[],Re=!1,je={state:we,setOptions:function(Be){var yt=typeof Be=="function"?Be(we.options):Be;Pe(),we.options=Object.assign({},K,we.options,yt),we.scrollParents={reference:Ps(te)?Zu(te):te.contextElement?Zu(te.contextElement):[],popper:Zu(le)};var _t,Xe,at=function(He){var et=x3(He);return nr.reduce(function(dt,vt){return dt.concat(et.filter(function(ft){return ft.phase===vt}))},[])}((_t=[].concat(k,we.options.modifiers),Xe=_t.reduce(function(He,et){var dt=He[et.name];return He[et.name]=dt?Object.assign({},dt,et,{options:Object.assign({},dt.options,et.options),data:Object.assign({},dt.data,et.data)}):et,He},{}),Object.keys(Xe).map(function(He){return Xe[He]})));return we.orderedModifiers=at.filter(function(He){return He.enabled}),we.orderedModifiers.forEach(function(He){var et=He.name,dt=He.options,vt=dt===void 0?{}:dt,ft=He.effect;if(typeof ft=="function"){var Zt=ft({state:we,name:et,instance:je,options:vt});Ve.push(Zt||function(){})}}),je.update()},forceUpdate:function(){if(!Re){var Be=we.elements,yt=Be.reference,_t=Be.popper;if(Yb(yt,_t)){we.rects={reference:v3(yt,Yu(_t),we.options.strategy==="fixed"),popper:gr(_t)},we.reset=!1,we.placement=we.options.placement,we.orderedModifiers.forEach(function(ft){return we.modifiersData[ft.name]=Object.assign({},ft.data)});for(var Xe=0;Xe<we.orderedModifiers.length;Xe++)if(we.reset!==!0){var at=we.orderedModifiers[Xe],He=at.fn,et=at.options,dt=et===void 0?{}:et,vt=at.name;typeof He=="function"&&(we=He({state:we,options:dt,name:vt,instance:je})||we)}else we.reset=!1,Xe=-1}}},update:(Ce=function(){return new Promise(function(Be){je.forceUpdate(),Be(we)})},function(){return Ee||(Ee=new Promise(function(Be){Promise.resolve().then(function(){Ee=void 0,Be(Ce())})})),Ee}),destroy:function(){Pe(),Re=!0}};if(!Yb(te,le))return je;function Pe(){Ve.forEach(function(Be){return Be()}),Ve=[]}return je.setOptions(me).then(function(Be){!Re&&me.onFirstUpdate&&me.onFirstUpdate(Be)}),je}}var b3=af(),w3=af({defaultModifiers:[ng,ag,tg,Ls]}),lg=af({defaultModifiers:[ng,ag,tg,Ls,qb,Wb,Kb,Fb,Hb]});const Qb=Object.freeze(Object.defineProperty({__proto__:null,afterMain:Qt,afterRead:$e,afterWrite:sn,applyStyles:Ls,arrow:Fb,auto:ii,basePlacements:Ir,beforeMain:Se,beforeRead:Ie,beforeWrite:We,bottom:Wt,clippingParents:wl,computeStyles:tg,createPopper:lg,createPopperBase:b3,createPopperLite:w3,detectOverflow:Cl,end:Or,eventListeners:ng,flip:Wb,hide:Hb,left:Yt,main:Ge,modifierPhases:nr,offset:qb,placements:ye,popper:Z,popperGenerator:af,popperOffsets:ag,preventOverflow:Kb,read:Ne,reference:se,right:xn,start:pr,top:rn,variationPlacements:ce,viewport:X,write:ut},Symbol.toStringTag,{value:"Module"})),Zb="dropdown",S3="ArrowUp",Jb="ArrowDown",ew="click.bs.dropdown.data-api",tw="keydown.bs.dropdown.data-api",Ju="show",da='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',C3=`${da}.show`,lf=".dropdown-menu",_3=v()?"top-end":"top-start",E3=v()?"top-start":"top-end",T3=v()?"bottom-end":"bottom-start",N3=v()?"bottom-start":"bottom-end",$3=v()?"left-start":"right-start",k3=v()?"right-start":"left-start",I3={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},O3={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class js extends re{constructor(y,C){super(y,C),this._popper=null,this._parent=this._element.parentNode,this._menu=ue.next(this._element,lf)[0]||ue.prev(this._element,lf)[0]||ue.findOne(lf,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return I3}static get DefaultType(){return O3}static get NAME(){return Zb}toggle(){return this._isShown()?this.hide():this.show()}show(){if(c(this._element)||this._isShown())return;const y={relatedTarget:this._element};if(!A.trigger(this._element,"show.bs.dropdown",y).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(".navbar-nav"))for(const C of[].concat(...document.body.children))A.on(C,"mouseover",f);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Ju),this._element.classList.add(Ju),A.trigger(this._element,"shown.bs.dropdown",y)}}hide(){if(c(this._element)||!this._isShown())return;const y={relatedTarget:this._element};this._completeHide(y)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(y){if(!A.trigger(this._element,"hide.bs.dropdown",y).defaultPrevented){if("ontouchstart"in document.documentElement)for(const C of[].concat(...document.body.children))A.off(C,"mouseover",f);this._popper&&this._popper.destroy(),this._menu.classList.remove(Ju),this._element.classList.remove(Ju),this._element.setAttribute("aria-expanded","false"),G.removeDataAttribute(this._menu,"popper"),A.trigger(this._element,"hidden.bs.dropdown",y)}}_getConfig(y){if(typeof(y=super._getConfig(y)).reference=="object"&&!a(y.reference)&&typeof y.reference.getBoundingClientRect!="function")throw new TypeError(`${Zb.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return y}_createPopper(){if(Qb===void 0)throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let y=this._element;this._config.reference==="parent"?y=this._parent:a(this._config.reference)?y=l(this._config.reference):typeof this._config.reference=="object"&&(y=this._config.reference);const C=this._getPopperConfig();this._popper=lg(y,this._menu,C)}_isShown(){return this._menu.classList.contains(Ju)}_getPlacement(){const y=this._parent;if(y.classList.contains("dropend"))return $3;if(y.classList.contains("dropstart"))return k3;if(y.classList.contains("dropup-center"))return"top";if(y.classList.contains("dropdown-center"))return"bottom";const C=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return y.classList.contains("dropup")?C?E3:_3:C?N3:T3}_detectNavbar(){return this._element.closest(".navbar")!==null}_getOffset(){const{offset:y}=this._config;return typeof y=="string"?y.split(",").map(C=>Number.parseInt(C,10)):typeof y=="function"?C=>y(C,this._element):y}_getPopperConfig(){const y={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(G.setDataAttribute(this._menu,"popper","static"),y.modifiers=[{name:"applyStyles",enabled:!1}]),{...y,...x(this._config.popperConfig,[y])}}_selectMenuItem({key:y,target:C}){const k=ue.find(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",this._menu).filter(q=>u(q));k.length&&_(k,C,y===Jb,!k.includes(C)).focus()}static jQueryInterface(y){return this.each(function(){const C=js.getOrCreateInstance(this,y);if(typeof y=="string"){if(C[y]===void 0)throw new TypeError(`No method named "${y}"`);C[y]()}})}static clearMenus(y){if(y.button===2||y.type==="keyup"&&y.key!=="Tab")return;const C=ue.find(C3);for(const k of C){const q=js.getInstance(k);if(!q||q._config.autoClose===!1)continue;const K=y.composedPath(),te=K.includes(q._menu);if(K.includes(q._element)||q._config.autoClose==="inside"&&!te||q._config.autoClose==="outside"&&te||q._menu.contains(y.target)&&(y.type==="keyup"&&y.key==="Tab"||/input|select|option|textarea|form/i.test(y.target.tagName)))continue;const le={relatedTarget:q._element};y.type==="click"&&(le.clickEvent=y),q._completeHide(le)}}static dataApiKeydownHandler(y){const C=/input|textarea/i.test(y.target.tagName),k=y.key==="Escape",q=[S3,Jb].includes(y.key);if(!q&&!k||C&&!k)return;y.preventDefault();const K=this.matches(da)?this:ue.prev(this,da)[0]||ue.next(this,da)[0]||ue.findOne(da,y.delegateTarget.parentNode),te=js.getOrCreateInstance(K);if(q)return y.stopPropagation(),te.show(),void te._selectMenuItem(y);te._isShown()&&(y.stopPropagation(),te.hide(),K.focus())}}A.on(document,tw,da,js.dataApiKeydownHandler),A.on(document,tw,lf,js.dataApiKeydownHandler),A.on(document,ew,js.clearMenus),A.on(document,"keyup.bs.dropdown.data-api",js.clearMenus),A.on(document,ew,da,function(T){T.preventDefault(),js.getOrCreateInstance(this).toggle()}),g(js);const nw="show",rw="mousedown.bs.backdrop",R3={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},D3={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class sw extends J{constructor(y){super(),this._config=this._getConfig(y),this._isAppended=!1,this._element=null}static get Default(){return R3}static get DefaultType(){return D3}static get NAME(){return"backdrop"}show(y){if(!this._config.isVisible)return void x(y);this._append();const C=this._getElement();this._config.isAnimated&&h(C),C.classList.add(nw),this._emulateAnimation(()=>{x(y)})}hide(y){this._config.isVisible?(this._getElement().classList.remove(nw),this._emulateAnimation(()=>{this.dispose(),x(y)})):x(y)}dispose(){this._isAppended&&(A.off(this._element,rw),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const y=document.createElement("div");y.className=this._config.className,this._config.isAnimated&&y.classList.add("fade"),this._element=y}return this._element}_configAfterMerge(y){return y.rootElement=l(y.rootElement),y}_append(){if(this._isAppended)return;const y=this._getElement();this._config.rootElement.append(y),A.on(y,rw,()=>{x(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(y){b(y,this._getElement(),this._config.isAnimated)}}const ow=".bs.focustrap",iw="backward",A3={autofocus:!0,trapElement:null},P3={autofocus:"boolean",trapElement:"element"};class aw extends J{constructor(y){super(),this._config=this._getConfig(y),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return A3}static get DefaultType(){return P3}static get NAME(){return"focustrap"}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),A.off(document,ow),A.on(document,"focusin.bs.focustrap",y=>this._handleFocusin(y)),A.on(document,"keydown.tab.bs.focustrap",y=>this._handleKeydown(y)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,A.off(document,ow))}_handleFocusin(y){const{trapElement:C}=this._config;if(y.target===document||y.target===C||C.contains(y.target))return;const k=ue.focusableChildren(C);k.length===0?C.focus():this._lastTabNavDirection===iw?k[k.length-1].focus():k[0].focus()}_handleKeydown(y){y.key==="Tab"&&(this._lastTabNavDirection=y.shiftKey?iw:"forward")}}const lw=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",uw=".sticky-top",uf="padding-right",cw="margin-right";class ug{constructor(){this._element=document.body}getWidth(){const y=document.documentElement.clientWidth;return Math.abs(window.innerWidth-y)}hide(){const y=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,uf,C=>C+y),this._setElementAttributes(lw,uf,C=>C+y),this._setElementAttributes(uw,cw,C=>C-y)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,uf),this._resetElementAttributes(lw,uf),this._resetElementAttributes(uw,cw)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(y,C,k){const q=this.getWidth();this._applyManipulationCallback(y,K=>{if(K!==this._element&&window.innerWidth>K.clientWidth+q)return;this._saveInitialAttribute(K,C);const te=window.getComputedStyle(K).getPropertyValue(C);K.style.setProperty(C,`${k(Number.parseFloat(te))}px`)})}_saveInitialAttribute(y,C){const k=y.style.getPropertyValue(C);k&&G.setDataAttribute(y,C,k)}_resetElementAttributes(y,C){this._applyManipulationCallback(y,k=>{const q=G.getDataAttribute(k,C);q!==null?(G.removeDataAttribute(k,C),k.style.setProperty(C,q)):k.style.removeProperty(C)})}_applyManipulationCallback(y,C){if(a(y))C(y);else for(const k of ue.find(y,this._element))C(k)}}const dw=".bs.modal",fw="hidden.bs.modal",hw="show.bs.modal",pw="modal-open",mw="show",cg="modal-static",L3={backdrop:!0,focus:!0,keyboard:!0},F3={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class fa extends re{constructor(y,C){super(y,C),this._dialog=ue.findOne(".modal-dialog",this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new ug,this._addEventListeners()}static get Default(){return L3}static get DefaultType(){return F3}static get NAME(){return"modal"}toggle(y){return this._isShown?this.hide():this.show(y)}show(y){this._isShown||this._isTransitioning||A.trigger(this._element,hw,{relatedTarget:y}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(pw),this._adjustDialog(),this._backdrop.show(()=>this._showElement(y)))}hide(){this._isShown&&!this._isTransitioning&&(A.trigger(this._element,"hide.bs.modal").defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(mw),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated())))}dispose(){A.off(window,dw),A.off(this._dialog,dw),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new sw({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new aw({trapElement:this._element})}_showElement(y){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const C=ue.findOne(".modal-body",this._dialog);C&&(C.scrollTop=0),h(this._element),this._element.classList.add(mw),this._queueCallback(()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,A.trigger(this._element,"shown.bs.modal",{relatedTarget:y})},this._dialog,this._isAnimated())}_addEventListeners(){A.on(this._element,"keydown.dismiss.bs.modal",y=>{y.key==="Escape"&&(this._config.keyboard?this.hide():this._triggerBackdropTransition())}),A.on(window,"resize.bs.modal",()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),A.on(this._element,"mousedown.dismiss.bs.modal",y=>{A.one(this._element,"click.dismiss.bs.modal",C=>{this._element===y.target&&this._element===C.target&&(this._config.backdrop!=="static"?this._config.backdrop&&this.hide():this._triggerBackdropTransition())})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(pw),this._resetAdjustments(),this._scrollBar.reset(),A.trigger(this._element,fw)})}_isAnimated(){return this._element.classList.contains("fade")}_triggerBackdropTransition(){if(A.trigger(this._element,"hidePrevented.bs.modal").defaultPrevented)return;const y=this._element.scrollHeight>document.documentElement.clientHeight,C=this._element.style.overflowY;C==="hidden"||this._element.classList.contains(cg)||(y||(this._element.style.overflowY="hidden"),this._element.classList.add(cg),this._queueCallback(()=>{this._element.classList.remove(cg),this._queueCallback(()=>{this._element.style.overflowY=C},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const y=this._element.scrollHeight>document.documentElement.clientHeight,C=this._scrollBar.getWidth(),k=C>0;if(k&&!y){const q=v()?"paddingLeft":"paddingRight";this._element.style[q]=`${C}px`}if(!k&&y){const q=v()?"paddingRight":"paddingLeft";this._element.style[q]=`${C}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(y,C){return this.each(function(){const k=fa.getOrCreateInstance(this,y);if(typeof y=="string"){if(k[y]===void 0)throw new TypeError(`No method named "${y}"`);k[y](C)}})}}A.on(document,"click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(T){const y=ue.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&T.preventDefault(),A.one(y,hw,k=>{k.defaultPrevented||A.one(y,fw,()=>{u(this)&&this.focus()})});const C=ue.findOne(".modal.show");C&&fa.getInstance(C).hide(),fa.getOrCreateInstance(y).toggle(this)}),De(fa),g(fa);const gw="show",yw="showing",vw="hiding",xw=".offcanvas.show",bw="hidePrevented.bs.offcanvas",ww="hidden.bs.offcanvas",M3={backdrop:!0,keyboard:!0,scroll:!1},j3={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Do extends re{constructor(y,C){super(y,C),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return M3}static get DefaultType(){return j3}static get NAME(){return"offcanvas"}toggle(y){return this._isShown?this.hide():this.show(y)}show(y){this._isShown||A.trigger(this._element,"show.bs.offcanvas",{relatedTarget:y}).defaultPrevented||(this._isShown=!0,this._backdrop.show(),this._config.scroll||new ug().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(yw),this._queueCallback(()=>{this._config.scroll&&!this._config.backdrop||this._focustrap.activate(),this._element.classList.add(gw),this._element.classList.remove(yw),A.trigger(this._element,"shown.bs.offcanvas",{relatedTarget:y})},this._element,!0))}hide(){this._isShown&&(A.trigger(this._element,"hide.bs.offcanvas").defaultPrevented||(this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(vw),this._backdrop.hide(),this._queueCallback(()=>{this._element.classList.remove(gw,vw),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new ug().reset(),A.trigger(this._element,ww)},this._element,!0)))}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const y=!!this._config.backdrop;return new sw({className:"offcanvas-backdrop",isVisible:y,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:y?()=>{this._config.backdrop!=="static"?this.hide():A.trigger(this._element,bw)}:null})}_initializeFocusTrap(){return new aw({trapElement:this._element})}_addEventListeners(){A.on(this._element,"keydown.dismiss.bs.offcanvas",y=>{y.key==="Escape"&&(this._config.keyboard?this.hide():A.trigger(this._element,bw))})}static jQueryInterface(y){return this.each(function(){const C=Do.getOrCreateInstance(this,y);if(typeof y=="string"){if(C[y]===void 0||y.startsWith("_")||y==="constructor")throw new TypeError(`No method named "${y}"`);C[y](this)}})}}A.on(document,"click.bs.offcanvas.data-api",'[data-bs-toggle="offcanvas"]',function(T){const y=ue.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&T.preventDefault(),c(this))return;A.one(y,ww,()=>{u(this)&&this.focus()});const C=ue.findOne(xw);C&&C!==y&&Do.getInstance(C).hide(),Do.getOrCreateInstance(y).toggle(this)}),A.on(window,"load.bs.offcanvas.data-api",()=>{for(const T of ue.find(xw))Do.getOrCreateInstance(T).show()}),A.on(window,"resize.bs.offcanvas",()=>{for(const T of ue.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(T).position!=="fixed"&&Do.getOrCreateInstance(T).hide()}),De(Do),g(Do);const Sw={"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},B3=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),U3=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,z3=(T,y)=>{const C=T.nodeName.toLowerCase();return y.includes(C)?!B3.has(C)||!!U3.test(T.nodeValue):y.filter(k=>k instanceof RegExp).some(k=>k.test(C))},W3={allowList:Sw,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},V3={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},G3={entry:"(string|element|function|null)",selector:"(string|element)"};class H3 extends J{constructor(y){super(),this._config=this._getConfig(y)}static get Default(){return W3}static get DefaultType(){return V3}static get NAME(){return"TemplateFactory"}getContent(){return Object.values(this._config.content).map(y=>this._resolvePossibleFunction(y)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(y){return this._checkContent(y),this._config.content={...this._config.content,...y},this}toHtml(){const y=document.createElement("div");y.innerHTML=this._maybeSanitize(this._config.template);for(const[q,K]of Object.entries(this._config.content))this._setContent(y,K,q);const C=y.children[0],k=this._resolvePossibleFunction(this._config.extraClass);return k&&C.classList.add(...k.split(" ")),C}_typeCheckConfig(y){super._typeCheckConfig(y),this._checkContent(y.content)}_checkContent(y){for(const[C,k]of Object.entries(y))super._typeCheckConfig({selector:C,entry:k},G3)}_setContent(y,C,k){const q=ue.findOne(k,y);q&&((C=this._resolvePossibleFunction(C))?a(C)?this._putElementInTemplate(l(C),q):this._config.html?q.innerHTML=this._maybeSanitize(C):q.textContent=C:q.remove())}_maybeSanitize(y){return this._config.sanitize?function(C,k,q){if(!C.length)return C;if(q&&typeof q=="function")return q(C);const K=new window.DOMParser().parseFromString(C,"text/html"),te=[].concat(...K.body.querySelectorAll("*"));for(const le of te){const me=le.nodeName.toLowerCase();if(!Object.keys(k).includes(me)){le.remove();continue}const Ce=[].concat(...le.attributes),Ee=[].concat(k["*"]||[],k[me]||[]);for(const we of Ce)z3(we,Ee)||le.removeAttribute(we.nodeName)}return K.body.innerHTML}(y,this._config.allowList,this._config.sanitizeFn):y}_resolvePossibleFunction(y){return x(y,[this])}_putElementInTemplate(y,C){if(this._config.html)return C.innerHTML="",void C.append(y);C.textContent=y.textContent}}const q3=new Set(["sanitize","allowList","sanitizeFn"]),dg="fade",cf="show",Cw=".modal",_w="hide.bs.modal",df="hover",Ew="focus",K3={AUTO:"auto",TOP:"top",RIGHT:v()?"left":"right",BOTTOM:"bottom",LEFT:v()?"right":"left"},X3={allowList:Sw,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Y3={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class ha extends re{constructor(y,C){if(Qb===void 0)throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(y,C),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return X3}static get DefaultType(){return Y3}static get NAME(){return"tooltip"}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){this._isEnabled&&(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()?this._leave():this._enter())}dispose(){clearTimeout(this._timeout),A.off(this._element.closest(Cw),_w,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!this._isWithContent()||!this._isEnabled)return;const y=A.trigger(this._element,this.constructor.eventName("show")),C=(d(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(y.defaultPrevented||!C)return;this._disposePopper();const k=this._getTipElement();this._element.setAttribute("aria-describedby",k.getAttribute("id"));const{container:q}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(q.append(k),A.trigger(this._element,this.constructor.eventName("inserted"))),this._popper=this._createPopper(k),k.classList.add(cf),"ontouchstart"in document.documentElement)for(const K of[].concat(...document.body.children))A.on(K,"mouseover",f);this._queueCallback(()=>{A.trigger(this._element,this.constructor.eventName("shown")),this._isHovered===!1&&this._leave(),this._isHovered=!1},this.tip,this._isAnimated())}hide(){if(this._isShown()&&!A.trigger(this._element,this.constructor.eventName("hide")).defaultPrevented){if(this._getTipElement().classList.remove(cf),"ontouchstart"in document.documentElement)for(const y of[].concat(...document.body.children))A.off(y,"mouseover",f);this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,this._isHovered=null,this._queueCallback(()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),A.trigger(this._element,this.constructor.eventName("hidden")))},this.tip,this._isAnimated())}}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(y){const C=this._getTemplateFactory(y).toHtml();if(!C)return null;C.classList.remove(dg,cf),C.classList.add(`bs-${this.constructor.NAME}-auto`);const k=(q=>{do q+=Math.floor(1e6*Math.random());while(document.getElementById(q));return q})(this.constructor.NAME).toString();return C.setAttribute("id",k),this._isAnimated()&&C.classList.add(dg),C}setContent(y){this._newContent=y,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(y){return this._templateFactory?this._templateFactory.changeContent(y):this._templateFactory=new H3({...this._config,content:y,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{".tooltip-inner":this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(y){return this.constructor.getOrCreateInstance(y.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(dg)}_isShown(){return this.tip&&this.tip.classList.contains(cf)}_createPopper(y){const C=x(this._config.placement,[this,y,this._element]),k=K3[C.toUpperCase()];return lg(this._element,y,this._getPopperConfig(k))}_getOffset(){const{offset:y}=this._config;return typeof y=="string"?y.split(",").map(C=>Number.parseInt(C,10)):typeof y=="function"?C=>y(C,this._element):y}_resolvePossibleFunction(y){return x(y,[this._element])}_getPopperConfig(y){const C={placement:y,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:k=>{this._getTipElement().setAttribute("data-popper-placement",k.state.placement)}}]};return{...C,...x(this._config.popperConfig,[C])}}_setListeners(){const y=this._config.trigger.split(" ");for(const C of y)if(C==="click")A.on(this._element,this.constructor.eventName("click"),this._config.selector,k=>{this._initializeOnDelegatedTarget(k).toggle()});else if(C!=="manual"){const k=C===df?this.constructor.eventName("mouseenter"):this.constructor.eventName("focusin"),q=C===df?this.constructor.eventName("mouseleave"):this.constructor.eventName("focusout");A.on(this._element,k,this._config.selector,K=>{const te=this._initializeOnDelegatedTarget(K);te._activeTrigger[K.type==="focusin"?Ew:df]=!0,te._enter()}),A.on(this._element,q,this._config.selector,K=>{const te=this._initializeOnDelegatedTarget(K);te._activeTrigger[K.type==="focusout"?Ew:df]=te._element.contains(K.relatedTarget),te._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},A.on(this._element.closest(Cw),_w,this._hideModalHandler)}_fixTitle(){const y=this._element.getAttribute("title");y&&(this._element.getAttribute("aria-label")||this._element.textContent.trim()||this._element.setAttribute("aria-label",y),this._element.setAttribute("data-bs-original-title",y),this._element.removeAttribute("title"))}_enter(){this._isShown()||this._isHovered?this._isHovered=!0:(this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show))}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(y,C){clearTimeout(this._timeout),this._timeout=setTimeout(y,C)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(y){const C=G.getDataAttributes(this._element);for(const k of Object.keys(C))q3.has(k)&&delete C[k];return y={...C,...typeof y=="object"&&y?y:{}},y=this._mergeConfigObj(y),y=this._configAfterMerge(y),this._typeCheckConfig(y),y}_configAfterMerge(y){return y.container=y.container===!1?document.body:l(y.container),typeof y.delay=="number"&&(y.delay={show:y.delay,hide:y.delay}),typeof y.title=="number"&&(y.title=y.title.toString()),typeof y.content=="number"&&(y.content=y.content.toString()),y}_getDelegateConfig(){const y={};for(const[C,k]of Object.entries(this._config))this.constructor.Default[C]!==k&&(y[C]=k);return y.selector=!1,y.trigger="manual",y}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(y){return this.each(function(){const C=ha.getOrCreateInstance(this,y);if(typeof y=="string"){if(C[y]===void 0)throw new TypeError(`No method named "${y}"`);C[y]()}})}}g(ha);const Q3={...ha.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Z3={...ha.DefaultType,content:"(null|string|element|function)"};class ff extends ha{static get Default(){return Q3}static get DefaultType(){return Z3}static get NAME(){return"popover"}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{".popover-header":this._getTitle(),".popover-body":this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(y){return this.each(function(){const C=ff.getOrCreateInstance(this,y);if(typeof y=="string"){if(C[y]===void 0)throw new TypeError(`No method named "${y}"`);C[y]()}})}}g(ff);const Tw="click.bs.scrollspy",ec="active",Nw="[href]",J3={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},eL={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class tc extends re{constructor(y,C){super(y,C),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return J3}static get DefaultType(){return eL}static get NAME(){return"scrollspy"}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const y of this._observableSections.values())this._observer.observe(y)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(y){return y.target=l(y.target)||document.body,y.rootMargin=y.offset?`${y.offset}px 0px -30%`:y.rootMargin,typeof y.threshold=="string"&&(y.threshold=y.threshold.split(",").map(C=>Number.parseFloat(C))),y}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(A.off(this._config.target,Tw),A.on(this._config.target,Tw,Nw,y=>{const C=this._observableSections.get(y.target.hash);if(C){y.preventDefault();const k=this._rootElement||window,q=C.offsetTop-this._element.offsetTop;if(k.scrollTo)return void k.scrollTo({top:q,behavior:"smooth"});k.scrollTop=q}}))}_getNewObserver(){const y={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(C=>this._observerCallback(C),y)}_observerCallback(y){const C=te=>this._targetLinks.get(`#${te.target.id}`),k=te=>{this._previousScrollData.visibleEntryTop=te.target.offsetTop,this._process(C(te))},q=(this._rootElement||document.documentElement).scrollTop,K=q>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=q;for(const te of y){if(!te.isIntersecting){this._activeTarget=null,this._clearActiveClass(C(te));continue}const le=te.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(K&&le){if(k(te),!q)return}else K||le||k(te)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const y=ue.find(Nw,this._config.target);for(const C of y){if(!C.hash||c(C))continue;const k=ue.findOne(decodeURI(C.hash),this._element);u(k)&&(this._targetLinks.set(decodeURI(C.hash),C),this._observableSections.set(C.hash,k))}}_process(y){this._activeTarget!==y&&(this._clearActiveClass(this._config.target),this._activeTarget=y,y.classList.add(ec),this._activateParents(y),A.trigger(this._element,"activate.bs.scrollspy",{relatedTarget:y}))}_activateParents(y){if(y.classList.contains("dropdown-item"))ue.findOne(".dropdown-toggle",y.closest(".dropdown")).classList.add(ec);else for(const C of ue.parents(y,".nav, .list-group"))for(const k of ue.prev(C,".nav-link, .nav-item > .nav-link, .list-group-item"))k.classList.add(ec)}_clearActiveClass(y){y.classList.remove(ec);const C=ue.find("[href].active",y);for(const k of C)k.classList.remove(ec)}static jQueryInterface(y){return this.each(function(){const C=tc.getOrCreateInstance(this,y);if(typeof y=="string"){if(C[y]===void 0||y.startsWith("_")||y==="constructor")throw new TypeError(`No method named "${y}"`);C[y]()}})}}A.on(window,"load.bs.scrollspy.data-api",()=>{for(const T of ue.find('[data-bs-spy="scroll"]'))tc.getOrCreateInstance(T)}),g(tc);const tL="ArrowLeft",$w="ArrowRight",nL="ArrowUp",kw="ArrowDown",hf="active",Iw="fade",fg="show",Ow='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',hg=`.nav-link:not(.dropdown-toggle), .list-group-item:not(.dropdown-toggle), [role="tab"]:not(.dropdown-toggle), ${Ow}`;class pa extends re{constructor(y){super(y),this._parent=this._element.closest('.list-group, .nav, [role="tablist"]'),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),A.on(this._element,"keydown.bs.tab",C=>this._keydown(C)))}static get NAME(){return"tab"}show(){const y=this._element;if(this._elemIsActive(y))return;const C=this._getActiveElem(),k=C?A.trigger(C,"hide.bs.tab",{relatedTarget:y}):null;A.trigger(y,"show.bs.tab",{relatedTarget:C}).defaultPrevented||k&&k.defaultPrevented||(this._deactivate(C,y),this._activate(y,C))}_activate(y,C){y&&(y.classList.add(hf),this._activate(ue.getElementFromSelector(y)),this._queueCallback(()=>{y.getAttribute("role")==="tab"?(y.removeAttribute("tabindex"),y.setAttribute("aria-selected",!0),this._toggleDropDown(y,!0),A.trigger(y,"shown.bs.tab",{relatedTarget:C})):y.classList.add(fg)},y,y.classList.contains(Iw)))}_deactivate(y,C){y&&(y.classList.remove(hf),y.blur(),this._deactivate(ue.getElementFromSelector(y)),this._queueCallback(()=>{y.getAttribute("role")==="tab"?(y.setAttribute("aria-selected",!1),y.setAttribute("tabindex","-1"),this._toggleDropDown(y,!1),A.trigger(y,"hidden.bs.tab",{relatedTarget:C})):y.classList.remove(fg)},y,y.classList.contains(Iw)))}_keydown(y){if(![tL,$w,nL,kw].includes(y.key))return;y.stopPropagation(),y.preventDefault();const C=[$w,kw].includes(y.key),k=_(this._getChildren().filter(q=>!c(q)),y.target,C,!0);k&&(k.focus({preventScroll:!0}),pa.getOrCreateInstance(k).show())}_getChildren(){return ue.find(hg,this._parent)}_getActiveElem(){return this._getChildren().find(y=>this._elemIsActive(y))||null}_setInitialAttributes(y,C){this._setAttributeIfNotExists(y,"role","tablist");for(const k of C)this._setInitialAttributesOnChild(k)}_setInitialAttributesOnChild(y){y=this._getInnerElement(y);const C=this._elemIsActive(y),k=this._getOuterElement(y);y.setAttribute("aria-selected",C),k!==y&&this._setAttributeIfNotExists(k,"role","presentation"),C||y.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(y,"role","tab"),this._setInitialAttributesOnTargetPanel(y)}_setInitialAttributesOnTargetPanel(y){const C=ue.getElementFromSelector(y);C&&(this._setAttributeIfNotExists(C,"role","tabpanel"),y.id&&this._setAttributeIfNotExists(C,"aria-labelledby",`${y.id}`))}_toggleDropDown(y,C){const k=this._getOuterElement(y);if(!k.classList.contains("dropdown"))return;const q=(K,te)=>{const le=ue.findOne(K,k);le&&le.classList.toggle(te,C)};q(".dropdown-toggle",hf),q(".dropdown-menu",fg),k.setAttribute("aria-expanded",C)}_setAttributeIfNotExists(y,C,k){y.hasAttribute(C)||y.setAttribute(C,k)}_elemIsActive(y){return y.classList.contains(hf)}_getInnerElement(y){return y.matches(hg)?y:ue.findOne(hg,y)}_getOuterElement(y){return y.closest(".nav-item, .list-group-item")||y}static jQueryInterface(y){return this.each(function(){const C=pa.getOrCreateInstance(this);if(typeof y=="string"){if(C[y]===void 0||y.startsWith("_")||y==="constructor")throw new TypeError(`No method named "${y}"`);C[y]()}})}}A.on(document,"click.bs.tab",Ow,function(T){["A","AREA"].includes(this.tagName)&&T.preventDefault(),c(this)||pa.getOrCreateInstance(this).show()}),A.on(window,"load.bs.tab",()=>{for(const T of ue.find('.active[data-bs-toggle="tab"], .active[data-bs-toggle="pill"], .active[data-bs-toggle="list"]'))pa.getOrCreateInstance(T)}),g(pa);const Rw="hide",pf="show",mf="showing",rL={animation:"boolean",autohide:"boolean",delay:"number"},sL={animation:!0,autohide:!0,delay:5e3};class nc extends re{constructor(y,C){super(y,C),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return sL}static get DefaultType(){return rL}static get NAME(){return"toast"}show(){A.trigger(this._element,"show.bs.toast").defaultPrevented||(this._clearTimeout(),this._config.animation&&this._element.classList.add("fade"),this._element.classList.remove(Rw),h(this._element),this._element.classList.add(pf,mf),this._queueCallback(()=>{this._element.classList.remove(mf),A.trigger(this._element,"shown.bs.toast"),this._maybeScheduleHide()},this._element,this._config.animation))}hide(){this.isShown()&&(A.trigger(this._element,"hide.bs.toast").defaultPrevented||(this._element.classList.add(mf),this._queueCallback(()=>{this._element.classList.add(Rw),this._element.classList.remove(mf,pf),A.trigger(this._element,"hidden.bs.toast")},this._element,this._config.animation)))}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(pf),super.dispose()}isShown(){return this._element.classList.contains(pf)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(y,C){switch(y.type){case"mouseover":case"mouseout":this._hasMouseInteraction=C;break;case"focusin":case"focusout":this._hasKeyboardInteraction=C}if(C)return void this._clearTimeout();const k=y.relatedTarget;this._element===k||this._element.contains(k)||this._maybeScheduleHide()}_setListeners(){A.on(this._element,"mouseover.bs.toast",y=>this._onInteraction(y,!0)),A.on(this._element,"mouseout.bs.toast",y=>this._onInteraction(y,!1)),A.on(this._element,"focusin.bs.toast",y=>this._onInteraction(y,!0)),A.on(this._element,"focusout.bs.toast",y=>this._onInteraction(y,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(y){return this.each(function(){const C=nc.getOrCreateInstance(this,y);if(typeof y=="string"){if(C[y]===void 0)throw new TypeError(`No method named "${y}"`);C[y](this)}})}}return De(nc),g(nc),{Alert:Ae,Button:ot,Carousel:Ds,Collapse:co,Dropdown:js,Modal:fa,Offcanvas:Do,Popover:ff,ScrollSpy:tc,Tab:pa,Toast:nc,Tooltip:ha}})})(FL);var pT={exports:{}},Kr={},mT={exports:{}},gT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,j){var A=O.length;O.push(j);e:for(;0<A;){var ne=A-1>>>1,U=O[ne];if(0<s(U,j))O[ne]=j,O[A]=U,A=ne;else break e}}function n(O){return O.length===0?null:O[0]}function r(O){if(O.length===0)return null;var j=O[0],A=O.pop();if(A!==j){O[0]=A;e:for(var ne=0,U=O.length,Q=U>>>1;ne<Q;){var G=2*(ne+1)-1,J=O[G],re=G+1,be=O[re];if(0>s(J,A))re<U&&0>s(be,J)?(O[ne]=be,O[re]=A,ne=re):(O[ne]=J,O[G]=A,ne=G);else if(re<U&&0>s(be,A))O[ne]=be,O[re]=A,ne=re;else break e}}return j}function s(O,j){var A=O.sortIndex-j.sortIndex;return A!==0?A:O.id-j.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var l=[],u=[],c=1,d=null,f=3,h=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(O){for(var j=n(u);j!==null;){if(j.callback===null)r(u);else if(j.startTime<=O)r(u),j.sortIndex=j.expirationTime,e(l,j);else break;j=n(u)}}function _(O){if(m=!1,b(O),!p)if(n(l)!==null)p=!0,W(N);else{var j=n(u);j!==null&&I(_,j.startTime-O)}}function N(O,j){p=!1,m&&(m=!1,g(P),P=-1),h=!0;var A=f;try{for(b(j),d=n(l);d!==null&&(!(d.expirationTime>j)||O&&!H());){var ne=d.callback;if(typeof ne=="function"){d.callback=null,f=d.priorityLevel;var U=ne(d.expirationTime<=j);j=t.unstable_now(),typeof U=="function"?d.callback=U:d===n(l)&&r(l),b(j)}else r(l);d=n(l)}if(d!==null)var Q=!0;else{var G=n(u);G!==null&&I(_,G.startTime-j),Q=!1}return Q}finally{d=null,f=A,h=!1}}var E=!1,R=null,P=-1,B=5,F=-1;function H(){return!(t.unstable_now()-F<B)}function ee(){if(R!==null){var O=t.unstable_now();F=O;var j=!0;try{j=R(!0,O)}finally{j?oe():(E=!1,R=null)}}else E=!1}var oe;if(typeof x=="function")oe=function(){x(ee)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,V=de.port2;de.port1.onmessage=ee,oe=function(){V.postMessage(null)}}else oe=function(){v(ee,0)};function W(O){R=O,E||(E=!0,oe())}function I(O,j){P=v(function(){O(t.unstable_now())},j)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){p||h||(p=!0,W(N))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(O){switch(f){case 1:case 2:case 3:var j=3;break;default:j=f}var A=f;f=j;try{return O()}finally{f=A}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,j){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var A=f;f=O;try{return j()}finally{f=A}},t.unstable_scheduleCallback=function(O,j,A){var ne=t.unstable_now();switch(typeof A=="object"&&A!==null?(A=A.delay,A=typeof A=="number"&&0<A?ne+A:ne):A=ne,O){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=A+U,O={id:c++,callback:j,priorityLevel:O,startTime:A,expirationTime:U,sortIndex:-1},A>ne?(O.sortIndex=A,e(u,O),n(l)===null&&O===n(u)&&(m?(g(P),P=-1):m=!0,I(_,A-ne))):(O.sortIndex=U,e(l,O),p||h||(p=!0,W(N))),O},t.unstable_shouldYield=H,t.unstable_wrapCallback=function(O){var j=f;return function(){var A=f;f=j;try{return O.apply(this,arguments)}finally{f=A}}}})(gT);mT.exports=gT;var ML=mT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yT=L,Hr=ML;function fe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var vT=new Set,Jc={};function ol(t,e){uu(t,e),uu(t+"Capture",e)}function uu(t,e){for(Jc[t]=e,t=0;t<e.length;t++)vT.add(e[t])}var Vo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ry=Object.prototype.hasOwnProperty,jL=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Kw={},Xw={};function BL(t){return Ry.call(Xw,t)?!0:Ry.call(Kw,t)?!1:jL.test(t)?Xw[t]=!0:(Kw[t]=!0,!1)}function UL(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function zL(t,e,n,r){if(e===null||typeof e>"u"||UL(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function fr(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Ln={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ln[t]=new fr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ln[e]=new fr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ln[t]=new fr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ln[t]=new fr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ln[t]=new fr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ln[t]=new fr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ln[t]=new fr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ln[t]=new fr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ln[t]=new fr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Gv=/[\-:]([a-z])/g;function Hv(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Gv,Hv);Ln[e]=new fr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Gv,Hv);Ln[e]=new fr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Gv,Hv);Ln[e]=new fr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ln[t]=new fr(t,1,!1,t.toLowerCase(),null,!1,!1)});Ln.xlinkHref=new fr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ln[t]=new fr(t,1,!1,t.toLowerCase(),null,!0,!0)});function qv(t,e,n,r){var s=Ln.hasOwnProperty(e)?Ln[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(zL(e,n,s,r)&&(n=null),r||s===null?BL(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Zo=yT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bf=Symbol.for("react.element"),Dl=Symbol.for("react.portal"),Al=Symbol.for("react.fragment"),Kv=Symbol.for("react.strict_mode"),Dy=Symbol.for("react.profiler"),xT=Symbol.for("react.provider"),bT=Symbol.for("react.context"),Xv=Symbol.for("react.forward_ref"),Ay=Symbol.for("react.suspense"),Py=Symbol.for("react.suspense_list"),Yv=Symbol.for("react.memo"),vi=Symbol.for("react.lazy"),wT=Symbol.for("react.offscreen"),Yw=Symbol.iterator;function rc(t){return t===null||typeof t!="object"?null:(t=Yw&&t[Yw]||t["@@iterator"],typeof t=="function"?t:null)}var Bt=Object.assign,vg;function Ec(t){if(vg===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);vg=e&&e[1]||""}return`
`+vg+t}var xg=!1;function bg(t,e){if(!t||xg)return"";xg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,a=o.length-1;1<=i&&0<=a&&s[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(s[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||s[i]!==o[a]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=a);break}}}finally{xg=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ec(t):""}function WL(t){switch(t.tag){case 5:return Ec(t.type);case 16:return Ec("Lazy");case 13:return Ec("Suspense");case 19:return Ec("SuspenseList");case 0:case 2:case 15:return t=bg(t.type,!1),t;case 11:return t=bg(t.type.render,!1),t;case 1:return t=bg(t.type,!0),t;default:return""}}function Ly(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Al:return"Fragment";case Dl:return"Portal";case Dy:return"Profiler";case Kv:return"StrictMode";case Ay:return"Suspense";case Py:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case bT:return(t.displayName||"Context")+".Consumer";case xT:return(t._context.displayName||"Context")+".Provider";case Xv:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Yv:return e=t.displayName||null,e!==null?e:Ly(t.type)||"Memo";case vi:e=t._payload,t=t._init;try{return Ly(t(e))}catch{}}return null}function VL(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ly(e);case 8:return e===Kv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function qi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ST(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function GL(t){var e=ST(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wf(t){t._valueTracker||(t._valueTracker=GL(t))}function CT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ST(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Oh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Fy(t,e){var n=e.checked;return Bt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Qw(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=qi(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _T(t,e){e=e.checked,e!=null&&qv(t,"checked",e,!1)}function My(t,e){_T(t,e);var n=qi(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?jy(t,e.type,n):e.hasOwnProperty("defaultValue")&&jy(t,e.type,qi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Zw(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function jy(t,e,n){(e!=="number"||Oh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Tc=Array.isArray;function Xl(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+qi(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function By(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(fe(91));return Bt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Jw(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(fe(92));if(Tc(n)){if(1<n.length)throw Error(fe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:qi(n)}}function ET(t,e){var n=qi(e.value),r=qi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function eS(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function TT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Uy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?TT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Sf,NT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Sf=Sf||document.createElement("div"),Sf.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Sf.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ed(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Fc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},HL=["Webkit","ms","Moz","O"];Object.keys(Fc).forEach(function(t){HL.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Fc[e]=Fc[t]})});function $T(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Fc.hasOwnProperty(t)&&Fc[t]?(""+e).trim():e+"px"}function kT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=$T(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var qL=Bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zy(t,e){if(e){if(qL[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(fe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(fe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(fe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(fe(62))}}function Wy(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vy=null;function Qv(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Gy=null,Yl=null,Ql=null;function tS(t){if(t=Md(t)){if(typeof Gy!="function")throw Error(fe(280));var e=t.stateNode;e&&(e=Fp(e),Gy(t.stateNode,t.type,e))}}function IT(t){Yl?Ql?Ql.push(t):Ql=[t]:Yl=t}function OT(){if(Yl){var t=Yl,e=Ql;if(Ql=Yl=null,tS(t),e)for(t=0;t<e.length;t++)tS(e[t])}}function RT(t,e){return t(e)}function DT(){}var wg=!1;function AT(t,e,n){if(wg)return t(e,n);wg=!0;try{return RT(t,e,n)}finally{wg=!1,(Yl!==null||Ql!==null)&&(DT(),OT())}}function td(t,e){var n=t.stateNode;if(n===null)return null;var r=Fp(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(fe(231,e,typeof n));return n}var Hy=!1;if(Vo)try{var sc={};Object.defineProperty(sc,"passive",{get:function(){Hy=!0}}),window.addEventListener("test",sc,sc),window.removeEventListener("test",sc,sc)}catch{Hy=!1}function KL(t,e,n,r,s,o,i,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(c){this.onError(c)}}var Mc=!1,Rh=null,Dh=!1,qy=null,XL={onError:function(t){Mc=!0,Rh=t}};function YL(t,e,n,r,s,o,i,a,l){Mc=!1,Rh=null,KL.apply(XL,arguments)}function QL(t,e,n,r,s,o,i,a,l){if(YL.apply(this,arguments),Mc){if(Mc){var u=Rh;Mc=!1,Rh=null}else throw Error(fe(198));Dh||(Dh=!0,qy=u)}}function il(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function PT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function nS(t){if(il(t)!==t)throw Error(fe(188))}function ZL(t){var e=t.alternate;if(!e){if(e=il(t),e===null)throw Error(fe(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return nS(s),t;if(o===r)return nS(s),e;o=o.sibling}throw Error(fe(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,a=s.child;a;){if(a===n){i=!0,n=s,r=o;break}if(a===r){i=!0,r=s,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,r=s;break}if(a===r){i=!0,r=o,n=s;break}a=a.sibling}if(!i)throw Error(fe(189))}}if(n.alternate!==r)throw Error(fe(190))}if(n.tag!==3)throw Error(fe(188));return n.stateNode.current===n?t:e}function LT(t){return t=ZL(t),t!==null?FT(t):null}function FT(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=FT(t);if(e!==null)return e;t=t.sibling}return null}var MT=Hr.unstable_scheduleCallback,rS=Hr.unstable_cancelCallback,JL=Hr.unstable_shouldYield,eF=Hr.unstable_requestPaint,en=Hr.unstable_now,tF=Hr.unstable_getCurrentPriorityLevel,Zv=Hr.unstable_ImmediatePriority,jT=Hr.unstable_UserBlockingPriority,Ah=Hr.unstable_NormalPriority,nF=Hr.unstable_LowPriority,BT=Hr.unstable_IdlePriority,Dp=null,wo=null;function rF(t){if(wo&&typeof wo.onCommitFiberRoot=="function")try{wo.onCommitFiberRoot(Dp,t,void 0,(t.current.flags&128)===128)}catch{}}var eo=Math.clz32?Math.clz32:iF,sF=Math.log,oF=Math.LN2;function iF(t){return t>>>=0,t===0?32:31-(sF(t)/oF|0)|0}var Cf=64,_f=4194304;function Nc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ph(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~s;a!==0?r=Nc(a):(o&=i,o!==0&&(r=Nc(o)))}else i=n&~s,i!==0?r=Nc(i):o!==0&&(r=Nc(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-eo(e),s=1<<n,r|=t[n],e&=~s;return r}function aF(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lF(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-eo(o),a=1<<i,l=s[i];l===-1?(!(a&n)||a&r)&&(s[i]=aF(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function Ky(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function UT(){var t=Cf;return Cf<<=1,!(Cf&4194240)&&(Cf=64),t}function Sg(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ld(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-eo(e),t[e]=n}function uF(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-eo(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function Jv(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-eo(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var pt=0;function zT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var WT,e1,VT,GT,HT,Xy=!1,Ef=[],Oi=null,Ri=null,Di=null,nd=new Map,rd=new Map,Ci=[],cF="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function sS(t,e){switch(t){case"focusin":case"focusout":Oi=null;break;case"dragenter":case"dragleave":Ri=null;break;case"mouseover":case"mouseout":Di=null;break;case"pointerover":case"pointerout":nd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":rd.delete(e.pointerId)}}function oc(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=Md(e),e!==null&&e1(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function dF(t,e,n,r,s){switch(e){case"focusin":return Oi=oc(Oi,t,e,n,r,s),!0;case"dragenter":return Ri=oc(Ri,t,e,n,r,s),!0;case"mouseover":return Di=oc(Di,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return nd.set(o,oc(nd.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,rd.set(o,oc(rd.get(o)||null,t,e,n,r,s)),!0}return!1}function qT(t){var e=Ta(t.target);if(e!==null){var n=il(e);if(n!==null){if(e=n.tag,e===13){if(e=PT(n),e!==null){t.blockedOn=e,HT(t.priority,function(){VT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function oh(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Yy(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Vy=r,n.target.dispatchEvent(r),Vy=null}else return e=Md(n),e!==null&&e1(e),t.blockedOn=n,!1;e.shift()}return!0}function oS(t,e,n){oh(t)&&n.delete(e)}function fF(){Xy=!1,Oi!==null&&oh(Oi)&&(Oi=null),Ri!==null&&oh(Ri)&&(Ri=null),Di!==null&&oh(Di)&&(Di=null),nd.forEach(oS),rd.forEach(oS)}function ic(t,e){t.blockedOn===e&&(t.blockedOn=null,Xy||(Xy=!0,Hr.unstable_scheduleCallback(Hr.unstable_NormalPriority,fF)))}function sd(t){function e(s){return ic(s,t)}if(0<Ef.length){ic(Ef[0],t);for(var n=1;n<Ef.length;n++){var r=Ef[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Oi!==null&&ic(Oi,t),Ri!==null&&ic(Ri,t),Di!==null&&ic(Di,t),nd.forEach(e),rd.forEach(e),n=0;n<Ci.length;n++)r=Ci[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ci.length&&(n=Ci[0],n.blockedOn===null);)qT(n),n.blockedOn===null&&Ci.shift()}var Zl=Zo.ReactCurrentBatchConfig,Lh=!0;function hF(t,e,n,r){var s=pt,o=Zl.transition;Zl.transition=null;try{pt=1,t1(t,e,n,r)}finally{pt=s,Zl.transition=o}}function pF(t,e,n,r){var s=pt,o=Zl.transition;Zl.transition=null;try{pt=4,t1(t,e,n,r)}finally{pt=s,Zl.transition=o}}function t1(t,e,n,r){if(Lh){var s=Yy(t,e,n,r);if(s===null)Rg(t,e,r,Fh,n),sS(t,r);else if(dF(s,t,e,n,r))r.stopPropagation();else if(sS(t,r),e&4&&-1<cF.indexOf(t)){for(;s!==null;){var o=Md(s);if(o!==null&&WT(o),o=Yy(t,e,n,r),o===null&&Rg(t,e,r,Fh,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else Rg(t,e,r,null,n)}}var Fh=null;function Yy(t,e,n,r){if(Fh=null,t=Qv(r),t=Ta(t),t!==null)if(e=il(t),e===null)t=null;else if(n=e.tag,n===13){if(t=PT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Fh=t,null}function KT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(tF()){case Zv:return 1;case jT:return 4;case Ah:case nF:return 16;case BT:return 536870912;default:return 16}default:return 16}}var Ti=null,n1=null,ih=null;function XT(){if(ih)return ih;var t,e=n1,n=e.length,r,s="value"in Ti?Ti.value:Ti.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return ih=s.slice(t,1<r?1-r:void 0)}function ah(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Tf(){return!0}function iS(){return!1}function Xr(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Tf:iS,this.isPropagationStopped=iS,this}return Bt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Tf)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Tf)},persist:function(){},isPersistent:Tf}),e}var Iu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},r1=Xr(Iu),Fd=Bt({},Iu,{view:0,detail:0}),mF=Xr(Fd),Cg,_g,ac,Ap=Bt({},Fd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:s1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ac&&(ac&&t.type==="mousemove"?(Cg=t.screenX-ac.screenX,_g=t.screenY-ac.screenY):_g=Cg=0,ac=t),Cg)},movementY:function(t){return"movementY"in t?t.movementY:_g}}),aS=Xr(Ap),gF=Bt({},Ap,{dataTransfer:0}),yF=Xr(gF),vF=Bt({},Fd,{relatedTarget:0}),Eg=Xr(vF),xF=Bt({},Iu,{animationName:0,elapsedTime:0,pseudoElement:0}),bF=Xr(xF),wF=Bt({},Iu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),SF=Xr(wF),CF=Bt({},Iu,{data:0}),lS=Xr(CF),_F={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},EF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},TF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function NF(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=TF[t])?!!e[t]:!1}function s1(){return NF}var $F=Bt({},Fd,{key:function(t){if(t.key){var e=_F[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ah(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?EF[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:s1,charCode:function(t){return t.type==="keypress"?ah(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ah(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),kF=Xr($F),IF=Bt({},Ap,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),uS=Xr(IF),OF=Bt({},Fd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:s1}),RF=Xr(OF),DF=Bt({},Iu,{propertyName:0,elapsedTime:0,pseudoElement:0}),AF=Xr(DF),PF=Bt({},Ap,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),LF=Xr(PF),FF=[9,13,27,32],o1=Vo&&"CompositionEvent"in window,jc=null;Vo&&"documentMode"in document&&(jc=document.documentMode);var MF=Vo&&"TextEvent"in window&&!jc,YT=Vo&&(!o1||jc&&8<jc&&11>=jc),cS=" ",dS=!1;function QT(t,e){switch(t){case"keyup":return FF.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ZT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Pl=!1;function jF(t,e){switch(t){case"compositionend":return ZT(e);case"keypress":return e.which!==32?null:(dS=!0,cS);case"textInput":return t=e.data,t===cS&&dS?null:t;default:return null}}function BF(t,e){if(Pl)return t==="compositionend"||!o1&&QT(t,e)?(t=XT(),ih=n1=Ti=null,Pl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return YT&&e.locale!=="ko"?null:e.data;default:return null}}var UF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fS(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!UF[t.type]:e==="textarea"}function JT(t,e,n,r){IT(r),e=Mh(e,"onChange"),0<e.length&&(n=new r1("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Bc=null,od=null;function zF(t){c2(t,0)}function Pp(t){var e=Ml(t);if(CT(e))return t}function WF(t,e){if(t==="change")return e}var e2=!1;if(Vo){var Tg;if(Vo){var Ng="oninput"in document;if(!Ng){var hS=document.createElement("div");hS.setAttribute("oninput","return;"),Ng=typeof hS.oninput=="function"}Tg=Ng}else Tg=!1;e2=Tg&&(!document.documentMode||9<document.documentMode)}function pS(){Bc&&(Bc.detachEvent("onpropertychange",t2),od=Bc=null)}function t2(t){if(t.propertyName==="value"&&Pp(od)){var e=[];JT(e,od,t,Qv(t)),AT(zF,e)}}function VF(t,e,n){t==="focusin"?(pS(),Bc=e,od=n,Bc.attachEvent("onpropertychange",t2)):t==="focusout"&&pS()}function GF(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Pp(od)}function HF(t,e){if(t==="click")return Pp(e)}function qF(t,e){if(t==="input"||t==="change")return Pp(e)}function KF(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var no=typeof Object.is=="function"?Object.is:KF;function id(t,e){if(no(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ry.call(e,s)||!no(t[s],e[s]))return!1}return!0}function mS(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function gS(t,e){var n=mS(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=mS(n)}}function n2(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?n2(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function r2(){for(var t=window,e=Oh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Oh(t.document)}return e}function i1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function XF(t){var e=r2(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&n2(n.ownerDocument.documentElement,n)){if(r!==null&&i1(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=gS(n,o);var i=gS(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var YF=Vo&&"documentMode"in document&&11>=document.documentMode,Ll=null,Qy=null,Uc=null,Zy=!1;function yS(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Zy||Ll==null||Ll!==Oh(r)||(r=Ll,"selectionStart"in r&&i1(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Uc&&id(Uc,r)||(Uc=r,r=Mh(Qy,"onSelect"),0<r.length&&(e=new r1("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ll)))}function Nf(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Fl={animationend:Nf("Animation","AnimationEnd"),animationiteration:Nf("Animation","AnimationIteration"),animationstart:Nf("Animation","AnimationStart"),transitionend:Nf("Transition","TransitionEnd")},$g={},s2={};Vo&&(s2=document.createElement("div").style,"AnimationEvent"in window||(delete Fl.animationend.animation,delete Fl.animationiteration.animation,delete Fl.animationstart.animation),"TransitionEvent"in window||delete Fl.transitionend.transition);function Lp(t){if($g[t])return $g[t];if(!Fl[t])return t;var e=Fl[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in s2)return $g[t]=e[n];return t}var o2=Lp("animationend"),i2=Lp("animationiteration"),a2=Lp("animationstart"),l2=Lp("transitionend"),u2=new Map,vS="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function na(t,e){u2.set(t,e),ol(e,[t])}for(var kg=0;kg<vS.length;kg++){var Ig=vS[kg],QF=Ig.toLowerCase(),ZF=Ig[0].toUpperCase()+Ig.slice(1);na(QF,"on"+ZF)}na(o2,"onAnimationEnd");na(i2,"onAnimationIteration");na(a2,"onAnimationStart");na("dblclick","onDoubleClick");na("focusin","onFocus");na("focusout","onBlur");na(l2,"onTransitionEnd");uu("onMouseEnter",["mouseout","mouseover"]);uu("onMouseLeave",["mouseout","mouseover"]);uu("onPointerEnter",["pointerout","pointerover"]);uu("onPointerLeave",["pointerout","pointerover"]);ol("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ol("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ol("onBeforeInput",["compositionend","keypress","textInput","paste"]);ol("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ol("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ol("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $c="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),JF=new Set("cancel close invalid load scroll toggle".split(" ").concat($c));function xS(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,QL(r,e,void 0,t),t.currentTarget=null}function c2(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var a=r[i],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&s.isPropagationStopped())break e;xS(s,a,u),o=l}else for(i=0;i<r.length;i++){if(a=r[i],l=a.instance,u=a.currentTarget,a=a.listener,l!==o&&s.isPropagationStopped())break e;xS(s,a,u),o=l}}}if(Dh)throw t=qy,Dh=!1,qy=null,t}function $t(t,e){var n=e[r0];n===void 0&&(n=e[r0]=new Set);var r=t+"__bubble";n.has(r)||(d2(e,t,2,!1),n.add(r))}function Og(t,e,n){var r=0;e&&(r|=4),d2(n,t,r,e)}var $f="_reactListening"+Math.random().toString(36).slice(2);function ad(t){if(!t[$f]){t[$f]=!0,vT.forEach(function(n){n!=="selectionchange"&&(JF.has(n)||Og(n,!1,t),Og(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[$f]||(e[$f]=!0,Og("selectionchange",!1,e))}}function d2(t,e,n,r){switch(KT(e)){case 1:var s=hF;break;case 4:s=pF;break;default:s=t1}n=s.bind(null,e,n,t),s=void 0,!Hy||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Rg(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;a!==null;){if(i=Ta(a),i===null)return;if(l=i.tag,l===5||l===6){r=o=i;continue e}a=a.parentNode}}r=r.return}AT(function(){var u=o,c=Qv(n),d=[];e:{var f=u2.get(t);if(f!==void 0){var h=r1,p=t;switch(t){case"keypress":if(ah(n)===0)break e;case"keydown":case"keyup":h=kF;break;case"focusin":p="focus",h=Eg;break;case"focusout":p="blur",h=Eg;break;case"beforeblur":case"afterblur":h=Eg;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=aS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=yF;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=RF;break;case o2:case i2:case a2:h=bF;break;case l2:h=AF;break;case"scroll":h=mF;break;case"wheel":h=LF;break;case"copy":case"cut":case"paste":h=SF;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=uS}var m=(e&4)!==0,v=!m&&t==="scroll",g=m?f!==null?f+"Capture":null:f;m=[];for(var x=u,b;x!==null;){b=x;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,g!==null&&(_=td(x,g),_!=null&&m.push(ld(x,_,b)))),v)break;x=x.return}0<m.length&&(f=new h(f,p,null,n,c),d.push({event:f,listeners:m}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Vy&&(p=n.relatedTarget||n.fromElement)&&(Ta(p)||p[Go]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(p=n.relatedTarget||n.toElement,h=u,p=p?Ta(p):null,p!==null&&(v=il(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(h=null,p=u),h!==p)){if(m=aS,_="onMouseLeave",g="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(m=uS,_="onPointerLeave",g="onPointerEnter",x="pointer"),v=h==null?f:Ml(h),b=p==null?f:Ml(p),f=new m(_,x+"leave",h,n,c),f.target=v,f.relatedTarget=b,_=null,Ta(c)===u&&(m=new m(g,x+"enter",p,n,c),m.target=b,m.relatedTarget=v,_=m),v=_,h&&p)t:{for(m=h,g=p,x=0,b=m;b;b=El(b))x++;for(b=0,_=g;_;_=El(_))b++;for(;0<x-b;)m=El(m),x--;for(;0<b-x;)g=El(g),b--;for(;x--;){if(m===g||g!==null&&m===g.alternate)break t;m=El(m),g=El(g)}m=null}else m=null;h!==null&&bS(d,f,h,m,!1),p!==null&&v!==null&&bS(d,v,p,m,!0)}}e:{if(f=u?Ml(u):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var N=WF;else if(fS(f))if(e2)N=qF;else{N=GF;var E=VF}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(N=HF);if(N&&(N=N(t,u))){JT(d,N,n,c);break e}E&&E(t,f,u),t==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&jy(f,"number",f.value)}switch(E=u?Ml(u):window,t){case"focusin":(fS(E)||E.contentEditable==="true")&&(Ll=E,Qy=u,Uc=null);break;case"focusout":Uc=Qy=Ll=null;break;case"mousedown":Zy=!0;break;case"contextmenu":case"mouseup":case"dragend":Zy=!1,yS(d,n,c);break;case"selectionchange":if(YF)break;case"keydown":case"keyup":yS(d,n,c)}var R;if(o1)e:{switch(t){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Pl?QT(t,n)&&(P="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(P="onCompositionStart");P&&(YT&&n.locale!=="ko"&&(Pl||P!=="onCompositionStart"?P==="onCompositionEnd"&&Pl&&(R=XT()):(Ti=c,n1="value"in Ti?Ti.value:Ti.textContent,Pl=!0)),E=Mh(u,P),0<E.length&&(P=new lS(P,t,null,n,c),d.push({event:P,listeners:E}),R?P.data=R:(R=ZT(n),R!==null&&(P.data=R)))),(R=MF?jF(t,n):BF(t,n))&&(u=Mh(u,"onBeforeInput"),0<u.length&&(c=new lS("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:u}),c.data=R))}c2(d,e)})}function ld(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Mh(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=td(t,n),o!=null&&r.unshift(ld(t,o,s)),o=td(t,e),o!=null&&r.push(ld(t,o,s))),t=t.return}return r}function El(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function bS(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&u!==null&&(a=u,s?(l=td(n,o),l!=null&&i.unshift(ld(n,l,a))):s||(l=td(n,o),l!=null&&i.push(ld(n,l,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var e4=/\r\n?/g,t4=/\u0000|\uFFFD/g;function wS(t){return(typeof t=="string"?t:""+t).replace(e4,`
`).replace(t4,"")}function kf(t,e,n){if(e=wS(e),wS(t)!==e&&n)throw Error(fe(425))}function jh(){}var Jy=null,e0=null;function t0(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var n0=typeof setTimeout=="function"?setTimeout:void 0,n4=typeof clearTimeout=="function"?clearTimeout:void 0,SS=typeof Promise=="function"?Promise:void 0,r4=typeof queueMicrotask=="function"?queueMicrotask:typeof SS<"u"?function(t){return SS.resolve(null).then(t).catch(s4)}:n0;function s4(t){setTimeout(function(){throw t})}function Dg(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),sd(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);sd(e)}function Ai(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function CS(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ou=Math.random().toString(36).slice(2),yo="__reactFiber$"+Ou,ud="__reactProps$"+Ou,Go="__reactContainer$"+Ou,r0="__reactEvents$"+Ou,o4="__reactListeners$"+Ou,i4="__reactHandles$"+Ou;function Ta(t){var e=t[yo];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Go]||n[yo]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=CS(t);t!==null;){if(n=t[yo])return n;t=CS(t)}return e}t=n,n=t.parentNode}return null}function Md(t){return t=t[yo]||t[Go],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ml(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(fe(33))}function Fp(t){return t[ud]||null}var s0=[],jl=-1;function ra(t){return{current:t}}function kt(t){0>jl||(t.current=s0[jl],s0[jl]=null,jl--)}function Et(t,e){jl++,s0[jl]=t.current,t.current=e}var Ki={},Zn=ra(Ki),Cr=ra(!1),Ma=Ki;function cu(t,e){var n=t.type.contextTypes;if(!n)return Ki;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function _r(t){return t=t.childContextTypes,t!=null}function Bh(){kt(Cr),kt(Zn)}function _S(t,e,n){if(Zn.current!==Ki)throw Error(fe(168));Et(Zn,e),Et(Cr,n)}function f2(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(fe(108,VL(t)||"Unknown",s));return Bt({},n,r)}function Uh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ki,Ma=Zn.current,Et(Zn,t),Et(Cr,Cr.current),!0}function ES(t,e,n){var r=t.stateNode;if(!r)throw Error(fe(169));n?(t=f2(t,e,Ma),r.__reactInternalMemoizedMergedChildContext=t,kt(Cr),kt(Zn),Et(Zn,t)):kt(Cr),Et(Cr,n)}var Lo=null,Mp=!1,Ag=!1;function h2(t){Lo===null?Lo=[t]:Lo.push(t)}function a4(t){Mp=!0,h2(t)}function sa(){if(!Ag&&Lo!==null){Ag=!0;var t=0,e=pt;try{var n=Lo;for(pt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Lo=null,Mp=!1}catch(s){throw Lo!==null&&(Lo=Lo.slice(t+1)),MT(Zv,sa),s}finally{pt=e,Ag=!1}}return null}var Bl=[],Ul=0,zh=null,Wh=0,fs=[],hs=0,ja=null,Bo=1,Uo="";function va(t,e){Bl[Ul++]=Wh,Bl[Ul++]=zh,zh=t,Wh=e}function p2(t,e,n){fs[hs++]=Bo,fs[hs++]=Uo,fs[hs++]=ja,ja=t;var r=Bo;t=Uo;var s=32-eo(r)-1;r&=~(1<<s),n+=1;var o=32-eo(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,Bo=1<<32-eo(e)+s|n<<s|r,Uo=o+t}else Bo=1<<o|n<<s|r,Uo=t}function a1(t){t.return!==null&&(va(t,1),p2(t,1,0))}function l1(t){for(;t===zh;)zh=Bl[--Ul],Bl[Ul]=null,Wh=Bl[--Ul],Bl[Ul]=null;for(;t===ja;)ja=fs[--hs],fs[hs]=null,Uo=fs[--hs],fs[hs]=null,Bo=fs[--hs],fs[hs]=null}var Wr=null,Ur=null,At=!1,Xs=null;function m2(t,e){var n=ms(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function TS(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wr=t,Ur=Ai(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wr=t,Ur=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=ja!==null?{id:Bo,overflow:Uo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ms(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Wr=t,Ur=null,!0):!1;default:return!1}}function o0(t){return(t.mode&1)!==0&&(t.flags&128)===0}function i0(t){if(At){var e=Ur;if(e){var n=e;if(!TS(t,e)){if(o0(t))throw Error(fe(418));e=Ai(n.nextSibling);var r=Wr;e&&TS(t,e)?m2(r,n):(t.flags=t.flags&-4097|2,At=!1,Wr=t)}}else{if(o0(t))throw Error(fe(418));t.flags=t.flags&-4097|2,At=!1,Wr=t}}}function NS(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wr=t}function If(t){if(t!==Wr)return!1;if(!At)return NS(t),At=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!t0(t.type,t.memoizedProps)),e&&(e=Ur)){if(o0(t))throw g2(),Error(fe(418));for(;e;)m2(t,e),e=Ai(e.nextSibling)}if(NS(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(fe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ur=Ai(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ur=null}}else Ur=Wr?Ai(t.stateNode.nextSibling):null;return!0}function g2(){for(var t=Ur;t;)t=Ai(t.nextSibling)}function du(){Ur=Wr=null,At=!1}function u1(t){Xs===null?Xs=[t]:Xs.push(t)}var l4=Zo.ReactCurrentBatchConfig;function Ws(t,e){if(t&&t.defaultProps){e=Bt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var Vh=ra(null),Gh=null,zl=null,c1=null;function d1(){c1=zl=Gh=null}function f1(t){var e=Vh.current;kt(Vh),t._currentValue=e}function a0(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Jl(t,e){Gh=t,c1=zl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(wr=!0),t.firstContext=null)}function Cs(t){var e=t._currentValue;if(c1!==t)if(t={context:t,memoizedValue:e,next:null},zl===null){if(Gh===null)throw Error(fe(308));zl=t,Gh.dependencies={lanes:0,firstContext:t}}else zl=zl.next=t;return e}var Na=null;function h1(t){Na===null?Na=[t]:Na.push(t)}function y2(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,h1(e)):(n.next=s.next,s.next=n),e.interleaved=n,Ho(t,r)}function Ho(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var xi=!1;function p1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function v2(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function zo(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Pi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,rt&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Ho(t,n)}return s=r.interleaved,s===null?(e.next=e,h1(r)):(e.next=s.next,s.next=e),r.interleaved=e,Ho(t,n)}function lh(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Jv(t,n)}}function $S(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Hh(t,e,n,r){var s=t.updateQueue;xi=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,i===null?o=u:i.next=u,i=l;var c=t.alternate;c!==null&&(c=c.updateQueue,a=c.lastBaseUpdate,a!==i&&(a===null?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(o!==null){var d=s.baseState;i=0,c=u=l=null,a=o;do{var f=a.lane,h=a.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(f=e,h=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(h,d,f);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,f=typeof p=="function"?p.call(h,d,f):p,f==null)break e;d=Bt({},d,f);break e;case 2:xi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[a]:f.push(a))}else h={eventTime:h,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},c===null?(u=c=h,l=d):c=c.next=h,i|=f;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;f=a,a=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(c===null&&(l=d),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=c,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);Ua|=i,t.lanes=i,t.memoizedState=d}}function kS(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(fe(191,s));s.call(r)}}}var x2=new yT.Component().refs;function l0(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Bt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var jp={isMounted:function(t){return(t=t._reactInternals)?il(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ur(),s=Fi(t),o=zo(r,s);o.payload=e,n!=null&&(o.callback=n),e=Pi(t,o,s),e!==null&&(to(e,t,s,r),lh(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ur(),s=Fi(t),o=zo(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Pi(t,o,s),e!==null&&(to(e,t,s,r),lh(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ur(),r=Fi(t),s=zo(n,r);s.tag=2,e!=null&&(s.callback=e),e=Pi(t,s,r),e!==null&&(to(e,t,r,n),lh(e,t,r))}};function IS(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!id(n,r)||!id(s,o):!0}function b2(t,e,n){var r=!1,s=Ki,o=e.contextType;return typeof o=="object"&&o!==null?o=Cs(o):(s=_r(e)?Ma:Zn.current,r=e.contextTypes,o=(r=r!=null)?cu(t,s):Ki),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=jp,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function OS(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&jp.enqueueReplaceState(e,e.state,null)}function u0(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=x2,p1(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=Cs(o):(o=_r(e)?Ma:Zn.current,s.context=cu(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(l0(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&jp.enqueueReplaceState(s,s.state,null),Hh(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function lc(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(fe(309));var r=n.stateNode}if(!r)throw Error(fe(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=s.refs;a===x2&&(a=s.refs={}),i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(fe(284));if(!n._owner)throw Error(fe(290,t))}return t}function Of(t,e){throw t=Object.prototype.toString.call(e),Error(fe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function RS(t){var e=t._init;return e(t._payload)}function w2(t){function e(g,x){if(t){var b=g.deletions;b===null?(g.deletions=[x],g.flags|=16):b.push(x)}}function n(g,x){if(!t)return null;for(;x!==null;)e(g,x),x=x.sibling;return null}function r(g,x){for(g=new Map;x!==null;)x.key!==null?g.set(x.key,x):g.set(x.index,x),x=x.sibling;return g}function s(g,x){return g=Mi(g,x),g.index=0,g.sibling=null,g}function o(g,x,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<x?(g.flags|=2,x):b):(g.flags|=2,x)):(g.flags|=1048576,x)}function i(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,x,b,_){return x===null||x.tag!==6?(x=Ug(b,g.mode,_),x.return=g,x):(x=s(x,b),x.return=g,x)}function l(g,x,b,_){var N=b.type;return N===Al?c(g,x,b.props.children,_,b.key):x!==null&&(x.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===vi&&RS(N)===x.type)?(_=s(x,b.props),_.ref=lc(g,x,b),_.return=g,_):(_=ph(b.type,b.key,b.props,null,g.mode,_),_.ref=lc(g,x,b),_.return=g,_)}function u(g,x,b,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=zg(b,g.mode,_),x.return=g,x):(x=s(x,b.children||[]),x.return=g,x)}function c(g,x,b,_,N){return x===null||x.tag!==7?(x=Aa(b,g.mode,_,N),x.return=g,x):(x=s(x,b),x.return=g,x)}function d(g,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=Ug(""+x,g.mode,b),x.return=g,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case bf:return b=ph(x.type,x.key,x.props,null,g.mode,b),b.ref=lc(g,null,x),b.return=g,b;case Dl:return x=zg(x,g.mode,b),x.return=g,x;case vi:var _=x._init;return d(g,_(x._payload),b)}if(Tc(x)||rc(x))return x=Aa(x,g.mode,b,null),x.return=g,x;Of(g,x)}return null}function f(g,x,b,_){var N=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return N!==null?null:a(g,x,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case bf:return b.key===N?l(g,x,b,_):null;case Dl:return b.key===N?u(g,x,b,_):null;case vi:return N=b._init,f(g,x,N(b._payload),_)}if(Tc(b)||rc(b))return N!==null?null:c(g,x,b,_,null);Of(g,b)}return null}function h(g,x,b,_,N){if(typeof _=="string"&&_!==""||typeof _=="number")return g=g.get(b)||null,a(x,g,""+_,N);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case bf:return g=g.get(_.key===null?b:_.key)||null,l(x,g,_,N);case Dl:return g=g.get(_.key===null?b:_.key)||null,u(x,g,_,N);case vi:var E=_._init;return h(g,x,b,E(_._payload),N)}if(Tc(_)||rc(_))return g=g.get(b)||null,c(x,g,_,N,null);Of(x,_)}return null}function p(g,x,b,_){for(var N=null,E=null,R=x,P=x=0,B=null;R!==null&&P<b.length;P++){R.index>P?(B=R,R=null):B=R.sibling;var F=f(g,R,b[P],_);if(F===null){R===null&&(R=B);break}t&&R&&F.alternate===null&&e(g,R),x=o(F,x,P),E===null?N=F:E.sibling=F,E=F,R=B}if(P===b.length)return n(g,R),At&&va(g,P),N;if(R===null){for(;P<b.length;P++)R=d(g,b[P],_),R!==null&&(x=o(R,x,P),E===null?N=R:E.sibling=R,E=R);return At&&va(g,P),N}for(R=r(g,R);P<b.length;P++)B=h(R,g,P,b[P],_),B!==null&&(t&&B.alternate!==null&&R.delete(B.key===null?P:B.key),x=o(B,x,P),E===null?N=B:E.sibling=B,E=B);return t&&R.forEach(function(H){return e(g,H)}),At&&va(g,P),N}function m(g,x,b,_){var N=rc(b);if(typeof N!="function")throw Error(fe(150));if(b=N.call(b),b==null)throw Error(fe(151));for(var E=N=null,R=x,P=x=0,B=null,F=b.next();R!==null&&!F.done;P++,F=b.next()){R.index>P?(B=R,R=null):B=R.sibling;var H=f(g,R,F.value,_);if(H===null){R===null&&(R=B);break}t&&R&&H.alternate===null&&e(g,R),x=o(H,x,P),E===null?N=H:E.sibling=H,E=H,R=B}if(F.done)return n(g,R),At&&va(g,P),N;if(R===null){for(;!F.done;P++,F=b.next())F=d(g,F.value,_),F!==null&&(x=o(F,x,P),E===null?N=F:E.sibling=F,E=F);return At&&va(g,P),N}for(R=r(g,R);!F.done;P++,F=b.next())F=h(R,g,P,F.value,_),F!==null&&(t&&F.alternate!==null&&R.delete(F.key===null?P:F.key),x=o(F,x,P),E===null?N=F:E.sibling=F,E=F);return t&&R.forEach(function(ee){return e(g,ee)}),At&&va(g,P),N}function v(g,x,b,_){if(typeof b=="object"&&b!==null&&b.type===Al&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case bf:e:{for(var N=b.key,E=x;E!==null;){if(E.key===N){if(N=b.type,N===Al){if(E.tag===7){n(g,E.sibling),x=s(E,b.props.children),x.return=g,g=x;break e}}else if(E.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===vi&&RS(N)===E.type){n(g,E.sibling),x=s(E,b.props),x.ref=lc(g,E,b),x.return=g,g=x;break e}n(g,E);break}else e(g,E);E=E.sibling}b.type===Al?(x=Aa(b.props.children,g.mode,_,b.key),x.return=g,g=x):(_=ph(b.type,b.key,b.props,null,g.mode,_),_.ref=lc(g,x,b),_.return=g,g=_)}return i(g);case Dl:e:{for(E=b.key;x!==null;){if(x.key===E)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){n(g,x.sibling),x=s(x,b.children||[]),x.return=g,g=x;break e}else{n(g,x);break}else e(g,x);x=x.sibling}x=zg(b,g.mode,_),x.return=g,g=x}return i(g);case vi:return E=b._init,v(g,x,E(b._payload),_)}if(Tc(b))return p(g,x,b,_);if(rc(b))return m(g,x,b,_);Of(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(n(g,x.sibling),x=s(x,b),x.return=g,g=x):(n(g,x),x=Ug(b,g.mode,_),x.return=g,g=x),i(g)):n(g,x)}return v}var fu=w2(!0),S2=w2(!1),jd={},So=ra(jd),cd=ra(jd),dd=ra(jd);function $a(t){if(t===jd)throw Error(fe(174));return t}function m1(t,e){switch(Et(dd,e),Et(cd,t),Et(So,jd),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Uy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Uy(e,t)}kt(So),Et(So,e)}function hu(){kt(So),kt(cd),kt(dd)}function C2(t){$a(dd.current);var e=$a(So.current),n=Uy(e,t.type);e!==n&&(Et(cd,t),Et(So,n))}function g1(t){cd.current===t&&(kt(So),kt(cd))}var Mt=ra(0);function qh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Pg=[];function y1(){for(var t=0;t<Pg.length;t++)Pg[t]._workInProgressVersionPrimary=null;Pg.length=0}var uh=Zo.ReactCurrentDispatcher,Lg=Zo.ReactCurrentBatchConfig,Ba=0,jt=null,fn=null,_n=null,Kh=!1,zc=!1,fd=0,u4=0;function Bn(){throw Error(fe(321))}function v1(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!no(t[n],e[n]))return!1;return!0}function x1(t,e,n,r,s,o){if(Ba=o,jt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,uh.current=t===null||t.memoizedState===null?h4:p4,t=n(r,s),zc){o=0;do{if(zc=!1,fd=0,25<=o)throw Error(fe(301));o+=1,_n=fn=null,e.updateQueue=null,uh.current=m4,t=n(r,s)}while(zc)}if(uh.current=Xh,e=fn!==null&&fn.next!==null,Ba=0,_n=fn=jt=null,Kh=!1,e)throw Error(fe(300));return t}function b1(){var t=fd!==0;return fd=0,t}function mo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _n===null?jt.memoizedState=_n=t:_n=_n.next=t,_n}function _s(){if(fn===null){var t=jt.alternate;t=t!==null?t.memoizedState:null}else t=fn.next;var e=_n===null?jt.memoizedState:_n.next;if(e!==null)_n=e,fn=t;else{if(t===null)throw Error(fe(310));fn=t,t={memoizedState:fn.memoizedState,baseState:fn.baseState,baseQueue:fn.baseQueue,queue:fn.queue,next:null},_n===null?jt.memoizedState=_n=t:_n=_n.next=t}return _n}function hd(t,e){return typeof e=="function"?e(t):e}function Fg(t){var e=_s(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var r=fn,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var a=i=null,l=null,u=o;do{var c=u.lane;if((Ba&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var d={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=d,i=r):l=l.next=d,jt.lanes|=c,Ua|=c}u=u.next}while(u!==null&&u!==o);l===null?i=r:l.next=a,no(r,e.memoizedState)||(wr=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,jt.lanes|=o,Ua|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Mg(t){var e=_s(),n=e.queue;if(n===null)throw Error(fe(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);no(o,e.memoizedState)||(wr=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function _2(){}function E2(t,e){var n=jt,r=_s(),s=e(),o=!no(r.memoizedState,s);if(o&&(r.memoizedState=s,wr=!0),r=r.queue,w1($2.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||_n!==null&&_n.memoizedState.tag&1){if(n.flags|=2048,pd(9,N2.bind(null,n,r,s,e),void 0,null),Nn===null)throw Error(fe(349));Ba&30||T2(n,e,s)}return s}function T2(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=jt.updateQueue,e===null?(e={lastEffect:null,stores:null},jt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function N2(t,e,n,r){e.value=n,e.getSnapshot=r,k2(e)&&I2(t)}function $2(t,e,n){return n(function(){k2(e)&&I2(t)})}function k2(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!no(t,n)}catch{return!0}}function I2(t){var e=Ho(t,1);e!==null&&to(e,t,1,-1)}function DS(t){var e=mo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hd,lastRenderedState:t},e.queue=t,t=t.dispatch=f4.bind(null,jt,t),[e.memoizedState,t]}function pd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=jt.updateQueue,e===null?(e={lastEffect:null,stores:null},jt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function O2(){return _s().memoizedState}function ch(t,e,n,r){var s=mo();jt.flags|=t,s.memoizedState=pd(1|e,n,void 0,r===void 0?null:r)}function Bp(t,e,n,r){var s=_s();r=r===void 0?null:r;var o=void 0;if(fn!==null){var i=fn.memoizedState;if(o=i.destroy,r!==null&&v1(r,i.deps)){s.memoizedState=pd(e,n,o,r);return}}jt.flags|=t,s.memoizedState=pd(1|e,n,o,r)}function AS(t,e){return ch(8390656,8,t,e)}function w1(t,e){return Bp(2048,8,t,e)}function R2(t,e){return Bp(4,2,t,e)}function D2(t,e){return Bp(4,4,t,e)}function A2(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function P2(t,e,n){return n=n!=null?n.concat([t]):null,Bp(4,4,A2.bind(null,e,t),n)}function S1(){}function L2(t,e){var n=_s();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&v1(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function F2(t,e){var n=_s();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&v1(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function M2(t,e,n){return Ba&21?(no(n,e)||(n=UT(),jt.lanes|=n,Ua|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,wr=!0),t.memoizedState=n)}function c4(t,e){var n=pt;pt=n!==0&&4>n?n:4,t(!0);var r=Lg.transition;Lg.transition={};try{t(!1),e()}finally{pt=n,Lg.transition=r}}function j2(){return _s().memoizedState}function d4(t,e,n){var r=Fi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},B2(t))U2(e,n);else if(n=y2(t,e,n,r),n!==null){var s=ur();to(n,t,r,s),z2(n,e,r)}}function f4(t,e,n){var r=Fi(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(B2(t))U2(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(s.hasEagerState=!0,s.eagerState=a,no(a,i)){var l=e.interleaved;l===null?(s.next=s,h1(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=y2(t,e,s,r),n!==null&&(s=ur(),to(n,t,r,s),z2(n,e,r))}}function B2(t){var e=t.alternate;return t===jt||e!==null&&e===jt}function U2(t,e){zc=Kh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function z2(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Jv(t,n)}}var Xh={readContext:Cs,useCallback:Bn,useContext:Bn,useEffect:Bn,useImperativeHandle:Bn,useInsertionEffect:Bn,useLayoutEffect:Bn,useMemo:Bn,useReducer:Bn,useRef:Bn,useState:Bn,useDebugValue:Bn,useDeferredValue:Bn,useTransition:Bn,useMutableSource:Bn,useSyncExternalStore:Bn,useId:Bn,unstable_isNewReconciler:!1},h4={readContext:Cs,useCallback:function(t,e){return mo().memoizedState=[t,e===void 0?null:e],t},useContext:Cs,useEffect:AS,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ch(4194308,4,A2.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ch(4194308,4,t,e)},useInsertionEffect:function(t,e){return ch(4,2,t,e)},useMemo:function(t,e){var n=mo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=mo();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=d4.bind(null,jt,t),[r.memoizedState,t]},useRef:function(t){var e=mo();return t={current:t},e.memoizedState=t},useState:DS,useDebugValue:S1,useDeferredValue:function(t){return mo().memoizedState=t},useTransition:function(){var t=DS(!1),e=t[0];return t=c4.bind(null,t[1]),mo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=jt,s=mo();if(At){if(n===void 0)throw Error(fe(407));n=n()}else{if(n=e(),Nn===null)throw Error(fe(349));Ba&30||T2(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,AS($2.bind(null,r,o,t),[t]),r.flags|=2048,pd(9,N2.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=mo(),e=Nn.identifierPrefix;if(At){var n=Uo,r=Bo;n=(r&~(1<<32-eo(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=fd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=u4++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},p4={readContext:Cs,useCallback:L2,useContext:Cs,useEffect:w1,useImperativeHandle:P2,useInsertionEffect:R2,useLayoutEffect:D2,useMemo:F2,useReducer:Fg,useRef:O2,useState:function(){return Fg(hd)},useDebugValue:S1,useDeferredValue:function(t){var e=_s();return M2(e,fn.memoizedState,t)},useTransition:function(){var t=Fg(hd)[0],e=_s().memoizedState;return[t,e]},useMutableSource:_2,useSyncExternalStore:E2,useId:j2,unstable_isNewReconciler:!1},m4={readContext:Cs,useCallback:L2,useContext:Cs,useEffect:w1,useImperativeHandle:P2,useInsertionEffect:R2,useLayoutEffect:D2,useMemo:F2,useReducer:Mg,useRef:O2,useState:function(){return Mg(hd)},useDebugValue:S1,useDeferredValue:function(t){var e=_s();return fn===null?e.memoizedState=t:M2(e,fn.memoizedState,t)},useTransition:function(){var t=Mg(hd)[0],e=_s().memoizedState;return[t,e]},useMutableSource:_2,useSyncExternalStore:E2,useId:j2,unstable_isNewReconciler:!1};function pu(t,e){try{var n="",r=e;do n+=WL(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function jg(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function c0(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var g4=typeof WeakMap=="function"?WeakMap:Map;function W2(t,e,n){n=zo(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Qh||(Qh=!0,b0=r),c0(t,e)},n}function V2(t,e,n){n=zo(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){c0(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){c0(t,e),typeof r!="function"&&(Li===null?Li=new Set([this]):Li.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function PS(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new g4;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=I4.bind(null,t,e,n),e.then(t,t))}function LS(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function FS(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=zo(-1,1),e.tag=2,Pi(n,e,1))),n.lanes|=1),t)}var y4=Zo.ReactCurrentOwner,wr=!1;function ar(t,e,n,r){e.child=t===null?S2(e,null,n,r):fu(e,t.child,n,r)}function MS(t,e,n,r,s){n=n.render;var o=e.ref;return Jl(e,s),r=x1(t,e,n,r,o,s),n=b1(),t!==null&&!wr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qo(t,e,s)):(At&&n&&a1(e),e.flags|=1,ar(t,e,r,s),e.child)}function jS(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!I1(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,G2(t,e,o,r,s)):(t=ph(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:id,n(i,r)&&t.ref===e.ref)return qo(t,e,s)}return e.flags|=1,t=Mi(o,r),t.ref=e.ref,t.return=e,e.child=t}function G2(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(id(o,r)&&t.ref===e.ref)if(wr=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(wr=!0);else return e.lanes=t.lanes,qo(t,e,s)}return d0(t,e,n,r,s)}function H2(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Et(Vl,Mr),Mr|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Et(Vl,Mr),Mr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,Et(Vl,Mr),Mr|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,Et(Vl,Mr),Mr|=r;return ar(t,e,s,n),e.child}function q2(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function d0(t,e,n,r,s){var o=_r(n)?Ma:Zn.current;return o=cu(e,o),Jl(e,s),n=x1(t,e,n,r,o,s),r=b1(),t!==null&&!wr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,qo(t,e,s)):(At&&r&&a1(e),e.flags|=1,ar(t,e,n,s),e.child)}function BS(t,e,n,r,s){if(_r(n)){var o=!0;Uh(e)}else o=!1;if(Jl(e,s),e.stateNode===null)dh(t,e),b2(e,n,r),u0(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var l=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=Cs(u):(u=_r(n)?Ma:Zn.current,u=cu(e,u));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==r||l!==u)&&OS(e,i,r,u),xi=!1;var f=e.memoizedState;i.state=f,Hh(e,r,i,s),l=e.memoizedState,a!==r||f!==l||Cr.current||xi?(typeof c=="function"&&(l0(e,n,c,r),l=e.memoizedState),(a=xi||IS(e,n,a,r,f,l,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),i.props=r,i.state=l,i.context=u,r=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,v2(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:Ws(e.type,a),i.props=u,d=e.pendingProps,f=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=Cs(l):(l=_r(n)?Ma:Zn.current,l=cu(e,l));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||f!==l)&&OS(e,i,r,l),xi=!1,f=e.memoizedState,i.state=f,Hh(e,r,i,s);var p=e.memoizedState;a!==d||f!==p||Cr.current||xi?(typeof h=="function"&&(l0(e,n,h,r),p=e.memoizedState),(u=xi||IS(e,n,u,r,f,p,l)||!1)?(c||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,p,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,p,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),i.props=r,i.state=p,i.context=l,r=u):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return f0(t,e,n,r,o,s)}function f0(t,e,n,r,s,o){q2(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&ES(e,n,!1),qo(t,e,o);r=e.stateNode,y4.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=fu(e,t.child,null,o),e.child=fu(e,null,a,o)):ar(t,e,a,o),e.memoizedState=r.state,s&&ES(e,n,!0),e.child}function K2(t){var e=t.stateNode;e.pendingContext?_S(t,e.pendingContext,e.pendingContext!==e.context):e.context&&_S(t,e.context,!1),m1(t,e.containerInfo)}function US(t,e,n,r,s){return du(),u1(s),e.flags|=256,ar(t,e,n,r),e.child}var h0={dehydrated:null,treeContext:null,retryLane:0};function p0(t){return{baseLanes:t,cachePool:null,transitions:null}}function X2(t,e,n){var r=e.pendingProps,s=Mt.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Et(Mt,s&1),t===null)return i0(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Wp(i,r,0,null),t=Aa(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=p0(n),e.memoizedState=h0,t):C1(e,i));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return v4(t,e,i,r,a,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Mi(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?o=Mi(a,o):(o=Aa(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?p0(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=h0,r}return o=t.child,t=o.sibling,r=Mi(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function C1(t,e){return e=Wp({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Rf(t,e,n,r){return r!==null&&u1(r),fu(e,t.child,null,n),t=C1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function v4(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=jg(Error(fe(422))),Rf(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=Wp({mode:"visible",children:r.children},s,0,null),o=Aa(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&fu(e,t.child,null,i),e.child.memoizedState=p0(i),e.memoizedState=h0,o);if(!(e.mode&1))return Rf(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(fe(419)),r=jg(o,r,void 0),Rf(t,e,i,r)}if(a=(i&t.childLanes)!==0,wr||a){if(r=Nn,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Ho(t,s),to(r,t,s,-1))}return k1(),r=jg(Error(fe(421))),Rf(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=O4.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,Ur=Ai(s.nextSibling),Wr=e,At=!0,Xs=null,t!==null&&(fs[hs++]=Bo,fs[hs++]=Uo,fs[hs++]=ja,Bo=t.id,Uo=t.overflow,ja=e),e=C1(e,r.children),e.flags|=4096,e)}function zS(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),a0(t.return,e,n)}function Bg(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function Y2(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(ar(t,e,r.children,n),r=Mt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&zS(t,n,e);else if(t.tag===19)zS(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Et(Mt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&qh(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Bg(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&qh(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Bg(e,!0,n,null,o);break;case"together":Bg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function dh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function qo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Ua|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(fe(153));if(e.child!==null){for(t=e.child,n=Mi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Mi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function x4(t,e,n){switch(e.tag){case 3:K2(e),du();break;case 5:C2(e);break;case 1:_r(e.type)&&Uh(e);break;case 4:m1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Et(Vh,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Et(Mt,Mt.current&1),e.flags|=128,null):n&e.child.childLanes?X2(t,e,n):(Et(Mt,Mt.current&1),t=qo(t,e,n),t!==null?t.sibling:null);Et(Mt,Mt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Y2(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Et(Mt,Mt.current),r)break;return null;case 22:case 23:return e.lanes=0,H2(t,e,n)}return qo(t,e,n)}var Q2,m0,Z2,J2;Q2=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};m0=function(){};Z2=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,$a(So.current);var o=null;switch(n){case"input":s=Fy(t,s),r=Fy(t,r),o=[];break;case"select":s=Bt({},s,{value:void 0}),r=Bt({},r,{value:void 0}),o=[];break;case"textarea":s=By(t,s),r=By(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=jh)}zy(n,r);var i;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Jc.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var l=r[u];if(a=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Jc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&$t("scroll",t),o||a===l||(o=[])):(o=o||[]).push(u,l))}n&&(o=o||[]).push("style",n);var u=o;(e.updateQueue=u)&&(e.flags|=4)}};J2=function(t,e,n,r){n!==r&&(e.flags|=4)};function uc(t,e){if(!At)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Un(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function b4(t,e,n){var r=e.pendingProps;switch(l1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Un(e),null;case 1:return _r(e.type)&&Bh(),Un(e),null;case 3:return r=e.stateNode,hu(),kt(Cr),kt(Zn),y1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(If(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xs!==null&&(C0(Xs),Xs=null))),m0(t,e),Un(e),null;case 5:g1(e);var s=$a(dd.current);if(n=e.type,t!==null&&e.stateNode!=null)Z2(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(fe(166));return Un(e),null}if(t=$a(So.current),If(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[yo]=e,r[ud]=o,t=(e.mode&1)!==0,n){case"dialog":$t("cancel",r),$t("close",r);break;case"iframe":case"object":case"embed":$t("load",r);break;case"video":case"audio":for(s=0;s<$c.length;s++)$t($c[s],r);break;case"source":$t("error",r);break;case"img":case"image":case"link":$t("error",r),$t("load",r);break;case"details":$t("toggle",r);break;case"input":Qw(r,o),$t("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},$t("invalid",r);break;case"textarea":Jw(r,o),$t("invalid",r)}zy(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&kf(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&kf(r.textContent,a,t),s=["children",""+a]):Jc.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&$t("scroll",r)}switch(n){case"input":wf(r),Zw(r,o,!0);break;case"textarea":wf(r),eS(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=jh)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=TT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[yo]=e,t[ud]=r,Q2(t,e,!1,!1),e.stateNode=t;e:{switch(i=Wy(n,r),n){case"dialog":$t("cancel",t),$t("close",t),s=r;break;case"iframe":case"object":case"embed":$t("load",t),s=r;break;case"video":case"audio":for(s=0;s<$c.length;s++)$t($c[s],t);s=r;break;case"source":$t("error",t),s=r;break;case"img":case"image":case"link":$t("error",t),$t("load",t),s=r;break;case"details":$t("toggle",t),s=r;break;case"input":Qw(t,r),s=Fy(t,r),$t("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Bt({},r,{value:void 0}),$t("invalid",t);break;case"textarea":Jw(t,r),s=By(t,r),$t("invalid",t);break;default:s=r}zy(n,s),a=s;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?kT(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&NT(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&ed(t,l):typeof l=="number"&&ed(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Jc.hasOwnProperty(o)?l!=null&&o==="onScroll"&&$t("scroll",t):l!=null&&qv(t,o,l,i))}switch(n){case"input":wf(t),Zw(t,r,!1);break;case"textarea":wf(t),eS(t);break;case"option":r.value!=null&&t.setAttribute("value",""+qi(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Xl(t,!!r.multiple,o,!1):r.defaultValue!=null&&Xl(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=jh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Un(e),null;case 6:if(t&&e.stateNode!=null)J2(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(fe(166));if(n=$a(dd.current),$a(So.current),If(e)){if(r=e.stateNode,n=e.memoizedProps,r[yo]=e,(o=r.nodeValue!==n)&&(t=Wr,t!==null))switch(t.tag){case 3:kf(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&kf(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[yo]=e,e.stateNode=r}return Un(e),null;case 13:if(kt(Mt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(At&&Ur!==null&&e.mode&1&&!(e.flags&128))g2(),du(),e.flags|=98560,o=!1;else if(o=If(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(fe(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(fe(317));o[yo]=e}else du(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Un(e),o=!1}else Xs!==null&&(C0(Xs),Xs=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Mt.current&1?pn===0&&(pn=3):k1())),e.updateQueue!==null&&(e.flags|=4),Un(e),null);case 4:return hu(),m0(t,e),t===null&&ad(e.stateNode.containerInfo),Un(e),null;case 10:return f1(e.type._context),Un(e),null;case 17:return _r(e.type)&&Bh(),Un(e),null;case 19:if(kt(Mt),o=e.memoizedState,o===null)return Un(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)uc(o,!1);else{if(pn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=qh(t),i!==null){for(e.flags|=128,uc(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Et(Mt,Mt.current&1|2),e.child}t=t.sibling}o.tail!==null&&en()>mu&&(e.flags|=128,r=!0,uc(o,!1),e.lanes=4194304)}else{if(!r)if(t=qh(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),uc(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!At)return Un(e),null}else 2*en()-o.renderingStartTime>mu&&n!==1073741824&&(e.flags|=128,r=!0,uc(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=en(),e.sibling=null,n=Mt.current,Et(Mt,r?n&1|2:n&1),e):(Un(e),null);case 22:case 23:return $1(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mr&1073741824&&(Un(e),e.subtreeFlags&6&&(e.flags|=8192)):Un(e),null;case 24:return null;case 25:return null}throw Error(fe(156,e.tag))}function w4(t,e){switch(l1(e),e.tag){case 1:return _r(e.type)&&Bh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return hu(),kt(Cr),kt(Zn),y1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return g1(e),null;case 13:if(kt(Mt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(fe(340));du()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return kt(Mt),null;case 4:return hu(),null;case 10:return f1(e.type._context),null;case 22:case 23:return $1(),null;case 24:return null;default:return null}}var Df=!1,Kn=!1,S4=typeof WeakSet=="function"?WeakSet:Set,_e=null;function Wl(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ht(t,e,r)}else n.current=null}function g0(t,e,n){try{n()}catch(r){Ht(t,e,r)}}var WS=!1;function C4(t,e){if(Jy=Lh,t=r2(),i1(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,l=-1,u=0,c=0,d=t,f=null;t:for(;;){for(var h;d!==n||s!==0&&d.nodeType!==3||(a=i+s),d!==o||r!==0&&d.nodeType!==3||(l=i+r),d.nodeType===3&&(i+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++u===s&&(a=i),f===o&&++c===r&&(l=i),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(e0={focusedElem:t,selectionRange:n},Lh=!1,_e=e;_e!==null;)if(e=_e,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,_e=t;else for(;_e!==null;){e=_e;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,v=p.memoizedState,g=e.stateNode,x=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:Ws(e.type,m),v);g.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(fe(163))}}catch(_){Ht(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,_e=t;break}_e=e.return}return p=WS,WS=!1,p}function Wc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&g0(e,n,o)}s=s.next}while(s!==r)}}function Up(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function y0(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function eN(t){var e=t.alternate;e!==null&&(t.alternate=null,eN(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[yo],delete e[ud],delete e[r0],delete e[o4],delete e[i4])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function tN(t){return t.tag===5||t.tag===3||t.tag===4}function VS(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||tN(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function v0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=jh));else if(r!==4&&(t=t.child,t!==null))for(v0(t,e,n),t=t.sibling;t!==null;)v0(t,e,n),t=t.sibling}function x0(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(x0(t,e,n),t=t.sibling;t!==null;)x0(t,e,n),t=t.sibling}var Dn=null,Hs=!1;function di(t,e,n){for(n=n.child;n!==null;)nN(t,e,n),n=n.sibling}function nN(t,e,n){if(wo&&typeof wo.onCommitFiberUnmount=="function")try{wo.onCommitFiberUnmount(Dp,n)}catch{}switch(n.tag){case 5:Kn||Wl(n,e);case 6:var r=Dn,s=Hs;Dn=null,di(t,e,n),Dn=r,Hs=s,Dn!==null&&(Hs?(t=Dn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Dn.removeChild(n.stateNode));break;case 18:Dn!==null&&(Hs?(t=Dn,n=n.stateNode,t.nodeType===8?Dg(t.parentNode,n):t.nodeType===1&&Dg(t,n),sd(t)):Dg(Dn,n.stateNode));break;case 4:r=Dn,s=Hs,Dn=n.stateNode.containerInfo,Hs=!0,di(t,e,n),Dn=r,Hs=s;break;case 0:case 11:case 14:case 15:if(!Kn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&g0(n,e,i),s=s.next}while(s!==r)}di(t,e,n);break;case 1:if(!Kn&&(Wl(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ht(n,e,a)}di(t,e,n);break;case 21:di(t,e,n);break;case 22:n.mode&1?(Kn=(r=Kn)||n.memoizedState!==null,di(t,e,n),Kn=r):di(t,e,n);break;default:di(t,e,n)}}function GS(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new S4),e.forEach(function(r){var s=R4.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Us(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:Dn=a.stateNode,Hs=!1;break e;case 3:Dn=a.stateNode.containerInfo,Hs=!0;break e;case 4:Dn=a.stateNode.containerInfo,Hs=!0;break e}a=a.return}if(Dn===null)throw Error(fe(160));nN(o,i,s),Dn=null,Hs=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){Ht(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)rN(e,t),e=e.sibling}function rN(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Us(e,t),po(t),r&4){try{Wc(3,t,t.return),Up(3,t)}catch(m){Ht(t,t.return,m)}try{Wc(5,t,t.return)}catch(m){Ht(t,t.return,m)}}break;case 1:Us(e,t),po(t),r&512&&n!==null&&Wl(n,n.return);break;case 5:if(Us(e,t),po(t),r&512&&n!==null&&Wl(n,n.return),t.flags&32){var s=t.stateNode;try{ed(s,"")}catch(m){Ht(t,t.return,m)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&_T(s,o),Wy(a,i);var u=Wy(a,o);for(i=0;i<l.length;i+=2){var c=l[i],d=l[i+1];c==="style"?kT(s,d):c==="dangerouslySetInnerHTML"?NT(s,d):c==="children"?ed(s,d):qv(s,c,d,u)}switch(a){case"input":My(s,o);break;case"textarea":ET(s,o);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var h=o.value;h!=null?Xl(s,!!o.multiple,h,!1):f!==!!o.multiple&&(o.defaultValue!=null?Xl(s,!!o.multiple,o.defaultValue,!0):Xl(s,!!o.multiple,o.multiple?[]:"",!1))}s[ud]=o}catch(m){Ht(t,t.return,m)}}break;case 6:if(Us(e,t),po(t),r&4){if(t.stateNode===null)throw Error(fe(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(m){Ht(t,t.return,m)}}break;case 3:if(Us(e,t),po(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{sd(e.containerInfo)}catch(m){Ht(t,t.return,m)}break;case 4:Us(e,t),po(t);break;case 13:Us(e,t),po(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(T1=en())),r&4&&GS(t);break;case 22:if(c=n!==null&&n.memoizedState!==null,t.mode&1?(Kn=(u=Kn)||c,Us(e,t),Kn=u):Us(e,t),po(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!c&&t.mode&1)for(_e=t,c=t.child;c!==null;){for(d=_e=c;_e!==null;){switch(f=_e,h=f.child,f.tag){case 0:case 11:case 14:case 15:Wc(4,f,f.return);break;case 1:Wl(f,f.return);var p=f.stateNode;if(typeof p.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Ht(r,n,m)}}break;case 5:Wl(f,f.return);break;case 22:if(f.memoizedState!==null){qS(d);continue}}h!==null?(h.return=f,_e=h):qS(d)}c=c.sibling}e:for(c=null,d=t;;){if(d.tag===5){if(c===null){c=d;try{s=d.stateNode,u?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=$T("display",i))}catch(m){Ht(t,t.return,m)}}}else if(d.tag===6){if(c===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Ht(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;c===d&&(c=null),d=d.return}c===d&&(c=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Us(e,t),po(t),r&4&&GS(t);break;case 21:break;default:Us(e,t),po(t)}}function po(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(tN(n)){var r=n;break e}n=n.return}throw Error(fe(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ed(s,""),r.flags&=-33);var o=VS(t);x0(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,a=VS(t);v0(t,a,i);break;default:throw Error(fe(161))}}catch(l){Ht(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function _4(t,e,n){_e=t,sN(t)}function sN(t,e,n){for(var r=(t.mode&1)!==0;_e!==null;){var s=_e,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Df;if(!i){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Kn;a=Df;var u=Kn;if(Df=i,(Kn=l)&&!u)for(_e=s;_e!==null;)i=_e,l=i.child,i.tag===22&&i.memoizedState!==null?KS(s):l!==null?(l.return=i,_e=l):KS(s);for(;o!==null;)_e=o,sN(o),o=o.sibling;_e=s,Df=a,Kn=u}HS(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,_e=o):HS(t)}}function HS(t){for(;_e!==null;){var e=_e;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Kn||Up(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Kn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Ws(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&kS(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}kS(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&sd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(fe(163))}Kn||e.flags&512&&y0(e)}catch(f){Ht(e,e.return,f)}}if(e===t){_e=null;break}if(n=e.sibling,n!==null){n.return=e.return,_e=n;break}_e=e.return}}function qS(t){for(;_e!==null;){var e=_e;if(e===t){_e=null;break}var n=e.sibling;if(n!==null){n.return=e.return,_e=n;break}_e=e.return}}function KS(t){for(;_e!==null;){var e=_e;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Up(4,e)}catch(l){Ht(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Ht(e,s,l)}}var o=e.return;try{y0(e)}catch(l){Ht(e,o,l)}break;case 5:var i=e.return;try{y0(e)}catch(l){Ht(e,i,l)}}}catch(l){Ht(e,e.return,l)}if(e===t){_e=null;break}var a=e.sibling;if(a!==null){a.return=e.return,_e=a;break}_e=e.return}}var E4=Math.ceil,Yh=Zo.ReactCurrentDispatcher,_1=Zo.ReactCurrentOwner,ws=Zo.ReactCurrentBatchConfig,rt=0,Nn=null,un=null,Pn=0,Mr=0,Vl=ra(0),pn=0,md=null,Ua=0,zp=0,E1=0,Vc=null,br=null,T1=0,mu=1/0,Po=null,Qh=!1,b0=null,Li=null,Af=!1,Ni=null,Zh=0,Gc=0,w0=null,fh=-1,hh=0;function ur(){return rt&6?en():fh!==-1?fh:fh=en()}function Fi(t){return t.mode&1?rt&2&&Pn!==0?Pn&-Pn:l4.transition!==null?(hh===0&&(hh=UT()),hh):(t=pt,t!==0||(t=window.event,t=t===void 0?16:KT(t.type)),t):1}function to(t,e,n,r){if(50<Gc)throw Gc=0,w0=null,Error(fe(185));Ld(t,n,r),(!(rt&2)||t!==Nn)&&(t===Nn&&(!(rt&2)&&(zp|=n),pn===4&&_i(t,Pn)),Er(t,r),n===1&&rt===0&&!(e.mode&1)&&(mu=en()+500,Mp&&sa()))}function Er(t,e){var n=t.callbackNode;lF(t,e);var r=Ph(t,t===Nn?Pn:0);if(r===0)n!==null&&rS(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&rS(n),e===1)t.tag===0?a4(XS.bind(null,t)):h2(XS.bind(null,t)),r4(function(){!(rt&6)&&sa()}),n=null;else{switch(zT(r)){case 1:n=Zv;break;case 4:n=jT;break;case 16:n=Ah;break;case 536870912:n=BT;break;default:n=Ah}n=fN(n,oN.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function oN(t,e){if(fh=-1,hh=0,rt&6)throw Error(fe(327));var n=t.callbackNode;if(eu()&&t.callbackNode!==n)return null;var r=Ph(t,t===Nn?Pn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Jh(t,r);else{e=r;var s=rt;rt|=2;var o=aN();(Nn!==t||Pn!==e)&&(Po=null,mu=en()+500,Da(t,e));do try{$4();break}catch(a){iN(t,a)}while(!0);d1(),Yh.current=o,rt=s,un!==null?e=0:(Nn=null,Pn=0,e=pn)}if(e!==0){if(e===2&&(s=Ky(t),s!==0&&(r=s,e=S0(t,s))),e===1)throw n=md,Da(t,0),_i(t,r),Er(t,en()),n;if(e===6)_i(t,r);else{if(s=t.current.alternate,!(r&30)&&!T4(s)&&(e=Jh(t,r),e===2&&(o=Ky(t),o!==0&&(r=o,e=S0(t,o))),e===1))throw n=md,Da(t,0),_i(t,r),Er(t,en()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(fe(345));case 2:xa(t,br,Po);break;case 3:if(_i(t,r),(r&130023424)===r&&(e=T1+500-en(),10<e)){if(Ph(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){ur(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=n0(xa.bind(null,t,br,Po),e);break}xa(t,br,Po);break;case 4:if(_i(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-eo(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=en()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*E4(r/1960))-r,10<r){t.timeoutHandle=n0(xa.bind(null,t,br,Po),r);break}xa(t,br,Po);break;case 5:xa(t,br,Po);break;default:throw Error(fe(329))}}}return Er(t,en()),t.callbackNode===n?oN.bind(null,t):null}function S0(t,e){var n=Vc;return t.current.memoizedState.isDehydrated&&(Da(t,e).flags|=256),t=Jh(t,e),t!==2&&(e=br,br=n,e!==null&&C0(e)),t}function C0(t){br===null?br=t:br.push.apply(br,t)}function T4(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!no(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function _i(t,e){for(e&=~E1,e&=~zp,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-eo(e),r=1<<n;t[n]=-1,e&=~r}}function XS(t){if(rt&6)throw Error(fe(327));eu();var e=Ph(t,0);if(!(e&1))return Er(t,en()),null;var n=Jh(t,e);if(t.tag!==0&&n===2){var r=Ky(t);r!==0&&(e=r,n=S0(t,r))}if(n===1)throw n=md,Da(t,0),_i(t,e),Er(t,en()),n;if(n===6)throw Error(fe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,xa(t,br,Po),Er(t,en()),null}function N1(t,e){var n=rt;rt|=1;try{return t(e)}finally{rt=n,rt===0&&(mu=en()+500,Mp&&sa())}}function za(t){Ni!==null&&Ni.tag===0&&!(rt&6)&&eu();var e=rt;rt|=1;var n=ws.transition,r=pt;try{if(ws.transition=null,pt=1,t)return t()}finally{pt=r,ws.transition=n,rt=e,!(rt&6)&&sa()}}function $1(){Mr=Vl.current,kt(Vl)}function Da(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,n4(n)),un!==null)for(n=un.return;n!==null;){var r=n;switch(l1(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Bh();break;case 3:hu(),kt(Cr),kt(Zn),y1();break;case 5:g1(r);break;case 4:hu();break;case 13:kt(Mt);break;case 19:kt(Mt);break;case 10:f1(r.type._context);break;case 22:case 23:$1()}n=n.return}if(Nn=t,un=t=Mi(t.current,null),Pn=Mr=e,pn=0,md=null,E1=zp=Ua=0,br=Vc=null,Na!==null){for(e=0;e<Na.length;e++)if(n=Na[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}Na=null}return t}function iN(t,e){do{var n=un;try{if(d1(),uh.current=Xh,Kh){for(var r=jt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Kh=!1}if(Ba=0,_n=fn=jt=null,zc=!1,fd=0,_1.current=null,n===null||n.return===null){pn=1,md=e,un=null;break}e:{var o=t,i=n.return,a=n,l=e;if(e=Pn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=a,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=LS(i);if(h!==null){h.flags&=-257,FS(h,i,a,o,e),h.mode&1&&PS(o,u,e),e=h,l=u;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){PS(o,u,e),k1();break e}l=Error(fe(426))}}else if(At&&a.mode&1){var v=LS(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),FS(v,i,a,o,e),u1(pu(l,a));break e}}o=l=pu(l,a),pn!==4&&(pn=2),Vc===null?Vc=[o]:Vc.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=W2(o,l,e);$S(o,g);break e;case 1:a=l;var x=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Li===null||!Li.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var _=V2(o,a,e);$S(o,_);break e}}o=o.return}while(o!==null)}uN(n)}catch(N){e=N,un===n&&n!==null&&(un=n=n.return);continue}break}while(!0)}function aN(){var t=Yh.current;return Yh.current=Xh,t===null?Xh:t}function k1(){(pn===0||pn===3||pn===2)&&(pn=4),Nn===null||!(Ua&268435455)&&!(zp&268435455)||_i(Nn,Pn)}function Jh(t,e){var n=rt;rt|=2;var r=aN();(Nn!==t||Pn!==e)&&(Po=null,Da(t,e));do try{N4();break}catch(s){iN(t,s)}while(!0);if(d1(),rt=n,Yh.current=r,un!==null)throw Error(fe(261));return Nn=null,Pn=0,pn}function N4(){for(;un!==null;)lN(un)}function $4(){for(;un!==null&&!JL();)lN(un)}function lN(t){var e=dN(t.alternate,t,Mr);t.memoizedProps=t.pendingProps,e===null?uN(t):un=e,_1.current=null}function uN(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=w4(n,e),n!==null){n.flags&=32767,un=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{pn=6,un=null;return}}else if(n=b4(n,e,Mr),n!==null){un=n;return}if(e=e.sibling,e!==null){un=e;return}un=e=t}while(e!==null);pn===0&&(pn=5)}function xa(t,e,n){var r=pt,s=ws.transition;try{ws.transition=null,pt=1,k4(t,e,n,r)}finally{ws.transition=s,pt=r}return null}function k4(t,e,n,r){do eu();while(Ni!==null);if(rt&6)throw Error(fe(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(fe(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(uF(t,o),t===Nn&&(un=Nn=null,Pn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Af||(Af=!0,fN(Ah,function(){return eu(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=ws.transition,ws.transition=null;var i=pt;pt=1;var a=rt;rt|=4,_1.current=null,C4(t,n),rN(n,t),XF(e0),Lh=!!Jy,e0=Jy=null,t.current=n,_4(n),eF(),rt=a,pt=i,ws.transition=o}else t.current=n;if(Af&&(Af=!1,Ni=t,Zh=s),o=t.pendingLanes,o===0&&(Li=null),rF(n.stateNode),Er(t,en()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Qh)throw Qh=!1,t=b0,b0=null,t;return Zh&1&&t.tag!==0&&eu(),o=t.pendingLanes,o&1?t===w0?Gc++:(Gc=0,w0=t):Gc=0,sa(),null}function eu(){if(Ni!==null){var t=zT(Zh),e=ws.transition,n=pt;try{if(ws.transition=null,pt=16>t?16:t,Ni===null)var r=!1;else{if(t=Ni,Ni=null,Zh=0,rt&6)throw Error(fe(331));var s=rt;for(rt|=4,_e=t.current;_e!==null;){var o=_e,i=o.child;if(_e.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(_e=u;_e!==null;){var c=_e;switch(c.tag){case 0:case 11:case 15:Wc(8,c,o)}var d=c.child;if(d!==null)d.return=c,_e=d;else for(;_e!==null;){c=_e;var f=c.sibling,h=c.return;if(eN(c),c===u){_e=null;break}if(f!==null){f.return=h,_e=f;break}_e=h}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}_e=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,_e=i;else e:for(;_e!==null;){if(o=_e,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Wc(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,_e=g;break e}_e=o.return}}var x=t.current;for(_e=x;_e!==null;){i=_e;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,_e=b;else e:for(i=x;_e!==null;){if(a=_e,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Up(9,a)}}catch(N){Ht(a,a.return,N)}if(a===i){_e=null;break e}var _=a.sibling;if(_!==null){_.return=a.return,_e=_;break e}_e=a.return}}if(rt=s,sa(),wo&&typeof wo.onPostCommitFiberRoot=="function")try{wo.onPostCommitFiberRoot(Dp,t)}catch{}r=!0}return r}finally{pt=n,ws.transition=e}}return!1}function YS(t,e,n){e=pu(n,e),e=W2(t,e,1),t=Pi(t,e,1),e=ur(),t!==null&&(Ld(t,1,e),Er(t,e))}function Ht(t,e,n){if(t.tag===3)YS(t,t,n);else for(;e!==null;){if(e.tag===3){YS(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Li===null||!Li.has(r))){t=pu(n,t),t=V2(e,t,1),e=Pi(e,t,1),t=ur(),e!==null&&(Ld(e,1,t),Er(e,t));break}}e=e.return}}function I4(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ur(),t.pingedLanes|=t.suspendedLanes&n,Nn===t&&(Pn&n)===n&&(pn===4||pn===3&&(Pn&130023424)===Pn&&500>en()-T1?Da(t,0):E1|=n),Er(t,e)}function cN(t,e){e===0&&(t.mode&1?(e=_f,_f<<=1,!(_f&130023424)&&(_f=4194304)):e=1);var n=ur();t=Ho(t,e),t!==null&&(Ld(t,e,n),Er(t,n))}function O4(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),cN(t,n)}function R4(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(fe(314))}r!==null&&r.delete(e),cN(t,n)}var dN;dN=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Cr.current)wr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return wr=!1,x4(t,e,n);wr=!!(t.flags&131072)}else wr=!1,At&&e.flags&1048576&&p2(e,Wh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;dh(t,e),t=e.pendingProps;var s=cu(e,Zn.current);Jl(e,n),s=x1(null,e,r,t,s,n);var o=b1();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_r(r)?(o=!0,Uh(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,p1(e),s.updater=jp,e.stateNode=s,s._reactInternals=e,u0(e,r,t,n),e=f0(null,e,r,!0,o,n)):(e.tag=0,At&&o&&a1(e),ar(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(dh(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=A4(r),t=Ws(r,t),s){case 0:e=d0(null,e,r,t,n);break e;case 1:e=BS(null,e,r,t,n);break e;case 11:e=MS(null,e,r,t,n);break e;case 14:e=jS(null,e,r,Ws(r.type,t),n);break e}throw Error(fe(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ws(r,s),d0(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ws(r,s),BS(t,e,r,s,n);case 3:e:{if(K2(e),t===null)throw Error(fe(387));r=e.pendingProps,o=e.memoizedState,s=o.element,v2(t,e),Hh(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=pu(Error(fe(423)),e),e=US(t,e,r,n,s);break e}else if(r!==s){s=pu(Error(fe(424)),e),e=US(t,e,r,n,s);break e}else for(Ur=Ai(e.stateNode.containerInfo.firstChild),Wr=e,At=!0,Xs=null,n=S2(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(du(),r===s){e=qo(t,e,n);break e}ar(t,e,r,n)}e=e.child}return e;case 5:return C2(e),t===null&&i0(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,t0(r,s)?i=null:o!==null&&t0(r,o)&&(e.flags|=32),q2(t,e),ar(t,e,i,n),e.child;case 6:return t===null&&i0(e),null;case 13:return X2(t,e,n);case 4:return m1(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=fu(e,null,r,n):ar(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ws(r,s),MS(t,e,r,s,n);case 7:return ar(t,e,e.pendingProps,n),e.child;case 8:return ar(t,e,e.pendingProps.children,n),e.child;case 12:return ar(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,Et(Vh,r._currentValue),r._currentValue=i,o!==null)if(no(o.value,i)){if(o.children===s.children&&!Cr.current){e=qo(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=zo(-1,n&-n),l.tag=2;var u=o.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),a0(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(fe(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),a0(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}ar(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Jl(e,n),s=Cs(s),r=r(s),e.flags|=1,ar(t,e,r,n),e.child;case 14:return r=e.type,s=Ws(r,e.pendingProps),s=Ws(r.type,s),jS(t,e,r,s,n);case 15:return G2(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Ws(r,s),dh(t,e),e.tag=1,_r(r)?(t=!0,Uh(e)):t=!1,Jl(e,n),b2(e,r,s),u0(e,r,s,n),f0(null,e,r,!0,t,n);case 19:return Y2(t,e,n);case 22:return H2(t,e,n)}throw Error(fe(156,e.tag))};function fN(t,e){return MT(t,e)}function D4(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ms(t,e,n,r){return new D4(t,e,n,r)}function I1(t){return t=t.prototype,!(!t||!t.isReactComponent)}function A4(t){if(typeof t=="function")return I1(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Xv)return 11;if(t===Yv)return 14}return 2}function Mi(t,e){var n=t.alternate;return n===null?(n=ms(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ph(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")I1(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Al:return Aa(n.children,s,o,e);case Kv:i=8,s|=8;break;case Dy:return t=ms(12,n,e,s|2),t.elementType=Dy,t.lanes=o,t;case Ay:return t=ms(13,n,e,s),t.elementType=Ay,t.lanes=o,t;case Py:return t=ms(19,n,e,s),t.elementType=Py,t.lanes=o,t;case wT:return Wp(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case xT:i=10;break e;case bT:i=9;break e;case Xv:i=11;break e;case Yv:i=14;break e;case vi:i=16,r=null;break e}throw Error(fe(130,t==null?t:typeof t,""))}return e=ms(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function Aa(t,e,n,r){return t=ms(7,t,r,e),t.lanes=n,t}function Wp(t,e,n,r){return t=ms(22,t,r,e),t.elementType=wT,t.lanes=n,t.stateNode={isHidden:!1},t}function Ug(t,e,n){return t=ms(6,t,null,e),t.lanes=n,t}function zg(t,e,n){return e=ms(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function P4(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sg(0),this.expirationTimes=Sg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sg(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function O1(t,e,n,r,s,o,i,a,l){return t=new P4(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=ms(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},p1(o),t}function L4(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Dl,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function hN(t){if(!t)return Ki;t=t._reactInternals;e:{if(il(t)!==t||t.tag!==1)throw Error(fe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_r(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(fe(171))}if(t.tag===1){var n=t.type;if(_r(n))return f2(t,n,e)}return e}function pN(t,e,n,r,s,o,i,a,l){return t=O1(n,r,!0,t,s,o,i,a,l),t.context=hN(null),n=t.current,r=ur(),s=Fi(n),o=zo(r,s),o.callback=e??null,Pi(n,o,s),t.current.lanes=s,Ld(t,s,r),Er(t,r),t}function Vp(t,e,n,r){var s=e.current,o=ur(),i=Fi(s);return n=hN(n),e.context===null?e.context=n:e.pendingContext=n,e=zo(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Pi(s,e,i),t!==null&&(to(t,s,i,o),lh(t,s,i)),i}function ep(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function QS(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function R1(t,e){QS(t,e),(t=t.alternate)&&QS(t,e)}function F4(){return null}var mN=typeof reportError=="function"?reportError:function(t){console.error(t)};function D1(t){this._internalRoot=t}Gp.prototype.render=D1.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(fe(409));Vp(t,e,null,null)};Gp.prototype.unmount=D1.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;za(function(){Vp(null,t,null,null)}),e[Go]=null}};function Gp(t){this._internalRoot=t}Gp.prototype.unstable_scheduleHydration=function(t){if(t){var e=GT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ci.length&&e!==0&&e<Ci[n].priority;n++);Ci.splice(n,0,t),n===0&&qT(t)}};function A1(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Hp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ZS(){}function M4(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var u=ep(i);o.call(u)}}var i=pN(e,r,t,0,null,!1,!1,"",ZS);return t._reactRootContainer=i,t[Go]=i.current,ad(t.nodeType===8?t.parentNode:t),za(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var u=ep(l);a.call(u)}}var l=O1(t,0,!1,null,null,!1,!1,"",ZS);return t._reactRootContainer=l,t[Go]=l.current,ad(t.nodeType===8?t.parentNode:t),za(function(){Vp(e,l,n,r)}),l}function qp(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var a=s;s=function(){var l=ep(i);a.call(l)}}Vp(e,i,t,s)}else i=M4(n,e,t,s,r);return ep(i)}WT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Nc(e.pendingLanes);n!==0&&(Jv(e,n|1),Er(e,en()),!(rt&6)&&(mu=en()+500,sa()))}break;case 13:za(function(){var r=Ho(t,1);if(r!==null){var s=ur();to(r,t,1,s)}}),R1(t,1)}};e1=function(t){if(t.tag===13){var e=Ho(t,134217728);if(e!==null){var n=ur();to(e,t,134217728,n)}R1(t,134217728)}};VT=function(t){if(t.tag===13){var e=Fi(t),n=Ho(t,e);if(n!==null){var r=ur();to(n,t,e,r)}R1(t,e)}};GT=function(){return pt};HT=function(t,e){var n=pt;try{return pt=t,e()}finally{pt=n}};Gy=function(t,e,n){switch(e){case"input":if(My(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Fp(r);if(!s)throw Error(fe(90));CT(r),My(r,s)}}}break;case"textarea":ET(t,n);break;case"select":e=n.value,e!=null&&Xl(t,!!n.multiple,e,!1)}};RT=N1;DT=za;var j4={usingClientEntryPoint:!1,Events:[Md,Ml,Fp,IT,OT,N1]},cc={findFiberByHostInstance:Ta,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},B4={bundleType:cc.bundleType,version:cc.version,rendererPackageName:cc.rendererPackageName,rendererConfig:cc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Zo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=LT(t),t===null?null:t.stateNode},findFiberByHostInstance:cc.findFiberByHostInstance||F4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Pf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Pf.isDisabled&&Pf.supportsFiber)try{Dp=Pf.inject(B4),wo=Pf}catch{}}Kr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=j4;Kr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!A1(e))throw Error(fe(200));return L4(t,e,null,n)};Kr.createRoot=function(t,e){if(!A1(t))throw Error(fe(299));var n=!1,r="",s=mN;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=O1(t,1,!1,null,null,n,!1,r,s),t[Go]=e.current,ad(t.nodeType===8?t.parentNode:t),new D1(e)};Kr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(fe(188)):(t=Object.keys(t).join(","),Error(fe(268,t)));return t=LT(e),t=t===null?null:t.stateNode,t};Kr.flushSync=function(t){return za(t)};Kr.hydrate=function(t,e,n){if(!Hp(e))throw Error(fe(200));return qp(null,t,e,!0,n)};Kr.hydrateRoot=function(t,e,n){if(!A1(t))throw Error(fe(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=mN;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=pN(e,null,t,1,n??null,s,!1,o,i),t[Go]=e.current,ad(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Gp(e)};Kr.render=function(t,e,n){if(!Hp(e))throw Error(fe(200));return qp(null,t,e,!1,n)};Kr.unmountComponentAtNode=function(t){if(!Hp(t))throw Error(fe(40));return t._reactRootContainer?(za(function(){qp(null,null,t,!1,function(){t._reactRootContainer=null,t[Go]=null})}),!0):!1};Kr.unstable_batchedUpdates=N1;Kr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Hp(n))throw Error(fe(200));if(t==null||t._reactInternals===void 0)throw Error(fe(38));return qp(t,e,n,!1,r)};Kr.version="18.2.0-next-9e3b772b8-20220608";function gN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gN)}catch(t){console.error(t)}}gN(),pT.exports=Kr;var Ru=pT.exports;const U4=$u(Ru),z4=Bv({__proto__:null,default:U4},[Ru]);/**
 * @remix-run/router v1.14.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function qt(){return qt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qt.apply(this,arguments)}var Jt;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Jt||(Jt={}));const JS="popstate";function W4(t){t===void 0&&(t={});function e(r,s){let{pathname:o,search:i,hash:a}=r.location;return gd("",{pathname:o,search:i,hash:a},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Bd(s)}return G4(e,n,null,t)}function Qe(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Wa(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function V4(){return Math.random().toString(36).substr(2,8)}function eC(t,e){return{usr:t.state,key:t.key,idx:e}}function gd(t,e,n,r){return n===void 0&&(n=null),qt({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Jo(e):e,{state:n,key:e&&e.key||r||V4()})}function Bd(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function Jo(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function G4(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:o=!1}=r,i=s.history,a=Jt.Pop,l=null,u=c();u==null&&(u=0,i.replaceState(qt({},i.state,{idx:u}),""));function c(){return(i.state||{idx:null}).idx}function d(){a=Jt.Pop;let v=c(),g=v==null?null:v-u;u=v,l&&l({action:a,location:m.location,delta:g})}function f(v,g){a=Jt.Push;let x=gd(m.location,v,g);n&&n(x,v),u=c()+1;let b=eC(x,u),_=m.createHref(x);try{i.pushState(b,"",_)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(_)}o&&l&&l({action:a,location:m.location,delta:1})}function h(v,g){a=Jt.Replace;let x=gd(m.location,v,g);n&&n(x,v),u=c();let b=eC(x,u),_=m.createHref(x);i.replaceState(b,"",_),o&&l&&l({action:a,location:m.location,delta:0})}function p(v){let g=s.location.origin!=="null"?s.location.origin:s.location.href,x=typeof v=="string"?v:Bd(v);return Qe(g,"No window.location.(origin|href) available to create URL for href: "+x),new URL(x,g)}let m={get action(){return a},get location(){return t(s,i)},listen(v){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(JS,d),l=v,()=>{s.removeEventListener(JS,d),l=null}},createHref(v){return e(s,v)},createURL:p,encodeLocation(v){let g=p(v);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:f,replace:h,go(v){return i.go(v)}};return m}var Gt;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Gt||(Gt={}));const H4=new Set(["lazy","caseSensitive","path","id","index","children"]);function q4(t){return t.index===!0}function _0(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,o)=>{let i=[...n,o],a=typeof s.id=="string"?s.id:i.join("-");if(Qe(s.index!==!0||!s.children,"Cannot specify children on an index route"),Qe(!r[a],'Found a route id collision on id "'+a+`".  Route id's must be globally unique within Data Router usages`),q4(s)){let l=qt({},s,e(s),{id:a});return r[a]=l,l}else{let l=qt({},s,e(s),{id:a,children:void 0});return r[a]=l,s.children&&(l.children=_0(s.children,e,i,r)),l}})}function Gl(t,e,n){n===void 0&&(n="/");let r=typeof e=="string"?Jo(e):e,s=Ud(r.pathname||"/",n);if(s==null)return null;let o=yN(t);X4(o);let i=null;for(let a=0;i==null&&a<o.length;++a)i=sM(o[a],aM(s));return i}function K4(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function yN(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(o,i,a)=>{let l={relativePath:a===void 0?o.path||"":a,caseSensitive:o.caseSensitive===!0,childrenIndex:i,route:o};l.relativePath.startsWith("/")&&(Qe(l.relativePath.startsWith(r),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(r.length));let u=ji([r,l.relativePath]),c=n.concat(l);o.children&&o.children.length>0&&(Qe(o.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),yN(o.children,e,c,u)),!(o.path==null&&!o.index)&&e.push({path:u,score:nM(u,o.index),routesMeta:c})};return t.forEach((o,i)=>{var a;if(o.path===""||!((a=o.path)!=null&&a.includes("?")))s(o,i);else for(let l of vN(o.path))s(o,i,l)}),e}function vN(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return s?[o,""]:[o];let i=vN(r.join("/")),a=[];return a.push(...i.map(l=>l===""?o:[o,l].join("/"))),s&&a.push(...i),a.map(l=>t.startsWith("/")&&l===""?"/":l)}function X4(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:rM(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const Y4=/^:\w+$/,Q4=3,Z4=2,J4=1,eM=10,tM=-2,tC=t=>t==="*";function nM(t,e){let n=t.split("/"),r=n.length;return n.some(tC)&&(r+=tM),e&&(r+=Z4),n.filter(s=>!tC(s)).reduce((s,o)=>s+(Y4.test(o)?Q4:o===""?J4:eM),r)}function rM(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function sM(t,e){let{routesMeta:n}=t,r={},s="/",o=[];for(let i=0;i<n.length;++i){let a=n[i],l=i===n.length-1,u=s==="/"?e:e.slice(s.length)||"/",c=oM({path:a.relativePath,caseSensitive:a.caseSensitive,end:l},u);if(!c)return null;Object.assign(r,c.params);let d=a.route;o.push({params:r,pathname:ji([s,c.pathname]),pathnameBase:dM(ji([s,c.pathnameBase])),route:d}),c.pathnameBase!=="/"&&(s=ji([s,c.pathnameBase]))}return o}function oM(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=iM(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let o=s[0],i=o.replace(/(.)\/+$/,"$1"),a=s.slice(1);return{params:r.reduce((u,c,d)=>{let{paramName:f,isOptional:h}=c;if(f==="*"){let m=a[d]||"";i=o.slice(0,o.length-m.length).replace(/(.)\/+$/,"$1")}const p=a[d];return h&&!p?u[f]=void 0:u[f]=lM(p||"",f),u},{}),pathname:o,pathnameBase:i,pattern:t}}function iM(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Wa(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:(\w+)(\?)?/g,(i,a,l)=>(r.push({paramName:a,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function aM(t){try{return decodeURI(t)}catch(e){return Wa(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function lM(t,e){try{return decodeURIComponent(t)}catch(n){return Wa(!1,'The value for the URL param "'+e+'" will not be decoded because'+(' the string "'+t+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+n+").")),t}}function Ud(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function uM(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?Jo(t):t;return{pathname:n?n.startsWith("/")?n:cM(n,e):e,search:fM(r),hash:hM(s)}}function cM(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Wg(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function xN(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function bN(t,e){let n=xN(t);return e?n.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function wN(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=Jo(t):(s=qt({},t),Qe(!s.pathname||!s.pathname.includes("?"),Wg("?","pathname","search",s)),Qe(!s.pathname||!s.pathname.includes("#"),Wg("#","pathname","hash",s)),Qe(!s.search||!s.search.includes("#"),Wg("#","search","hash",s)));let o=t===""||s.pathname==="",i=o?"/":s.pathname,a;if(i==null)a=n;else if(r){let d=e.length===0?[]:e[e.length-1].replace(/^\//,"").split("/");if(i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),d.pop();s.pathname=f.join("/")}a="/"+d.join("/")}else{let d=e.length-1;if(i.startsWith("..")){let f=i.split("/");for(;f[0]==="..";)f.shift(),d-=1;s.pathname=f.join("/")}a=d>=0?e[d]:"/"}let l=uM(s,a),u=i&&i!=="/"&&i.endsWith("/"),c=(o||i===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}const ji=t=>t.join("/").replace(/\/\/+/g,"/"),dM=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),fM=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,hM=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class P1{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function SN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const CN=["post","put","patch","delete"],pM=new Set(CN),mM=["get",...CN],gM=new Set(mM),yM=new Set([301,302,303,307,308]),vM=new Set([307,308]),Vg={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},xM={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},dc={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},_N=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bM=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),EN="remix-router-transitions";function wM(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;Qe(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let X=t.detectErrorBoundary;s=Z=>({hasErrorBoundary:X(Z)})}else s=bM;let o={},i=_0(t.routes,s,void 0,o),a,l=t.basename||"/",u=qt({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1},t.future),c=null,d=new Set,f=null,h=null,p=null,m=t.hydrationData!=null,v=Gl(i,t.history.location,l),g=null;if(v==null){let X=cs(404,{pathname:t.history.location.pathname}),{matches:Z,route:se}=uC(i);v=Z,g={[se.id]:X}}let x,b=v.some(X=>X.route.lazy),_=v.some(X=>X.route.loader);if(b)x=!1;else if(!_)x=!0;else if(u.v7_partialHydration){let X=t.hydrationData?t.hydrationData.loaderData:null,Z=t.hydrationData?t.hydrationData.errors:null;x=v.every(se=>se.route.loader&&se.route.loader.hydrate!==!0&&(X&&X[se.route.id]!==void 0||Z&&Z[se.route.id]!==void 0))}else x=t.hydrationData!=null;let N,E={historyAction:t.history.action,location:t.history.location,matches:v,initialized:x,navigation:Vg,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||g,fetchers:new Map,blockers:new Map},R=Jt.Pop,P=!1,B,F=!1,H=new Map,ee=null,oe=!1,de=!1,V=[],W=[],I=new Map,O=0,j=-1,A=new Map,ne=new Set,U=new Map,Q=new Map,G=new Set,J=new Map,re=new Map,be=!1;function ue(){if(c=t.history.listen(X=>{let{action:Z,location:se,delta:ce}=X;if(be){be=!1;return}Wa(re.size===0||ce!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ye=xn({currentLocation:E.location,nextLocation:se,historyAction:Z});if(ye&&ce!=null){be=!0,t.history.go(ce*-1),Wt(ye,{state:"blocked",location:se,proceed(){Wt(ye,{state:"proceeding",proceed:void 0,reset:void 0,location:se}),t.history.go(ce)},reset(){let Ie=new Map(E.blockers);Ie.set(ye,dc),Ye({blockers:Ie})}});return}return Ct(Z,se)}),n){DM(e,H);let X=()=>AM(e,H);e.addEventListener("pagehide",X),ee=()=>e.removeEventListener("pagehide",X)}return E.initialized||Ct(Jt.Pop,E.location,{initialHydration:!0}),N}function De(){c&&c(),ee&&ee(),d.clear(),B&&B.abort(),E.fetchers.forEach((X,Z)=>uo(Z)),E.blockers.forEach((X,Z)=>rn(Z))}function Ae(X){return d.add(X),()=>d.delete(X)}function Ye(X,Z){Z===void 0&&(Z={}),E=qt({},E,X);let se=[],ce=[];u.v7_fetcherPersist&&E.fetchers.forEach((ye,Ie)=>{ye.state==="idle"&&(G.has(Ie)?ce.push(Ie):se.push(Ie))}),[...d].forEach(ye=>ye(E,{deletedFetchers:ce,unstable_viewTransitionOpts:Z.viewTransitionOpts,unstable_flushSync:Z.flushSync===!0})),u.v7_fetcherPersist&&(se.forEach(ye=>E.fetchers.delete(ye)),ce.forEach(ye=>uo(ye)))}function ot(X,Z,se){var ce,ye;let{flushSync:Ie}=se===void 0?{}:se,Ne=E.actionData!=null&&E.navigation.formMethod!=null&&qs(E.navigation.formMethod)&&E.navigation.state==="loading"&&((ce=X.state)==null?void 0:ce._isRedirect)!==!0,$e;Z.actionData?Object.keys(Z.actionData).length>0?$e=Z.actionData:$e=null:Ne?$e=E.actionData:$e=null;let Se=Z.loaderData?lC(E.loaderData,Z.loaderData,Z.matches||[],Z.errors):E.loaderData,Ge=E.blockers;Ge.size>0&&(Ge=new Map(Ge),Ge.forEach((ut,sn)=>Ge.set(sn,dc)));let Qt=P===!0||E.navigation.formMethod!=null&&qs(E.navigation.formMethod)&&((ye=X.state)==null?void 0:ye._isRedirect)!==!0;a&&(i=a,a=void 0),oe||R===Jt.Pop||(R===Jt.Push?t.history.push(X,X.state):R===Jt.Replace&&t.history.replace(X,X.state));let We;if(R===Jt.Pop){let ut=H.get(E.location.pathname);ut&&ut.has(X.pathname)?We={currentLocation:E.location,nextLocation:X}:H.has(X.pathname)&&(We={currentLocation:X,nextLocation:E.location})}else if(F){let ut=H.get(E.location.pathname);ut?ut.add(X.pathname):(ut=new Set([X.pathname]),H.set(E.location.pathname,ut)),We={currentLocation:E.location,nextLocation:X}}Ye(qt({},Z,{actionData:$e,loaderData:Se,historyAction:R,location:X,initialized:!0,navigation:Vg,revalidation:"idle",restoreScrollPosition:Or(X,Z.matches||E.matches),preventScrollReset:Qt,blockers:Ge}),{viewTransitionOpts:We,flushSync:Ie===!0}),R=Jt.Pop,P=!1,F=!1,oe=!1,de=!1,V=[],W=[]}async function Ft(X,Z){if(typeof X=="number"){t.history.go(X);return}let se=E0(E.location,E.matches,l,u.v7_prependBasename,X,u.v7_relativeSplatPath,Z==null?void 0:Z.fromRouteId,Z==null?void 0:Z.relative),{path:ce,submission:ye,error:Ie}=nC(u.v7_normalizeFormMethod,!1,se,Z),Ne=E.location,$e=gd(E.location,ce,Z&&Z.state);$e=qt({},$e,t.history.encodeLocation($e));let Se=Z&&Z.replace!=null?Z.replace:void 0,Ge=Jt.Push;Se===!0?Ge=Jt.Replace:Se===!1||ye!=null&&qs(ye.formMethod)&&ye.formAction===E.location.pathname+E.location.search&&(Ge=Jt.Replace);let Qt=Z&&"preventScrollReset"in Z?Z.preventScrollReset===!0:void 0,We=(Z&&Z.unstable_flushSync)===!0,ut=xn({currentLocation:Ne,nextLocation:$e,historyAction:Ge});if(ut){Wt(ut,{state:"blocked",location:$e,proceed(){Wt(ut,{state:"proceeding",proceed:void 0,reset:void 0,location:$e}),Ft(X,Z)},reset(){let sn=new Map(E.blockers);sn.set(ut,dc),Ye({blockers:sn})}});return}return await Ct(Ge,$e,{submission:ye,pendingError:Ie,preventScrollReset:Qt,replace:Z&&Z.replace,enableViewTransition:Z&&Z.unstable_viewTransition,flushSync:We})}function yn(){if(Rs(),Ye({revalidation:"loading"}),E.navigation.state!=="submitting"){if(E.navigation.state==="idle"){Ct(E.historyAction,E.location,{startUninterruptedRevalidation:!0});return}Ct(R||E.historyAction,E.navigation.location,{overrideNavigation:E.navigation})}}async function Ct(X,Z,se){B&&B.abort(),B=null,R=X,oe=(se&&se.startUninterruptedRevalidation)===!0,pr(E.location,E.matches),P=(se&&se.preventScrollReset)===!0,F=(se&&se.enableViewTransition)===!0;let ce=a||i,ye=se&&se.overrideNavigation,Ie=Gl(ce,Z,l),Ne=(se&&se.flushSync)===!0;if(!Ie){let sn=cs(404,{pathname:Z.pathname}),{matches:nr,route:ct}=uC(ce);Yt(),ot(Z,{matches:nr,loaderData:{},errors:{[ct.id]:sn}},{flushSync:Ne});return}if(E.initialized&&!de&&NM(E.location,Z)&&!(se&&se.submission&&qs(se.submission.formMethod))){ot(Z,{matches:Ie},{flushSync:Ne});return}B=new AbortController;let $e=hc(t.history,Z,B.signal,se&&se.submission),Se,Ge;if(se&&se.pendingError)Ge={[Hc(Ie).route.id]:se.pendingError};else if(se&&se.submission&&qs(se.submission.formMethod)){let sn=await It($e,Z,se.submission,Ie,{replace:se.replace,flushSync:Ne});if(sn.shortCircuited)return;Se=sn.pendingActionData,Ge=sn.pendingActionError,ye=Gg(Z,se.submission),Ne=!1,$e=new Request($e.url,{signal:$e.signal})}let{shortCircuited:Qt,loaderData:We,errors:ut}=await zt($e,Z,Ie,ye,se&&se.submission,se&&se.fetcherSubmission,se&&se.replace,se&&se.initialHydration===!0,Ne,Se,Ge);Qt||(B=null,ot(Z,qt({matches:Ie},Se?{actionData:Se}:{},{loaderData:We,errors:ut})))}async function It(X,Z,se,ce,ye){ye===void 0&&(ye={}),Rs();let Ie=OM(Z,se);Ye({navigation:Ie},{flushSync:ye.flushSync===!0});let Ne,$e=N0(ce,Z);if(!$e.route.action&&!$e.route.lazy)Ne={type:Gt.error,error:cs(405,{method:X.method,pathname:Z.pathname,routeId:$e.route.id})};else if(Ne=await fc("action",X,$e,ce,o,s,l,u.v7_relativeSplatPath),X.signal.aborted)return{shortCircuited:!0};if(tu(Ne)){let Se;return ye&&ye.replace!=null?Se=ye.replace:Se=Ne.location===E.location.pathname+E.location.search,await vn(E,Ne,{submission:se,replace:Se}),{shortCircuited:!0}}if(qc(Ne)){let Se=Hc(ce,$e.route.id);return(ye&&ye.replace)!==!0&&(R=Jt.Push),{pendingActionData:{},pendingActionError:{[Se.route.id]:Ne.error}}}if(ka(Ne))throw cs(400,{type:"defer-action"});return{pendingActionData:{[$e.route.id]:Ne.data}}}async function zt(X,Z,se,ce,ye,Ie,Ne,$e,Se,Ge,Qt){let We=ce||Gg(Z,ye),ut=ye||Ie||fC(We),sn=a||i,[nr,ct]=rC(t.history,E,se,ut,Z,u.v7_partialHydration&&$e===!0,de,V,W,G,U,ne,sn,l,Ge,Qt);if(Yt(lt=>!(se&&se.some(it=>it.route.id===lt))||nr&&nr.some(it=>it.route.id===lt)),j=++O,nr.length===0&&ct.length===0){let lt=Oo();return ot(Z,qt({matches:se,loaderData:{},errors:Qt||null},Ge?{actionData:Ge}:{},lt?{fetchers:new Map(E.fetchers)}:{}),{flushSync:Se}),{shortCircuited:!0}}if(!oe&&(!u.v7_partialHydration||!$e)){ct.forEach(it=>{let gr=E.fetchers.get(it.key),ca=pc(void 0,gr?gr.data:void 0);E.fetchers.set(it.key,ca)});let lt=Ge||E.actionData;Ye(qt({navigation:We},lt?Object.keys(lt).length===0?{actionData:null}:{actionData:lt}:{},ct.length>0?{fetchers:new Map(E.fetchers)}:{}),{flushSync:Se})}ct.forEach(lt=>{I.has(lt.key)&&Rn(lt.key),lt.controller&&I.set(lt.key,lt.controller)});let on=()=>ct.forEach(lt=>Rn(lt.key));B&&B.signal.addEventListener("abort",on);let{results:Ps,loaderResults:dn,fetcherResults:ts}=await Ot(E.matches,se,nr,ct,X);if(X.signal.aborted)return{shortCircuited:!0};B&&B.signal.removeEventListener("abort",on),ct.forEach(lt=>I.delete(lt.key));let Ls=cC(Ps);if(Ls){if(Ls.idx>=nr.length){let lt=ct[Ls.idx-nr.length].key;ne.add(lt)}return await vn(E,Ls.result,{replace:Ne}),{shortCircuited:!0}}let{loaderData:mr,errors:Fs}=aC(E,se,nr,dn,Qt,ct,ts,J);J.forEach((lt,it)=>{lt.subscribe(gr=>{(gr||lt.done)&&J.delete(it)})});let ai=Oo(),Rr=Ro(j),li=ai||Rr||ct.length>0;return qt({loaderData:mr,errors:Fs},li?{fetchers:new Map(E.fetchers)}:{})}function Mn(X,Z,se,ce){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");I.has(X)&&Rn(X);let ye=(ce&&ce.unstable_flushSync)===!0,Ie=a||i,Ne=E0(E.location,E.matches,l,u.v7_prependBasename,se,u.v7_relativeSplatPath,Z,ce==null?void 0:ce.relative),$e=Gl(Ie,Ne,l);if(!$e){Io(X,Z,cs(404,{pathname:Ne}),{flushSync:ye});return}let{path:Se,submission:Ge,error:Qt}=nC(u.v7_normalizeFormMethod,!0,Ne,ce);if(Qt){Io(X,Z,Qt,{flushSync:ye});return}let We=N0($e,Se);if(P=(ce&&ce.preventScrollReset)===!0,Ge&&qs(Ge.formMethod)){jn(X,Z,Se,We,$e,ye,Ge);return}U.set(X,{routeId:Z,path:Se}),kr(X,Z,Se,We,$e,ye,Ge)}async function jn(X,Z,se,ce,ye,Ie,Ne){if(Rs(),U.delete(X),!ce.route.action&&!ce.route.lazy){let it=cs(405,{method:Ne.formMethod,pathname:se,routeId:Z});Io(X,Z,it,{flushSync:Ie});return}let $e=E.fetchers.get(X);tr(X,RM(Ne,$e),{flushSync:Ie});let Se=new AbortController,Ge=hc(t.history,se,Se.signal,Ne);I.set(X,Se);let Qt=O,We=await fc("action",Ge,ce,ye,o,s,l,u.v7_relativeSplatPath);if(Ge.signal.aborted){I.get(X)===Se&&I.delete(X);return}if(G.has(X)){tr(X,yi(void 0));return}if(tu(We))if(I.delete(X),j>Qt){tr(X,yi(void 0));return}else return ne.add(X),tr(X,pc(Ne)),vn(E,We,{fetcherSubmission:Ne});if(qc(We)){Io(X,Z,We.error);return}if(ka(We))throw cs(400,{type:"defer-action"});let ut=E.navigation.location||E.location,sn=hc(t.history,ut,Se.signal),nr=a||i,ct=E.navigation.state!=="idle"?Gl(nr,E.navigation.location,l):E.matches;Qe(ct,"Didn't find any matches after fetcher action");let on=++O;A.set(X,on);let Ps=pc(Ne,We.data);E.fetchers.set(X,Ps);let[dn,ts]=rC(t.history,E,ct,Ne,ut,!1,de,V,W,G,U,ne,nr,l,{[ce.route.id]:We.data},void 0);ts.filter(it=>it.key!==X).forEach(it=>{let gr=it.key,ca=E.fetchers.get(gr),Ms=pc(void 0,ca?ca.data:void 0);E.fetchers.set(gr,Ms),I.has(gr)&&Rn(gr),it.controller&&I.set(gr,it.controller)}),Ye({fetchers:new Map(E.fetchers)});let Ls=()=>ts.forEach(it=>Rn(it.key));Se.signal.addEventListener("abort",Ls);let{results:mr,loaderResults:Fs,fetcherResults:ai}=await Ot(E.matches,ct,dn,ts,sn);if(Se.signal.aborted)return;Se.signal.removeEventListener("abort",Ls),A.delete(X),I.delete(X),ts.forEach(it=>I.delete(it.key));let Rr=cC(mr);if(Rr){if(Rr.idx>=dn.length){let it=ts[Rr.idx-dn.length].key;ne.add(it)}return vn(E,Rr.result)}let{loaderData:li,errors:lt}=aC(E,E.matches,dn,Fs,void 0,ts,ai,J);if(E.fetchers.has(X)){let it=yi(We.data);E.fetchers.set(X,it)}Ro(on),E.navigation.state==="loading"&&on>j?(Qe(R,"Expected pending action"),B&&B.abort(),ot(E.navigation.location,{matches:ct,loaderData:li,errors:lt,fetchers:new Map(E.fetchers)})):(Ye({errors:lt,loaderData:lC(E.loaderData,li,ct,lt),fetchers:new Map(E.fetchers)}),de=!1)}async function kr(X,Z,se,ce,ye,Ie,Ne){let $e=E.fetchers.get(X);tr(X,pc(Ne,$e?$e.data:void 0),{flushSync:Ie});let Se=new AbortController,Ge=hc(t.history,se,Se.signal);I.set(X,Se);let Qt=O,We=await fc("loader",Ge,ce,ye,o,s,l,u.v7_relativeSplatPath);if(ka(We)&&(We=await $N(We,Ge.signal,!0)||We),I.get(X)===Se&&I.delete(X),!Ge.signal.aborted){if(G.has(X)){tr(X,yi(void 0));return}if(tu(We))if(j>Qt){tr(X,yi(void 0));return}else{ne.add(X),await vn(E,We);return}if(qc(We)){Io(X,Z,We.error);return}Qe(!ka(We),"Unhandled fetcher deferred data"),tr(X,yi(We.data))}}async function vn(X,Z,se){let{submission:ce,fetcherSubmission:ye,replace:Ie}=se===void 0?{}:se;Z.revalidate&&(de=!0);let Ne=gd(X.location,Z.location,{_isRedirect:!0});if(Qe(Ne,"Expected a location on the redirect navigation"),n){let ut=!1;if(Z.reloadDocument)ut=!0;else if(_N.test(Z.location)){const sn=t.history.createURL(Z.location);ut=sn.origin!==e.location.origin||Ud(sn.pathname,l)==null}if(ut){Ie?e.location.replace(Z.location):e.location.assign(Z.location);return}}B=null;let $e=Ie===!0?Jt.Replace:Jt.Push,{formMethod:Se,formAction:Ge,formEncType:Qt}=X.navigation;!ce&&!ye&&Se&&Ge&&Qt&&(ce=fC(X.navigation));let We=ce||ye;if(vM.has(Z.status)&&We&&qs(We.formMethod))await Ct($e,Ne,{submission:qt({},We,{formAction:Z.location}),preventScrollReset:P});else{let ut=Gg(Ne,ce);await Ct($e,Ne,{overrideNavigation:ut,fetcherSubmission:ye,preventScrollReset:P})}}async function Ot(X,Z,se,ce,ye){let Ie=await Promise.all([...se.map(Se=>fc("loader",ye,Se,Z,o,s,l,u.v7_relativeSplatPath)),...ce.map(Se=>Se.matches&&Se.match&&Se.controller?fc("loader",hc(t.history,Se.path,Se.controller.signal),Se.match,Se.matches,o,s,l,u.v7_relativeSplatPath):{type:Gt.error,error:cs(404,{pathname:Se.path})})]),Ne=Ie.slice(0,se.length),$e=Ie.slice(se.length);return await Promise.all([dC(X,se,Ne,Ne.map(()=>ye.signal),!1,E.loaderData),dC(X,ce.map(Se=>Se.match),$e,ce.map(Se=>Se.controller?Se.controller.signal:null),!0)]),{results:Ie,loaderResults:Ne,fetcherResults:$e}}function Rs(){de=!0,V.push(...Yt()),U.forEach((X,Z)=>{I.has(Z)&&(W.push(Z),Rn(Z))})}function tr(X,Z,se){se===void 0&&(se={}),E.fetchers.set(X,Z),Ye({fetchers:new Map(E.fetchers)},{flushSync:(se&&se.flushSync)===!0})}function Io(X,Z,se,ce){ce===void 0&&(ce={});let ye=Hc(E.matches,Z);uo(X),Ye({errors:{[ye.route.id]:se},fetchers:new Map(E.fetchers)},{flushSync:(ce&&ce.flushSync)===!0})}function Ds(X){return u.v7_fetcherPersist&&(Q.set(X,(Q.get(X)||0)+1),G.has(X)&&G.delete(X)),E.fetchers.get(X)||xM}function uo(X){let Z=E.fetchers.get(X);I.has(X)&&!(Z&&Z.state==="loading"&&A.has(X))&&Rn(X),U.delete(X),A.delete(X),ne.delete(X),G.delete(X),E.fetchers.delete(X)}function As(X){if(u.v7_fetcherPersist){let Z=(Q.get(X)||0)-1;Z<=0?(Q.delete(X),G.add(X)):Q.set(X,Z)}else uo(X);Ye({fetchers:new Map(E.fetchers)})}function Rn(X){let Z=I.get(X);Qe(Z,"Expected fetch controller: "+X),Z.abort(),I.delete(X)}function oi(X){for(let Z of X){let se=Ds(Z),ce=yi(se.data);E.fetchers.set(Z,ce)}}function Oo(){let X=[],Z=!1;for(let se of ne){let ce=E.fetchers.get(se);Qe(ce,"Expected fetcher: "+se),ce.state==="loading"&&(ne.delete(se),X.push(se),Z=!0)}return oi(X),Z}function Ro(X){let Z=[];for(let[se,ce]of A)if(ce<X){let ye=E.fetchers.get(se);Qe(ye,"Expected fetcher: "+se),ye.state==="loading"&&(Rn(se),A.delete(se),Z.push(se))}return oi(Z),Z.length>0}function co(X,Z){let se=E.blockers.get(X)||dc;return re.get(X)!==Z&&re.set(X,Z),se}function rn(X){E.blockers.delete(X),re.delete(X)}function Wt(X,Z){let se=E.blockers.get(X)||dc;Qe(se.state==="unblocked"&&Z.state==="blocked"||se.state==="blocked"&&Z.state==="blocked"||se.state==="blocked"&&Z.state==="proceeding"||se.state==="blocked"&&Z.state==="unblocked"||se.state==="proceeding"&&Z.state==="unblocked","Invalid blocker state transition: "+se.state+" -> "+Z.state);let ce=new Map(E.blockers);ce.set(X,Z),Ye({blockers:ce})}function xn(X){let{currentLocation:Z,nextLocation:se,historyAction:ce}=X;if(re.size===0)return;re.size>1&&Wa(!1,"A router only supports one blocker at a time");let ye=Array.from(re.entries()),[Ie,Ne]=ye[ye.length-1],$e=E.blockers.get(Ie);if(!($e&&$e.state==="proceeding")&&Ne({currentLocation:Z,nextLocation:se,historyAction:ce}))return Ie}function Yt(X){let Z=[];return J.forEach((se,ce)=>{(!X||X(ce))&&(se.cancel(),Z.push(ce),J.delete(ce))}),Z}function ii(X,Z,se){if(f=X,p=Z,h=se||null,!m&&E.navigation===Vg){m=!0;let ce=Or(E.location,E.matches);ce!=null&&Ye({restoreScrollPosition:ce})}return()=>{f=null,p=null,h=null}}function Ir(X,Z){return h&&h(X,Z.map(ce=>K4(ce,E.loaderData)))||X.key}function pr(X,Z){if(f&&p){let se=Ir(X,Z);f[se]=p()}}function Or(X,Z){if(f){let se=Ir(X,Z),ce=f[se];if(typeof ce=="number")return ce}return null}function wl(X){o={},a=_0(X,s,void 0,o)}return N={get basename(){return l},get future(){return u},get state(){return E},get routes(){return i},get window(){return e},initialize:ue,subscribe:Ae,enableScrollRestoration:ii,navigate:Ft,fetch:Mn,revalidate:yn,createHref:X=>t.history.createHref(X),encodeLocation:X=>t.history.encodeLocation(X),getFetcher:Ds,deleteFetcher:As,dispose:De,getBlocker:co,deleteBlocker:rn,_internalFetchControllers:I,_internalActiveDeferreds:J,_internalSetRoutes:wl},N}function SM(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function E0(t,e,n,r,s,o,i,a){let l,u;if(i){l=[];for(let d of e)if(l.push(d),d.route.id===i){u=d;break}}else l=e,u=e[e.length-1];let c=wN(s||".",bN(l,o),Ud(t.pathname,n)||t.pathname,a==="path");return s==null&&(c.search=t.search,c.hash=t.hash),(s==null||s===""||s===".")&&u&&u.route.index&&!L1(c.search)&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),r&&n!=="/"&&(c.pathname=c.pathname==="/"?n:ji([n,c.pathname])),Bd(c)}function nC(t,e,n,r){if(!r||!SM(r))return{path:n};if(r.formMethod&&!IM(r.formMethod))return{path:n,error:cs(405,{method:r.formMethod})};let s=()=>({path:n,error:cs(400,{type:"invalid-body"})}),o=r.formMethod||"get",i=t?o.toUpperCase():o.toLowerCase(),a=NN(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!qs(i))return s();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((h,p)=>{let[m,v]=p;return""+h+m+"="+v+`
`},""):String(r.body);return{path:n,submission:{formMethod:i,formAction:a,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!qs(i))return s();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:i,formAction:a,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return s()}}}Qe(typeof FormData=="function","FormData is not available in this environment");let l,u;if(r.formData)l=T0(r.formData),u=r.formData;else if(r.body instanceof FormData)l=T0(r.body),u=r.body;else if(r.body instanceof URLSearchParams)l=r.body,u=iC(l);else if(r.body==null)l=new URLSearchParams,u=new FormData;else try{l=new URLSearchParams(r.body),u=iC(l)}catch{return s()}let c={formMethod:i,formAction:a,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(qs(c.formMethod))return{path:n,submission:c};let d=Jo(n);return e&&d.search&&L1(d.search)&&l.append("index",""),d.search="?"+l,{path:Bd(d),submission:c}}function CM(t,e){let n=t;if(e){let r=t.findIndex(s=>s.route.id===e);r>=0&&(n=t.slice(0,r))}return n}function rC(t,e,n,r,s,o,i,a,l,u,c,d,f,h,p,m){let v=m?Object.values(m)[0]:p?Object.values(p)[0]:void 0,g=t.createURL(e.location),x=t.createURL(s),b=m?Object.keys(m)[0]:void 0,N=CM(n,b).filter((R,P)=>{if(o)return _M(e,R.route);if(R.route.lazy)return!0;if(R.route.loader==null)return!1;if(EM(e.loaderData,e.matches[P],R)||a.some(H=>H===R.route.id))return!0;let B=e.matches[P],F=R;return sC(R,qt({currentUrl:g,currentParams:B.params,nextUrl:x,nextParams:F.params},r,{actionResult:v,defaultShouldRevalidate:i||g.pathname+g.search===x.pathname+x.search||g.search!==x.search||TN(B,F)}))}),E=[];return c.forEach((R,P)=>{if(o||!n.some(oe=>oe.route.id===R.routeId)||u.has(P))return;let B=Gl(f,R.path,h);if(!B){E.push({key:P,routeId:R.routeId,path:R.path,matches:null,match:null,controller:null});return}let F=e.fetchers.get(P),H=N0(B,R.path),ee=!1;d.has(P)?ee=!1:l.includes(P)?ee=!0:F&&F.state!=="idle"&&F.data===void 0?ee=i:ee=sC(H,qt({currentUrl:g,currentParams:e.matches[e.matches.length-1].params,nextUrl:x,nextParams:n[n.length-1].params},r,{actionResult:v,defaultShouldRevalidate:i})),ee&&E.push({key:P,routeId:R.routeId,path:R.path,matches:B,match:H,controller:new AbortController})}),[N,E]}function _M(t,e){return e.loader?e.loader.hydrate?!0:t.loaderData[e.id]===void 0&&(!t.errors||t.errors[e.id]===void 0):!1}function EM(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function TN(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function sC(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}async function oC(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];Qe(s,"No route found in manifest");let o={};for(let i in r){let l=s[i]!==void 0&&i!=="hasErrorBoundary";Wa(!l,'Route "'+s.id+'" has a static property "'+i+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+i+'" will be ignored.')),!l&&!H4.has(i)&&(o[i]=r[i])}Object.assign(s,o),Object.assign(s,qt({},e(s),{lazy:void 0}))}async function fc(t,e,n,r,s,o,i,a,l){l===void 0&&(l={});let u,c,d,f=m=>{let v,g=new Promise((x,b)=>v=b);return d=()=>v(),e.signal.addEventListener("abort",d),Promise.race([m({request:e,params:n.params,context:l.requestContext}),g])};try{let m=n.route[t];if(n.route.lazy)if(m){let v,g=await Promise.all([f(m).catch(x=>{v=x}),oC(n.route,o,s)]);if(v)throw v;c=g[0]}else if(await oC(n.route,o,s),m=n.route[t],m)c=await f(m);else if(t==="action"){let v=new URL(e.url),g=v.pathname+v.search;throw cs(405,{method:e.method,pathname:g,routeId:n.route.id})}else return{type:Gt.data,data:void 0};else if(m)c=await f(m);else{let v=new URL(e.url),g=v.pathname+v.search;throw cs(404,{pathname:g})}Qe(c!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(m){u=Gt.error,c=m}finally{d&&e.signal.removeEventListener("abort",d)}if(kM(c)){let m=c.status;if(yM.has(m)){let g=c.headers.get("Location");if(Qe(g,"Redirects returned/thrown from loaders/actions must have a Location header"),!_N.test(g))g=E0(new URL(e.url),r.slice(0,r.indexOf(n)+1),i,!0,g,a);else if(!l.isStaticRequest){let x=new URL(e.url),b=g.startsWith("//")?new URL(x.protocol+g):new URL(g),_=Ud(b.pathname,i)!=null;b.origin===x.origin&&_&&(g=b.pathname+b.search+b.hash)}if(l.isStaticRequest)throw c.headers.set("Location",g),c;return{type:Gt.redirect,status:m,location:g,revalidate:c.headers.get("X-Remix-Revalidate")!==null,reloadDocument:c.headers.get("X-Remix-Reload-Document")!==null}}if(l.isRouteRequest)throw{type:u===Gt.error?Gt.error:Gt.data,response:c};let v;try{let g=c.headers.get("Content-Type");g&&/\bapplication\/json\b/.test(g)?v=await c.json():v=await c.text()}catch(g){return{type:Gt.error,error:g}}return u===Gt.error?{type:u,error:new P1(m,c.statusText,v),headers:c.headers}:{type:Gt.data,data:v,statusCode:c.status,headers:c.headers}}if(u===Gt.error)return{type:u,error:c};if($M(c)){var h,p;return{type:Gt.deferred,deferredData:c,statusCode:(h=c.init)==null?void 0:h.status,headers:((p=c.init)==null?void 0:p.headers)&&new Headers(c.init.headers)}}return{type:Gt.data,data:c}}function hc(t,e,n,r){let s=t.createURL(NN(e)).toString(),o={signal:n};if(r&&qs(r.formMethod)){let{formMethod:i,formEncType:a}=r;o.method=i.toUpperCase(),a==="application/json"?(o.headers=new Headers({"Content-Type":a}),o.body=JSON.stringify(r.json)):a==="text/plain"?o.body=r.text:a==="application/x-www-form-urlencoded"&&r.formData?o.body=T0(r.formData):o.body=r.formData}return new Request(s,o)}function T0(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function iC(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function TM(t,e,n,r,s){let o={},i=null,a,l=!1,u={};return n.forEach((c,d)=>{let f=e[d].route.id;if(Qe(!tu(c),"Cannot handle redirect results in processLoaderData"),qc(c)){let h=Hc(t,f),p=c.error;r&&(p=Object.values(r)[0],r=void 0),i=i||{},i[h.route.id]==null&&(i[h.route.id]=p),o[f]=void 0,l||(l=!0,a=SN(c.error)?c.error.status:500),c.headers&&(u[f]=c.headers)}else ka(c)?(s.set(f,c.deferredData),o[f]=c.deferredData.data):o[f]=c.data,c.statusCode!=null&&c.statusCode!==200&&!l&&(a=c.statusCode),c.headers&&(u[f]=c.headers)}),r&&(i=r,o[Object.keys(r)[0]]=void 0),{loaderData:o,errors:i,statusCode:a||200,loaderHeaders:u}}function aC(t,e,n,r,s,o,i,a){let{loaderData:l,errors:u}=TM(e,n,r,s,a);for(let c=0;c<o.length;c++){let{key:d,match:f,controller:h}=o[c];Qe(i!==void 0&&i[c]!==void 0,"Did not find corresponding fetcher result");let p=i[c];if(!(h&&h.signal.aborted))if(qc(p)){let m=Hc(t.matches,f==null?void 0:f.route.id);u&&u[m.route.id]||(u=qt({},u,{[m.route.id]:p.error})),t.fetchers.delete(d)}else if(tu(p))Qe(!1,"Unhandled fetcher revalidation redirect");else if(ka(p))Qe(!1,"Unhandled fetcher deferred data");else{let m=yi(p.data);t.fetchers.set(d,m)}}return{loaderData:l,errors:u}}function lC(t,e,n,r){let s=qt({},e);for(let o of n){let i=o.route.id;if(e.hasOwnProperty(i)?e[i]!==void 0&&(s[i]=e[i]):t[i]!==void 0&&o.route.loader&&(s[i]=t[i]),r&&r.hasOwnProperty(i))break}return s}function Hc(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function uC(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function cs(t,e){let{pathname:n,routeId:r,method:s,type:o}=e===void 0?{}:e,i="Unknown Server Error",a="Unknown @remix-run/router error";return t===400?(i="Bad Request",s&&n&&r?a="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":o==="defer-action"?a="defer() is not supported in actions":o==="invalid-body"&&(a="Unable to encode submission body")):t===403?(i="Forbidden",a='Route "'+r+'" does not match URL "'+n+'"'):t===404?(i="Not Found",a='No route matches URL "'+n+'"'):t===405&&(i="Method Not Allowed",s&&n&&r?a="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(a='Invalid request method "'+s.toUpperCase()+'"')),new P1(t||500,i,new Error(a),!0)}function cC(t){for(let e=t.length-1;e>=0;e--){let n=t[e];if(tu(n))return{result:n,idx:e}}}function NN(t){let e=typeof t=="string"?Jo(t):t;return Bd(qt({},e,{hash:""}))}function NM(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function ka(t){return t.type===Gt.deferred}function qc(t){return t.type===Gt.error}function tu(t){return(t&&t.type)===Gt.redirect}function $M(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function kM(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function IM(t){return gM.has(t.toLowerCase())}function qs(t){return pM.has(t.toLowerCase())}async function dC(t,e,n,r,s,o){for(let i=0;i<n.length;i++){let a=n[i],l=e[i];if(!l)continue;let u=t.find(d=>d.route.id===l.route.id),c=u!=null&&!TN(u,l)&&(o&&o[l.route.id])!==void 0;if(ka(a)&&(s||c)){let d=r[i];Qe(d,"Expected an AbortSignal for revalidating fetcher deferred result"),await $N(a,d,s).then(f=>{f&&(n[i]=f||n[i])})}}}async function $N(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Gt.data,data:t.deferredData.unwrappedData}}catch(s){return{type:Gt.error,error:s}}return{type:Gt.data,data:t.deferredData.data}}}function L1(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function N0(t,e){let n=typeof e=="string"?Jo(e).search:e.search;if(t[t.length-1].route.index&&L1(n||""))return t[t.length-1];let r=xN(t);return r[r.length-1]}function fC(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:o,json:i}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(o!=null)return{formMethod:e,formAction:n,formEncType:r,formData:o,json:void 0,text:void 0};if(i!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:i,text:void 0}}}function Gg(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function OM(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function pc(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function RM(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function yi(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function DM(t,e){try{let n=t.sessionStorage.getItem(EN);if(n){let r=JSON.parse(n);for(let[s,o]of Object.entries(r||{}))o&&Array.isArray(o)&&e.set(s,new Set(o||[]))}}catch{}}function AM(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(EN,JSON.stringify(n))}catch(r){Wa(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function yd(){return yd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},yd.apply(this,arguments)}const Kp=L.createContext(null),kN=L.createContext(null),Xp=L.createContext(null),Yp=L.createContext(null),al=L.createContext({outlet:null,matches:[],isDataRoute:!1}),IN=L.createContext(null);function Qp(){return L.useContext(Yp)!=null}function ON(){return Qp()||Qe(!1),L.useContext(Yp).location}function RN(t){L.useContext(Xp).static||L.useLayoutEffect(t)}function Zp(){let{isDataRoute:t}=L.useContext(al);return t?KM():PM()}function PM(){Qp()||Qe(!1);let t=L.useContext(Kp),{basename:e,future:n,navigator:r}=L.useContext(Xp),{matches:s}=L.useContext(al),{pathname:o}=ON(),i=JSON.stringify(bN(s,n.v7_relativeSplatPath)),a=L.useRef(!1);return RN(()=>{a.current=!0}),L.useCallback(function(u,c){if(c===void 0&&(c={}),!a.current)return;if(typeof u=="number"){r.go(u);return}let d=wN(u,JSON.parse(i),o,c.relative==="path");t==null&&e!=="/"&&(d.pathname=d.pathname==="/"?e:ji([e,d.pathname])),(c.replace?r.replace:r.push)(d,c.state,c)},[e,r,i,o,t])}const DN=L.createContext(null);function LM(){return L.useContext(DN)}function FM(t){let e=L.useContext(al).outlet;return e&&L.createElement(DN.Provider,{value:t},e)}function MM(t,e,n,r){Qp()||Qe(!1);let{navigator:s}=L.useContext(Xp),{matches:o}=L.useContext(al),i=o[o.length-1],a=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=ON(),c;if(e){var d;let v=typeof e=="string"?Jo(e):e;l==="/"||(d=v.pathname)!=null&&d.startsWith(l)||Qe(!1),c=v}else c=u;let f=c.pathname||"/",h=l==="/"?f:f.slice(l.length)||"/",p=Gl(t,{pathname:h}),m=WM(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},a,v.params),pathname:ji([l,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?l:ji([l,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),o,n,r);return e&&m?L.createElement(Yp.Provider,{value:{location:yd({pathname:"/",search:"",hash:"",state:null,key:"default"},c),navigationType:Jt.Pop}},m):m}function jM(){let t=qM(),e=SN(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},o=null;return L.createElement(L.Fragment,null,L.createElement("h2",null,"Unexpected Application Error!"),L.createElement("h3",{style:{fontStyle:"italic"}},e),n?L.createElement("pre",{style:s},n):null,o)}const BM=L.createElement(jM,null);class UM extends L.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?L.createElement(al.Provider,{value:this.props.routeContext},L.createElement(IN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function zM(t){let{routeContext:e,match:n,children:r}=t,s=L.useContext(Kp);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),L.createElement(al.Provider,{value:e},r)}function WM(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var o;if((o=n)!=null&&o.errors)t=n.matches;else return null}let i=t,a=(s=n)==null?void 0:s.errors;if(a!=null){let c=i.findIndex(d=>d.route.id&&(a==null?void 0:a[d.route.id]));c>=0||Qe(!1),i=i.slice(0,Math.min(i.length,c+1))}let l=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let c=0;c<i.length;c++){let d=i[c];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=c),d.route.loader&&d.route.id&&n.loaderData[d.route.id]===void 0&&(!n.errors||n.errors[d.route.id]===void 0)){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}return i.reduceRight((c,d,f)=>{let h,p=!1,m=null,v=null;n&&(h=a&&d.route.id?a[d.route.id]:void 0,m=d.route.errorElement||BM,l&&(u<0&&f===0?(XM("route-fallback",!1),p=!0,v=null):u===f&&(p=!0,v=d.route.hydrateFallbackElement||null)));let g=e.concat(i.slice(0,f+1)),x=()=>{let b;return h?b=m:p?b=v:d.route.Component?b=L.createElement(d.route.Component,null):d.route.element?b=d.route.element:b=c,L.createElement(zM,{match:d,routeContext:{outlet:c,matches:g,isDataRoute:n!=null},children:b})};return n&&(d.route.ErrorBoundary||d.route.errorElement||f===0)?L.createElement(UM,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:x(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):x()},null)}var AN=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(AN||{}),tp=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(tp||{});function VM(t){let e=L.useContext(Kp);return e||Qe(!1),e}function GM(t){let e=L.useContext(kN);return e||Qe(!1),e}function HM(t){let e=L.useContext(al);return e||Qe(!1),e}function PN(t){let e=HM(),n=e.matches[e.matches.length-1];return n.route.id||Qe(!1),n.route.id}function qM(){var t;let e=L.useContext(IN),n=GM(tp.UseRouteError),r=PN(tp.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function KM(){let{router:t}=VM(AN.UseNavigateStable),e=PN(tp.UseNavigateStable),n=L.useRef(!1);return RN(()=>{n.current=!0}),L.useCallback(function(s,o){o===void 0&&(o={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,yd({fromRouteId:e},o)))},[t,e])}const hC={};function XM(t,e,n){!e&&!hC[t]&&(hC[t]=!0)}function YM(t){return FM(t.context)}function QM(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Jt.Pop,navigator:o,static:i=!1,future:a}=t;Qp()&&Qe(!1);let l=e.replace(/^\/*/,"/"),u=L.useMemo(()=>({basename:l,navigator:o,static:i,future:yd({v7_relativeSplatPath:!1},a)}),[l,a,o,i]);typeof r=="string"&&(r=Jo(r));let{pathname:c="/",search:d="",hash:f="",state:h=null,key:p="default"}=r,m=L.useMemo(()=>{let v=Ud(c,l);return v==null?null:{location:{pathname:v,search:d,hash:f,state:h,key:p},navigationType:s}},[l,c,d,f,h,p,s]);return m==null?null:L.createElement(Xp.Provider,{value:u},L.createElement(Yp.Provider,{children:n,value:m}))}new Promise(()=>{});function ZM(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:L.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:L.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:L.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function np(){return np=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},np.apply(this,arguments)}function JM(t,e){return wM({basename:e==null?void 0:e.basename,future:np({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:W4({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||ej(),routes:t,mapRouteProperties:ZM,window:e==null?void 0:e.window}).initialize()}function ej(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=np({},e,{errors:tj(e.errors)})),e}function tj(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new P1(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let o=window[s.__subType];if(typeof o=="function")try{let i=new o(s.message);i.stack="",n[r]=i}catch{}}if(n[r]==null){let o=new Error(s.message);o.stack="",n[r]=o}}else n[r]=s;return n}const nj=L.createContext({isTransitioning:!1}),rj=L.createContext(new Map),sj="startTransition",pC=IL[sj],oj="flushSync",mC=z4[oj];function ij(t){pC?pC(t):t()}function mc(t){mC?mC(t):t()}class aj{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}}function lj(t){let{fallbackElement:e,router:n,future:r}=t,[s,o]=L.useState(n.state),[i,a]=L.useState(),[l,u]=L.useState({isTransitioning:!1}),[c,d]=L.useState(),[f,h]=L.useState(),[p,m]=L.useState(),v=L.useRef(new Map),{v7_startTransition:g}=r||{},x=L.useCallback(R=>{g?ij(R):R()},[g]),b=L.useCallback((R,P)=>{let{deletedFetchers:B,unstable_flushSync:F,unstable_viewTransitionOpts:H}=P;B.forEach(oe=>v.current.delete(oe)),R.fetchers.forEach((oe,de)=>{oe.data!==void 0&&v.current.set(de,oe.data)});let ee=n.window==null||typeof n.window.document.startViewTransition!="function";if(!H||ee){F?mc(()=>o(R)):x(()=>o(R));return}if(F){mc(()=>{f&&(c&&c.resolve(),f.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:H.currentLocation,nextLocation:H.nextLocation})});let oe=n.window.document.startViewTransition(()=>{mc(()=>o(R))});oe.finished.finally(()=>{mc(()=>{d(void 0),h(void 0),a(void 0),u({isTransitioning:!1})})}),mc(()=>h(oe));return}f?(c&&c.resolve(),f.skipTransition(),m({state:R,currentLocation:H.currentLocation,nextLocation:H.nextLocation})):(a(R),u({isTransitioning:!0,flushSync:!1,currentLocation:H.currentLocation,nextLocation:H.nextLocation}))},[n.window,f,c,v,x]);L.useLayoutEffect(()=>n.subscribe(b),[n,b]),L.useEffect(()=>{l.isTransitioning&&!l.flushSync&&d(new aj)},[l]),L.useEffect(()=>{if(c&&i&&n.window){let R=i,P=c.promise,B=n.window.document.startViewTransition(async()=>{x(()=>o(R)),await P});B.finished.finally(()=>{d(void 0),h(void 0),a(void 0),u({isTransitioning:!1})}),h(B)}},[x,i,c,n.window]),L.useEffect(()=>{c&&i&&s.location.key===i.location.key&&c.resolve()},[c,f,s.location,i]),L.useEffect(()=>{!l.isTransitioning&&p&&(a(p.state),u({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),m(void 0))},[l.isTransitioning,p]),L.useEffect(()=>{},[]);let _=L.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:R=>n.navigate(R),push:(R,P,B)=>n.navigate(R,{state:P,preventScrollReset:B==null?void 0:B.preventScrollReset}),replace:(R,P,B)=>n.navigate(R,{replace:!0,state:P,preventScrollReset:B==null?void 0:B.preventScrollReset})}),[n]),N=n.basename||"/",E=L.useMemo(()=>({router:n,navigator:_,static:!1,basename:N}),[n,_,N]);return L.createElement(L.Fragment,null,L.createElement(Kp.Provider,{value:E},L.createElement(kN.Provider,{value:s},L.createElement(rj.Provider,{value:v.current},L.createElement(nj.Provider,{value:l},L.createElement(QM,{basename:N,location:s.location,navigationType:s.historyAction,navigator:_,future:{v7_relativeSplatPath:n.future.v7_relativeSplatPath}},s.initialized||n.future.v7_partialHydration?L.createElement(uj,{routes:n.routes,future:n.future,state:s}):e))))),null)}function uj(t){let{routes:e,future:n,state:r}=t;return MM(e,void 0,r,n)}var gC;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(gC||(gC={}));var yC;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(yC||(yC={}));function Zs(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+t+(n.length?" "+n.map(function(s){return"'"+s+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Xi(t){return!!t&&!!t[Rt]}function Ko(t){var e;return!!t&&(function(n){if(!n||typeof n!="object")return!1;var r=Object.getPrototypeOf(n);if(r===null)return!0;var s=Object.hasOwnProperty.call(r,"constructor")&&r.constructor;return s===Object||typeof s=="function"&&Function.toString.call(s)===vj}(t)||Array.isArray(t)||!!t[_C]||!!(!((e=t.constructor)===null||e===void 0)&&e[_C])||F1(t)||M1(t))}function Va(t,e,n){n===void 0&&(n=!1),Du(t)===0?(n?Object.keys:ru)(t).forEach(function(r){n&&typeof r=="symbol"||e(r,t[r],t)}):t.forEach(function(r,s){return e(s,r,t)})}function Du(t){var e=t[Rt];return e?e.i>3?e.i-4:e.i:Array.isArray(t)?1:F1(t)?2:M1(t)?3:0}function nu(t,e){return Du(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function cj(t,e){return Du(t)===2?t.get(e):t[e]}function LN(t,e,n){var r=Du(t);r===2?t.set(e,n):r===3?t.add(n):t[e]=n}function FN(t,e){return t===e?t!==0||1/t==1/e:t!=t&&e!=e}function F1(t){return gj&&t instanceof Map}function M1(t){return yj&&t instanceof Set}function ba(t){return t.o||t.t}function j1(t){if(Array.isArray(t))return Array.prototype.slice.call(t);var e=jN(t);delete e[Rt];for(var n=ru(e),r=0;r<n.length;r++){var s=n[r],o=e[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(e[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:t[s]})}return Object.create(Object.getPrototypeOf(t),e)}function B1(t,e){return e===void 0&&(e=!1),U1(t)||Xi(t)||!Ko(t)||(Du(t)>1&&(t.set=t.add=t.clear=t.delete=dj),Object.freeze(t),e&&Va(t,function(n,r){return B1(r,!0)},!0)),t}function dj(){Zs(2)}function U1(t){return t==null||typeof t!="object"||Object.isFrozen(t)}function Co(t){var e=O0[t];return e||Zs(18,t),e}function fj(t,e){O0[t]||(O0[t]=e)}function $0(){return vd}function Hg(t,e){e&&(Co("Patches"),t.u=[],t.s=[],t.v=e)}function rp(t){k0(t),t.p.forEach(hj),t.p=null}function k0(t){t===vd&&(vd=t.l)}function vC(t){return vd={p:[],l:vd,h:t,m:!0,_:0}}function hj(t){var e=t[Rt];e.i===0||e.i===1?e.j():e.g=!0}function qg(t,e){e._=e.p.length;var n=e.p[0],r=t!==void 0&&t!==n;return e.h.O||Co("ES5").S(e,t,r),r?(n[Rt].P&&(rp(e),Zs(4)),Ko(t)&&(t=sp(e,t),e.l||op(e,t)),e.u&&Co("Patches").M(n[Rt].t,t,e.u,e.s)):t=sp(e,n,[]),rp(e),e.u&&e.v(e.u,e.s),t!==MN?t:void 0}function sp(t,e,n){if(U1(e))return e;var r=e[Rt];if(!r)return Va(e,function(a,l){return xC(t,r,e,a,l,n)},!0),e;if(r.A!==t)return e;if(!r.P)return op(t,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var s=r.i===4||r.i===5?r.o=j1(r.k):r.o,o=s,i=!1;r.i===3&&(o=new Set(s),s.clear(),i=!0),Va(o,function(a,l){return xC(t,r,s,a,l,n,i)}),op(t,s,!1),n&&t.u&&Co("Patches").N(r,n,t.u,t.s)}return r.o}function xC(t,e,n,r,s,o,i){if(Xi(s)){var a=sp(t,s,o&&e&&e.i!==3&&!nu(e.R,r)?o.concat(r):void 0);if(LN(n,r,a),!Xi(a))return;t.m=!1}else i&&n.add(s);if(Ko(s)&&!U1(s)){if(!t.h.D&&t._<1)return;sp(t,s),e&&e.A.l||op(t,s)}}function op(t,e,n){n===void 0&&(n=!1),!t.l&&t.h.D&&t.m&&B1(e,n)}function Kg(t,e){var n=t[Rt];return(n?ba(n):t)[e]}function bC(t,e){if(e in t)for(var n=Object.getPrototypeOf(t);n;){var r=Object.getOwnPropertyDescriptor(n,e);if(r)return r;n=Object.getPrototypeOf(n)}}function Ei(t){t.P||(t.P=!0,t.l&&Ei(t.l))}function Xg(t){t.o||(t.o=j1(t.t))}function I0(t,e,n){var r=F1(e)?Co("MapSet").F(e,n):M1(e)?Co("MapSet").T(e,n):t.O?function(s,o){var i=Array.isArray(s),a={i:i?1:0,A:o?o.A:$0(),P:!1,I:!1,R:{},l:o,t:s,k:null,o:null,j:null,C:!1},l=a,u=xd;i&&(l=[a],u=kc);var c=Proxy.revocable(l,u),d=c.revoke,f=c.proxy;return a.k=f,a.j=d,f}(e,n):Co("ES5").J(e,n);return(n?n.A:$0()).p.push(r),r}function pj(t){return Xi(t)||Zs(22,t),function e(n){if(!Ko(n))return n;var r,s=n[Rt],o=Du(n);if(s){if(!s.P&&(s.i<4||!Co("ES5").K(s)))return s.t;s.I=!0,r=wC(n,o),s.I=!1}else r=wC(n,o);return Va(r,function(i,a){s&&cj(s.t,i)===a||LN(r,i,e(a))}),o===3?new Set(r):r}(t)}function wC(t,e){switch(e){case 2:return new Map(t);case 3:return Array.from(t)}return j1(t)}function mj(){function t(o,i){var a=s[o];return a?a.enumerable=i:s[o]=a={configurable:!0,enumerable:i,get:function(){var l=this[Rt];return xd.get(l,o)},set:function(l){var u=this[Rt];xd.set(u,o,l)}},a}function e(o){for(var i=o.length-1;i>=0;i--){var a=o[i][Rt];if(!a.P)switch(a.i){case 5:r(a)&&Ei(a);break;case 4:n(a)&&Ei(a)}}}function n(o){for(var i=o.t,a=o.k,l=ru(a),u=l.length-1;u>=0;u--){var c=l[u];if(c!==Rt){var d=i[c];if(d===void 0&&!nu(i,c))return!0;var f=a[c],h=f&&f[Rt];if(h?h.t!==d:!FN(f,d))return!0}}var p=!!i[Rt];return l.length!==ru(i).length+(p?0:1)}function r(o){var i=o.k;if(i.length!==o.t.length)return!0;var a=Object.getOwnPropertyDescriptor(i,i.length-1);if(a&&!a.get)return!0;for(var l=0;l<i.length;l++)if(!i.hasOwnProperty(l))return!0;return!1}var s={};fj("ES5",{J:function(o,i){var a=Array.isArray(o),l=function(c,d){if(c){for(var f=Array(d.length),h=0;h<d.length;h++)Object.defineProperty(f,""+h,t(h,!0));return f}var p=jN(d);delete p[Rt];for(var m=ru(p),v=0;v<m.length;v++){var g=m[v];p[g]=t(g,c||!!p[g].enumerable)}return Object.create(Object.getPrototypeOf(d),p)}(a,o),u={i:a?5:4,A:i?i.A:$0(),P:!1,I:!1,R:{},l:i,t:o,k:l,o:null,g:!1,C:!1};return Object.defineProperty(l,Rt,{value:u,writable:!0}),l},S:function(o,i,a){a?Xi(i)&&i[Rt].A===o&&e(o.p):(o.u&&function l(u){if(u&&typeof u=="object"){var c=u[Rt];if(c){var d=c.t,f=c.k,h=c.R,p=c.i;if(p===4)Va(f,function(b){b!==Rt&&(d[b]!==void 0||nu(d,b)?h[b]||l(f[b]):(h[b]=!0,Ei(c)))}),Va(d,function(b){f[b]!==void 0||nu(f,b)||(h[b]=!1,Ei(c))});else if(p===5){if(r(c)&&(Ei(c),h.length=!0),f.length<d.length)for(var m=f.length;m<d.length;m++)h[m]=!1;else for(var v=d.length;v<f.length;v++)h[v]=!0;for(var g=Math.min(f.length,d.length),x=0;x<g;x++)f.hasOwnProperty(x)||(h[x]=!0),h[x]===void 0&&l(f[x])}}}}(o.p[0]),e(o.p))},K:function(o){return o.i===4?n(o):r(o)}})}var SC,vd,z1=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",gj=typeof Map<"u",yj=typeof Set<"u",CC=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",MN=z1?Symbol.for("immer-nothing"):((SC={})["immer-nothing"]=!0,SC),_C=z1?Symbol.for("immer-draftable"):"__$immer_draftable",Rt=z1?Symbol.for("immer-state"):"__$immer_state",vj=""+Object.prototype.constructor,ru=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames,jN=Object.getOwnPropertyDescriptors||function(t){var e={};return ru(t).forEach(function(n){e[n]=Object.getOwnPropertyDescriptor(t,n)}),e},O0={},xd={get:function(t,e){if(e===Rt)return t;var n=ba(t);if(!nu(n,e))return function(s,o,i){var a,l=bC(o,i);return l?"value"in l?l.value:(a=l.get)===null||a===void 0?void 0:a.call(s.k):void 0}(t,n,e);var r=n[e];return t.I||!Ko(r)?r:r===Kg(t.t,e)?(Xg(t),t.o[e]=I0(t.A.h,r,t)):r},has:function(t,e){return e in ba(t)},ownKeys:function(t){return Reflect.ownKeys(ba(t))},set:function(t,e,n){var r=bC(ba(t),e);if(r!=null&&r.set)return r.set.call(t.k,n),!0;if(!t.P){var s=Kg(ba(t),e),o=s==null?void 0:s[Rt];if(o&&o.t===n)return t.o[e]=n,t.R[e]=!1,!0;if(FN(n,s)&&(n!==void 0||nu(t.t,e)))return!0;Xg(t),Ei(t)}return t.o[e]===n&&(n!==void 0||e in t.o)||Number.isNaN(n)&&Number.isNaN(t.o[e])||(t.o[e]=n,t.R[e]=!0),!0},deleteProperty:function(t,e){return Kg(t.t,e)!==void 0||e in t.t?(t.R[e]=!1,Xg(t),Ei(t)):delete t.R[e],t.o&&delete t.o[e],!0},getOwnPropertyDescriptor:function(t,e){var n=ba(t),r=Reflect.getOwnPropertyDescriptor(n,e);return r&&{writable:!0,configurable:t.i!==1||e!=="length",enumerable:r.enumerable,value:n[e]}},defineProperty:function(){Zs(11)},getPrototypeOf:function(t){return Object.getPrototypeOf(t.t)},setPrototypeOf:function(){Zs(12)}},kc={};Va(xd,function(t,e){kc[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),kc.deleteProperty=function(t,e){return kc.set.call(this,t,e,void 0)},kc.set=function(t,e,n){return xd.set.call(this,t[0],e,n,t[0])};var xj=function(){function t(n){var r=this;this.O=CC,this.D=!0,this.produce=function(s,o,i){if(typeof s=="function"&&typeof o!="function"){var a=o;o=s;var l=r;return function(m){var v=this;m===void 0&&(m=a);for(var g=arguments.length,x=Array(g>1?g-1:0),b=1;b<g;b++)x[b-1]=arguments[b];return l.produce(m,function(_){var N;return(N=o).call.apply(N,[v,_].concat(x))})}}var u;if(typeof o!="function"&&Zs(6),i!==void 0&&typeof i!="function"&&Zs(7),Ko(s)){var c=vC(r),d=I0(r,s,void 0),f=!0;try{u=o(d),f=!1}finally{f?rp(c):k0(c)}return typeof Promise<"u"&&u instanceof Promise?u.then(function(m){return Hg(c,i),qg(m,c)},function(m){throw rp(c),m}):(Hg(c,i),qg(u,c))}if(!s||typeof s!="object"){if((u=o(s))===void 0&&(u=s),u===MN&&(u=void 0),r.D&&B1(u,!0),i){var h=[],p=[];Co("Patches").M(s,u,h,p),i(h,p)}return u}Zs(21,s)},this.produceWithPatches=function(s,o){if(typeof s=="function")return function(u){for(var c=arguments.length,d=Array(c>1?c-1:0),f=1;f<c;f++)d[f-1]=arguments[f];return r.produceWithPatches(u,function(h){return s.apply(void 0,[h].concat(d))})};var i,a,l=r.produce(s,o,function(u,c){i=u,a=c});return typeof Promise<"u"&&l instanceof Promise?l.then(function(u){return[u,i,a]}):[l,i,a]},typeof(n==null?void 0:n.useProxies)=="boolean"&&this.setUseProxies(n.useProxies),typeof(n==null?void 0:n.autoFreeze)=="boolean"&&this.setAutoFreeze(n.autoFreeze)}var e=t.prototype;return e.createDraft=function(n){Ko(n)||Zs(8),Xi(n)&&(n=pj(n));var r=vC(this),s=I0(this,n,void 0);return s[Rt].C=!0,k0(r),s},e.finishDraft=function(n,r){var s=n&&n[Rt],o=s.A;return Hg(o,r),qg(void 0,o)},e.setAutoFreeze=function(n){this.D=n},e.setUseProxies=function(n){n&&!CC&&Zs(20),this.O=n},e.applyPatches=function(n,r){var s;for(s=r.length-1;s>=0;s--){var o=r[s];if(o.path.length===0&&o.op==="replace"){n=o.value;break}}s>-1&&(r=r.slice(s+1));var i=Co("Patches").$;return Xi(n)?i(n,r):this.produce(n,function(a){return i(a,r)})},t}(),qr=new xj,BN=qr.produce;qr.produceWithPatches.bind(qr);qr.setAutoFreeze.bind(qr);qr.setUseProxies.bind(qr);qr.applyPatches.bind(qr);qr.createDraft.bind(qr);qr.finishDraft.bind(qr);function bd(t){"@babel/helpers - typeof";return bd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bd(t)}function bj(t,e){if(bd(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(bd(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wj(t){var e=bj(t,"string");return bd(e)==="symbol"?e:String(e)}function Sj(t,e,n){return e=wj(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function EC(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function TC(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?EC(Object(n),!0).forEach(function(r){Sj(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):EC(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Hn(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var NC=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),Yg=function(){return Math.random().toString(36).substring(7).split("").join(".")},ip={INIT:"@@redux/INIT"+Yg(),REPLACE:"@@redux/REPLACE"+Yg(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Yg()}};function Cj(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function W1(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(Hn(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(Hn(1));return n(W1)(t,e)}if(typeof t!="function")throw new Error(Hn(2));var s=t,o=e,i=[],a=i,l=!1;function u(){a===i&&(a=i.slice())}function c(){if(l)throw new Error(Hn(3));return o}function d(m){if(typeof m!="function")throw new Error(Hn(4));if(l)throw new Error(Hn(5));var v=!0;return u(),a.push(m),function(){if(v){if(l)throw new Error(Hn(6));v=!1,u();var x=a.indexOf(m);a.splice(x,1),i=null}}}function f(m){if(!Cj(m))throw new Error(Hn(7));if(typeof m.type>"u")throw new Error(Hn(8));if(l)throw new Error(Hn(9));try{l=!0,o=s(o,m)}finally{l=!1}for(var v=i=a,g=0;g<v.length;g++){var x=v[g];x()}return m}function h(m){if(typeof m!="function")throw new Error(Hn(10));s=m,f({type:ip.REPLACE})}function p(){var m,v=d;return m={subscribe:function(x){if(typeof x!="object"||x===null)throw new Error(Hn(11));function b(){x.next&&x.next(c())}b();var _=v(b);return{unsubscribe:_}}},m[NC]=function(){return this},m}return f({type:ip.INIT}),r={dispatch:f,subscribe:d,getState:c,replaceReducer:h},r[NC]=p,r}function _j(t){Object.keys(t).forEach(function(e){var n=t[e],r=n(void 0,{type:ip.INIT});if(typeof r>"u")throw new Error(Hn(12));if(typeof n(void 0,{type:ip.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Hn(13))})}function UN(t){for(var e=Object.keys(t),n={},r=0;r<e.length;r++){var s=e[r];typeof t[s]=="function"&&(n[s]=t[s])}var o=Object.keys(n),i;try{_j(n)}catch(a){i=a}return function(l,u){if(l===void 0&&(l={}),i)throw i;for(var c=!1,d={},f=0;f<o.length;f++){var h=o[f],p=n[h],m=l[h],v=p(m,u);if(typeof v>"u")throw u&&u.type,new Error(Hn(14));d[h]=v,c=c||v!==m}return c=c||o.length!==Object.keys(l).length,c?d:l}}function ap(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.length===0?function(r){return r}:e.length===1?e[0]:e.reduce(function(r,s){return function(){return r(s.apply(void 0,arguments))}})}function Ej(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(r){return function(){var s=r.apply(void 0,arguments),o=function(){throw new Error(Hn(15))},i={getState:s.getState,dispatch:function(){return o.apply(void 0,arguments)}},a=e.map(function(l){return l(i)});return o=ap.apply(void 0,a)(s.dispatch),TC(TC({},s),{},{dispatch:o})}}}function zN(t){var e=function(r){var s=r.dispatch,o=r.getState;return function(i){return function(a){return typeof a=="function"?a(s,o,t):i(a)}}};return e}var WN=zN();WN.withExtraArgument=zN;const $C=WN;var VN=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(r[o]=s[o])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Tj=function(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,s,o,i;return i={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function a(u){return function(c){return l([u,c])}}function l(u){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,s&&(o=u[0]&2?s.return:u[0]?s.throw||((o=s.return)&&o.call(s),0):s.next)&&!(o=o.call(s,u[1])).done)return o;switch(s=0,o&&(u=[u[0]&2,o.value]),u[0]){case 0:case 1:o=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,s=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!o||u[1]>o[0]&&u[1]<o[3])){n.label=u[1];break}if(u[0]===6&&n.label<o[1]){n.label=o[1],o=u;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(u);break}o[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(c){u=[6,c],s=0}finally{r=o=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},gu=function(t,e){for(var n=0,r=e.length,s=t.length;n<r;n++,s++)t[s]=e[n];return t},Nj=Object.defineProperty,$j=Object.defineProperties,kj=Object.getOwnPropertyDescriptors,kC=Object.getOwnPropertySymbols,Ij=Object.prototype.hasOwnProperty,Oj=Object.prototype.propertyIsEnumerable,IC=function(t,e,n){return e in t?Nj(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n},Bi=function(t,e){for(var n in e||(e={}))Ij.call(e,n)&&IC(t,n,e[n]);if(kC)for(var r=0,s=kC(e);r<s.length;r++){var n=s[r];Oj.call(e,n)&&IC(t,n,e[n])}return t},Qg=function(t,e){return $j(t,kj(e))},Rj=function(t,e,n){return new Promise(function(r,s){var o=function(l){try{a(n.next(l))}catch(u){s(u)}},i=function(l){try{a(n.throw(l))}catch(u){s(u)}},a=function(l){return l.done?r(l.value):Promise.resolve(l.value).then(o,i)};a((n=n.apply(t,e)).next())})},Dj=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?ap:ap.apply(null,arguments)};function Aj(t){if(typeof t!="object"||t===null)return!1;var e=Object.getPrototypeOf(t);if(e===null)return!0;for(var n=e;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return e===n}function Ui(t,e){function n(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];if(e){var o=e.apply(void 0,r);if(!o)throw new Error("prepareAction did not return an object");return Bi(Bi({type:t,payload:o.payload},"meta"in o&&{meta:o.meta}),"error"in o&&{error:o.error})}return{type:t,payload:r[0]}}return n.toString=function(){return""+t},n.type=t,n.match=function(r){return r.type===t},n}var Pj=function(t){VN(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var s=t.apply(this,n)||this;return Object.setPrototypeOf(s,e.prototype),s}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,gu([void 0],n[0].concat(this)))):new(e.bind.apply(e,gu([void 0],n.concat(this))))},e}(Array),Lj=function(t){VN(e,t);function e(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var s=t.apply(this,n)||this;return Object.setPrototypeOf(s,e.prototype),s}return Object.defineProperty(e,Symbol.species,{get:function(){return e},enumerable:!1,configurable:!0}),e.prototype.concat=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t.prototype.concat.apply(this,n)},e.prototype.prepend=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.length===1&&Array.isArray(n[0])?new(e.bind.apply(e,gu([void 0],n[0].concat(this)))):new(e.bind.apply(e,gu([void 0],n.concat(this))))},e}(Array);function R0(t){return Ko(t)?BN(t,function(){}):t}function Fj(t){return typeof t=="boolean"}function Mj(){return function(e){return jj(e)}}function jj(t){t===void 0&&(t={});var e=t.thunk,n=e===void 0?!0:e;t.immutableCheck,t.serializableCheck,t.actionCreatorCheck;var r=new Pj;return n&&(Fj(n)?r.push($C):r.push($C.withExtraArgument(n.extraArgument))),r}var Bj=!0;function Uj(t){var e=Mj(),n=t||{},r=n.reducer,s=r===void 0?void 0:r,o=n.middleware,i=o===void 0?e():o,a=n.devTools,l=a===void 0?!0:a,u=n.preloadedState,c=u===void 0?void 0:u,d=n.enhancers,f=d===void 0?void 0:d,h;if(typeof s=="function")h=s;else if(Aj(s))h=UN(s);else throw new Error('"reducer" is a required argument, and must be a function or an object of functions that can be passed to combineReducers');var p=i;typeof p=="function"&&(p=p(e));var m=Ej.apply(void 0,p),v=ap;l&&(v=Dj(Bi({trace:!Bj},typeof l=="object"&&l)));var g=new Lj(m),x=g;Array.isArray(f)?x=gu([m],f):typeof f=="function"&&(x=f(g));var b=v.apply(void 0,x);return W1(h,c,b)}function GN(t){var e={},n=[],r,s={addCase:function(o,i){var a=typeof o=="string"?o:o.type;if(!a)throw new Error("`builder.addCase` cannot be called with an empty action type");if(a in e)throw new Error("`builder.addCase` cannot be called with two reducers for the same action type");return e[a]=i,s},addMatcher:function(o,i){return n.push({matcher:o,reducer:i}),s},addDefaultCase:function(o){return r=o,s}};return t(s),[e,n,r]}function zj(t){return typeof t=="function"}function Wj(t,e,n,r){n===void 0&&(n=[]);var s=typeof e=="function"?GN(e):[e,n,r],o=s[0],i=s[1],a=s[2],l;if(zj(t))l=function(){return R0(t())};else{var u=R0(t);l=function(){return u}}function c(d,f){d===void 0&&(d=l());var h=gu([o[f.type]],i.filter(function(p){var m=p.matcher;return m(f)}).map(function(p){var m=p.reducer;return m}));return h.filter(function(p){return!!p}).length===0&&(h=[a]),h.reduce(function(p,m){if(m)if(Xi(p)){var v=p,g=m(v,f);return g===void 0?p:g}else{if(Ko(p))return BN(p,function(x){return m(x,f)});var g=m(p,f);if(g===void 0){if(p===null)return p;throw Error("A case reducer on a non-draftable value must not return undefined")}return g}return p},d)}return c.getInitialState=l,c}function Vj(t,e){return t+"/"+e}function V1(t){var e=t.name;if(!e)throw new Error("`name` is a required option for createSlice");typeof process<"u";var n=typeof t.initialState=="function"?t.initialState:R0(t.initialState),r=t.reducers||{},s=Object.keys(r),o={},i={},a={};s.forEach(function(c){var d=r[c],f=Vj(e,c),h,p;"reducer"in d?(h=d.reducer,p=d.prepare):h=d,o[c]=h,i[f]=h,a[c]=p?Ui(f,p):Ui(f)});function l(){var c=typeof t.extraReducers=="function"?GN(t.extraReducers):[t.extraReducers],d=c[0],f=d===void 0?{}:d,h=c[1],p=h===void 0?[]:h,m=c[2],v=m===void 0?void 0:m,g=Bi(Bi({},f),i);return Wj(n,function(x){for(var b in g)x.addCase(b,g[b]);for(var _=0,N=p;_<N.length;_++){var E=N[_];x.addMatcher(E.matcher,E.reducer)}v&&x.addDefaultCase(v)})}var u;return{name:e,reducer:function(c,d){return u||(u=l()),u(c,d)},actions:a,caseReducers:o,getInitialState:function(){return u||(u=l()),u.getInitialState()}}}var Gj="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Hj=function(t){t===void 0&&(t=21);for(var e="",n=t;n--;)e+=Gj[Math.random()*64|0];return e},qj=["name","message","stack","code"],Zg=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),OC=function(){function t(e,n){this.payload=e,this.meta=n}return t}(),Kj=function(t){if(typeof t=="object"&&t!==null){for(var e={},n=0,r=qj;n<r.length;n++){var s=r[n];typeof t[s]=="string"&&(e[s]=t[s])}return e}return{message:String(t)}};(function(){function t(e,n,r){var s=Ui(e+"/fulfilled",function(u,c,d,f){return{payload:u,meta:Qg(Bi({},f||{}),{arg:d,requestId:c,requestStatus:"fulfilled"})}}),o=Ui(e+"/pending",function(u,c,d){return{payload:void 0,meta:Qg(Bi({},d||{}),{arg:c,requestId:u,requestStatus:"pending"})}}),i=Ui(e+"/rejected",function(u,c,d,f,h){return{payload:f,error:(r&&r.serializeError||Kj)(u||"Rejected"),meta:Qg(Bi({},h||{}),{arg:d,requestId:c,rejectedWithValue:!!f,requestStatus:"rejected",aborted:(u==null?void 0:u.name)==="AbortError",condition:(u==null?void 0:u.name)==="ConditionError"})}}),a=typeof AbortController<"u"?AbortController:function(){function u(){this.signal={aborted:!1,addEventListener:function(){},dispatchEvent:function(){return!1},onabort:function(){},removeEventListener:function(){},reason:void 0,throwIfAborted:function(){}}}return u.prototype.abort=function(){},u}();function l(u){return function(c,d,f){var h=r!=null&&r.idGenerator?r.idGenerator(u):Hj(),p=new a,m;function v(x){m=x,p.abort()}var g=function(){return Rj(this,null,function(){var x,b,_,N,E,R,P;return Tj(this,function(B){switch(B.label){case 0:return B.trys.push([0,4,,5]),N=(x=r==null?void 0:r.condition)==null?void 0:x.call(r,u,{getState:d,extra:f}),Yj(N)?[4,N]:[3,2];case 1:N=B.sent(),B.label=2;case 2:if(N===!1||p.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};return E=new Promise(function(F,H){return p.signal.addEventListener("abort",function(){return H({name:"AbortError",message:m||"Aborted"})})}),c(o(h,u,(b=r==null?void 0:r.getPendingMeta)==null?void 0:b.call(r,{requestId:h,arg:u},{getState:d,extra:f}))),[4,Promise.race([E,Promise.resolve(n(u,{dispatch:c,getState:d,extra:f,requestId:h,signal:p.signal,abort:v,rejectWithValue:function(F,H){return new Zg(F,H)},fulfillWithValue:function(F,H){return new OC(F,H)}})).then(function(F){if(F instanceof Zg)throw F;return F instanceof OC?s(F.payload,h,u,F.meta):s(F,h,u)})])];case 3:return _=B.sent(),[3,5];case 4:return R=B.sent(),_=R instanceof Zg?i(null,h,u,R.payload,R.meta):i(R,h,u),[3,5];case 5:return P=r&&!r.dispatchConditionRejection&&i.match(_)&&_.meta.condition,P||c(_),[2,_]}})})}();return Object.assign(g,{abort:v,requestId:h,arg:u,unwrap:function(){return g.then(Xj)}})}}return Object.assign(l,{pending:o,rejected:i,fulfilled:s,typePrefix:e})}return t.withTypes=function(){return t},t})();function Xj(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function Yj(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var G1="listenerMiddleware";Ui(G1+"/add");Ui(G1+"/removeAll");Ui(G1+"/remove");var RC;typeof queueMicrotask=="function"&&queueMicrotask.bind(typeof window<"u"?window:typeof global<"u"?global:globalThis);mj();var HN={exports:{}},qN={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yu=L;function Qj(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Zj=typeof Object.is=="function"?Object.is:Qj,Jj=yu.useState,eB=yu.useEffect,tB=yu.useLayoutEffect,nB=yu.useDebugValue;function rB(t,e){var n=e(),r=Jj({inst:{value:n,getSnapshot:e}}),s=r[0].inst,o=r[1];return tB(function(){s.value=n,s.getSnapshot=e,Jg(s)&&o({inst:s})},[t,n,e]),eB(function(){return Jg(s)&&o({inst:s}),t(function(){Jg(s)&&o({inst:s})})},[t]),nB(n),n}function Jg(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Zj(t,n)}catch{return!0}}function sB(t,e){return e()}var oB=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?sB:rB;qN.useSyncExternalStore=yu.useSyncExternalStore!==void 0?yu.useSyncExternalStore:oB;HN.exports=qN;var iB=HN.exports,KN={exports:{}},XN={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jp=L,aB=iB;function lB(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var uB=typeof Object.is=="function"?Object.is:lB,cB=aB.useSyncExternalStore,dB=Jp.useRef,fB=Jp.useEffect,hB=Jp.useMemo,pB=Jp.useDebugValue;XN.useSyncExternalStoreWithSelector=function(t,e,n,r,s){var o=dB(null);if(o.current===null){var i={hasValue:!1,value:null};o.current=i}else i=o.current;o=hB(function(){function l(h){if(!u){if(u=!0,c=h,h=r(h),s!==void 0&&i.hasValue){var p=i.value;if(s(p,h))return d=p}return d=h}if(p=d,uB(c,h))return p;var m=r(h);return s!==void 0&&s(p,m)?p:(c=h,d=m)}var u=!1,c,d,f=n===void 0?null:n;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,n,r,s]);var a=cB(t,o[0],o[1]);return fB(function(){i.hasValue=!0,i.value=a},[a]),pB(a),a};KN.exports=XN;var mB=KN.exports;function gB(t){t()}let YN=gB;const yB=t=>YN=t,vB=()=>YN,DC=Symbol.for("react-redux-context"),AC=typeof globalThis<"u"?globalThis:{};function xB(){var t;if(!L.createContext)return{};const e=(t=AC[DC])!=null?t:AC[DC]=new Map;let n=e.get(L.createContext);return n||(n=L.createContext(null),e.set(L.createContext,n)),n}const Yi=xB();function H1(t=Yi){return function(){return L.useContext(t)}}const QN=H1(),bB=()=>{throw new Error("uSES not initialized!")};let ZN=bB;const wB=t=>{ZN=t},SB=(t,e)=>t===e;function CB(t=Yi){const e=t===Yi?QN:H1(t);return function(r,s={}){const{equalityFn:o=SB,stabilityCheck:i=void 0,noopCheck:a=void 0}=typeof s=="function"?{equalityFn:s}:s,{store:l,subscription:u,getServerState:c,stabilityCheck:d,noopCheck:f}=e();L.useRef(!0);const h=L.useCallback({[r.name](m){return r(m)}}[r.name],[r,d,i]),p=ZN(u.addNestedSub,l.getState,c||l.getState,h,o);return L.useDebugValue(p),p}}const q1=CB();var JN={exports:{}},gt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kn=typeof Symbol=="function"&&Symbol.for,K1=kn?Symbol.for("react.element"):60103,X1=kn?Symbol.for("react.portal"):60106,em=kn?Symbol.for("react.fragment"):60107,tm=kn?Symbol.for("react.strict_mode"):60108,nm=kn?Symbol.for("react.profiler"):60114,rm=kn?Symbol.for("react.provider"):60109,sm=kn?Symbol.for("react.context"):60110,Y1=kn?Symbol.for("react.async_mode"):60111,om=kn?Symbol.for("react.concurrent_mode"):60111,im=kn?Symbol.for("react.forward_ref"):60112,am=kn?Symbol.for("react.suspense"):60113,_B=kn?Symbol.for("react.suspense_list"):60120,lm=kn?Symbol.for("react.memo"):60115,um=kn?Symbol.for("react.lazy"):60116,EB=kn?Symbol.for("react.block"):60121,TB=kn?Symbol.for("react.fundamental"):60117,NB=kn?Symbol.for("react.responder"):60118,$B=kn?Symbol.for("react.scope"):60119;function Yr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case K1:switch(t=t.type,t){case Y1:case om:case em:case nm:case tm:case am:return t;default:switch(t=t&&t.$$typeof,t){case sm:case im:case um:case lm:case rm:return t;default:return e}}case X1:return e}}}function e$(t){return Yr(t)===om}gt.AsyncMode=Y1;gt.ConcurrentMode=om;gt.ContextConsumer=sm;gt.ContextProvider=rm;gt.Element=K1;gt.ForwardRef=im;gt.Fragment=em;gt.Lazy=um;gt.Memo=lm;gt.Portal=X1;gt.Profiler=nm;gt.StrictMode=tm;gt.Suspense=am;gt.isAsyncMode=function(t){return e$(t)||Yr(t)===Y1};gt.isConcurrentMode=e$;gt.isContextConsumer=function(t){return Yr(t)===sm};gt.isContextProvider=function(t){return Yr(t)===rm};gt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===K1};gt.isForwardRef=function(t){return Yr(t)===im};gt.isFragment=function(t){return Yr(t)===em};gt.isLazy=function(t){return Yr(t)===um};gt.isMemo=function(t){return Yr(t)===lm};gt.isPortal=function(t){return Yr(t)===X1};gt.isProfiler=function(t){return Yr(t)===nm};gt.isStrictMode=function(t){return Yr(t)===tm};gt.isSuspense=function(t){return Yr(t)===am};gt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===em||t===om||t===nm||t===tm||t===am||t===_B||typeof t=="object"&&t!==null&&(t.$$typeof===um||t.$$typeof===lm||t.$$typeof===rm||t.$$typeof===sm||t.$$typeof===im||t.$$typeof===TB||t.$$typeof===NB||t.$$typeof===$B||t.$$typeof===EB)};gt.typeOf=Yr;JN.exports=gt;var kB=JN.exports,t$=kB,IB={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},OB={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},n$={};n$[t$.ForwardRef]=IB;n$[t$.Memo]=OB;var xt={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Q1=Symbol.for("react.element"),Z1=Symbol.for("react.portal"),cm=Symbol.for("react.fragment"),dm=Symbol.for("react.strict_mode"),fm=Symbol.for("react.profiler"),hm=Symbol.for("react.provider"),pm=Symbol.for("react.context"),RB=Symbol.for("react.server_context"),mm=Symbol.for("react.forward_ref"),gm=Symbol.for("react.suspense"),ym=Symbol.for("react.suspense_list"),vm=Symbol.for("react.memo"),xm=Symbol.for("react.lazy"),DB=Symbol.for("react.offscreen"),r$;r$=Symbol.for("react.module.reference");function Ts(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case Q1:switch(t=t.type,t){case cm:case fm:case dm:case gm:case ym:return t;default:switch(t=t&&t.$$typeof,t){case RB:case pm:case mm:case xm:case vm:case hm:return t;default:return e}}case Z1:return e}}}xt.ContextConsumer=pm;xt.ContextProvider=hm;xt.Element=Q1;xt.ForwardRef=mm;xt.Fragment=cm;xt.Lazy=xm;xt.Memo=vm;xt.Portal=Z1;xt.Profiler=fm;xt.StrictMode=dm;xt.Suspense=gm;xt.SuspenseList=ym;xt.isAsyncMode=function(){return!1};xt.isConcurrentMode=function(){return!1};xt.isContextConsumer=function(t){return Ts(t)===pm};xt.isContextProvider=function(t){return Ts(t)===hm};xt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===Q1};xt.isForwardRef=function(t){return Ts(t)===mm};xt.isFragment=function(t){return Ts(t)===cm};xt.isLazy=function(t){return Ts(t)===xm};xt.isMemo=function(t){return Ts(t)===vm};xt.isPortal=function(t){return Ts(t)===Z1};xt.isProfiler=function(t){return Ts(t)===fm};xt.isStrictMode=function(t){return Ts(t)===dm};xt.isSuspense=function(t){return Ts(t)===gm};xt.isSuspenseList=function(t){return Ts(t)===ym};xt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===cm||t===fm||t===dm||t===gm||t===ym||t===DB||typeof t=="object"&&t!==null&&(t.$$typeof===xm||t.$$typeof===vm||t.$$typeof===hm||t.$$typeof===pm||t.$$typeof===mm||t.$$typeof===r$||t.getModuleId!==void 0)};xt.typeOf=Ts;function AB(){const t=vB();let e=null,n=null;return{clear(){e=null,n=null},notify(){t(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){let r=[],s=e;for(;s;)r.push(s),s=s.next;return r},subscribe(r){let s=!0,o=n={callback:r,next:null,prev:n};return o.prev?o.prev.next=o:e=o,function(){!s||e===null||(s=!1,o.next?o.next.prev=o.prev:n=o.prev,o.prev?o.prev.next=o.next:e=o.next)}}}}const PC={notify(){},get:()=>[]};function PB(t,e){let n,r=PC,s=0,o=!1;function i(m){c();const v=r.subscribe(m);let g=!1;return()=>{g||(g=!0,v(),d())}}function a(){r.notify()}function l(){p.onStateChange&&p.onStateChange()}function u(){return o}function c(){s++,n||(n=e?e.addNestedSub(l):t.subscribe(l),r=AB())}function d(){s--,n&&s===0&&(n(),n=void 0,r.clear(),r=PC)}function f(){o||(o=!0,c())}function h(){o&&(o=!1,d())}const p={addNestedSub:i,notifyNestedSubs:a,handleChangeWrapper:l,isSubscribed:u,trySubscribe:f,tryUnsubscribe:h,getListeners:()=>r};return p}const LB=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",FB=LB?L.useLayoutEffect:L.useEffect;function MB({store:t,context:e,children:n,serverState:r,stabilityCheck:s="once",noopCheck:o="once"}){const i=L.useMemo(()=>{const u=PB(t);return{store:t,subscription:u,getServerState:r?()=>r:void 0,stabilityCheck:s,noopCheck:o}},[t,r,s,o]),a=L.useMemo(()=>t.getState(),[t]);FB(()=>{const{subscription:u}=i;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),a!==t.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[i,a]);const l=e||Yi;return L.createElement(l.Provider,{value:i},n)}function s$(t=Yi){const e=t===Yi?QN:H1(t);return function(){const{store:r}=e();return r}}const jB=s$();function BB(t=Yi){const e=t===Yi?jB:s$(t);return function(){return e().dispatch}}const Ns=BB();wB(mB.useSyncExternalStoreWithSelector);yB(Ru.unstable_batchedUpdates);const LC={token:"",username:""},o$=V1({name:"user",initialState:LC,reducers:{userSetToken(t,e){t.token=e.payload},userSetUsername(t,e){t.username=e.payload},userReset(){return LC}}}),ei=()=>q1(t=>t.user),{userSetToken:UB,userSetUsername:zB,userReset:WB}=o$.actions,VB=o$.reducer;var i$={};(function(t){var e=Cn&&Cn.__extends||function(){var V=function(W,I){return V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,j){O.__proto__=j}||function(O,j){for(var A in j)j.hasOwnProperty(A)&&(O[A]=j[A])},V(W,I)};return function(W,I){V(W,I);function O(){this.constructor=W}W.prototype=I===null?Object.create(I):(O.prototype=I.prototype,new O)}}(),n=Cn&&Cn.__assign||function(){return n=Object.assign||function(V){for(var W,I=1,O=arguments.length;I<O;I++){W=arguments[I];for(var j in W)Object.prototype.hasOwnProperty.call(W,j)&&(V[j]=W[j])}return V},n.apply(this,arguments)},r=Cn&&Cn.__awaiter||function(V,W,I,O){function j(A){return A instanceof I?A:new I(function(ne){ne(A)})}return new(I||(I=Promise))(function(A,ne){function U(J){try{G(O.next(J))}catch(re){ne(re)}}function Q(J){try{G(O.throw(J))}catch(re){ne(re)}}function G(J){J.done?A(J.value):j(J.value).then(U,Q)}G((O=O.apply(V,W||[])).next())})},s=Cn&&Cn.__generator||function(V,W){var I={label:0,sent:function(){if(A[0]&1)throw A[1];return A[1]},trys:[],ops:[]},O,j,A,ne;return ne={next:U(0),throw:U(1),return:U(2)},typeof Symbol=="function"&&(ne[Symbol.iterator]=function(){return this}),ne;function U(G){return function(J){return Q([G,J])}}function Q(G){if(O)throw new TypeError("Generator is already executing.");for(;I;)try{if(O=1,j&&(A=G[0]&2?j.return:G[0]?j.throw||((A=j.return)&&A.call(j),0):j.next)&&!(A=A.call(j,G[1])).done)return A;switch(j=0,A&&(G=[G[0]&2,A.value]),G[0]){case 0:case 1:A=G;break;case 4:return I.label++,{value:G[1],done:!1};case 5:I.label++,j=G[1],G=[0];continue;case 7:G=I.ops.pop(),I.trys.pop();continue;default:if(A=I.trys,!(A=A.length>0&&A[A.length-1])&&(G[0]===6||G[0]===2)){I=0;continue}if(G[0]===3&&(!A||G[1]>A[0]&&G[1]<A[3])){I.label=G[1];break}if(G[0]===6&&I.label<A[1]){I.label=A[1],A=G;break}if(A&&I.label<A[2]){I.label=A[2],I.ops.push(G);break}A[2]&&I.ops.pop(),I.trys.pop();continue}G=W.call(V,I)}catch(J){G=[6,J],j=0}finally{O=A=0}if(G[0]&5)throw G[1];return{value:G[0]?G[1]:void 0,done:!0}}},o=Cn&&Cn.__spreadArrays||function(){for(var V=0,W=0,I=arguments.length;W<I;W++)V+=arguments[W].length;for(var O=Array(V),j=0,W=0;W<I;W++)for(var A=arguments[W],ne=0,U=A.length;ne<U;ne++,j++)O[j]=A[ne];return O};Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function V(){}return V.prototype.toString=function(){return"ErrorOAuth2"},V}();t.ErrorOAuth2=i;var a=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorUnknown"},W}(i);t.ErrorUnknown=a;var l=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorNoAuthCode"},W}(i);t.ErrorNoAuthCode=l;var u=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorInvalidReturnedStateParam"},W}(i);t.ErrorInvalidReturnedStateParam=u;var c=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorInvalidJson"},W}(i);t.ErrorInvalidJson=c;var d=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorInvalidScope"},W}(i);t.ErrorInvalidScope=d;var f=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorInvalidRequest"},W}(i);t.ErrorInvalidRequest=f;var h=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorInvalidToken"},W}(i);t.ErrorInvalidToken=h;var p=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorAuthenticationGrant"},W}(i);t.ErrorAuthenticationGrant=p;var m=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorUnauthorizedClient"},W}(p);t.ErrorUnauthorizedClient=m;var v=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorAccessDenied"},W}(p);t.ErrorAccessDenied=v;var g=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorUnsupportedResponseType"},W}(p);t.ErrorUnsupportedResponseType=g;var x=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorServerError"},W}(p);t.ErrorServerError=x;var b=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorTemporarilyUnavailable"},W}(p);t.ErrorTemporarilyUnavailable=b;var _=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorAccessTokenResponse"},W}(i);t.ErrorAccessTokenResponse=_;var N=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorInvalidClient"},W}(_);t.ErrorInvalidClient=N;var E=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorInvalidGrant"},W}(_);t.ErrorInvalidGrant=E;var R=function(V){e(W,V);function W(){return V!==null&&V.apply(this,arguments)||this}return W.prototype.toString=function(){return"ErrorUnsupportedGrantType"},W}(_);t.ErrorUnsupportedGrantType=R;var P=function(){function V(){this.realm="",this.error=""}return V}();t.ErrorWWWAuthenticate=P,t.RawErrorToErrorClassMap={invalid_request:f,invalid_grant:E,unauthorized_client:m,access_denied:v,unsupported_response_type:g,invalid_scope:d,server_error:x,temporarily_unavailable:b,invalid_client:N,unsupported_grant_type:R,invalid_json:c,invalid_token:h};function B(V){return new(t.RawErrorToErrorClassMap[V]||a)}t.toErrorClass=B;function F(V){var W=V.slice(7).replace(/"/g,"").split(", ").map(function(I){var O,j=I.split("="),A=j[0],ne=j[1];return O={},O[A]=ne,O}).reduce(function(I,O){return n(n({},I),O)},{});return{realm:W.realm,error:W.error}}t.fromWWWAuthenticateHeaderStringToObject=F;var H="Authorization",ee="WWW-Authenticate";t.LOCALSTORAGE_ID="oauth2authcodepkce",t.LOCALSTORAGE_STATE=t.LOCALSTORAGE_ID+"-state",t.RECOMMENDED_CODE_VERIFIER_LENGTH=96,t.RECOMMENDED_STATE_LENGTH=32;var oe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",de=function(){function V(W){return this.state={},this.config=W,this.recoverState(),this}return V.prototype.decorateFetchHTTPClient=function(W){var I=this;return function(O,j){for(var A=[],ne=2;ne<arguments.length;ne++)A[ne-2]=arguments[ne];return I.state.isHTTPDecoratorActive?I.getAccessToken().then(function(U){var Q=U.token,G=Object.assign({},j);return G.headers||(G.headers={}),G.headers[H]="Bearer "+Q.value,W.apply(void 0,o([O,G],A))}).then(function(U){if(U.ok||!U.headers.has(ee.toLowerCase()))return U;var Q=B(F(U.headers.get(ee.toLowerCase())).error);return Q instanceof h&&I.config.onAccessTokenExpiry(function(){return I.exchangeRefreshTokenForAccessToken()}),Promise.reject(Q)}):W.apply(void 0,o([O,j],A))}},V.prototype.isReturningFromAuthServer=function(){var W=V.extractParamFromUrl(location.href,"error");if(W)return Promise.reject(B(W));var I=V.extractParamFromUrl(location.href,"code");if(!I)return Promise.resolve(!1);var O=JSON.parse(localStorage.getItem(t.LOCALSTORAGE_STATE)||"{}"),j=V.extractParamFromUrl(location.href,"state");return j!==O.stateQueryParam?(console.warn("state query string parameter doesn't match the one sent! Possible malicious activity somewhere."),Promise.reject(new u)):(O.authorizationCode=I,O.hasAuthCodeBeenExchangedForAccessToken=!1,localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(O)),this.setState(O),Promise.resolve(!0))},V.prototype.fetchAuthorizationCode=function(W){return r(this,void 0,void 0,function(){var I,O,j,A,ne,U,Q,G,J,re,be;return s(this,function(ue){switch(ue.label){case 0:return this.assertStateAndConfigArePresent(),I=this.config,O=I.clientId,j=I.extraAuthorizationParams,A=I.redirectUrl,ne=I.scopes,[4,V.generatePKCECodes()];case 1:return U=ue.sent(),Q=U.codeChallenge,G=U.codeVerifier,J=V.generateRandomState(t.RECOMMENDED_STATE_LENGTH),this.state=n(n({},this.state),{codeChallenge:Q,codeVerifier:G,stateQueryParam:J,isHTTPDecoratorActive:!0}),localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(this.state)),re=this.config.authorizationUrl+"?response_type=code&"+("client_id="+encodeURIComponent(O)+"&")+("redirect_uri="+encodeURIComponent(A)+"&")+("scope="+encodeURIComponent(ne.join(" "))+"&")+("state="+J+"&")+("code_challenge="+encodeURIComponent(Q)+"&")+"code_challenge_method=S256",(j||W)&&(be=n(n({},j),W),re=re+"&"+V.objectToQueryString(be)),location.replace(re),[2]}})})},V.prototype.getAccessToken=function(){var W=this;this.assertStateAndConfigArePresent();var I=this.config.onAccessTokenExpiry,O=this.state,j=O.accessToken,A=O.authorizationCode,ne=O.explicitlyExposedTokens,U=O.hasAuthCodeBeenExchangedForAccessToken,Q=O.refreshToken,G=O.scopes;return A?this.authCodeForAccessTokenRequest?this.authCodeForAccessTokenRequest:!this.isAuthorized()||!U?(this.authCodeForAccessTokenRequest=this.exchangeAuthCodeForAccessToken(),this.authCodeForAccessTokenRequest):Q&&this.isAccessTokenExpired()?I(function(){return W.exchangeRefreshTokenForAccessToken()}):Promise.resolve({token:j,explicitlyExposedTokens:ne,scopes:G,refreshToken:Q}):Promise.reject(new l)},V.prototype.exchangeRefreshTokenForAccessToken=function(){var W=this,I;this.assertStateAndConfigArePresent();var O=this.config,j=O.extraRefreshParams,A=O.clientId,ne=O.tokenUrl,U=this.state.refreshToken;U||console.warn("No refresh token is present.");var Q=ne,G="grant_type=refresh_token&"+("refresh_token="+((I=U)===null||I===void 0?void 0:I.value)+"&")+("client_id="+A);return j&&(G=Q+"&"+V.objectToQueryString(j)),fetch(Q,{method:"POST",body:G,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(J){return J.status>=400?J.json().then(function(re){return Promise.reject(re)}):J.json()}).then(function(J){var re=J.access_token,be=J.expires_in,ue=J.refresh_token,De=J.scope,Ae=W.config.explicitlyExposedTokens,Ye=[],ot={},Ft={value:re,expiry:new Date(Date.now()+parseInt(be)*1e3).toString()};if(W.state.accessToken=Ft,ue){var yn={value:ue};W.state.refreshToken=yn}Ae&&(ot=Object.fromEntries(Ae.map(function(It){return[It,J[It]]}).filter(function(It){It[0];var zt=It[1];return zt!==void 0})),W.state.explicitlyExposedTokens=ot),De&&(Ye=De.split(" "),W.state.scopes=Ye),localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(W.state));var Ct={token:Ft,scopes:Ye};return Ae&&(Ct.explicitlyExposedTokens=ot),Ct}).catch(function(J){var re=W.config.onInvalidGrant,be=J.error||"There was a network error.";switch(be){case"invalid_grant":re(function(){return W.fetchAuthorizationCode()});break}return Promise.reject(B(be))})},V.prototype.getGrantedScopes=function(){return this.state.scopes},V.prototype.isHTTPDecoratorActive=function(W){this.state.isHTTPDecoratorActive=W,localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(this.state))},V.prototype.isAuthorized=function(){return!!this.state.accessToken},V.prototype.isAccessTokenExpired=function(){var W=this.state.accessToken;return!!(W&&new Date>=new Date(W.expiry))},V.prototype.reset=function(){this.setState({}),this.authCodeForAccessTokenRequest=void 0},V.prototype.assertStateAndConfigArePresent=function(){if(!this.state||!this.config)throw console.error("state:",this.state,"config:",this.config),new Error("state or config is not set.")},V.prototype.exchangeAuthCodeForAccessToken=function(W){var I=this;this.assertStateAndConfigArePresent();var O=this.state,j=O.authorizationCode,A=j===void 0?W:j,ne=O.codeVerifier,U=ne===void 0?"":ne,Q=this.config,G=Q.clientId,J=Q.onInvalidGrant,re=Q.redirectUrl;U?A||console.warn("No authorization grant code is being passed."):console.warn("No code verifier is being sent.");var be=this.config.tokenUrl,ue="grant_type=authorization_code&"+("code="+encodeURIComponent(A||"")+"&")+("redirect_uri="+encodeURIComponent(re)+"&")+("client_id="+encodeURIComponent(G)+"&")+("code_verifier="+U);return fetch(be,{method:"POST",body:ue,headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(De){var Ae=De.json().catch(function(Ye){return{error:"invalid_json"}});return De.ok?Ae.then(function(Ye){var ot=Ye.access_token,Ft=Ye.expires_in,yn=Ye.refresh_token,Ct=Ye.scope,It=I.config.explicitlyExposedTokens,zt=[],Mn={};I.state.hasAuthCodeBeenExchangedForAccessToken=!0,I.authCodeForAccessTokenRequest=void 0;var jn={value:ot,expiry:new Date(Date.now()+parseInt(Ft)*1e3).toString()};if(I.state.accessToken=jn,yn){var kr={value:yn};I.state.refreshToken=kr}It&&(Mn=Object.fromEntries(It.map(function(Ot){return[Ot,Ye[Ot]]}).filter(function(Ot){Ot[0];var Rs=Ot[1];return Rs!==void 0})),I.state.explicitlyExposedTokens=Mn),Ct&&(zt=Ct.split(" "),I.state.scopes=zt),localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(I.state));var vn={token:jn,scopes:zt};return It&&(vn.explicitlyExposedTokens=Mn),vn}):Ae.then(function(Ye){var ot=Ye.error;switch(ot){case"invalid_grant":J(function(){return I.fetchAuthorizationCode()});break}return Promise.reject(B(ot))})})},V.prototype.recoverState=function(){return this.state=JSON.parse(localStorage.getItem(t.LOCALSTORAGE_STATE)||"{}"),this},V.prototype.setState=function(W){return this.state=W,localStorage.setItem(t.LOCALSTORAGE_STATE,JSON.stringify(W)),this},V.base64urlEncode=function(W){var I=btoa(W);return I=I.replace(/\+/g,"-"),I=I.replace(/\//g,"_"),I=I.replace(/=/g,""),I},V.extractParamFromUrl=function(W,I){var O=W.split("?");if(O.length<2)return"";O=O[1].split("#");var j=O[0].split("&").reduce(function(ne,U){return ne.concat(U.split("="))},[]);if(j.length<2)return"";var A=j.indexOf(I);return decodeURIComponent(A>=0?j[A+1]:"")},V.objectToQueryString=function(W){return Object.entries(W).map(function(I){var O=I[0],j=I[1];return O+"="+encodeURIComponent(j)}).join("&")},V.generatePKCECodes=function(){var W=new Uint32Array(t.RECOMMENDED_CODE_VERIFIER_LENGTH);crypto.getRandomValues(W);var I=V.base64urlEncode(Array.from(W).map(function(O){return oe[O%oe.length]}).join(""));return crypto.subtle.digest("SHA-256",new TextEncoder().encode(I)).then(function(O){for(var j=new Uint8Array(O),A="",ne=j.byteLength,U=0;U<ne;U++)A+=String.fromCharCode(j[U]);return A}).then(V.base64urlEncode).then(function(O){return{codeChallenge:O,codeVerifier:I}})},V.generateRandomState=function(W){var I=new Uint32Array(W);return crypto.getRandomValues(I),Array.from(I).map(function(O){return oe[O%oe.length]}).join("")},V}();t.OAuth2AuthCodePKCE=de})(i$);const D0="https://lichess.org",GB=["study:write","study:read","challenge:read","bot:play","board:play"],HB="lichess-api-demo",qB=`${location.protocol}//${location.host}/`,a$=()=>new i$.OAuth2AuthCodePKCE({authorizationUrl:`${D0}/oauth`,tokenUrl:`${D0}/api/token`,clientId:HB,scopes:GB,redirectUrl:qB,onAccessTokenExpiry:e=>e(),onInvalidGrant:console.warn}),J1=t=>e=>{const n=e.body.getReader(),r=/\r?\n/,s=new TextDecoder;let o="";const i=()=>n.read().then(({done:a,value:l})=>{if(a)o.length>0&&t(JSON.parse(o));else{const u=s.decode(l,{stream:!0});o+=u;const c=o.split(r);o=c.pop();for(const d of c.filter(f=>f))t(JSON.parse(d));return i()}});return i()},ex=async(t,e,n={})=>await(await oa(t,e,n)).json(),oa=async(t,e,n={})=>{const r={...n,headers:{Authorization:`Bearer ${t}`}},s=await window.fetch(`${D0}${e}`,r);if(!s.ok){const o=`${s.status} ${s.statusText}`;throw alert(o),o}return s},KB=async(t,e,n,r)=>{const s=`/api/study/by/${e}`,o=r.map(a=>a.id),i=[];oa(t,s).then(J1(async a=>{const l=a.id;o.includes(l)||i.push({id:l,name:a.name})})).then(()=>n(i))},XB=()=>{a$().fetchAuthorizationCode()},YB=t=>{localStorage.removeItem("oauth2authcodepkce-state"),t(WB())},QB=t=>ex(t,"/api/account"),ZB=(t,e)=>{const n=`/api/broadcast/round/${e}.pgn`;return oa(t,n).then(async s=>{const o=s.body.getReader(),i=new TextDecoder;return o.read().then(async({done:l,value:u})=>l?"":i.decode(u,{stream:!0}))})},JB=(t,e,n,r)=>{const s="/api/broadcast/my-rounds",o=[];oa(t,s).then(J1(async i=>{o.push({id:i.round.id,name:i.round.name})})).then(()=>{r?e(o):KB(t,n,e,o)})},eU=(t,e)=>{const n="/api/import",r={body:new URLSearchParams({pgn:e}),method:"POST"};return ex(t,n,r)},tU=(t,e,n,r)=>{const s=`/api/study/${r}/import-pgn`,o={body:new URLSearchParams({pgn:e,name:n}),method:"POST"};oa(t,s,o)},nU=(t,e,n)=>{const r=`/api/broadcast/round/${n}/push`;oa(t,r,{body:e,method:"POST"})},rU=(t,e,n)=>{const r=`/api/board/game/stream/${n}`;oa(t,r).then(J1(e))},sU=t=>ex(t,"/api/account/playing"),oU=(t,e,n)=>{const r=`/api/board/game/${e}/move/${n}`;oa(t,r,{method:"POST"})},iU=async(t,e)=>{var l;const n=a$();if(!await n.isReturningFromAuthServer())return;const s=await n.getAccessToken(),o=(l=s==null?void 0:s.token)==null?void 0:l.value;if(o===void 0){console.log("Access Context token is undefined");return}e(UB(o));const a=(await QB(o)).username;e(zB(a)),t("/")},aU=()=>{const t=Zp(),e=Ns(),n=ei().username,r=()=>{n===""?XB():(YB(e),t("/"))};return w.jsxs("div",{className:"row py-2 m-0 align-items-center",children:[w.jsx("div",{className:"col-3 px-1",children:w.jsx("h3",{children:"ChessCam"})}),w.jsx("div",{className:"col-2 px-1",children:w.jsx("i",{className:"h1 bi bi-info-circle",onClick:()=>t("/faq")})}),w.jsx("div",{className:"col-3 px-1",children:w.jsx("h6",{children:w.jsx("button",{className:"btn btn-dark btn-outline-light",onClick:r,children:n===""?"Login":"Logout"})})}),w.jsx("div",{className:"col-4 px-1",children:w.jsx("h6",{children:n})})]})},lp="sharethis",lU={display:"inline-block",width:"50px",height:"50px",position:"relative",overflow:"hidden",verticalAlign:"middle"},l$={position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},uU={...l$,borderRadius:"50%",fillRule:"evenodd"},FC={transition:"fill 170ms ease-in-out",fill:"transparent"},u$=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return new RegExp("(?:[/.]|^)($SOCIALS)[.]".replace("$SOCIALS",t.join("|").replace(/\./gu,"\\.")),"u")},mh=new Map,MC=new Set;let c$=u$();function tx(t,e){return mh.set(t,e),MC.add(t),c$=u$([...MC].sort((n,r)=>r.length-n.length)),e}function cU(t){var e;return t?t.startsWith("mailto:")?"mailto":((e=t.match(c$))==null?void 0:e[1])||lp:lp}const dU=L.forwardRef(function(e,n){const{as:r="a",href:s,url:o,network:i,bgColor:a,fgColor:l,className:u,label:c,children:d,fallback:f,defaultSVG:h,...p}=e,m=i||cU(o),v=c||e["aria-label"]||m,g=(typeof f=="string"?mh.get(f):f||h)||mh.get(lp),{color:x,path:b}=m===lp?g:mh.get(m)||{};return L.createElement(r,{href:s||o,className:`social-icon${u?` ${u}`:""}`,...p,style:{...lU,...p.style},"aria-label":v,ref:n},L.createElement("span",{className:"social-container",style:l$},L.createElement("svg",{role:"img","aria-label":`${v} social icon`,className:"social-svg",viewBox:"0 0 64 64",style:uU},L.createElement("g",{className:"social-svg-icon",style:{...FC,fill:l||"white"}},L.createElement("path",{d:`M0,0H64V64H0Z${b}`})),L.createElement("g",{className:"social-svg-mask",style:{...FC,fill:a||x}},L.createElement("path",{d:b})))),d)});tx("youtube",{color:"#ff3333",path:"M0,0v64h64V0H0z M47,33.1c0,2.4-0.3,4.9-0.3,4.9s-0.3,2.1-1.2,3c-1.1,1.2-2.4,1.2-3,1.3 C38.3,42.5,32,42.6,32,42.6s-7.8-0.1-10.2-0.3c-0.7-0.1-2.2-0.1-3.3-1.3c-0.9-0.9-1.2-3-1.2-3S17,35.6,17,33.1v-2.3 c0-2.4,0.3-4.9,0.3-4.9s0.3-2.1,1.2-3c1.1-1.2,2.4-1.2,3-1.3c4.2-0.3,10.5-0.3,10.5-0.3h0c0,0,6.3,0,10.5,0.3c0.6,0.1,1.9,0.1,3,1.3 c0.9,0.9,1.2,3,1.2,3s0.3,2.4,0.3,4.9V33.1z M28.9,35.9l8.1-4.2l-8.1-4.2L28.9,35.9z"});tx("github",{color:"#24292e",path:"M0,0v64h64V0H0z M37.1,47.2c-0.8,0.2-1.1-0.3-1.1-0.8c0-0.5,0-2.3,0-4.4c0-1.5-0.5-2.5-1.1-3 c3.6-0.4,7.3-1.7,7.3-7.9c0-1.7-0.6-3.2-1.6-4.3c0.2-0.4,0.7-2-0.2-4.2c0,0-1.3-0.4-4.4,1.6c-1.3-0.4-2.6-0.5-4-0.5 c-1.4,0-2.7,0.2-4,0.5c-3.1-2.1-4.4-1.6-4.4-1.6c-0.9,2.2-0.3,3.8-0.2,4.2c-1,1.1-1.6,2.5-1.6,4.3c0,6.1,3.7,7.5,7.3,7.9 c-0.5,0.4-0.9,1.1-1,2.1c-0.9,0.4-3.2,1.1-4.7-1.3c0,0-0.8-1.5-2.5-1.6c0,0-1.6,0-0.1,1c0,0,1,0.5,1.8,2.3c0,0,0.9,3.1,5.4,2.1 c0,1.3,0,2.3,0,2.7c0,0.4-0.3,0.9-1.1,0.8C20.6,45.1,16,39.1,16,32c0-8.8,7.2-16,16-16c8.8,0,16,7.2,16,16 C48,39.1,43.4,45.1,37.1,47.2z"});tx("google_play",{color:"#40BBC1",path:"M0,0v64h64V0H0z M40.4,27.1l-3.6,3.6L24.5,18.4L40.4,27.1z M22,44.5V19.4c0-0.4,0.1-0.7,0.2-0.9L35.6,32 L22.2,45.4C22.1,45.2,22,44.9,22,44.5z M24.4,45.6l12.4-12.4l3.6,3.6L24.4,45.6z M47.1,33.2l-5,2.8l-4-4l3.9-3.9l5.1,2.8 C48.3,31.4,48.3,32.5,47.1,33.2z"});const fU=()=>{const t=[{network:"github",url:"https://github.com/Pbatch/CameraChessWeb",bgColor:"#111111"},{network:"youtube",url:"https://www.youtube.com/channel/UCtgc3RevHj6UHq1D8Ymarmw"},{network:"google_play",url:"https://play.google.com/store/apps/details?id=com.camerachess.www.twa"}],e=[];return t.forEach(n=>{e.push(w.jsx("div",{className:"col",children:w.jsx(dU,{target:"_blank",network:n.network,url:n.url,bgColor:n==null?void 0:n.bgColor})},n.network))}),e},gc=({text:t,tokenRequired:e})=>{const n=Zp(),s=ei().token===""&&e,o=()=>{s||n(`/${t.toLowerCase()}`)};return w.jsx("button",{className:"btn btn-dark btn-lg btn-outline-light w-100 p-3",onClick:o,children:s?`${t} (must Login)`:`${t}`})},hU=()=>w.jsxs("div",{className:"container-flex d-flex h-100 flex-column p-0 m-0 text-center text-white bg-dark",children:[w.jsx(aU,{}),w.jsxs("div",{className:"row py-2 m-0",children:[w.jsx("div",{className:"col",children:w.jsx(gc,{text:"Upload",tokenRequired:!1})}),w.jsx("div",{className:"col",children:w.jsx(gc,{text:"Record",tokenRequired:!1})})]}),w.jsxs("div",{className:"row py-2 m-0",children:[w.jsx("div",{className:"col",children:w.jsx(gc,{text:"Broadcast",tokenRequired:!0})}),w.jsx("div",{className:"col",children:w.jsx(gc,{text:"Play",tokenRequired:!0})})]}),w.jsx("div",{className:"row py-2 m-0",children:w.jsx("div",{className:"col",children:w.jsx(gc,{text:"Export",tokenRequired:!0})})}),w.jsx("div",{className:"row py-2 m-0 mt-auto",children:w.jsx(fU,{})})]}),oo=t=>w.jsx("button",{onClick:t.onClick,className:"btn btn-dark btn-sm btn-outline-light w-100",children:t.children});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pU=1e-7,mU=1e-4;class gU{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class d${refCount(e){return yr("refCount")}incRef(e){return yr("incRef")}timerAvailable(){return!0}time(e){return yr("time")}read(e){return yr("read")}readSync(e){return yr("readSync")}readToGPU(e,n){return yr("readToGPU")}numDataIds(){return yr("numDataIds")}disposeData(e,n){return yr("disposeData")}write(e,n,r){return yr("write")}move(e,n,r,s,o){return yr("move")}createTensorFromGPUData(e,n,r){return yr("createTensorFromGPUData")}memory(){return yr("memory")}floatPrecision(){return yr("floatPrecision")}epsilon(){return this.floatPrecision()===32?pU:mU}dispose(){return yr("dispose")}}function yr(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function up(t,e,n){return Math.max(t,Math.min(e,n))}function nx(t){return t%2===0?t:t+1}function yc(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function yU(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function D(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Qr(t,e,n=""){D(Pt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Au(t){D(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function pe(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function vU(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function Pt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function vu(t){return t%1===0}function A0(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function su(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function jC(t,e=s=>0,n,r){return new Promise((s,o)=>{let i=0;const a=()=>{if(t()){s();return}i++;const l=e(i);if(n!=null&&i>=n){o();return}r!=null?r(a,l):setTimeout(a,l)};a()})}function xU(t,e){let n=1,r=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${o}`);r=o}else if(t[o]<0)throw Error(`Shapes can not be < 0. Found ${t[o]} at dim ${o}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const s=t.slice();return s[r]=e/n,s}function gn(t,e){const n=e.length;return t=t==null?e.map((r,s)=>s):[].concat(t),D(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),D(t.every(r=>vu(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function ia(t,e){const n=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||s?null:gn(e,t).sort();let i=0;for(let a=0;a<t.length;++a){if(o!=null){if(o[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(o[i]==null||o[i]>a)&&t[a]===1&&(n.push(t[a]),r.push(a)),o[i]<=a&&i++}t[a]!==1&&(n.push(t[a]),r.push(a))}return{newShape:n,keptDims:r}}function Qi(t,e){return mn(t,e)}function mn(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function bU(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function wU(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function SU(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function cp(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function CU(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function bm(t){return typeof t=="string"||t instanceof String}function _U(t){return typeof t=="boolean"}function EU(t){return typeof t=="number"}function zd(t){return Array.isArray(t)?zd(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":EU(t)?"float32":bm(t)?"string":_U(t)?"bool":"float32"}function P0(t){return!!(t&&t.constructor&&t.call&&t.apply)}function L0(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function $n(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function f$(t,e,n,r=!1){const s=new Array;if(e.length===1){const o=e[0]*(r?2:1);for(let i=0;i<o;i++)s[i]=n[t+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((l,u)=>l*u)*(r?2:1);for(let l=0;l<o;l++)s[l]=f$(t+l*a,i,n,r)}return s}function F0(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((s,o)=>s*o)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return f$(0,t,e,n)}function h$(t,e){const n=Zi(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function Zi(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function Zr(t){t.forEach(e=>{D(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function M0(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let s=0;s<t.length-1;++s)r+=n[s]*t[s];return r}function rx(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(t/n[s]),t-=r[s]*n[s];return r[r.length-1]=t,r}function Ga(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BC="tfjsflags";class TU{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=NU,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Ga(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);BC in e&&e[BC].split(",").forEach(r=>{const[s,o]=r.split(":");this.urlFlags[s]=kU(s,o)})}}function NU(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>($U(e,r[0],r[1]),r.join("="))),e}function $U(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function kU(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function Y(){return p$}let p$=null;function IU(t){p$=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ey;function m$(){if(ey==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");ey=t}return ey}function OU(){const t=m$();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function sx(t,e){const n=OU();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const g$="Abs",y$="Acos",v$="Acosh",ox="Add",x$="AddN",b$="All",w$="Any",S$="ArgMax",C$="ArgMin",_$="Asin",E$="Asinh",T$="Atan",N$="Atanh",$$="Atan2",k$="AvgPool",RU="AvgPoolGrad",I$="AvgPool3D",DU="AvgPool3DGrad",O$="BatchMatMul",R$="BatchToSpaceND",D$="Bincount",A$="BitwiseAnd",P$="BroadcastArgs",ix="Cast",L$="Ceil",F$="ClipByValue",M$="Complex",j$="ComplexAbs",B$="Concat",U$="Conv2D",z$="Conv2DBackpropFilter",W$="Conv2DBackpropInput",V$="Conv3D",AU="Conv3DBackpropFilterV2",G$="Conv3DBackpropInputV2",H$="Cos",q$="Cosh",K$="Cumprod",X$="Cumsum",Y$="CropAndResize",Q$="DenseBincount",Z$="DepthToSpace",J$="DepthwiseConv2dNative",ek="DepthwiseConv2dNativeBackpropFilter",tk="DepthwiseConv2dNativeBackpropInput",nk="Diag",rk="Dilation2D",sk="RealDiv",ok="Einsum",ik="Elu",PU="EluGrad",ak="Erf",lk="Equal",uk="Exp",ck="ExpandDims",dk="Expm1",fk="FFT",hk="Fill",pk="FlipLeftRight",mk="Floor",gk="FloorDiv",yk="FusedBatchNorm",vk="GatherV2",xk="GatherNd",bk="Greater",wk="GreaterEqual",ax="Identity",Sk="IFFT",Ck="Imag",_k="IsFinite",Ek="IsInf",Tk="IsNan",Nk="LeakyRelu",$k="Less",kk="LessEqual",Ik="LinSpace",Ok="Log",Rk="Log1p",Dk="LogicalAnd",Ak="LogicalNot",Pk="LogicalOr",Lk="LRN",LU="LRNGrad",Fk="Max",Mk="Maximum",jk="MaxPool",FU="MaxPoolGrad",Bk="MaxPool3D",MU="MaxPool3DGrad",Uk="MaxPoolWithArgmax",zk="Mean",Wk="Min",Vk="Minimum",Gk="MirrorPad",Hk="Mod",qk="Multinomial",Kk="Multiply",Xk="Neg",Yk="NotEqual",Qk="NonMaxSuppressionV3",Zk="NonMaxSuppressionV4",Jk="NonMaxSuppressionV5",eI="OnesLike",tI="OneHot",nI="Pack",rI="PadV2",sI="Pow",oI="Prelu",iI="Prod",aI="RaggedGather",lI="RaggedRange",uI="RaggedTensorToTensor",cI="Range",dI="Real",fI="Reciprocal",hI="Relu",pI="Reshape",mI="ResizeNearestNeighbor",jU="ResizeNearestNeighborGrad",gI="ResizeBilinear",BU="ResizeBilinearGrad",yI="Relu6",vI="Reverse",xI="Round",bI="Rsqrt",wI="ScatterNd",SI="TensorScatterUpdate",CI="SearchSorted",_I="Select",EI="Selu",TI="Slice",NI="Sin",$I="Sinh",kI="Sign",II="Sigmoid",OI="Softplus",RI="Sqrt",DI="Sum",AI="SpaceToBatchND",PI="SplitV",LI="Softmax",FI="SparseFillEmptyRows",MI="SparseReshape",jI="SparseSegmentMean",BI="SparseSegmentSum",UI="SparseToDense",zI="SquaredDifference",UU="Square",WI="StaticRegexReplace",VI="StridedSlice",GI="StringNGrams",HI="StringSplit",qI="StringToHashBucketFast",KI="Sub",XI="Tan",YI="Tanh",lx="Tile",QI="TopK",ZI="Transform",gh="Transpose",JI="Unique",eO="Unpack",tO="UnsortedSegmentSum",nO="ZerosLike",rO="Step",j0="FromPixels",sO="RotateWithOffset",B0="_FusedMatMul",U0="FusedConv2D",z0="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Js(...t){Y().getBool("IS_TEST")||Y().getBool("PROD")||console.warn(...t)}function zU(...t){Y().getBool("IS_TEST")||Y().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dp=sx("kernelRegistry",()=>new Map),WU=sx("gradRegistry",()=>new Map);function W0(t,e){const n=oO(t,e);return dp.get(n)}function UC(t){return WU.get(t)}function zC(t){const e=dp.entries(),n=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[o,i]=s,[a]=o.split("_");a===t&&n.push(i)}return n}function VU(t){const{kernelName:e,backendName:n}=t,r=oO(e,n);dp.has(r)&&Js(`The kernel '${e}' for backend '${n}' is already registered`),dp.set(r,t)}function oO(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iO(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var aO=Tt,gs=null;try{gs=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Tt(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Tt.prototype.__isLong__;Object.defineProperty(Tt.prototype,"__isLong__",{value:!0});function Nr(t){return(t&&t.__isLong__)===!0}Tt.isLong=Nr;var WC={},VC={};function ll(t,e){var n,r,s;return e?(t>>>=0,(s=0<=t&&t<256)&&(r=VC[t],r)?r:(n=Nt(t,(t|0)<0?-1:0,!0),s&&(VC[t]=n),n)):(t|=0,(s=-128<=t&&t<128)&&(r=WC[t],r)?r:(n=Nt(t,t<0?-1:0,!1),s&&(WC[t]=n),n))}Tt.fromInt=ll;function ys(t,e){if(isNaN(t))return e?Ia:vs;if(e){if(t<0)return Ia;if(t>=lO)return dO}else{if(t<=-HC)return Sr;if(t+1>=HC)return cO}return t<0?ys(-t,e).neg():Nt(t%xu|0,t/xu|0,e)}Tt.fromNumber=ys;function Nt(t,e,n){return new Tt(t,e,n)}Tt.fromBits=Nt;var fp=Math.pow;function ux(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return vs;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return ux(t.substring(1),e,n).neg();for(var s=ys(fp(n,8)),o=vs,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),n);if(a<8){var u=ys(fp(n,a));o=o.mul(u).add(ys(l))}else o=o.mul(s),o=o.add(ys(l))}return o.unsigned=e,o}Tt.fromString=ux;function io(t,e){return typeof t=="number"?ys(t,e):typeof t=="string"?ux(t,e):Nt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Tt.fromValue=io;var GC=65536,GU=1<<24,xu=GC*GC,lO=xu*xu,HC=lO/2,qC=ll(GU),vs=ll(0);Tt.ZERO=vs;var Ia=ll(0,!0);Tt.UZERO=Ia;var Hl=ll(1);Tt.ONE=Hl;var uO=ll(1,!0);Tt.UONE=uO;var V0=ll(-1);Tt.NEG_ONE=V0;var cO=Nt(-1,2147483647,!1);Tt.MAX_VALUE=cO;var dO=Nt(-1,-1,!0);Tt.MAX_UNSIGNED_VALUE=dO;var Sr=Nt(0,-2147483648,!1);Tt.MIN_VALUE=Sr;var ve=Tt.prototype;ve.toInt=function(){return this.unsigned?this.low>>>0:this.low};ve.toNumber=function(){return this.unsigned?(this.high>>>0)*xu+(this.low>>>0):this.high*xu+(this.low>>>0)};ve.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Sr)){var n=ys(e),r=this.div(n),s=r.mul(n).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=ys(fp(e,6),this.unsigned),i=this,a="";;){var l=i.div(o),u=i.sub(l.mul(o)).toInt()>>>0,c=u.toString(e);if(i=l,i.isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}};ve.getHighBits=function(){return this.high};ve.getHighBitsUnsigned=function(){return this.high>>>0};ve.getLowBits=function(){return this.low};ve.getLowBitsUnsigned=function(){return this.low>>>0};ve.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Sr)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};ve.isZero=function(){return this.high===0&&this.low===0};ve.eqz=ve.isZero;ve.isNegative=function(){return!this.unsigned&&this.high<0};ve.isPositive=function(){return this.unsigned||this.high>=0};ve.isOdd=function(){return(this.low&1)===1};ve.isEven=function(){return(this.low&1)===0};ve.equals=function(e){return Nr(e)||(e=io(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ve.eq=ve.equals;ve.notEquals=function(e){return!this.eq(e)};ve.neq=ve.notEquals;ve.ne=ve.notEquals;ve.lessThan=function(e){return this.comp(e)<0};ve.lt=ve.lessThan;ve.lessThanOrEqual=function(e){return this.comp(e)<=0};ve.lte=ve.lessThanOrEqual;ve.le=ve.lessThanOrEqual;ve.greaterThan=function(e){return this.comp(e)>0};ve.gt=ve.greaterThan;ve.greaterThanOrEqual=function(e){return this.comp(e)>=0};ve.gte=ve.greaterThanOrEqual;ve.ge=ve.greaterThanOrEqual;ve.compare=function(e){if(Nr(e)||(e=io(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ve.comp=ve.compare;ve.negate=function(){return!this.unsigned&&this.eq(Sr)?Sr:this.not().add(Hl)};ve.neg=ve.negate;ve.add=function(e){Nr(e)||(e=io(e));var n=this.high>>>16,r=this.high&65535,s=this.low>>>16,o=this.low&65535,i=e.high>>>16,a=e.high&65535,l=e.low>>>16,u=e.low&65535,c=0,d=0,f=0,h=0;return h+=o+u,f+=h>>>16,h&=65535,f+=s+l,d+=f>>>16,f&=65535,d+=r+a,c+=d>>>16,d&=65535,c+=n+i,c&=65535,Nt(f<<16|h,c<<16|d,this.unsigned)};ve.subtract=function(e){return Nr(e)||(e=io(e)),this.add(e.neg())};ve.sub=ve.subtract;ve.multiply=function(e){if(this.isZero())return vs;if(Nr(e)||(e=io(e)),gs){var n=gs.mul(this.low,this.high,e.low,e.high);return Nt(n,gs.get_high(),this.unsigned)}if(e.isZero())return vs;if(this.eq(Sr))return e.isOdd()?Sr:vs;if(e.eq(Sr))return this.isOdd()?Sr:vs;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(qC)&&e.lt(qC))return ys(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,o=this.low>>>16,i=this.low&65535,a=e.high>>>16,l=e.high&65535,u=e.low>>>16,c=e.low&65535,d=0,f=0,h=0,p=0;return p+=i*c,h+=p>>>16,p&=65535,h+=o*c,f+=h>>>16,h&=65535,h+=i*u,f+=h>>>16,h&=65535,f+=s*c,d+=f>>>16,f&=65535,f+=o*u,d+=f>>>16,f&=65535,f+=i*l,d+=f>>>16,f&=65535,d+=r*c+s*u+o*l+i*a,d&=65535,Nt(h<<16|p,d<<16|f,this.unsigned)};ve.mul=ve.multiply;ve.divide=function(e){if(Nr(e)||(e=io(e)),e.isZero())throw Error("division by zero");if(gs){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?gs.div_u:gs.div_s)(this.low,this.high,e.low,e.high);return Nt(n,gs.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Ia:vs;var r,s,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Ia;if(e.gt(this.shru(1)))return uO;o=Ia}else{if(this.eq(Sr)){if(e.eq(Hl)||e.eq(V0))return Sr;if(e.eq(Sr))return Hl;var i=this.shr(1);return r=i.div(e).shl(1),r.eq(vs)?e.isNegative()?Hl:V0:(s=this.sub(e.mul(r)),o=r.add(s.div(e)),o)}else if(e.eq(Sr))return this.unsigned?Ia:vs;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=vs}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),l=a<=48?1:fp(2,a-48),u=ys(r),c=u.mul(e);c.isNegative()||c.gt(s);)r-=l,u=ys(r,this.unsigned),c=u.mul(e);u.isZero()&&(u=Hl),o=o.add(u),s=s.sub(c)}return o};ve.div=ve.divide;ve.modulo=function(e){if(Nr(e)||(e=io(e)),gs){var n=(this.unsigned?gs.rem_u:gs.rem_s)(this.low,this.high,e.low,e.high);return Nt(n,gs.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ve.mod=ve.modulo;ve.rem=ve.modulo;ve.not=function(){return Nt(~this.low,~this.high,this.unsigned)};ve.and=function(e){return Nr(e)||(e=io(e)),Nt(this.low&e.low,this.high&e.high,this.unsigned)};ve.or=function(e){return Nr(e)||(e=io(e)),Nt(this.low|e.low,this.high|e.high,this.unsigned)};ve.xor=function(e){return Nr(e)||(e=io(e)),Nt(this.low^e.low,this.high^e.high,this.unsigned)};ve.shiftLeft=function(e){return Nr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Nt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Nt(0,this.low<<e-32,this.unsigned)};ve.shl=ve.shiftLeft;ve.shiftRight=function(e){return Nr(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Nt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Nt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ve.shr=ve.shiftRight;ve.shiftRightUnsigned=function(e){if(Nr(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return Nt(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Nt(n,0,this.unsigned):Nt(n>>>e-32,0,this.unsigned)};ve.shru=ve.shiftRightUnsigned;ve.shr_u=ve.shiftRightUnsigned;ve.toSigned=function(){return this.unsigned?Nt(this.low,this.high,!1):this};ve.toUnsigned=function(){return this.unsigned?this:Nt(this.low,this.high,!0)};ve.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ve.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ve.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Tt.fromBytes=function(e,n,r){return r?Tt.fromBytesLE(e,n):Tt.fromBytesBE(e,n)};Tt.fromBytesLE=function(e,n){return new Tt(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Tt.fromBytesBE=function(e,n){return new Tt(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const fO=$u(aO),HU=Bv({__proto__:null,default:fO},[aO]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sa=fO||HU;function wm(t){return Sa.fromString(t,!0,16)}const hO=wm("c3a5c85c97cb3127"),wa=wm("b492b66fbe98f273"),Xn=wm("9ae16a3b2f90404f");function G0(t){return t.xor(t.shru(47))}function pO(t,e,n){const r=t.slice(e,e+n);return Sa.fromBytes(Array.from(r),!0,!0)}function wt(t,e){return pO(t,e,8)}function KC(t,e){return pO(t,e,4)}function hn(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function zi(t,e,n=wm("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let s=e.xor(r).mul(n);return s=s.xor(s.shru(47)),s=s.mul(n),s}function qU(t,e,n,r,s,o){s=s.add(t),o=hn(o.add(s).add(r),21);const i=s;return s=s.add(e),s=s.add(n),o=o.add(hn(s,44)),[s.add(r),o.add(i)]}function Lf(t,e,n,r){return qU(wt(t,e),wt(t,e+8),wt(t,e+16),wt(t,e+24),n,r)}function KU(t,e=t.length){if(e>=8){const n=Xn.add(e*2),r=wt(t,0).add(Xn),s=wt(t,e-8),o=hn(s,37).mul(n).add(r),i=hn(r,25).add(s).mul(n);return zi(o,i,n)}if(e>=4){const n=Xn.add(e*2),r=KC(t,0);return zi(r.shl(3).add(e),KC(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],s=t[e-1],o=n+(r<<8),i=e+(s<<2);return G0(Xn.mul(o).xor(hO.mul(i))).mul(Xn)}return Xn}function XU(t,e=t.length){const n=Xn.add(e*2),r=wt(t,0).mul(wa),s=wt(t,8),o=wt(t,e-8).mul(n),i=wt(t,e-16).mul(Xn);return zi(hn(r.add(s),43).add(hn(o,30)).add(i),r.add(hn(s.add(Xn),18)).add(o),n)}function YU(t,e=t.length){const n=Xn.add(e*2),r=wt(t,0).mul(Xn),s=wt(t,8),o=wt(t,e-8).mul(n),i=wt(t,e-16).mul(Xn),a=hn(r.add(s),43).add(hn(o,30)).add(i),l=zi(a,r.add(hn(s.add(Xn),18)).add(o),n),u=wt(t,16).mul(n),c=wt(t,24),d=a.add(wt(t,e-32)).mul(n),f=l.add(wt(t,e-24)).mul(n);return zi(hn(u.add(c),43).add(hn(d,30)).add(f),u.add(hn(c.add(r),18)).add(d),n)}function QU(t,e=t.length){const n=Sa.fromNumber(81,!0);if(e<=32)return e<=16?KU(t,e):XU(t,e);if(e<=64)return YU(t,e);let r=n,s=n.mul(wa).add(113),o=G0(s.mul(Xn).add(113)).mul(Xn),i=[Sa.UZERO,Sa.UZERO],a=[Sa.UZERO,Sa.UZERO];r=r.mul(Xn).add(wt(t,0));let l=0;const u=(e-1>>6)*64,c=u+(e-1&63)-63;do r=hn(r.add(s).add(i[0]).add(wt(t,l+8)),37).mul(wa),s=hn(s.add(i[1]).add(wt(t,l+48)),42).mul(wa),r=r.xor(a[1]),s=s.add(i[0]).add(wt(t,l+40)),o=hn(o.add(a[0]),33).mul(wa),i=Lf(t,l,i[1].mul(wa),r.add(a[0])),a=Lf(t,l+32,o.add(a[1]),s.add(wt(t,l+16))),[o,r]=[r,o],l+=64;while(l!==u);const d=wa.add(o.and(255).shl(1));return l=c,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),r=hn(r.add(s).add(i[0]).add(wt(t,l+8)),37).mul(d),s=hn(s.add(i[1]).add(wt(t,l+48)),42).mul(d),r=r.xor(a[1].mul(9)),s=s.add(i[0].mul(9).add(wt(t,l+40))),o=hn(o.add(a[0]),33).mul(d),i=Lf(t,l,i[1].mul(d),r.add(a[0])),a=Lf(t,l+32,o.add(a[1]),s.add(wt(t,l+16))),[o,r]=[r,o],zi(zi(i[0],a[0],d).add(G0(s).mul(hO)).add(o),zi(i[1],a[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pu(t,e){return e==="string"?Pa(t):Sm([t],e)}function ZU(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Sm(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=Ha(t)),Y().getBool("DEBUG")&&bU(t,e),ZU(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Ks(){return Y().platform.now()}function Pa(t,e="utf-8"){return e=e||"utf-8",Y().platform.encode(t,e)}function bu(t,e="utf-8"){return e=e||"utf-8",Y().platform.decode(t,e)}function Es(t){return Y().platform.isTypedArray!=null?Y().platform.isTypedArray(t):iO(t)}function Ha(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Ga(t)||t==null||Es(t)&&n)e.push(t);else if(Array.isArray(t)||Es(t))for(let r=0;r<t.length;++r)Ha(t[r],e,n);else{let r=-1;for(const s of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(s)&&(r=Math.max(r,Number(s)));for(let s=0;s<=r;s++)Ha(t[s],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JU{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new t5)}profileKernel(e,n,r){let s;const o=()=>{s=r()};let i;const a=Ks();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const u of s)u.dataSync();i=Promise.resolve({kernelMs:Ks()-a})}if(Y().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<s.length;u++){const c=s[u];c.data().then(d=>{e5(d,c.dtype,e)})}return{kernelName:e,outputs:s,inputs:n,timeMs:i.then(u=>u.kernelMs),extraInfo:i.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:s,inputs:o,extraInfo:i}=e;r.forEach(a=>{Promise.all([a.data(),s,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],o,l[2])})})}}function e5(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const s=t[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${n}'`),!0}return!1}class t5{logKernelProfile(e,n,r,s,o,i){const a=typeof s=="number"?su(`${s}ms`,9):s.error,l=su(e,25),u=n.rank,c=n.size,d=su(n.shape.toString(),14);let f="";for(const h in o){const p=o[h];if(p!=null){const m=p.shape||n.shape,v=m.length;f+=`${h}: ${v}D ${v>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${d}	%c${c}	%c${f}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n5(t,e,n){const r={},s={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const u=t[l],c=u.inputs;for(const d in c){const f=c[d];let h=!1;for(let p=0;p<e.length;p++)if(r[f.id]){u.outputs.forEach(m=>r[m.id]=!0),h=!0,s[u.id]=!0;break}if(h)break}}const o={};o[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const u=t[l],c=u.inputs;for(let d=0;d<u.outputs.length;d++)if(o[u.outputs[d].id]){for(const f in c)o[c[f].id]=!0,i[u.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const u=t[l];if(s[u.id]&&i[u.id]){const c={};for(const f in u.inputs){const h=u.inputs[f];r[h.id]&&(c[f]=h)}const d=Object.assign({},u);d.inputs=c,d.outputs=u.outputs,a.push(d)}}return a}function r5(t,e,n,r){for(let s=e.length-1;s>=0;s--){const o=e[s],i=[];if(o.outputs.forEach(l=>{const u=t[l.id];u!=null?i.push(u):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=n(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const c=o.inputs[l];if(!Pt(u.shape,c.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${c.shape}'`);if(t[c.id]==null)t[c.id]=u;else{const d=t[c.id];t[c.id]=r(d,u),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XC=20,vc=3,ty=7;function s5(t,e,n,r){const s=$n(e),o=o5(t,e,n,s),i=e.length,a=yh(t,e,n,s,o),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function o5(t,e,n,r){const s=pe(e),o=r[r.length-1],i=new Array(o).fill(0),a=e.length,l=n==="complex64"?Oc(t):t;if(a>1)for(let u=0;u<s/o;u++){const c=u*o;for(let d=0;d<o;d++)i[d]=Math.max(i[d],Ic(l[c+d],0,n).length)}return i}function Ic(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(ty))} + ${parseFloat(t[1].toFixed(ty))}j`:bm(t)?r=`'${t}'`:n==="bool"?r=mO(t):r=parseFloat(t.toFixed(ty)).toString(),su(r,e)}function mO(t){return t===0?"false":"true"}function yh(t,e,n,r,s,o=!0){const i=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=Oc(t);return[Ic(m[0],0,n)]}return n==="bool"?[mO(t[0])]:[t[0].toString()]}if(l===1){if(a>XC){const v=vc*i;let g=Array.from(t.slice(0,v)),x=Array.from(t.slice((a-vc)*i,a*i));return n==="complex64"&&(g=Oc(g),x=Oc(x)),["["+g.map((b,_)=>Ic(b,s[_],n)).join(", ")+", ..., "+x.map((b,_)=>Ic(b,s[a-vc+_],n)).join(", ")+"]"]}return["["+(n==="complex64"?Oc(t):Array.from(t)).map((v,g)=>Ic(v,s[g],n)).join(", ")+"]"]}const u=e.slice(1),c=r.slice(1),d=r[0]*i,f=[];if(a>XC){for(let m=0;m<vc;m++){const v=m*d,g=v+d;f.push(...yh(t.slice(v,g),u,n,c,s,!1))}f.push("...");for(let m=a-vc;m<a;m++){const v=m*d,g=v+d;f.push(...yh(t.slice(v,g),u,n,c,s,m===a-1))}}else for(let m=0;m<a;m++){const v=m*d,g=v+d;f.push(...yh(t.slice(v,g),u,n,c,s,m===a-1))}const h=l===2?",":"";f[0]="["+(a>0?f[0]+h:"");for(let m=1;m<f.length-1;m++)f[m]=" "+f[m]+h;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return f[f.length-1]=" "+f[f.length-1]+"]"+(o?"":p),f}function Oc(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wu{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=pe(e),r!=null){const s=r.length;D(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||mn(n,this.size),this.strides=$n(e)}set(e,...n){n.length===0&&(n=[0]),D(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const s of e){if(s<0||s>=this.shape[n]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Ys().makeTensor(this.values,this.shape,this.dtype)}}let Ys=null,Il=null;function i5(t){Ys=t}function a5(t){Il=t}class Yn{constructor(e,n,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=pe(e),this.strides=$n(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Il.buffer(this.shape,this.dtype,e)}bufferSync(){return Il.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return F0(this.shape,e,this.dtype==="complex64")}arraySync(){return F0(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Ys().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>bu(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Ys().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Ys().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>bu(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Ys().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Ys().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Il.print(this,e)}clone(){return this.throwIfDisposed(),Il.clone(this)}toString(e=!1){const n=this.dataSync();return s5(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Il.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),Ys().makeVariable(this,e,n,r)}}Object.defineProperty(Yn,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function gO(){return sx("Tensor",()=>Yn)}gO();class hp extends Yn{constructor(e,n,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Pt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Ys().disposeTensor(this),this.dataId=e.dataId,Ys().incRef(this,null)}dispose(){Ys().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(hp,Symbol.hasInstance,{value:t=>t instanceof Yn&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var YC;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(YC||(YC={}));var H0;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(H0||(H0={}));var q0;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(q0||(q0={}));var K0;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(K0||(K0={}));var X0;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(X0||(X0={}));const l5={float32:K0,int32:H0,bool:q0,complex64:X0};function To(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return l5[t][e]}function cx(t){return To(t,"int32")}function yO(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function vO(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ut(t,e){if(t.dtype===e.dtype)return[t,e];const n=To(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function u5(t,e){D(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function xO(t){const e=[];return bO(t,e,new Set),e}function bO(t,e,n){if(t==null)return;if(t instanceof Yn){e.push(t);return}if(!c5(t))return;const r=t;for(const s in r){const o=r[s];n.has(o)||(n.add(o),bO(o,e,n))}}function c5(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ny(t){return t.kernelName!=null}class QC{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Su{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new QC}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(Js(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new JU(this.backendInstance),!0}setupRegisteredKernels(){zC(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){zC(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof d$)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,o=r.then(i=>s<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,Js(`Initialization of backend ${e} failed`),Js(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Js(`Initialization of backend ${e} failed`),Js(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:s,asyncInit:o}=this.initializeBackend(r);if(o||s)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),s=r.backend,o=this.readSync(n),i=s.refCount(n);s.disposeData(n,!0),r.backend=e,e.move(n,o,r.shape,r.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=n(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,n,r){e();try{const s=r();return n(),s}catch(s){throw n(),s}}nextTensorId(){return Su.nextTensorId++}nextVariableId(){return Su.nextVariableId++}clone(e){const n=z.runKernel(ax,{x:e}),r={x:e},s=i=>({x:()=>{const a="float32",l={x:i},u={dtype:a};return z.runKernel(ix,l,u)}}),o=[];return this.addTapeNode(this.state.activeScope.name,r,[n],s,o,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(W0(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const s=this.backend.numDataIds();let o=0;r.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-n-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const s=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=ny(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(ny(e)){const{kernelName:p,inputs:m,attrs:v}=e;this.backendName==null&&this.backend;const g=W0(p,this.backendName);D(g!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const x=this.backend.numDataIds();l=g.kernelFunc({inputs:m,attrs:v,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,x,b);const _=b.map(N=>N.rank!=null?N:this.makeTensorFromTensorInfo(N));if(s){const N=this.getTensorsForGradient(p,m,_);r=this.saveTensorsForBackwardMode(N)}return _}}else{const{forwardFunc:p}=e,m=v=>{s&&(r=v.map(g=>this.keep(this.clone(g))))};a=()=>{const v=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const g=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,v,g),g}}const{inputs:c,attrs:d}=e,f=ny(e)?null:e.backwardsFunc;let h;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(h=this.profiler.profileKernel(u,c,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(h),n=h.outputs)}),s&&this.addTapeNode(u,c,n,f,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(c).map(p=>c[p]!=null?c[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:h.timeMs,extraInfo:h.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const s=UC(e);if(s!=null){const o=s.inputsToSave||[],i=s.outputsToSave||[];let a;s.saveAllInputs?(D(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(u=>n[u])):a=o.map(u=>n[u]);const l=r.filter((u,c)=>i[c]);return a.concat(l)}return[]}makeTensor(e,n,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let o=e;r==="string"&&bm(e[0])&&(o=e.map(l=>Pa(l)));const i=s.write(o,n,r),a=new Yn(n,r,i,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const l=this.state.tensorInfo.get(i),u=CU(o);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,n,r,s){r=r||"float32";const o={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(o,s)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:s,dtype:o}=e,i=new Yn(s,o,r,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const o=new hp(e,n,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*cp(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof hp||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*cp(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,s,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:o},l=UC(e);l!=null&&(s=l.gradFunc),s!=null&&(a.gradient=u=>(u=u.map((c,d)=>{if(c==null){const f=r[d],h=Zi(f.size,f.dtype);return this.makeTensor(h,f.shape,f.dtype)}return c}),s(u.length>1?u:u[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=xO(e),r=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!r.has(i.id)&&i.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===s.id&&this.track(o)})}gradients(e,n,r,s=!1){if(D(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));D(o instanceof Yn,()=>"The result y returned by f() must be a tensor.");const i=n5(this.state.activeTape,n,o);if(!s&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=r??d5(o.shape),r5(a,i,u=>this.tidy(u),f5);const l=n.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const c of u.saved)c.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return D(P0(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{D(n.every(a=>a instanceof Yn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};n.forEach((a,l)=>{s[l]=a});const o=(a,l)=>(r=e(...n,l),D(r.value instanceof Yn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),D(P0(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),i=(a,l)=>{const u=r.gradFunc(a,l),c=Array.isArray(u)?u:[u];D(c.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),D(c.every(f=>f instanceof Yn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return c.forEach((f,h)=>{d[h]=()=>f}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Ks(),r=await this.backend.time(e);return r.wallMs=Ks()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new QC;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Su.nextTensorId=0;Su.nextVariableId=0;function d5(t){const e=h$(pe(t),"float32");return z.makeTensor(e,t,"float32")}function wO(){const t=m$();if(t._tfengine==null){const e=new TU(t);t._tfengine=new Su(e)}return IU(t._tfengine.ENV),i5(()=>t._tfengine),t._tfengine}const z=wO();function f5(t,e){const n={a:t,b:e};return z.runKernel(ox,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h5(){return typeof navigator<"u"&&navigator!=null}function SO(t){if(t||h5()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function CO(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cr=Y();cr.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});cr.registerFlag("IS_BROWSER",()=>CO());cr.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");cr.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));cr.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));cr.registerFlag("PROD",()=>!1);cr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>cr.getBool("DEBUG"));cr.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);cr.registerFlag("IS_TEST",()=>!1);cr.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>cr.getBool("DEBUG"));cr.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);cr.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);cr.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aa(t,e){let n=t;if(Es(t))return e==="string"?[]:[t.length];if(yO(t)){const s=t.channels||"RGBA";return[t.height,t.width*s.length]}else if(vO(t))return[t.buffer.size/(e==null?4:cp(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Es(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&Y().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&_O(t,r,[]),r}function _O(t,e,n){if(n=n||[],!Array.isArray(t)&&!Es(t)){D(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}D(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),D(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let s=0;s<t.length;++s)_O(t[s],r,n.concat(s))}function ZC(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function $(t,e,n,r="numeric"){if(t instanceof gO())return ZC(r,t.dtype,e,n),t;let s=zd(t);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),ZC(r,s,e,n),t==null||!Es(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const o=aa(t,s);!Es(t)&&!Array.isArray(t)&&(t=[t]);const a=s!=="string"?Sm(t,s):Ha(t,[],!0);return z.makeTensor(a,o,s)}function pp(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((o,i)=>$(o,`${e}[${i}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EO="__op";function M(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+EO;const s=(...o)=>{z.startScope(n);try{const i=r(...o);return Ga(i)&&console.error("Cannot return a Promise inside of tidy."),z.endScope(i),i}catch(i){throw z.endScope(null),i}};return Object.defineProperty(s,"name",{value:n,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p5(t,e){const n=$(t,"real","complex"),r=$(e,"imag","complex");Qr(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:n,imag:r};return z.runKernel(M$,s)}const Ji=M({complex_:p5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function la(t,e,n,r){if(r==null)r=zd(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(vO(t)||yO(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return z.backend.createTensorFromGPUData(t,e||n,r)}if(!Es(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Zr(e);const s=pe(e),o=pe(n);D(s===o,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${o}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==pe(e.slice(i)):!0;D(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Es(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Sm(t,r):Ha(t,[],!0),z.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _o(t,e,n){const r=aa(t,n);return la(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qa={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class ao{static join(e){return new ao(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>Es(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const s=e[r];r!==e.length-1&&s.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=n+s.byteLength;this.shards.push({buffer:s,start:n,end:o}),n=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const s=n-e,o=new ArrayBuffer(s),i=new Uint8Array(o);let a=0;for(let l=r;l<this.shards.length;l++){const u=this.shards[l],d=e+a-u.start,f=a,p=Math.min(n,u.end)-u.start,m=new Uint8Array(u.buffer,d,p-d);if(i.set(m,f),a+=m.length,n<u.end)break}return o}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(s){return e<s.start?-1:e>=s.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=m5(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function m5(t,e){let n=0,r=t.length;for(;n<=r;){const s=Math.floor((r-n)/2)+n,o=e(t[s]);if(o===0)return s;o<0?r=s:n=s+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dx(){z.disposeVariables()}function fi(){return z}function Cu(){return z.memory()}function Ke(t,e){return z.tidy(t,e)}function Kt(t){xO(t).forEach(n=>n.dispose())}function vo(t){return z.keep(t)}function g5(){return z.ready()}function y5(){return z.backendName}function v5(t,e,n=1){return z.registerBackend(t,e,n)}function TO(){return z.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ea=4;async function x5(t,e){const n=[],r=[],s=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<s.length;++i){const a=s[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const c=new Promise(async d=>{const f=await l.bytes(),h=f.reduce((v,g)=>v+g.length,0)+ea*f.length,p=new Uint8Array(h);let m=0;for(let v=0;v<f.length;v++){const g=f[v],x=new Uint8Array(new Uint32Array([g.length]).buffer);p.set(x,m),m+=ea,p.set(g,m),m+=g.length}d(p)});r.push(c)}else r.push(l.data());e!=null&&(u.group=e),n.push(u)}const o=await Promise.all(r);return{data:S5(o),specs:n}}function NO(t,e){const n=new ao(t),r={};let s=0;for(const o of e){const i=b5(o,(a,l)=>n.slice(s+a,s+l));r[o.name]=$O(o,n.slice(s,s+i)),s+=i}return r}function b5(t,e){const n=pe(t.shape);let r;if("quantization"in t){const s=t.quantization;r=qa[s.dtype]}else if(t.dtype==="string"){let s=0;for(let o=0;o<n;o++)s+=ea+new Uint32Array(e(s,s+ea))[0];return s}else r=qa[t.dtype];return n*r}async function w5(t,e){const n=pe(t.shape);let r;if("quantization"in t){const s=t.quantization;r=qa[s.dtype]}else if(t.dtype==="string"){let s=0;for(let o=0;o<n;o++)s+=ea+new Uint32Array(await e(s,s+ea))[0];return s}else r=qa[t.dtype];return n*r}function $O(t,e){const n=t.name,r=t.dtype,s=t.shape,o=pe(s);let i,a=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=qa[l.dtype],c=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){i=new Float32Array(c.length);for(let d=0;d<c.length;d++){const f=c[d];i[d]=f*l.scale+l.min}}else if(l.dtype==="float16")i=k5()(c);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);i=new Int32Array(c.length);for(let d=0;d<c.length;d++){const f=c[d];i[d]=Math.round(f*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=o*u}else if(r==="string"){const l=pe(t.shape);i=[];for(let u=0;u<l;u++){const c=new Uint32Array(e.slice(a,a+ea))[0];a+=ea;const d=new Uint8Array(e.slice(a,a+c));i.push(d),a+=c}}else{const l=qa[r];if(r==="float32")i=new Float32Array(e);else if(r==="int32")i=new Int32Array(e);else if(r==="bool")i=new Uint8Array(e);else if(r==="complex64"){i=new Float32Array(e);const u=new Float32Array(i.length/2),c=new Float32Array(i.length/2);for(let p=0;p<u.length;p++)u[p]=i[p*2],c[p]=i[p*2+1];const d=_o(u,s,"float32"),f=_o(c,s,"float32"),h=Ji(d,f);return d.dispose(),f.dispose(),h}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);a+=o*l}return _o(i,s,r)}async function JC(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:s,value:o}=await t.read();if(s&&o==null){const a=n-r.byteLength;throw new Error(`Reader is done but ${a} bytes are still expected`)}const i=new Uint8Array(r.length+o.byteLength);i.set(r,0),i.set(new Uint8Array(o),r.length),r=i}return r.buffer}async function kO(t,e){const n={},r=t.getReader();let s=new ArrayBuffer(0);for(const o of e){const i=await w5(o,async(u,c)=>(s=await JC(r,s,c),s.slice(u,c)));s=await JC(r,s,i);const a=s.slice(0,i);s=s.slice(i);const l=$O(o,a);if(n[o.name]=l,y5()==="webgpu"){const u=TO();"uploadToGPU"in u&&pe(l.shape)>=Y().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(l.dataId)}}return n}function S5(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(o=>{if(e+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const r=new Uint8Array(e);let s=0;return n.forEach(o=>{r.set(new Uint8Array(o.buffer),s),s+=o.byteLength}),r.buffer}const fx=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function e_(t){return fx?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function C5(t){if(fx)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,s=e.length;r<s;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function _5(t){if(fx){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function E5(t){return ao.join(t)}function t_(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function IO(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function OO(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function hx(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),OO(t,n,r)}function Wd(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:e_(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:e_(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new ao(t.weightData).byteLength}}function Y0(t){const e=[];for(const n of t)e.push(...n.weights);return e}function T5(){const t=n=>{let r=n<<13,s=0;for(;!(r&8388608);)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function N5(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function $5(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function k5(){const t=T5(),e=N5(),n=$5();return r=>{const s=new ArrayBuffer(4*r.length),o=new Uint32Array(s);for(let i=0;i<r.length;i++){const a=r[i],l=t[n[a>>10]+(a&1023)]+e[a>>10];o[i]=l}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dt{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Dt.instance==null&&(Dt.instance=new Dt),Dt.instance}static registerSaveRouter(e){Dt.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Dt.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Dt.getHandlers(e,"save")}static getLoadHandlers(e,n){return Dt.getHandlers(e,"load",n)}static getHandlers(e,n,r){const s=[];return(n==="load"?Dt.getInstance().loadRouters:Dt.getInstance().saveRouters).forEach(i=>{const a=i(e,r);a!==null&&s.push(a)}),s}}const I5=t=>Dt.registerSaveRouter(t),O5=t=>Dt.registerLoadRouter(t),R5=t=>Dt.getSaveHandlers(t),D5=(t,e)=>Dt.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q0="tensorflowjs",Z0=1,Oa="models_store",$i="model_info_store";function RO(){if(!Y().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function J0(t){const e=t.result;e.createObjectStore(Oa,{keyPath:"modelPath"}),e.createObjectStore($i,{keyPath:"modelPath"})}class Ka{constructor(e){if(this.indexedDB=RO(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,s)=>{const o=this.indexedDB.open(Q0,Z0);o.onupgradeneeded=()=>J0(o),o.onsuccess=()=>{const i=o.result;if(n==null){const a=i.transaction(Oa,"readonly"),u=a.objectStore(Oa).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return i.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(u.result.modelArtifacts)},u.onerror=c=>(i.close(),s(u.error)),a.oncomplete=()=>i.close()}else{n.weightData=ao.join(n.weightData);const a=Wd(n),l=i.transaction($i,"readwrite");let u=l.objectStore($i),c;try{c=u.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(f){return s(f)}let d;c.onsuccess=()=>{d=i.transaction(Oa,"readwrite");const f=d.objectStore(Oa);let h;try{h=f.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return s(p)}h.onsuccess=()=>r({modelArtifactsInfo:a}),h.onerror=p=>{u=l.objectStore($i);const m=u.delete(this.modelPath);m.onsuccess=()=>(i.close(),s(h.error)),m.onerror=v=>(i.close(),s(h.error))}},c.onerror=f=>(i.close(),s(c.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},o.onerror=i=>s(o.error)})}}Ka.URL_SCHEME="indexeddb://";const DO=t=>Y().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ka.URL_SCHEME)?A5(t.slice(Ka.URL_SCHEME.length)):null;Dt.registerSaveRouter(DO);Dt.registerLoadRouter(DO);function A5(t){return new Ka(t)}function P5(t){return t.startsWith(Ka.URL_SCHEME)?t.slice(Ka.URL_SCHEME.length):t}class L5{constructor(){this.indexedDB=RO()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(Q0,Z0);r.onupgradeneeded=()=>J0(r),r.onsuccess=()=>{const s=r.result,o=s.transaction($i,"readonly"),a=o.objectStore($i).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(s.close(),n(a.error)),o.oncomplete=()=>s.close()},r.onerror=s=>n(r.error)})}async removeModel(e){return e=P5(e),new Promise((n,r)=>{const s=this.indexedDB.open(Q0,Z0);s.onupgradeneeded=()=>J0(s),s.onsuccess=()=>{const o=s.result,i=o.transaction($i,"readwrite"),a=i.objectStore($i),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return o.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const c=a.delete(e),d=()=>{u=o.transaction(Oa,"readwrite");const h=u.objectStore(Oa).delete(e);h.onsuccess=()=>n(l.result.modelArtifactsInfo),h.onerror=p=>r(l.error)};c.onsuccess=d,c.onerror=f=>(d(),o.close(),r(l.error))}},l.onerror=c=>(o.close(),r(l.error)),i.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},s.onerror=o=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jo="/",Ol="tensorflowjs_models",AO="info",F5="model_topology",M5="weight_specs",j5="weight_data",B5="model_metadata";function PO(t){return{info:[Ol,t,AO].join(jo),topology:[Ol,t,F5].join(jo),weightSpecs:[Ol,t,M5].join(jo),weightData:[Ol,t,j5].join(jo),modelMetadata:[Ol,t,B5].join(jo)}}function LO(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function U5(t){const e=t.split(jo);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(jo)}function z5(t){return t.startsWith(Xa.URL_SCHEME)?t.slice(Xa.URL_SCHEME.length):t}class Xa{constructor(e){if(!Y().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=PO(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=Wd(e),o=ao.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,C5(o));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:s}}catch{throw LO(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=s;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=_5(i),n}}Xa.URL_SCHEME="localstorage://";const FO=t=>Y().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Xa.URL_SCHEME)?W5(t.slice(Xa.URL_SCHEME.length)):null;Dt.registerSaveRouter(FO);Dt.registerLoadRouter(FO);function W5(t){return new Xa(t)}class V5{constructor(){D(Y().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),D(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Ol+jo,r=jo+AO;for(let s=0;s<this.LS.length;++s){const o=this.LS.key(s);if(o.startsWith(n)&&o.endsWith(r)){const i=U5(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=z5(e);const n=PO(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return LO(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ou="://";class qn{constructor(){this.managers={}}static getInstance(){return qn.instance==null&&(qn.instance=new qn),qn.instance}static registerManager(e,n){D(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(ou)&&(e=e.slice(0,e.indexOf(ou))),D(e.length>0,()=>"scheme must not be an empty string.");const r=qn.getInstance();D(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=qn.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(qn.getInstance().managers)}}function vh(t){if(t.indexOf(ou)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${qn.getSchemes().join(",")}`);return{scheme:t.split(ou)[0],path:t.split(ou)[1]}}async function MO(t,e,n=!1){D(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=Dt.getLoadHandlers(t);D(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),D(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const s=r[0],o=Dt.getSaveHandlers(e);D(o.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),D(o.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const i=o[0],a=vh(t).scheme,l=vh(t).path,u=a===vh(t).scheme,c=await s.load();n&&u&&await qn.getManager(a).removeModel(l);const d=await i.save(c);return n&&!u&&await qn.getManager(a).removeModel(l),d.modelArtifactsInfo}async function G5(){const t=qn.getSchemes(),e={};for(const n of t){const r=await qn.getManager(n).listModels();for(const s in r){const o=n+ou+s;e[o]=r[s]}}return e}async function H5(t){const e=vh(t);return qn.getManager(e.scheme).removeModel(e.path)}async function q5(t,e){return MO(t,e,!1)}async function K5(t,e){return MO(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X5{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!Y().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return iO(e)}}if(Y().get("IS_BROWSER")){Y().setPlatform("browser",new X5);try{qn.registerManager(Xa.URL_SCHEME,new V5)}catch{}try{qn.registerManager(Ka.URL_SCHEME,new L5)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y5={importFetch:()=>require("node-fetch")};let ry;class Q5{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return Y().global.fetch!=null?Y().global.fetch(e,n):(ry==null&&(ry=Y5.importFetch()),ry(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}Y().get("IS_NODE")&&!Y().get("IS_BROWSER")&&Y().setPlatform("node",new Q5);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lt(t,e="float32",n){return e=e||"float32",Zr(t),new wu(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z5(t,e){const n=$(t,"x","cast");if(!wU(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},s={dtype:e};return z.runKernel(ix,r,s)}const nn=M({cast_:Z5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J5(t){const n={x:$(t,"x","clone","string_or_numeric")};return z.runKernel(ax,n)}const Wi=M({clone_:J5});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jO(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */wO();const ez={buffer:Lt,cast:nn,clone:Wi,print:jO};a5(ez);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tz(t,e){let n=$(t,"a","add"),r=$(e,"b","add");[n,r]=Ut(n,r);const s={a:n,b:r};return z.runKernel(ox,s)}const ke=M({add_:tz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nz(t,e){let n=$(t,"a","floorDiv"),r=$(e,"b","floorDiv");[n,r]=Ut(n,r);const s={a:n,b:r};return z.runKernel(gk,s)}const BO=M({floorDiv_:nz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rz(t,e){let n=$(t,"a","div"),r=$(e,"b","div");if([n,r]=Ut(n,r),n.dtype==="int32"&&r.dtype==="int32")return BO(n,r);const s={a:n,b:r},o={};return z.runKernel(sk,s,o)}const st=M({div_:rz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sz(t,e){let n=$(t,"a","mul"),r=$(e,"b","mul");[n,r]=Ut(n,r);const s={a:n,b:r};return z.runKernel(Kk,s)}const he=M({mul_:sz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oz(t){const e=$(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return z.runKernel(j$,n)}else{const n={x:e};return z.runKernel(g$,n)}}const jr=M({abs_:oz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iz(t){const n={x:$(t,"x","acos")};return z.runKernel(y$,n)}const az=M({acos_:iz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lz(t){const n={x:$(t,"x","acosh")};return z.runKernel(v$,n)}const uz=M({acosh_:lz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cz(t){D(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),D(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((s,o)=>$(s,`tensors${o}`,"addN")),n=e[0];e.forEach(s=>{if(s.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!Pt(s.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return z.runKernel(x$,r)}const dz=M({addN_:cz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fz(t,e=null,n=!1){const s={x:$(t,"x","all","bool")},o={axis:e,keepDims:n};return z.runKernel(b$,s,o)}const hz=M({all_:fz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pz(t,e=null,n=!1){const s={x:$(t,"x","any","bool")},o={axis:e,keepDims:n};return z.runKernel(w$,s,o)}const mz=M({any_:pz});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gz(t,e=0){const r={x:$(t,"x","argMax")},s={axis:e};return z.runKernel(S$,r,s)}const yz=M({argMax_:gz});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vz(t,e=0){const r={x:$(t,"x","argMin")},s={axis:e};return z.runKernel(C$,r,s)}const UO=M({argMin_:vz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xz(t){const n={x:$(t,"x","asin")};return z.runKernel(_$,n)}const bz=M({asin_:xz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wz(t){const n={x:$(t,"x","asinh")};return z.runKernel(E$,n)}const Sz=M({asinh_:wz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cz(t){const n={x:$(t,"x","atan")};return z.runKernel(T$,n)}const _z=M({atan_:Cz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ez(t,e){let n=$(t,"a","atan2"),r=$(e,"b","atan2");[n,r]=Ut(n,r);const s={a:n,b:r};return z.runKernel($$,s)}const Tz=M({atan2_:Ez});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nz(t){const n={x:$(t,"x","atanh")};return z.runKernel(N$,n)}const $z=M({atanh_:Nz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zO(t,e,n,r,s="NHWC",o){const i=t[3],a=[...e,i],l=Lu(s);return Jr(t,a,n,o,r,null,null,l)}function ul(t,e,n,r,s,o,i="channelsLast"){const[a,l]=wd(e);let u;if(i==="channelsLast")u=[a,l,t[3],t[3]];else if(i==="channelsFirst")u=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Jr(t,u,n,r,s,o,!1,i)}function Vd(t,e,n,r,s,o,i="NDHWC"){const[a,l,u]=ev(e);let c,d;if(i==="NDHWC")d="channelsLast",c=[a,l,u,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",c=[a,l,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Gd(t,c,n,r,s,!1,d,o)}function Jr(t,e,n,r,s,o,i=!1,a="channelsLast"){let[l,u,c,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,c,d]=t;else if(a==="channelsFirst")[l,d,u,c]=t;else throw new Error(`Unknown dataFormat ${a}`);const[f,h,,p]=e,[m,v]=wd(n),[g,x]=wd(r),b=iu(f,g),_=iu(h,x),{padInfo:N,outHeight:E,outWidth:R}=Oz(s,u,c,m,v,b,_,o,a),P=i?p*d:p;let B;return a==="channelsFirst"?B=[l,P,E,R]:a==="channelsLast"&&(B=[l,E,R,P]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:c,inChannels:d,outHeight:E,outWidth:R,outChannels:P,padInfo:N,strideHeight:m,strideWidth:v,filterHeight:f,filterWidth:h,effectiveFilterHeight:b,effectiveFilterWidth:_,dilationHeight:g,dilationWidth:x,inShape:t,outShape:B,filterShape:e}}function Gd(t,e,n,r,s,o=!1,i="channelsLast",a){let[l,u,c,d,f]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,u,c,d,f]=t;else if(i==="channelsFirst")[l,f,u,c,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[h,p,m,,v]=e,[g,x,b]=ev(n),[_,N,E]=ev(r),R=iu(h,_),P=iu(p,N),B=iu(m,E),{padInfo:F,outDepth:H,outHeight:ee,outWidth:oe}=Rz(s,u,c,d,g,x,b,R,P,B,a),de=o?v*f:v;let V;return i==="channelsFirst"?V=[l,de,H,ee,oe]:i==="channelsLast"&&(V=[l,H,ee,oe,de]),{batchSize:l,dataFormat:i,inDepth:u,inHeight:c,inWidth:d,inChannels:f,outDepth:H,outHeight:ee,outWidth:oe,outChannels:de,padInfo:F,strideDepth:g,strideHeight:x,strideWidth:b,filterDepth:h,filterHeight:p,filterWidth:m,effectiveFilterDepth:R,effectiveFilterHeight:P,effectiveFilterWidth:B,dilationDepth:_,dilationHeight:N,dilationWidth:E,inShape:t,outShape:V,filterShape:e}}function kz(t,e,n,r,s){r==null&&(r=px(t,e,n));const o=t[0],i=t[1],a=Sd((o-e+2*r)/n+1,s),l=Sd((i-e+2*r)/n+1,s);return[a,l]}function Iz(t,e,n,r,s,o){s==null&&(s=px(t,e[0],r[0]));const i=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*s>=e[a]&&(i[a]=Sd((t[a]-e[a]+2*s)/r[a]+1,o));return i}function px(t,e,n,r=1){const s=iu(e,r);return Math.floor((t[0]*(n-1)-n+s)/2)}function wd(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function ev(t){return typeof t=="number"?[t,t,t]:t}function iu(t,e){return e<=1?t:t+(t-1)*(e-1)}function Oz(t,e,n,r,s,o,i,a,l){let u,c,d;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const h=kz([e,n],o,r,t,a);c=h[0],d=h[1]}else if(t==="same"){c=Math.ceil(e/r),d=Math.ceil(n/s);const f=Math.max(0,(c-1)*r+o-e),h=Math.max(0,(d-1)*s+i-n),p=Math.floor(f/2),m=f-p,v=Math.floor(h/2),g=h-v;u={top:p,bottom:m,left:v,right:g,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((e-o+1)/r),d=Math.ceil((n-i+1)/s);else if(typeof t=="object"){const f=l==="channelsLast"?t[1][0]:t[2][0],h=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];u={top:f,bottom:h,left:p,right:m,type:f===0&&h===0&&p===0&&m===0?"VALID":"EXPLICIT"},c=Sd((e-o+f+h)/r+1,a),d=Sd((n-i+p+m)/s+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:c,outWidth:d}}function Rz(t,e,n,r,s,o,i,a,l,u,c){let d,f,h,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const v=Iz([e,n,r,1],[a,l,u],1,[s,o,i],t,c);f=v[0],h=v[1],p=v[2]}else if(t==="same"){f=Math.ceil(e/s),h=Math.ceil(n/o),p=Math.ceil(r/i);const m=(f-1)*s+a-e,v=(h-1)*o+l-n,g=(p-1)*i+u-r,x=Math.floor(m/2),b=m-x,_=Math.floor(v/2),N=v-_,E=Math.floor(g/2),R=g-E;d={top:_,bottom:N,left:E,right:R,front:x,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:f,outHeight:h,outWidth:p}}function Sd(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Cd(t){const[e,n,r]=wd(t);return e===1&&n===1&&r===1}function $r(t,e){return Cd(t)||Cd(e)}function Ya(t){return wd(t).every(e=>e>0)}function Lu(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function $s(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")D(vu(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{D(vu(s),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${s}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dz(t,e){const r={x:$(t,"x","reshape","string_or_numeric")},s={shape:e};return z.runKernel(pI,r,s)}const ae=M({reshape_:Dz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Az(t,e,n,r,s){const o=$(t,"x","avgPool","float32"),i=1;D($r(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=ae(o,[1,o.shape[0],o.shape[1],o.shape[2]])),D(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),$s("avgPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s};let d=z.runKernel(k$,u,c);return d=nn(d,o.dtype),l?ae(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const WO=M({avgPool_:Az});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pz(t,e,n,r,s,o="NDHWC"){const i=$(t,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=ae(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),D(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),D(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),$s("avgPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o};let d=z.runKernel(I$,u,c);return d=nn(d,a.dtype),l?ae(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Lz=M({avgPool3d_:Pz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fz(t,e=0){D(t.length>=1,()=>"Pass at least one tensor to concat");const n=pp(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return Wi(n[0]);const r=n,s={axis:e};return z.runKernel(B$,r,s)}const cn=M({concat_:Fz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mz(t,e,n=!1,r=!1){let s=$(t,"a","matMul"),o=$(e,"b","matMul");[s,o]=Ut(s,o);const i={a:s,b:o},a={transposeA:n,transposeB:r};return z.runKernel(O$,i,a)}const ht=M({matMul_:Mz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jz(t){const n={x:$(t,"x","sigmoid","float32")};return z.runKernel(II,n)}const au=M({sigmoid_:jz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bz(t,e,n){const r=$(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},o={begin:e,size:n};return z.runKernel(TI,s,o)}const Le=M({slice_:Bz});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uz(t){const n={x:$(t,"x","tanh","float32")};return z.runKernel(YI,n)}const tv=M({tanh_:Uz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zz(t,e,n,r,s,o){const i=$(t,"forgetBias","basicLSTMCell"),a=$(e,"lstmKernel","basicLSTMCell"),l=$(n,"lstmBias","basicLSTMCell"),u=$(r,"data","basicLSTMCell"),c=$(s,"c","basicLSTMCell"),d=$(o,"h","basicLSTMCell"),f=cn([u,d],1),h=ht(f,a),p=ke(h,l),m=p.shape[0],v=p.shape[1]/4,g=[m,v],x=Le(p,[0,0],g),b=Le(p,[0,v],g),_=Le(p,[0,v*2],g),N=Le(p,[0,v*3],g),E=ke(he(au(x),tv(b)),he(c,au(ke(i,_)))),R=he(tv(E),au(N));return[E,R]}const Wz=M({basicLSTMCell_:zz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vz(t,e,n){const r=$(t,"x","batchToSpaceND"),s=e.reduce((a,l)=>a*l);D(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),D(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),D(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const o={x:r},i={blockShape:e,crops:n};return z.runKernel(R$,o,i)}const VO=M({batchToSpaceND_:Vz});function Gz(t){let e;return t.rank===0||t.rank===1?e=ae(t,[1,1,1,t.size]):t.rank===2?e=ae(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=ae(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hz(t,e,n,r,s,o){o==null&&(o=.001);const i=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;s!=null&&(u=$(s,"scale","batchNorm"));let c;r!=null&&(c=$(r,"offset","batchNorm")),D(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const f={x:Gz(i),scale:u,offset:c,mean:a,variance:l},h={varianceEpsilon:o},p=z.runKernel(yk,f,h);return ae(p,i.shape)}const Cm=M({batchNorm_:Hz});function qz(t,e,n,r,s,o){const i=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;s!=null&&(u=$(s,"scale","batchNorm"));let c;return r!=null&&(c=$(r,"offset","batchNorm")),D(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),D(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),D(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&D(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&D(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${c.rank}.`),Cm(i,a,l,c,u,o)}const Kz=M({batchNorm2d_:qz});function Xz(t,e,n,r,s,o){const i=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;s!=null&&(u=$(s,"scale","batchNorm"));let c;return r!=null&&(c=$(r,"offset","batchNorm")),D(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),D(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),D(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&D(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&D(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${c.rank}.`),Cm(i,a,l,c,u,o)}const Yz=M({batchNorm3d_:Xz});function Qz(t,e,n,r,s,o){const i=$(t,"x","batchNorm"),a=$(e,"mean","batchNorm"),l=$(n,"variance","batchNorm");let u;s!=null&&(u=$(s,"scale","batchNorm"));let c;return r!=null&&(c=$(r,"offset","batchNorm")),D(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),D(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),D(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&D(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&D(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${c.rank}.`),Cm(i,a,l,c,u,o)}const Zz=M({batchNorm4d_:Qz});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jz(t,e,n){const r=$(t,"x","bincount"),s=$(e,"weights","bincount");D(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),D(n>=0,()=>`size must be non-negative, but got ${n}.`),D(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const o={x:r,weights:s},i={size:n};return z.runKernel(D$,o,i)}const GO=M({bincount_:Jz});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eW(t,e){const n=$(t,"x","bitwiseAnd"),r=$(e,"y","bitwiseAnd");if(!Pt(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const s={a:n,b:r};return z.runKernel(A$,s)}const tW=M({bitwiseAnd_:eW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nW(t,e){const n=$(t,"s0","broadcastArgs","int32"),r=$(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:n,s1:r};return z.runKernel(P$,s)}const rW=M({broadcastArgs_:nW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sW(t,e){let n=$(t,"broadcastTo","x");const r=n.shape;if(Zr(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=ae(n,u)}const s=n.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(s[u]===e[u])o[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(o.map((u,c)=>u>1?c:-1).filter(u=>u>=0).length===0)return Wi(n);const a={x:n},l={reps:o};return z.runKernel(lx,a,l)}const Kc=M({broadcastTo_:sW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oW(t){const n={x:$(t,"x","ceil","float32")};return z.runKernel(L$,n)}const iW=M({ceil_:oW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hd(t,e,n){Zr(t),n=n||zd(e);const r={shape:t,value:e,dtype:n};return z.runKernel(hk,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aW(t,e,n){const r=$(t,"x","clipByValue");if(D(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Hd(r.shape,e,r.dtype);const s={x:r},o={clipValueMin:e,clipValueMax:n};return z.runKernel(F$,s,o)}const lW=M({clipByValue_:aW});function uW(t){return cn(t,0)}const cW=M({concat1d_:uW});function dW(t,e){return cn(t,e)}const HO=M({concat2d_:dW});function fW(t,e){return cn(t,e)}const hW=M({concat3d_:fW});function pW(t,e){return cn(t,e)}const mW=M({concat4d_:pW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gW(t,e,n,r,s="NHWC",o=[1,1],i){const a=$(t,"x","conv2d","float32"),l=$(e,"filter","conv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),D(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),$s("conv2d",r,i);const d=s==="NHWC"?u.shape[3]:u.shape[1];D(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),D($r(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),D(Ya(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),D(Ya(n),()=>"Error in conv2D: Strides should be larger than 0.");const f={x:u,filter:l},h={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},p=z.runKernel(U$,f,h);return c?ae(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const _m=M({conv2d_:gW});function yW(t,e,n,r,s="NWC",o=1,i){const a=$(t,"x","conv1d"),l=$(e,"filter","conv1d");let u=a,c=!1;a.rank===2&&(c=!0,u=ae(a,[1,a.shape[0],a.shape[1]])),D(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),D(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),$s("conv1d",r,i),D(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),D($r(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),D(Ya(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),D(Ya(n),()=>"Error in conv1D: Stride should be larger than 0."),D(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const d=ae(l,[1,l.shape[0],l.shape[1],l.shape[2]]),f=ae(u,[u.shape[0],1,u.shape[1],u.shape[2]]),v=_m(f,d,[1,n],r,"NHWC",[1,o],i);return c?ae(v,[v.shape[2],v.shape[3]]):ae(v,[v.shape[0],v.shape[2],v.shape[3]])}const vW=M({conv1d_:yW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xW(t,e,n,r,s,o="NHWC",i){D(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,u=!1;e.rank===3&&(u=!0,l=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),D(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),D(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),D(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const c=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?l.shape[3]:l.shape[1];D(c===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[2]}.`),D(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),$s("conv2dDerInput",s,i);const f={dy:l,filter:n},h={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,inputShape:a},p=z.runKernel(W$,f,h);return u?ae(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const qO=M({conv2DBackpropInput_:xW});function bW(t,e,n,r,s,o){const i=$(t,"x","conv2dTranspose"),a=$(e,"filter","conv2dTranspose");return qO(n,i,a,r,s,"NHWC",o)}const wW=M({conv2dTranspose_:bW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SW(t,e,n,r,s="NDHWC",o=[1,1,1]){const i=$(t,"x","conv3d"),a=$(e,"filter","conv3d");let l=i,u=!1;i.rank===4&&(u=!0,l=ae(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),D(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),D(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),D($r(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),D(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`),D(Ya(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),D(Ya(n),()=>"Error in conv3D: Strides should be larger than 0.");const c={x:l,filter:a},d={strides:n,pad:r,dataFormat:s,dilations:o},f=z.runKernel(V$,c,d);return u?ae(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const CW=M({conv3d_:SW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _W(t,e,n,r,s){D(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,i=e,a=!1;e.rank===4&&(a=!0,i=ae(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],u=i.shape[4];D(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),D(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),D(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),D(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),D(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const c={dy:i,filter:n},d={pad:s,strides:r,inputShape:o},f=z.runKernel(G$,c,d);return a?ae(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const EW=M({conv3DBackpropInput_:_W});function TW(t,e,n,r,s){const o=$(t,"x","conv3dTranspose"),i=$(e,"filter","conv3dTranspose");return EW(n,o,i,r,s)}const NW=M({conv3dTranspose_:TW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $W(t){const n={x:$(t,"x","cos","float32")};return z.runKernel(H$,n)}const kW=M({cos_:$W});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IW(t){const n={x:$(t,"x","cosh","float32")};return z.runKernel(q$,n)}const OW=M({cosh_:IW});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RW(t,e=0,n=!1,r=!1){const o={x:$(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:r};return z.runKernel(K$,o,i)}const DW=M({cumprod_:RW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AW(t,e=0,n=!1,r=!1){const o={x:$(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:r};return z.runKernel(X$,o,i)}const PW=M({cumsum_:AW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(t,e,n,r=!1){const s=$(t,"x","denseBincount"),o=$(e,"weights","denseBincount");D(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),D(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),D(n>=0,()=>`size must be non-negative, but got ${n}.`),D(o.size===s.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${o.shape}.`);const i={x:s,weights:o},a={size:n,binaryOutput:r};return z.runKernel(Q$,i,a)}const FW=M({denseBincount_:LW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MW(t,e,n="NHWC"){const r=$(t,"x","depthToSpace","float32"),s=n==="NHWC"?r.shape[1]:r.shape[2],o=n==="NHWC"?r.shape[2]:r.shape[3],i=n==="NHWC"?r.shape[3]:r.shape[1];D(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),D(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),D(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${r.shape}`),D(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${r.shape}`);const a={x:r},l={blockSize:e,dataFormat:n};return z.runKernel(Z$,a,l)}const jW=M({depthToSpace_:MW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BW(t,e,n,r,s="NHWC",o=[1,1],i){const a=$(t,"x","depthwiseConv2d","float32"),l=$(e,"filter","depthwiseConv2d","float32");let u=a,c=!1;a.rank===3&&(c=!0,u=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),D(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=s==="NHWC"?u.shape[3]:u.shape[1];D(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),$s("depthwiseConv2d",r,i);const f={x:u,filter:l},h={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},p=z.runKernel(J$,f,h);return c?ae(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const mx=M({depthwiseConv2d_:BW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(t){const n={x:$(t,"x","diag")};return z.runKernel(nk,n)}const zW=M({diag_:UW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WW(t,e,n,r,s=[1,1],o="NHWC"){const i=$(t,"x","dilation2d"),a=$(e,"filter","dilation2d");D(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),D(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),D(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,u=!1;i.rank===3&&(l=ae(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0),D(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const c={x:l,filter:a},d={strides:n,pad:r,dilations:s},f=z.runKernel(rk,c,d);return u?ae(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const VW=M({dilation2d_:WW});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mp(t,e){const n=t.length,r=[];for(let s=0;s<n;s++){const o=n-1-s,i=t[o]||1;(e[e.length-1-s]||1)>1&&i===1&&r.unshift(o)}return r}function KO(t,e){const n=[];for(let r=0;r<e.length;r++){const s=t[t.length-r-1],o=e.length-r-1,i=e[o];(s==null||s===1&&i>1)&&n.unshift(o)}return n}function nt(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let s=0;s<n;s++){let o=t[t.length-s-1];o==null&&(o=1);let i=e[e.length-s-1];if(i==null&&(i=1),o===1)r[n-s-1]=i;else if(i===1)r[n-s-1]=o;else if(o!==i){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else r[n-s-1]=o}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GW(t,e){let n=$(t,"a","equal","string_or_numeric"),r=$(e,"b","equal","string_or_numeric");[n,r]=Ut(n,r),nt(n.shape,r.shape);const s={a:n,b:r};return z.runKernel(lk,s)}const XO=M({equal_:GW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HW(t,e,n){const r=$(e,"a","where"),s=$(n,"b","where"),o=$(t,"condition","where","bool"),i=nt(nt(o.shape,r.shape),s.shape),a=Kc(o,i),l=Kc(r,i),u=Kc(s,i),c={condition:a,t:l,e:u};return z.runKernel(_I,c)}const Vi=M({where_:HW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qW(t){const n={x:$(t,"x","zerosLike")};return z.runKernel(nO,n)}const Vr=M({zerosLike_:qW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(t,e){let n=$(t,"a","div"),r=$(e,"b","div");[n,r]=Ut(n,r);const s=st(n,r),o=Vr(s),i=XO(r,o);return Vi(i,o,s)}const XW=M({divNoNan_:KW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YW(t,e){const n=$(t,"t1","dot"),r=$(e,"t2","dot");D((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const s=n.rank===1?n.size:n.shape[1],o=r.rank===1?r.size:r.shape[0];if(D(s===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${o}.`),n.rank===1&&r.rank===1){const i=ae(n,[1,-1]),a=ae(r,[-1,1]),l=ht(i,a);return ae(l,[])}else if(n.rank===1&&r.rank===2){const i=ae(n,[1,-1]),a=ae(r,[r.shape[0],r.shape[1]]),l=ht(i,a);return ae(l,[l.size])}else if(n.rank===2&&r.rank===1){const i=ae(r,[-1,1]),a=ht(n,i);return ae(a,[a.size])}else{const i=ae(r,[r.shape[0],r.shape[1]]);return ht(n,i)}}const QW=M({dot_:YW});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(t,...e){const n=e.map((s,o)=>$(s,`tensors${o}`,"einsum")),r={equation:t};return z.runKernel(ok,n,r)}const Rl=M({einsum_:ZW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JW(t){const n={x:$(t,"x","elu","float32")};return z.runKernel(ik,n)}const YO=M({elu_:JW});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eV(t,e){const n=$(t,"x","ensureShape","string_or_numeric");if(!vU(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const tV=M({ensureShape_:eV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nV(t){let e=$(t,"x","erf");D(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=nn(e,"float32"));const n={x:e};return z.runKernel(ak,n)}const rV=M({erf_:nV});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gx(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function QO(t,e,n){const r=t.length+e.length,s=[];let o=0,i=0;for(let a=0;a<r;a++)n.indexOf(a)===-1?s.push(t[o++]):s.push(e[i++]);return s}function No(t,e){const n=[],r=t.length;for(let o=0;o<r;o++)e.indexOf(o)===-1&&n.push(t[o]);const s=e.map(o=>t[o]);return[n,s]}function es(t,e){const n=e.map(r=>1);return QO(t,n,e)}function lo(t,e,n){D(gx(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function ks(t,e){if(gx(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function yx(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Is(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sV(t,e=null,n=!1){const s={x:$(t,"x","max")},o={reductionIndices:e,keepDims:n};return z.runKernel(Fk,s,o)}const La=M({max_:sV});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oV(t,e=null,n=!1){const s={x:$(t,"x","min")},o={axis:e,keepDims:n};return z.runKernel(Wk,s,o)}const nv=M({min_:oV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iV(t,e){let n=$(t,"base","pow"),r=$(e,"exp","pow");[n,r]=Ut(n,r);const s={a:n,b:r};return z.runKernel(sI,s)}const _d=M({pow_:iV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ze(t,e){if((Es(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Es(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return la(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aV(t){const n={x:$(t,"x","sqrt","float32")};return z.runKernel(RI,n)}const Xo=M({sqrt_:aV});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lV(t){const e=$(t,"x","square"),n={};return z.runKernel("Square",{x:e},n)}const Ss=M({square_:lV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uV(t,e=null,n=!1){let r=$(t,"x","sum");r.dtype==="bool"&&(r=nn(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return z.runKernel(DI,s,o)}const St=M({sum_:uV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cV(t,e="euclidean",n=null,r=!1){t=$(t,"x","norm");const s=ZO(t,e,n);let o=s.shape;if(r){const i=gn(n,t.shape);o=es(s.shape,i)}return ae(s,o)}function ZO(t,e,n=null){if(t.rank===0)return jr(t);if(t.rank!==1&&n===null)return ZO(ae(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return St(jr(t),n);if(e===1/0)return La(jr(t),n);if(e===-1/0)return nv(jr(t),n);if(e==="euclidean"||e===2)return Xo(St(_d(jr(t),Ze(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return La(St(jr(t),n[0]),n[1]-1);if(e===1/0)return La(St(jr(t),n[1]),n[0]);if(e===-1/0)return nv(St(jr(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Xo(St(Ss(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Em=M({norm_:cV});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dV(t,e=null,n=!1){return Em(t,"euclidean",e,n)}const fV=M({euclideanNorm_:dV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hV(t){const n={x:$(t,"x","exp")};return z.runKernel(uk,n)}const Qa=M({exp_:hV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pV(t,e=0){const n=$(t,"x","expandDims","string_or_numeric");D(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},s={dim:e};return z.runKernel(ck,r,s)}const Br=M({expandDims_:pV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mV(t){const n={x:$(t,"x","expm1")};return z.runKernel(dk,n)}const gV=M({expm1_:mV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yV(t,e){const n=$(t,"x","tile","string_or_numeric");D(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},s={reps:e};return z.runKernel(lx,r,s)}const Xc=M({tile_:yV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vV(t,e,n,r="float32"){e==null&&(e=t);const s=Lt([t,e],r),o=t<=e?t:e;for(let a=0;a<o;++a)s.set(1,a,a);const i=ae(s.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return Xc(Br(i,0),[n[0],1,1]);if(n.length===2)return Xc(Br(Br(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return Xc(Br(Br(Br(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const JO=M({eye_:vV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xV(t){const n={x:$(t,"x","floor","float32")};return z.runKernel(mk,n)}const eR=M({floor_:xV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bV(t,e,n=0,r=0){const s=$(t,"x","gather"),o=$(e,"indices","gather","int32"),i={x:s,indices:o},a={axis:n,batchDims:r};return z.runKernel(vk,i,a)}const vx=M({gather_:bV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wV(t,e){let n=$(t,"a","greater","string_or_numeric"),r=$(e,"b","greater","string_or_numeric");[n,r]=Ut(n,r),nt(n.shape,r.shape);const s={a:n,b:r};return z.runKernel(bk,s)}const Tm=M({greater_:wV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SV(t,e){let n=$(t,"a","greaterEqual","string_or_numeric"),r=$(e,"b","greaterEqual","string_or_numeric");[n,r]=Ut(n,r),nt(n.shape,r.shape);const s={a:n,b:r};return z.runKernel(wk,s)}const tR=M({greaterEqual_:SV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CV(t){const n={input:$(t,"input","imag")};return z.runKernel(Ck,n)}const Nm=M({imag_:CV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _V(t){const n={x:$(t,"x","isFinite")};return z.runKernel(_k,n)}const EV=M({isFinite_:_V});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TV(t){const n={x:$(t,"x","isInf")};return z.runKernel(Ek,n)}const NV=M({isInf_:TV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $V(t){const n={x:$(t,"x","isNaN")};return z.runKernel(Tk,n)}const kV=M({isNaN_:$V});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IV(t,e=.2){const r={x:$(t,"x","leakyRelu")},s={alpha:e};return z.runKernel(Nk,r,s)}const nR=M({leakyRelu_:IV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OV(t,e){let n=$(t,"a","less","string_or_numeric"),r=$(e,"b","less","string_or_numeric");[n,r]=Ut(n,r),nt(n.shape,r.shape);const s={a:n,b:r};return z.runKernel($k,s)}const rv=M({less_:OV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RV(t,e){let n=$(t,"a","lessEqual","string_or_numeric"),r=$(e,"b","lessEqual","string_or_numeric");[n,r]=Ut(n,r),nt(n.shape,r.shape);const s={a:n,b:r};return z.runKernel(kk,s)}const xx=M({lessEqual_:RV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DV(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return z.runKernel(Ik,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AV(t,e=5,n=1,r=1,s=.5){const o=$(t,"x","localResponseNormalization");D(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),D(vu(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=ae(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},u={depthRadius:e,bias:n,alpha:r,beta:s},c=z.runKernel(Lk,l,u);return a?ae(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const PV=M({localResponseNormalization_:AV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LV(t){const n={x:$(t,"x","log","float32")};return z.runKernel(Ok,n)}const Ed=M({log_:LV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FV(t){const n={x:$(t,"x","log1p")};return z.runKernel(Rk,n)}const rR=M({log1p_:FV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MV(t,e){D(P0(t),()=>"The f passed in variableGrads(f) must be a function"),D(e==null||Array.isArray(e)&&e.every(u=>u instanceof hp),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in z.registeredVariables)e.push(z.registeredVariables[u])}const r=n?e.filter(u=>!u.trainable):null,s=e.length;e=e.filter(u=>u.trainable),D(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${s} variables is trainable.`);const o=!0,{value:i,grads:a}=z.gradients(t,e,null,o);D(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),D(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((u,c)=>{a[c]!=null&&(l[u.name]=a[c])}),r!=null&&r.forEach(u=>l[u.name]=null),{value:i,grads:l}}function Yo(t){return z.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jV(t){const n={x:$(t,"x","neg")};return z.runKernel(Xk,n)}const Eo=M({neg_:jV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BV(t){const n={x:$(t,"x","softplus")};return z.runKernel(OI,n)}const sR=M({softplus_:BV});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UV(t){const e=$(t,"x","logSigmoid");return Yo(r=>({value:Eo(sR(Eo(r))),gradFunc:i=>he(i,au(Eo(r)))}))(e)}const zV=M({logSigmoid_:UV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WV(t,e){let n=$(t,"a","sub"),r=$(e,"b","sub");[n,r]=Ut(n,r);const s={a:n,b:r};return z.runKernel(KI,s)}const Oe=M({sub_:WV});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VV(t,e=-1){const n=$(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Yo((s,o)=>{const a=La(s,e,!0),l=Oe(s,a),u=Oe(nn(l,"float32"),Ed(St(Qa(l),e,!0)));return o([u]),{value:u,gradFunc:(d,f)=>{const[h]=f,p=!0,m=Qa(h);return Oe(d,he(St(d,e,p),m))}}})(n)}const GV=M({logSoftmax_:VV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HV(t,e=null,n=!1){const r=$(t,"x","logSumExp"),s=gn(e,r.shape),o=La(r,s,!0),i=Oe(r,o),a=Qa(i),l=St(a,s),u=Ed(l),c=ke(ae(o,u.shape),u);if(n){const d=es(c.shape,s);return ae(c,d)}return c}const oR=M({logSumExp_:HV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qV(t,e){const n=$(t,"a","logicalAnd","bool"),r=$(e,"b","logicalAnd","bool");nt(n.shape,r.shape);const s={a:n,b:r};return z.runKernel(Dk,s)}const gp=M({logicalAnd_:qV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KV(t){const n={x:$(t,"x","logicalNot","bool")};return z.runKernel(Ak,n)}const iR=M({logicalNot_:KV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XV(t,e){const n=$(t,"a","logicalOr","bool"),r=$(e,"b","logicalOr","bool");nt(n.shape,r.shape);const s={a:n,b:r};return z.runKernel(Pk,s)}const aR=M({logicalOr_:XV});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YV(t,e){const n=$(t,"a","logicalXor","bool"),r=$(e,"b","logicalXor","bool");return nt(n.shape,r.shape),gp(aR(t,e),iR(gp(t,e)))}const QV=M({logicalXor_:YV});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ff=2147483648;function ZV(t,e,n="left"){const r=$(t,"sortedSequence","searchSorted"),s=$(e,"values","searchSorted"),o=r.shape[r.shape.length-1],i=s.shape[s.shape.length-1],a=ae(r,[-1,o]),l=ae(s,[-1,i]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(pe(l.shape)>=Ff)throw new Error(`values tensor size must less than ${Ff}`);if(a.shape[1]>=Ff)throw new Error(`trailing dim_size must less than ${Ff} for int32 output type, was ${a.shape[1]}`);const u={sortedSequence:a,values:l},c={side:n};return z.runKernel(CI,u,c)}const bx=M({searchSorted_:ZV});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JV(t,e){return bx(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e6(t,e,n,r,s){const o=$(t,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=ae(o,[1,o.shape[0],o.shape[1],o.shape[2]])),D(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),D($r(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),$s("maxPool",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s},d=z.runKernel(jk,u,c);return l?ae(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const lR=M({maxPool_:e6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t6(t,e=[1,1,1],n,r,s,o="NDHWC"){const i=$(t,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=ae(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),D(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),D(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),$s("maxPool3d",r,s);const u={x:a},c={filterSize:e,strides:n,pad:r,dimRoundingMode:s,dataFormat:o},d=z.runKernel(Bk,u,c);return l?ae(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const n6=M({maxPool3d_:t6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r6(t,e,n,r,s=!1){const i={x:$(t,"x","maxPoolWithArgmax")},a={filterSize:e,strides:n,pad:r,includeBatchInIndex:s},l=z.runKernel(Uk,i,a);return{result:l[0],indexes:l[1]}}const s6=M({maxPoolWithArgmax_:r6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o6(t,e){let n=$(t,"a","maximum"),r=$(e,"b","maximum");[n,r]=Ut(n,r),n.dtype==="bool"&&(n=nn(n,"int32"),r=nn(r,"int32")),nt(n.shape,r.shape);const s={a:n,b:r};return z.runKernel(Mk,s)}const uR=M({maximum_:o6});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i6(t,e=null,n=!1){const s={x:$(t,"x","mean")},o={axis:e,keepDims:n};return z.runKernel(zk,s,o)}const yp=M({mean_:i6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ta(t,e="float32"){if(Zr(t),e==="complex64"){const r=ta(t,"float32"),s=ta(t,"float32");return Ji(r,s)}const n=Zi(pe(t),e);return z.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ra(t,e="float32"){if(Zr(t),e==="complex64"){const r=Ra(t,"float32"),s=ta(t,"float32");return Ji(r,s)}const n=h$(pe(t),e);return z.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a6(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=$(t,"x","meshgrid",t instanceof Yn?t.dtype:"float32");if(e===void 0)return[r];let s=$(e,"y","meshgrid",e instanceof Yn?e.dtype:"float32");const o=pe(r.shape),i=pe(s.shape);return n==="xy"?(r=ae(r,[1,-1]),s=ae(s,[-1,1]),[ht(Ra([i,1],r.dtype),r),ht(s,Ra([1,o],s.dtype))]):(r=ae(r,[-1,1]),s=ae(s,[1,-1]),[ht(r,Ra([1,i],r.dtype)),ht(Ra([o,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l6(t,e){let n=$(t,"a","minimum"),r=$(e,"b","minimum");[n,r]=Ut(n,r),n.dtype==="bool"&&(n=nn(n,"int32"),r=nn(r,"int32")),nt(n.shape,r.shape);const s={a:n,b:r};return z.runKernel(Vk,s)}const vp=M({minimum_:l6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u6(t,e,n){D(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=$(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");D(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=n==="reflect"?1:0;for(let a=0;a<r.rank;a++)D(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),D(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const o={paddings:e,mode:n},i={x:r};return z.runKernel(Gk,i,o)}const c6=M({mirrorPad_:u6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d6(t,e){let n=$(t,"a","mod"),r=$(e,"b","mod");[n,r]=Ut(n,r);const s={a:n,b:r};return z.runKernel(Hk,s)}const f6=M({mod_:d6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h6(t,e=null,n=!1){t=$(t,"x","moments");const r=gn(e,t.shape),s=yp(t,r,n);let o=s.shape;n||(o=es(s.shape,r));const i=Ss(Oe(nn(t,"float32"),ae(s,o))),a=yp(i,r,n);return{mean:s,variance:a}}const p6=M({moments_:h6});function m6(t,e,n,r){const s=$(e,"data","multiRNNCell"),o=pp(n,"c","multiRNNCell"),i=pp(r,"h","multiRNNCell");let a=s;const l=[];for(let d=0;d<t.length;d++){const f=t[d](a,o[d],i[d]);l.push(f[0]),l.push(f[1]),a=f[1]}const u=[],c=[];for(let d=0;d<l.length;d+=2)u.push(l[d]),c.push(l[d+1]);return[u,c]}const g6=M({multiRNNCell_:m6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y6(t,e,n,r=!1){const s=$(t,"logits","multinomial"),o=s.size,i=s.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);n=n||Math.random();const l={logits:i===1?ae(s,[1,-1]):s},u={numSamples:e,seed:n,normalized:r},c=z.runKernel(qk,l,u);return i===1?ae(c,[c.size]):c}const v6=M({multinomial_:y6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x6(t,e){let n=$(t,"a","notEqual","string_or_numeric"),r=$(e,"b","notEqual","string_or_numeric");[n,r]=Ut(n,r),nt(n.shape,r.shape);const s={a:n,b:r};return z.runKernel(Yk,s)}const cR=M({notEqual_:x6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b6(t,e,n=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:$(t,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:n,offValue:r};return z.runKernel(tI,i,a)}const w6=M({oneHot_:b6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S6(t){const n={x:$(t,"x","onesLike")};return z.runKernel(eI,n)}const C6=M({onesLike_:S6});function _6(t,e){const n=$(t,"v1","outerProduct"),r=$(e,"v2","outerProduct");D(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const s=ae(n,[-1,1]),o=ae(r,[1,-1]);return ht(s,o)}const E6=M({outerProduct_:_6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(t,e,n=0){const r=$(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:n},o={x:r};return z.runKernel(rI,o,s)}const Fu=M({pad_:T6});function N6(t,e,n=0){return D(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Fu(t,[e],n)}const $6=M({pad1d_:N6});function k6(t,e,n=0){return D(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Fu(t,e,n)}const I6=M({pad2d_:k6});function O6(t,e,n=0){return D(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Fu(t,e,n)}const R6=M({pad3d_:O6});function D6(t,e,n=0){return D(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Fu(t,e,n)}const A6=M({pad4d_:D6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P6(t,e,n){const r=$(t,"x","spaceToBatchND");D(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),D(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),D(r.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},o={blockShape:e,paddings:n};return z.runKernel(AI,s,o)}const dR=M({spaceToBatchND_:P6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L6(t,e,n,r,s,o,i){s==null&&(s=[1,1]),o==null&&(o=1),r===0&&(r="valid");const a=$(t,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),D($r(o,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${s}'`);const c=ul(l.shape,e,o,s,r),d=[c.dilationHeight,c.dilationWidth];let f;r==="same"?f=M6([c.filterHeight,c.filterWidth],d):f=[[0,0],[0,0]];const h=d[0]===1&&d[1]===1,[p,m]=F6([c.inHeight,c.inWidth],d,f),v=h?r:"valid",g=h?l:dR(l,d,p),b=(n==="avg"?()=>WO(g,e,o,v,i):()=>lR(g,e,o,v,i))(),_=h?b:VO(b,d,m);return u?ae(_,[_.shape[1],_.shape[2],_.shape[3]]):_}function F6(t,e,n){const r=n.map(c=>c[0]),s=n.map(c=>c[1]),o=t.concat(r,s),i=e.map((c,d)=>(c-o[d]%c)%c),a=s.map((c,d)=>c+i[d]),l=e.map((c,d)=>[r[d],a[d]]),u=e.map((c,d)=>[0,i[d]]);return[l,u]}function M6(t,e){const r=t.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),s=r.map(i=>Math.floor(i/2)),o=r.map((i,a)=>i-s[a]);return r.map((i,a)=>[s[a],o[a]])}const j6=M({pool_:L6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B6(t,e){const n=$(t,"x","prelu"),r=$(e,"alpha","prelu"),s={x:n,alpha:r};return z.runKernel(oI,s)}const fR=M({prelu_:B6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(t,e=null,n=!1){let r=$(t,"x","prod");r.dtype==="bool"&&(r=nn(r,"int32"));const s={x:r},o={axis:e,keepDims:n};return z.runKernel(iI,s,o)}const z6=M({prod_:U6});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(t,e,n,r){const s=t.map((c,d)=>$(c,`tensors${d}`,"raggedGather","int32")),o=$(e,"paramsDenseValues","raggedGather"),i=$(n,"indices","raggedGather","int32"),a={paramsNestedSplits:s,paramsDenseValues:o,indices:i},l={outputRaggedRank:r},u=z.runKernel(aI,a,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const V6=M({raggedGather_:W6});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G6(t,e,n){const r=$(t,"starts","raggedRange"),s=$(e,"limits","raggedRange",r.dtype),o=$(n,"deltas","raggedRange",r.dtype),i={starts:r,limits:s,deltas:o},a=z.runKernel(lI,i);return{rtNestedSplits:a[0],rtDenseValues:a[1]}}const H6=M({raggedRange_:G6});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q6(t,e,n,r,s){const o=$(t,"shape","raggedTensorToTensor","int32"),i=$(e,"values","raggedTensorToTensor"),a=$(n,"defaultValue","raggedTensorToTensor",i.dtype),l=r.map((d,f)=>$(d,`tensors${f}`,"raggedTensorToTensor","int32")),u={shape:o,values:i,defaultValue:a,rowPartitionTensors:l},c={rowPartitionTypes:s};return z.runKernel(uI,u,c)}const K6=M({raggedTensorToTensor_:q6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(t,e,n){Zr(t);const r=pe(t);let s=null;if(n==null||n==="float32")s=new Float32Array(r);else if(n==="int32")s=new Int32Array(r);else if(n==="bool")s=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let o=0;o<r;o++)s[o]=e();return z.makeTensor(s,t,n)}const Y6=M({rand_:X6});var wx={exports:{}};wx.exports;(function(t){(function(e,n,r){function s(l){var u=this,c=a();u.next=function(){var d=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=d-(u.c=d|0)},u.c=1,u.s0=c(" "),u.s1=c(" "),u.s2=c(" "),u.s0-=c(l),u.s0<0&&(u.s0+=1),u.s1-=c(l),u.s1<0&&(u.s1+=1),u.s2-=c(l),u.s2<0&&(u.s2+=1),c=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function i(l,u){var c=new s(l),d=u&&u.state,f=c.next;return f.int32=function(){return c.next()*4294967296|0},f.double=function(){return f()+(f()*2097152|0)*11102230246251565e-32},f.quick=f,d&&(typeof d=="object"&&o(d,c),f.state=function(){return o(c,{})}),f}function a(){var l=4022871197,u=function(c){c=String(c);for(var d=0;d<c.length;d++){l+=c.charCodeAt(d);var f=.02519603282416938*l;l=f>>>0,f-=l,f*=l,l=f>>>0,f-=l,l+=f*4294967296}return(l>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.alea=i})(Cn,t,!1)})(wx);var Q6=wx.exports,Sx={exports:{}};Sx.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xor128=i})(Cn,t,!1)})(Sx);var Z6=Sx.exports,Cx={exports:{}};Cx.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var c=0;c<u.length+64;c++)l.x^=u.charCodeAt(c)|0,c==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xorwow=i})(Cn,t,!1)})(Cx);var J6=Cx.exports,_x={exports:{}};_x.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.x,d=l.i,f,h;return f=c[d],f^=f>>>7,h=f^f<<24,f=c[d+1&7],h^=f^f>>>10,f=c[d+3&7],h^=f^f>>>3,f=c[d+4&7],h^=f^f<<7,f=c[d+7&7],f=f^f<<13,h^=f^f<<9,c[d]=h,l.i=d+1&7,h};function u(c,d){var f,h=[];if(d===(d|0))h[0]=d;else for(d=""+d,f=0;f<d.length;++f)h[f&7]=h[f&7]<<15^d.charCodeAt(f)+h[f+1&7]<<13;for(;h.length<8;)h.push(0);for(f=0;f<8&&h[f]===0;++f);for(f==8?h[7]=-1:h[f],c.x=h,c.i=0,f=256;f>0;--f)c.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(c.x&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xorshift7=i})(Cn,t,!1)})(_x);var eG=_x.exports,Ex={exports:{}};Ex.exports;(function(t){(function(e,n,r){function s(a){var l=this;l.next=function(){var c=l.w,d=l.X,f=l.i,h,p;return l.w=c=c+1640531527|0,p=d[f+34&127],h=d[f=f+1&127],p^=p<<13,h^=h<<17,p^=p>>>15,h^=h>>>12,p=d[f]=p^h,l.i=f,p+(c^c>>>16)|0};function u(c,d){var f,h,p,m,v,g=[],x=128;for(d===(d|0)?(h=d,d=null):(d=d+"\0",h=0,x=Math.max(x,d.length)),p=0,m=-32;m<x;++m)d&&(h^=d.charCodeAt((m+32)%d.length)),m===0&&(v=h),h^=h<<10,h^=h>>>15,h^=h<<4,h^=h>>>13,m>=0&&(v=v+1640531527|0,f=g[m&127]^=h+v,p=f==0?p+1:0);for(p>=128&&(g[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)h=g[p+34&127],f=g[p=p+1&127],h^=h<<13,f^=f<<17,h^=h>>>15,f^=f>>>12,g[p]=h^f;c.w=v,c.X=g,c.i=p}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(c.X&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.xor4096=i})(Cn,t,!1)})(Ex);var tG=Ex.exports,Tx={exports:{}};Tx.exports;(function(t){(function(e,n,r){function s(a){var l=this,u="";l.next=function(){var d=l.b,f=l.c,h=l.d,p=l.a;return d=d<<25^d>>>7^f,f=f-h|0,h=h<<24^h>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^f,l.c=f=f-h|0,l.d=h<<16^f>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var c=0;c<u.length+20;c++)l.b^=u.charCodeAt(c)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var u=new s(a),c=l&&l.state,d=function(){return(u.next()>>>0)/4294967296};return d.double=function(){do var f=u.next()>>>11,h=(u.next()>>>0)/4294967296,p=(f+h)/(1<<21);while(p===0);return p},d.int32=u.next,d.quick=d,c&&(typeof c=="object"&&o(c,u),d.state=function(){return o(u,{})}),d}n&&n.exports?n.exports=i:r&&r.amd?r(function(){return i}):this.tychei=i})(Cn,t,!1)})(Tx);var nG=Tx.exports,hR={exports:{}};const rG={},sG=Object.freeze(Object.defineProperty({__proto__:null,default:rG},Symbol.toStringTag,{value:"Module"})),oG=rT(sG);(function(t){(function(e,n,r){var s=256,o=6,i=52,a="random",l=r.pow(s,o),u=r.pow(2,i),c=u*2,d=s-1,f;function h(_,N,E){var R=[];N=N==!0?{entropy:!0}:N||{};var P=g(v(N.entropy?[_,b(n)]:_??x(),3),R),B=new p(R),F=function(){for(var H=B.g(o),ee=l,oe=0;H<u;)H=(H+oe)*s,ee*=s,oe=B.g(1);for(;H>=c;)H/=2,ee/=2,oe>>>=1;return(H+oe)/ee};return F.int32=function(){return B.g(4)|0},F.quick=function(){return B.g(4)/4294967296},F.double=F,g(b(B.S),n),(N.pass||E||function(H,ee,oe,de){return de&&(de.S&&m(de,B),H.state=function(){return m(B,{})}),oe?(r[a]=H,ee):H})(F,P,"global"in N?N.global:this==r,N.state)}function p(_){var N,E=_.length,R=this,P=0,B=R.i=R.j=0,F=R.S=[];for(E||(_=[E++]);P<s;)F[P]=P++;for(P=0;P<s;P++)F[P]=F[B=d&B+_[P%E]+(N=F[P])],F[B]=N;(R.g=function(H){for(var ee,oe=0,de=R.i,V=R.j,W=R.S;H--;)ee=W[de=d&de+1],oe=oe*s+W[d&(W[de]=W[V=d&V+ee])+(W[V]=ee)];return R.i=de,R.j=V,oe})(s)}function m(_,N){return N.i=_.i,N.j=_.j,N.S=_.S.slice(),N}function v(_,N){var E=[],R=typeof _,P;if(N&&R=="object")for(P in _)try{E.push(v(_[P],N-1))}catch{}return E.length?E:R=="string"?_:_+"\0"}function g(_,N){for(var E=_+"",R,P=0;P<E.length;)N[d&P]=d&(R^=N[d&P]*19)+E.charCodeAt(P++);return b(N)}function x(){try{var _;return f&&(_=f.randomBytes)?_=_(s):(_=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(_)),b(_)}catch{var N=e.navigator,E=N&&N.plugins;return[+new Date,e,E,e.screen,b(n)]}}function b(_){return String.fromCharCode.apply(0,_)}if(g(r.random(),n),t.exports){t.exports=h;try{f=oG}catch{}}else r["seed"+a]=h})(typeof self<"u"?self:Cn,[],Math)})(hR);var iG=hR.exports,aG=Q6,lG=Z6,uG=J6,cG=eG,dG=tG,fG=nG,cl=iG;cl.alea=aG;cl.xor128=lG;cl.xorwow=uG;cl.xorshift7=cG;cl.xor4096=dG;cl.tychei=fG;var Nx=cl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $x{constructor(e,n,r,s,o){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=Nx.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,n,r=!1;for(;!r;){let s,o,i;do s=2*this.random()-1,o=2*this.random()-1,i=s*s+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*s*a,n=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class hG{constructor(e,n,r,s){this.alpha=e,this.beta=1/n,this.dtype=r;const o=s||Math.random();this.randu=Nx.alea(o.toString()),this.randn=new $x(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,s,o,i;for(;;){do s=this.randn.nextValue(),i=1+this.c*s;while(i<=0);if(i*=i*i,e=s*s,n=1-.331*e*e,r=.5*e+this.d*(1-i+Math.log(i)),o=this.randu(),o<n||Math.log(o)<r)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class pG{constructor(e=0,n=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=Nx.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mG(t,e,n=1,r="float32",s){if(Zr(t),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const o=new hG(e,n,r,s),i=Lt(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const gG=M({randomGamma_:mG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yG(t,e=0,n=1,r,s){if(Zr(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const o=new $x(e,n,r,!1,s),i=Lt(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const pR=M({randomNormal_:yG});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return pR(t,0,1,e,n)}const xG=M({randomStandardNormal_:vG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bG(t,e=0,n=1,r="float32",s){Zr(t);const o=Lt(t,r),i=new pG(e,n,null,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const kx=M({randomUniform_:bG});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(t,e,n,r){return kx(t,e,n,"int32",r)}const SG=M({randomUniformInt_:wG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Td(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const s={start:t,stop:e,step:n,dtype:r};return z.runKernel(cI,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CG(t){const n={input:$(t,"input","real")};return z.runKernel(dI,n)}const Nd=M({real_:CG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _G(t){const n={x:$(t,"x","reciprocal")};return z.runKernel(fI,n)}const EG=M({reciprocal_:_G});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TG(t){const n={x:$(t,"x","relu")};return z.runKernel(hI,n)}const $m=M({relu_:TG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NG(t){const n={x:$(t,"x","relu6")};return z.runKernel(yI,n)}const mR=M({relu6_:NG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(t,e){const r={x:$(t,"x","reverse")},s={dims:e};return z.runKernel(vI,r,s)}const Za=M({reverse_:$G});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kG(t){const e=$(t,"x","reverse");return D(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Za(e,0)}const IG=M({reverse1d_:kG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OG(t,e){const n=$(t,"x","reverse");return D(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Za(n,e)}const RG=M({reverse2d_:OG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DG(t,e){const n=$(t,"x","reverse");return D(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Za(n,e)}const AG=M({reverse3d_:DG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PG(t,e){const n=$(t,"x","reverse");return D(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Za(n,e)}const LG=M({reverse4d_:PG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FG(t){const n={x:$(t,"x","round")};return z.runKernel(xI,n)}const gR=M({round_:FG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MG(t){const n={x:$(t,"x","rsqrt","float32")};return z.runKernel(bI,n)}const jG=M({rsqrt_:MG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BG(t){const n={x:$(t,"x","selu")};return z.runKernel(EI,n)}const UG=M({selu_:BG});function zG(t,e,n,r,s,o=[1,1],i="NHWC"){const a=$(t,"x","separableConv2d"),l=$(e,"depthwiseFilter","separableConv2d"),u=$(n,"pointwiseFilter","separableConv2d");let c=a,d=!1;if(a.rank===3&&(d=!0,c=ae(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");D(c.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${c.rank}.`),D(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),D(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),D(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),D(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const f=l.shape[2],h=l.shape[3];D(u.shape[2]===f*h,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${f*h}, but got ${u.shape[2]}.`);const p=mx(c,l,r,s,i,o),v=_m(p,u,1,"valid",i);return d?ae(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const WG=M({separableConv2d_:zG});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function VG(t,e){const n=$(t,"x","setdiff1d"),r=$(e,"y","setdiff1d");D(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),D(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),D(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await n.data(),o=await r.data(),i=new Set(o);let a=0;for(let c=0;c<s.length;c++)i.has(s[c])||a++;const l=new wu([a],n.dtype),u=new wu([a],"int32");for(let c=0,d=0;c<s.length;c++)i.has(s[c])||(l.values[d]=s[c],u.values[d]=c,d++);return[l.toTensor(),u.toTensor()]}const GG=VG;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HG(t){const n={x:$(t,"x","sign")};return z.runKernel(kI,n)}const qG=M({sign_:HG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KG(t){const n={x:$(t,"x","sin","float32")};return z.runKernel(NI,n)}const XG=M({sin_:KG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YG(t){const n={x:$(t,"x","sinh")};return z.runKernel($I,n)}const QG=M({sinh_:YG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZG(t,e,n){const r=$(t,"x","slice1d");return D(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Le(r,[e],[n])}const JG=M({slice1d_:ZG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eH(t,e,n){const r=$(t,"x","slice2d");return D(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Le(r,e,n)}const tH=M({slice2d_:eH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nH(t,e,n){const r=$(t,"x","slice3d");return D(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Le(r,e,n)}const rH=M({slice3d_:nH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sH(t,e,n){const r=$(t,"x","slice4d");return D(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Le(r,e,n)}const oH=M({slice4d_:sH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iH(t,e=-1){const n=$(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},s={dim:e};return z.runKernel(LI,r,s)}const aH=M({softmax_:iH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lH(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return z.runKernel(fk,e)}const Ix=M({fft_:lH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uH(t){D(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return z.runKernel(Sk,e)}const xp=M({ifft_:uH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cH(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const s=ae(t,[n,e]);r=xp(s)}else{const s=[n,2*(e-1)],o=ae(Nd(t),[n,e]),i=ae(Nm(t),[n,e]),a=Za(Le(o,[0,1],[n,e-2]),1),l=he(Za(Le(i,[0,1],[n,e-2]),1),Ze(-1)),u=cn([o,a],1),c=cn([i,l],1),d=ae(Ji(u,c),[s[0],s[1]]);r=xp(d)}if(r=Nd(r),t.rank===3&&t.shape[0]!==0){const s=r,o=t.shape[0];r=ae(r,[o,r.shape[0]/o,r.shape[1]]),s.dispose()}return r}const yR=M({irfft_:cH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dH(t,e,n=0){const s={x:$(t,"x","split")},o={numOrSizeSplits:e,axis:n};return z.runKernel(PI,s,o)}const $d=M({split_:dH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fH(t,e){D(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let s;if(e!=null&&e<n){const p=t.shape.map(v=>0),m=t.shape.map(v=>v);m[t.shape.length-1]=e,s=Le(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,s=cn([t,ta(p)],t.shape.length-1),n=e}else s=t;const o=Vr(s),i=ae(Ji(s,o),[r,n]),a=Ix(i),l=Math.floor(n/2)+1,u=Nd(a),c=Nm(a),d=$d(u,[l,n-l],u.shape.length-1),f=$d(c,[l,n-l],c.shape.length-1),h=s.shape.slice();return h[s.shape.length-1]=l,ae(Ji(d[0],f[0]),h)}const Ox=M({rfft_:fH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hH(t,e){let n=$(t,"a","squaredDifference"),r=$(e,"b","squaredDifference");[n,r]=Ut(n,r),nt(n.shape,r.shape);const s={a:n,b:r},o={};return z.runKernel(zI,s,o)}const vR=M({squaredDifference_:hH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pH(t,e){const n=$(t,"x","squeeze","string_or_numeric");return ae(n,ia(n.shape,e).newShape)}const Gi=M({squeeze_:pH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mH(t,e=0){const n=pp(t,"tensors","stack","string_or_numeric");D(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&D(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,s={axis:e};return z.runKernel(nI,r,s)}const Qo=M({stack_:mH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gH(t,e=0){const r={x:$(t,"x","step")},s={alpha:e};return z.runKernel(rO,r,s)}const xR=M({step_:gH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yH(t,e,n,r,s=0,o=0,i=0,a=0,l=0){const c={x:$(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return z.runKernel(VI,c,d)}const vH=M({stridedSlice_:yH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xH(t){const n={x:$(t,"x","tan","float32")};return z.runKernel(XI,n)}const bH=M({tan_:xH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xs(t,e){Au(t);const n=aa(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return la(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lu(t,e,n){if(Au(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=aa(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return la(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bR(t,e,n){if(Au(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=aa(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return la(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wH(t,e,n){if(Au(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=aa(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return la(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SH(t,e,n){if(Au(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=aa(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return la(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CH(t,e,n){if(Au(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=aa(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,la(t,e,r,n)}function wR(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${s}.`;if(n.rank<s)throw new Error(o+` update.rank < ${s}. `);if(t.length<r+(n.rank-s))throw new Error(o+` Output shape length < ${r+(n.rank-s)}`);if(n.rank!==s+t.length-r)throw new Error(o+` update.rank != ${s+t.length-r}`);for(let i=0;i<s;++i)if(n.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-s;++i)if(n.shape[i+s]!==t[i+r])throw new Error(o+` updates.shape[${i+s}] (${n.shape[i+s]}) != shape[${i+s}] (${t[i+s]})`)}function Rx(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}wR(n,e,t)}function km(t,e,n){const r=e.shape.length,s=r>1?e.shape[r-1]:1,o=n.length;let i=1;for(let d=s;d<o;++d)i*=n[d];const a=s<1?1:s,l=pe(e.shape)/a,u=[...$n(n.slice(0,s)),1],c=pe(n);return{sliceRank:s,numUpdates:l,sliceSize:i,strides:u,outputSize:c}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _H(t,e,n){const r=$(t,"tensor","tensorScatterupdate"),s=$(e,"indices","tensorScatterupdate","int32"),o=$(n,"updates","tensorScatterupdate");if(Rx(o,s,r.shape),r.dtype!==o.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${o.dtype}.`);const i={tensor:r,indices:s,updates:o},a={};return z.runKernel(SI,i,a)}const EH=M({tensorScatterUpdate_:_H});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TH(t,e=1,n=!0){const r=$(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const o={x:r},i={k:e,sorted:n},[a,l]=z.runKernel(QI,o,i);return{values:a,indices:l}}const NH=M({topk_:TH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $H(t,e=0,n=1,r,s){if(Zr(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new $x(e,n,r,!0,s),i=Lt(t,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const kH=M({truncatedNormal_:$H});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IH(t,e=0){const n=$(t,"x","unique","string_or_numeric");D(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},s={axis:e},[o,i]=z.runKernel(JI,r,s);return{values:o,indices:i}}const OH=M({unique_:IH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RH(t,e,n){const r=$(t,"x","unsortedSegmentSum"),s=$(e,"segmentIds","unsortedSegmentSum","int32");D(vu(n),()=>"numSegments must be of dtype int");const o={x:r,segmentIds:s},i={numSegments:n};return z.runKernel(tO,o,i)}const DH=M({unsortedSegmentSum_:RH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(t,e=0){const n=$(t,"x","unstack","string_or_numeric");D(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},s={axis:e};return z.runKernel(eO,r,s)}const dl=M({unstack_:AH});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PH(t,e){return bx(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LH(t,e=!0,n,r){return z.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SR(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const r=Lt(t,"int32"),s=Lt([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const i=r.indexToLoc(n[o]),a=o*t.length;s.values.set(i,a)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function FH(t){const e=$(t,"condition","whereAsync","bool"),n=await e.data(),r=SR(e.shape,n);return t!==e&&e.dispose(),r}const CR=FH;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function MH(t,e,n){const r=$(t,"tensor","boolMask"),s=$(e,"mask","boolMask","bool"),o=n??0,i=s.rank,a=r.shape;D(i>0,()=>"mask cannot be scalar"),Qr(a.slice(o,o+i),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let m=o;m<o+i;m++)l*=a[m];const u=a.slice(0,o).concat([l],a.slice(o+i)),c=ae(r,u),d=ae(s,[-1]),f=await CR(d),h=Gi(f,[1]),p=vx(c,h,o);return t!==r&&r.dispose(),e!==s&&s.dispose(),h.dispose(),c.dispose(),d.dispose(),f.dispose(),p}const jH=MH;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BH(t,e,n){const r=$(t,"x","transpose");if(e==null&&(e=r.shape.map((i,a)=>a).reverse()),D(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(i=>{D(i>=0&&i<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},o={perm:e};return r.dtype==="complex64"?Ke(()=>{let i=Nd(r),a=Nm(r);return i=z.runKernel(gh,{x:i},o),a=z.runKernel(gh,{x:a},o),n&&(a=Eo(a)),Ji(i,a)}):z.runKernel(gh,s,o)}const bp=M({transpose_:BH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UH(t,e,n,r,s=!0){const o=$(t,"v","movingAverage"),i=$(e,"x","movingAverage"),a=$(n,"decay","movingAverage");u5(o,i),D(Pt(o.shape,i.shape),()=>"Shape mismatch in v and x");const l=Ze(1),u=Oe(l,a);let c=he(Oe(i,o),u);if(s){D(r!=null,()=>"When using zeroDebias: true, step is required.");const d=$(r,"step","movingAverage");c=st(c,Oe(l,_d(a,d)))}return ke(o,c)}const zH=M({movingAverage_:UH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WH(t,e,n){Zr(n);const r=$(t,"indices","scatterND","int32"),s=$(e,"updates","scatterND");Rx(s,r,n);const o={indices:r,updates:s},i={shape:n};return z.runKernel(wI,o,i)}const VH=M({scatterND_:WH});function GH(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const s=t.rank>0?t.shape[0]:1,o=t.rank>1?t.shape[1]:1;if(n.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${o}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HH(t,e,n,r=0){Zr(n);const s=$(t,"sparseIndices","sparseToDense","int32"),o=$(e,"sparseValues","sparseToDense","string_or_numeric"),i=$(r,"defaultValue","sparseToDense",o.dtype);GH(s,o,n,i);const a={sparseIndices:s,sparseValues:o,defaultValue:i},l={outputShape:n};return z.runKernel(UI,a,l)}const qH=M({sparseToDense_:HH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KH(t,e){const n=$(e,"indices","gatherND","int32"),s={params:$(t,"x","gatherND","string_or_numeric"),indices:n};return z.runKernel(xk,s)}const XH=M({gatherND_:KH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YH(t,e){if(e==null)return t.shape.slice();if(Pt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(t,e,n,r){const s=$(t,"x","dropout");if(D(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),D(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Yn?s.clone():s;const o=YH(s,n),i=1-e,a=st(eR(ke(kx(o,0,1,"float32",r),i)),i);return he(s,a)}const ZH=M({dropout_:QH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _R(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function Dx(t,e,n){const r=1-t%2,s=new Float32Array(t);for(let o=0;o<t;++o){const i=2*Math.PI*o/(t+r-1);s[o]=e-n*Math.cos(i)}return xs(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function JH(t,e,n=1){const r=$(t,"predictions","inTopK"),s=$(e,"targets","inTopK");D(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),D(r.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`),Qr(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=r.shape[r.shape.length-1];D(n>0&&n<=o,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${n}`);const i=await r.data(),a=await s.data(),[l,u]=[i.length/o,o],c=Qi("bool",l);for(let d=0;d<l;d++){const f=d*u,h=i.subarray(f,f+u),p=[];for(let m=0;m<h.length;m++)p.push({value:h[m],index:m});p.sort((m,v)=>v.value-m.value),c[d]=0;for(let m=0;m<n;m++)if(p[m].index===a[d]){c[d]=1;break}}return t!==r&&r.dispose(),e!==s&&s.dispose(),_o(c,s.shape,"bool")}const e8=JH;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t8(t,e,n,r,s,o="NHWC",i){let a=t;t.rank===3&&(a=ae(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]])),D(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),D(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),D(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=o==="NHWC"?a.shape[3]:a.shape[1],c=o==="NHWC"?l.shape[3]:l.shape[1];D(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),D(c===n[3],()=>`Error in conv2dDerFilter: depth of dy (${c}) must match output depth for filter (${n[3]}).`),$s("conv2dDerFilter",s,i);const d={x:a,dy:l},f={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,filterShape:n};return z.runKernel(z$,d,f)}const n8=M({conv2DBackpropFilter_:t8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Im(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return he(t,xR(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function Om(t,e){let n=e;const r=KO(t.shape,e.shape);return r.length>0&&(n=St(n,r)),ae(n,t.shape)}function Rm(t,e,n,r){if(e==="linear")return t;if(e==="relu")return $m(t);if(e==="elu")return YO(t);if(e==="relu6")return mR(t);if(e==="prelu")return fR(t,n);if(e==="leakyrelu")return nR(t,r);if(e==="sigmoid")return au(t);throw new Error(`Unknown fused activation ${e}.`)}const Dm=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r8({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(l=l||"linear",Dm(z.state.gradientDepth,l)===!1){D(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let E=_m(t,e,n,r,s,o,i);return a!=null&&(E=ke(E,a)),Rm(E,l,u,c)}const d=$(t,"x","conv2d","float32"),f=$(e,"filter","conv2d","float32");let h=d,p=!1;d.rank===3&&(p=!0,h=ae(d,[1,d.shape[0],d.shape[1],d.shape[2]])),D(h.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${h.rank}.`),D(f.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${f.rank}.`),$s("fused conv2d",r,i);const m=s==="NHWC"?h.shape[3]:h.shape[1];D(f.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${f.shape[2]}.`),D($r(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const v=Jr(h.shape,f.shape,n,o,r,i);let g;a!=null&&(g=$(a,"bias","fused conv2d"),[g]=Ut(g,d),s==="NHWC"?nt(v.outShape,g.shape):(D(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),D(g.shape.length===0||g.shape[0]===v.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${v.outChannels})`)));let x;if(u!=null){const E=u.shape;if(D(E.length<=1||E.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${E.length}.`),E.length===1)D(E[0]===1||E[0]===v.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${E}) is not compatible with the number of output channels (${v.outChannels}).`);else if(E.length===3)try{nt(E,v.outShape)}catch{const P=`Error in fused conv2d: PReLU activation weights (${E}) is not compatible with the output shape of the conv2d (${v.outShape}).`;throw Error(P)}x=$(u,"prelu weights","fused conv2d")}const b=(E,R)=>{D(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[P,B,F,H]=R,ee=Im(E,F,l);D(Cd(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const oe=qO(B.shape,ee,P,n,r),de=n8(B,ee,P.shape,n,r),V=[oe,de];if(H!=null){const W=Om(H,ee);V.push(W)}return V},_={x:h,filter:f,bias:g,preluActivationWeights:x},N={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return a==null?Yo((R,P,B)=>{let F=z.runKernel(U0,_,N);return B([P,R,F]),p&&(F=ae(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:b}})(h,f):Yo((R,P,B,F)=>{let H=z.runKernel(U0,_,N);return F([P,R,H,B]),p&&(H=ae(H,[H.shape[1],H.shape[2],H.shape[3]])),{value:H,gradFunc:b}})(h,f,g)}const s8=M({fusedConv2d_:r8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o8(t,e,n,r,s,o=[1,1],i){let a=t;t.rank===3&&(a=ae(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},c={strides:r,pad:s,dimRoundingMode:i,dilations:o,filterShape:n};return z.runKernel(ek,u,c)}const i8=M({depthwiseConv2dNativeBackpropFilter_:o8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a8(t,e,n,r,s,o=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=ae(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:n},c={strides:r,pad:s,dimRoundingMode:i,dilations:o,inputShape:t},d=z.runKernel(tk,u,c);return l?ae(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const l8=M({depthwiseConv2dNativeBackpropInput_:a8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u8({x:t,filter:e,strides:n,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:c}){if(Dm(z.state.gradientDepth,l)===!1){let N=mx(t,e,n,r,s,o,i);return a!=null&&(N=ke(N,a)),Rm(N,l,u,c)}const d=$(t,"x","depthwiseConv2d","float32"),f=$(e,"filter","depthwiseConv2d","float32");let h=d,p=!1;d.rank===3&&(p=!0,h=ae(d,[1,d.shape[0],d.shape[1],d.shape[2]])),D(h.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${h.rank}.`),D(f.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${f.rank}.`),D(h.shape[3]===f.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${h.shape[3]}) must match the inChannels dimension in filter ${f.shape[2]}.`),o==null&&(o=[1,1]),D($r(n,o),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),$s("fused depthwiseConv2d",r,i);const m=Jr(h.shape,f.shape,n,o,r,i,!0);let v;a!=null&&(v=$(a,"bias","fused conv2d"),[v]=Ut(v,d),nt(m.outShape,v.shape));let g;u!=null&&(g=$(u,"prelu weights","fused depthwiseConv2d"));const x=(N,E)=>{D(Cd(o),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[R,P,B,F]=E,H=Im(N,B,l),ee=l8(P.shape,H,R,n,r,o,i),oe=i8(P,H,R.shape,n,r,o,i);if(F!=null){const de=Om(v,H);return[ee,oe,de]}return[ee,oe]},b={x:h,filter:f,bias:v,preluActivationWeights:g},_={strides:n,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:c};return a==null?Yo((E,R,P)=>{let B=z.runKernel(z0,b,_);return P([R,E,B]),p&&(B=ae(B,[B.shape[1],B.shape[2],B.shape[3]])),{value:B,gradFunc:x}})(h,f):Yo((E,R,P,B)=>{let F=z.runKernel(z0,b,_);return B([R,E,F,P]),p&&(F=ae(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:x}})(h,f,v)}const c8=M({fusedDepthwiseConv2d_:u8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:s,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(Dm(z.state.gradientDepth,o)===!1){let H=ht(t,e,n,r);return s!=null&&(H=ke(H,s)),Rm(H,o,i,a)}let l=$(t,"a","fused matMul"),u=$(e,"b","fused matMul");[l,u]=Ut(l,u);const c=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?u.shape[u.rank-1]:u.shape[u.rank-2],f=n?l.shape[l.rank-1]:l.shape[l.rank-2],h=r?u.shape[u.rank-2]:u.shape[u.rank-1],p=l.shape.slice(0,-2),m=u.shape.slice(0,-2),v=pe(p),g=pe(m);D(c===d,()=>`Error in fused matMul: inner shapes (${c}) and (${d}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${n} and transposeB=${r} must match.`);const b=nt(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([f,h]),_=n?ae(l,[v,c,f]):ae(l,[v,f,c]),N=r?ae(u,[g,h,d]):ae(u,[g,d,h]);let E;s!=null&&(E=$(s,"bias","fused matMul"),[E]=Ut(E,l),nt(b,E.shape));let R;i!=null&&(R=$(i,"prelu weights","fused matMul"));const P=(H,ee)=>{const[oe,de,V,W]=ee,I=Im(ae(H,V.shape),V,o);let O,j;if(!n&&!r?(O=ht(I,de,!1,!0),j=ht(oe,I,!0,!1)):!n&&r?(O=ht(I,de,!1,!1),j=ht(I,oe,!0,!1)):n&&!r?(O=ht(de,I,!1,!0),j=ht(oe,I,!1,!1)):(O=ht(de,I,!0,!0),j=ht(I,oe,!0,!0)),s!=null){const A=Om(W,I);return[O,j,A]}else return[O,j]},B={a:_,b:N,bias:E,preluActivationWeights:R},F={transposeA:n,transposeB:r,activation:o,leakyreluAlpha:a};return s==null?Yo((ee,oe,de)=>{const V=z.runKernel(B0,B,F);return de([ee,oe,V]),{value:ae(V,b),gradFunc:P}})(_,N):Yo((ee,oe,de,V)=>{const W=z.runKernel(B0,B,F);return V([ee,oe,W,de]),{value:ae(W,b),gradFunc:P}})(_,N,E)}const f8=M({fusedMatMul_:d8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h8=Object.freeze(Object.defineProperty({__proto__:null,conv2d:s8,depthwiseConv2d:c8,matMul:f8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p8(t){return Dx(t,.54,.46)}const m8=M({hammingWindow_:p8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g8(t){return Dx(t,.5,.5)}const ER=M({hannWindow_:g8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y8(t,e,n,r=!1,s=0){let o=0;const i=[];for(;o+e<=t.size;)i.push(Le(t,o,e)),o+=n;if(r)for(;o<t.size;){const a=o+e-t.size,l=cn([Le(t,o,e-a),Hd([a],s)]);i.push(l),o+=n}return i.length===0?lu([],[0,e]):ae(cn(i),[i.length,e])}const TR=M({frame_:y8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v8(t,e,n,r,s=ER){r==null&&(r=_R(e));const o=TR(t,e,n),i=he(o,s(e));return Ox(i,r)}const x8=M({stft_:v8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b8(t,e,n,r,s="bilinear",o=0){const i=$(t,"image","cropAndResize"),a=$(e,"boxes","cropAndResize","float32"),l=$(n,"boxInd","cropAndResize","int32"),u=a.shape[0];D(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),D(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),D(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),D(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),D(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),D(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const c={image:i,boxes:a,boxInd:l},d={method:s,extrapolationValue:o,cropSize:r};return z.runKernel(Y$,c,d)}const w8=M({cropAndResize_:b8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S8(t){const e=$(t,"image","flipLeftRight","float32");D(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return z.runKernel(pk,n,{})}const C8=M({flipLeftRight_:S8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _8(t){const e=$(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];D(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),D(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,n),s[n]=3,Xc(e,s)}const E8=M({grayscaleToRGB_:_8});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T8(t){const e=$(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];D(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),D(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const s=e.dtype,o=nn(e,"float32"),i=xs([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Rl("ij,j->i",o,i);break;case 3:a=Rl("ijk,k->ij",o,i);break;case 4:a=Rl("ijkl,l->ijk",o,i);break;case 5:a=Rl("ijklm,m->ijkl",o,i);break;case 6:a=Rl("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return a=Br(a,-1),nn(a,s)}const N8=M({rgbToGrayscale_:T8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $8(t,e,n=0,r=.5){const s=$(t,"image","rotateWithOffset","float32");D(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const o={image:s},i={radians:e,fillValue:n,center:r};return z.runKernel(sO,o,i)}const k8=M({rotateWithOffset_:$8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mu(t,e,n,r,s,o){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=t.shape[0];return n=Math.min(n,i),D(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),D(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),D(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),D(e.rank===1,()=>"scores must be a 1D tensor"),D(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),D(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I8(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=$(t,"boxes","nonMaxSuppression","float32"),i=$(e,"scores","nonMaxSuppression","float32"),a=Mu(o,i,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:s};return z.runKernel(Qk,{boxes:o,scores:i},l)}const O8=M({nonMaxSuppression_:I8});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R8(t,e,n){const r=D8(t,e,n),s=r<0?-(r+1):r;t.splice(s,0,e)}function D8(t,e,n){return P8(t,e,n||A8)}function A8(t,e){return t>e?1:t<e?-1:0}function P8(t,e,n){let r=0,s=t.length,o=0,i=!1;for(;r<s;){o=r+(s-r>>>1);const a=n(e,t[o]);a>0?r=o+1:(s=o,i=!a)}return i?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NR(t,e,n,r,s){return Ax(t,e,n,r,s,0)}function $R(t,e,n,r,s,o){return Ax(t,e,n,r,s,0,!1,o,!0)}function kR(t,e,n,r,s,o){return Ax(t,e,n,r,s,o,!0)}function Ax(t,e,n,r,s,o,i=!1,a=!1,l=!1){const u=[];for(let v=0;v<e.length;v++)e[v]>s&&u.push({score:e[v],boxIndex:v,suppressBeginIndex:0});u.sort(n_);const c=o>0?-.5/o:0,d=[],f=[];for(;d.length<n&&u.length>0;){const v=u.pop(),{score:g,boxIndex:x,suppressBeginIndex:b}=v;if(g<s)break;let _=!1;for(let N=d.length-1;N>=b;--N){const E=L8(t,x,d[N]);if(E>=r){_=!0;break}if(v.score=v.score*F8(r,c,E),v.score<=s)break}v.suppressBeginIndex=d.length,_||(v.score===g?(d.push(x),f.push(v.score)):v.score>s&&R8(u,v,n_))}const h=d.length,p=n-h;a&&p>0&&(d.push(...new Array(p).fill(0)),f.push(...new Array(p).fill(0)));const m={selectedIndices:d};return i&&(m.selectedScores=f),l&&(m.validOutputs=h),m}function L8(t,e,n){const r=t.subarray(e*4,e*4+4),s=t.subarray(n*4,n*4+4),o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),u=Math.min(s[0],s[2]),c=Math.min(s[1],s[3]),d=Math.max(s[0],s[2]),f=Math.max(s[1],s[3]),h=(a-o)*(l-i),p=(d-u)*(f-c);if(h<=0||p<=0)return 0;const m=Math.max(o,u),v=Math.max(i,c),g=Math.min(a,d),x=Math.min(l,f),b=Math.max(g-m,0)*Math.max(x-v,0);return b/(h+p-b)}function F8(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function n_(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function M8(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY){const o=$(t,"boxes","nonMaxSuppressionAsync"),i=$(e,"scores","nonMaxSuppressionAsync"),a=Mu(o,i,n,r,s);n=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),u=l[0],c=l[1],{selectedIndices:d}=NR(u,c,n,r,s);return o!==t&&o.dispose(),i!==e&&i.dispose(),xs(d,"int32")}const j8=M8;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B8(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=$(t,"boxes","nonMaxSuppression"),a=$(e,"scores","nonMaxSuppression"),l=Mu(i,a,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:i,scores:a},c={maxOutputSize:n,iouThreshold:r,scoreThreshold:s,softNmsSigma:o},d=z.runKernel(Jk,u,c);return{selectedIndices:d[0],selectedScores:d[1]}}const U8=M({nonMaxSuppressionWithScore_:B8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function z8(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=$(t,"boxes","nonMaxSuppressionAsync"),a=$(e,"scores","nonMaxSuppressionAsync"),l=Mu(i,a,n,r,s,o);n=l.maxOutputSize,r=l.iouThreshold,s=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([i.data(),a.data()]),c=u[0],d=u[1],{selectedIndices:f,selectedScores:h}=kR(c,d,n,r,s,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:xs(f,"int32"),selectedScores:xs(h)}}const W8=z8;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V8(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=$(t,"boxes","nonMaxSuppression"),a=$(e,"scores","nonMaxSuppression"),l=Mu(i,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,f={boxes:i,scores:a},h={maxOutputSize:u,iouThreshold:c,scoreThreshold:d,padToMaxOutputSize:o},p=z.runKernel(Zk,f,h);return{selectedIndices:p[0],validOutputs:p[1]}}const G8=M({nonMaxSuppressionPadded_:V8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function H8(t,e,n,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=$(t,"boxes","nonMaxSuppressionAsync"),a=$(e,"scores","nonMaxSuppressionAsync"),l=Mu(i,a,n,r,s,null),u=l.maxOutputSize,c=l.iouThreshold,d=l.scoreThreshold,[f,h]=await Promise.all([i.data(),a.data()]),{selectedIndices:p,validOutputs:m}=$R(f,h,u,c,d,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:xs(p,"int32"),validOutputs:Ze(m,"int32")}}const q8=H8;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8(t,e,n=!1,r=!1){const s=$(t,"images","resizeBilinear");D(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),D(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),D(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=ae(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=z.runKernel(gI,a,l);return i?ae(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const X8=M({resizeBilinear_:K8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y8(t,e,n=!1,r=!1){const s=$(t,"images","resizeNearestNeighbor");D(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),D(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),D(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),D(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=ae(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:r,size:e},u=z.runKernel(mI,a,l);return i?ae(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Q8=M({resizeNearestNeighbor_:Y8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z8(t,e="binary",n=!1,r=.5){const s=$(t,"image","threshold"),o=.2989,i=.587,a=.114,l=s.shape[0]*s.shape[1];let u=he(xs([r]),255),c,d,f,h;if(D(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),D(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),D(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),D(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[c,d,f]=$d(s,[1,1,1],-1);const v=he(c,o),g=he(d,i),x=he(f,a);h=ke(ke(v,g),x)}else h=t;if(e==="otsu"){const v=GO(nn(gR(h),"int32"),_o([]),256);u=J8(v,l)}const p=n?xx(h,u):Tm(h,u);return nn(he(p,255),"int32")}function J8(t,e){let n=xs([-1]),r=xs([0]),s=xs([0]),o,i,a,l,u,c;for(let d=0;d<t.size-1;d++){o=Le(t,0,d+1),i=Le(t,d+1),u=st(St(o),e),c=st(St(i),e);const f=St(he(o,Td(0,o.size)));a=st(f,St(o));const h=Hd(i.shape,o.size),p=ke(Td(0,i.size),h),m=he(i,p);l=st(St(m),St(i));const v=Oe(a,l),g=Oe(a,l),x=he(u,c);s=he(he(x,v),g);const b=Tm(s,r);r=Vi(b,s,r),n=Vi(b,xs([d]),n)}return n}const eq=M({threshold_:Z8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tq(t,e,n="nearest",r="constant",s=0,o){const i=$(t,"image","transform","float32"),a=$(e,"transforms","transform","float32");D(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),D(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),D(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},u={interpolation:n,fillMode:r,fillValue:s,outputShape:o};return z.runKernel(ZI,l,u)}const nq=M({transform_:tq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rq(t,e,n){const r=$(t,"a","bandPart");D(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[o,i]=r.shape.slice(-2);let a,l;typeof e=="number"?(D(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),D(e<=o,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`),a=$(e<0?o:e,"numLower","bandPart")):(D(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=Vi(rv(e,0),o,vp(e,o))),typeof n=="number"?(D(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),D(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=$(n<0?i:n,"numUpper","bandPart")):(D(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Vi(rv(n,0),i,vp(n,i)));const u=ae(Td(0,o,1,"int32"),[-1,1]),c=Td(0,i,1,"int32"),d=Oe(u,c),f=gp(xx(d,a),tR(d,Eo(l))),h=ta([o,i],r.dtype);return ae(Qo(dl(ae(r,[-1,o,i])).map(p=>Vi(f,p,h))),s)}const sq=M({bandPart_:rq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(t){let e;if(Array.isArray(t)){e=!1,D(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=t[0].shape[0];for(let o=1;o<t.length;++o)D(t[o].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[o].shape[0]} vs. ${s})`)}else e=!0,t=$d(t,t.shape[0],0).map(s=>Gi(s,[0]));D(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let s=0;s<t.length;++s)n.push(z.tidy(()=>{let o=r[s];if(s>0)for(let i=0;i<s;++i){const a=he(St(he(n[i],o)),n[i]);o=Oe(o,a)}return st(o,Em(o,"euclidean"))}));return e?Qo(n,0):n}const iq=M({gramSchmidt_:oq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aq(t,e=!1){if(D(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return r_(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,u)=>l*u),r=dl(ae(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),s=[],o=[];r.forEach(l=>{const[u,c]=r_(l,e);s.push(u),o.push(c)});const i=ae(Qo(s,0),t.shape),a=ae(Qo(o,0),t.shape);return[i,a]}}function r_(t,e=!1){return z.tidy(()=>{D(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let s=JO(n),o=Wi(t);const i=lu([[1]],[1,1]);let a=Wi(i);const l=n>=r?r:n;for(let u=0;u<l;++u){const c=o,d=a,f=s;[a,o,s]=z.tidy(()=>{const h=Le(o,[u,u],[n-u,1]),p=Em(h),m=Le(o,[u,u],[1,1]),v=Vi(Tm(m,0),lu([[-1]]),lu([[1]])),g=Oe(m,he(v,p)),x=st(h,g);x.shape[0]===1?a=Wi(i):a=cn([i,Le(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);const b=Eo(st(ht(v,g),p)),_=Le(o,[u,0],[n-u,r]),N=he(b,a),E=bp(a);if(u===0)o=Oe(_,ht(N,ht(E,_)));else{const B=Oe(_,ht(N,ht(E,_)));o=cn([Le(o,[0,0],[u,r]),B],0)}const R=bp(N),P=Le(s,[0,u],[n,s.shape[1]-u]);if(u===0)s=Oe(P,ht(ht(P,a),R));else{const B=Oe(P,ht(ht(P,a),R));s=cn([Le(s,[0,0],[n,u]),B],1)}return[a,o,s]}),Kt([c,d,f])}return!e&&n>r&&(s=Le(s,[0,0],[n,r]),o=Le(o,[0,0],[r,r])),[s,o]})}const lq=M({qr_:aq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var lr;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(lr||(lr={}));function uq(t,e,n=lr.SUM_BY_NONZERO_WEIGHTS){const r=$(t,"losses","computeWeightedLoss");let s=null;e!=null&&(s=$(e,"weights","computeWeightedLoss"));const o=s==null?r:he(r,s);if(n===lr.NONE)return o;if(n===lr.SUM)return St(o);if(n===lr.MEAN){if(s==null)return yp(o);{const i=r.size/s.size,a=st(St(o),St(s));return i>1?st(a,Ze(i)):a}}if(n===lr.SUM_BY_NONZERO_WEIGHTS){if(s==null)return st(St(o),Ze(r.size));{const i=he(s,Ra(r.shape)),a=nn(St(cR(i,Ze(0))),"float32");return st(St(o),a)}}throw Error(`Unknown reduction: ${n}`)}const ti=M({computeWeightedLoss_:uq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cq(t,e,n,r=lr.SUM_BY_NONZERO_WEIGHTS){const s=$(t,"labels","absoluteDifference"),o=$(e,"predictions","absoluteDifference");let i=null;n!=null&&(i=$(n,"weights","absoluteDifference")),Qr(s.shape,o.shape,"Error in absoluteDifference: ");const a=jr(Oe(s,o));return ti(a,i,r)}const dq=M({absoluteDifference_:cq});function fq(t,e,n,r,s=lr.SUM_BY_NONZERO_WEIGHTS){const o=$(t,"labels","cosineDistance"),i=$(e,"predictions","cosineDistance");let a=null;r!=null&&(a=$(r,"weights","cosineDistance")),Qr(o.shape,i.shape,"Error in cosineDistance: ");const l=Ze(1),u=Oe(l,St(he(o,i),n,!0));return ti(u,a,s)}const hq=M({cosineDistance_:fq});function pq(t,e,n,r=lr.SUM_BY_NONZERO_WEIGHTS){let s=$(t,"labels","hingeLoss");const o=$(e,"predictions","hingeLoss");let i=null;n!=null&&(i=$(n,"weights","hingeLoss")),Qr(s.shape,o.shape,"Error in hingeLoss: ");const a=Ze(1);s=Oe(he(Ze(2),s),a);const l=$m(Oe(a,he(s,o)));return ti(l,i,r)}const mq=M({hingeLoss_:pq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gq(t,e,n,r=1,s=lr.SUM_BY_NONZERO_WEIGHTS){const o=$(t,"labels","huberLoss"),i=$(e,"predictions","huberLoss");let a=null;n!=null&&(a=$(n,"weights","huberLoss")),Qr(o.shape,i.shape,"Error in huberLoss: ");const l=Ze(r),u=jr(Oe(i,o)),c=vp(u,l),d=Oe(u,c),f=ke(he(Ze(.5),Ss(c)),he(l,d));return ti(f,a,s)}const yq=M({huberLoss_:gq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(t,e,n,r=1e-7,s=lr.SUM_BY_NONZERO_WEIGHTS){const o=$(t,"labels","logLoss"),i=$(e,"predictions","logLoss");let a=null;n!=null&&(a=$(n,"weights","logLoss")),Qr(o.shape,i.shape,"Error in logLoss: ");const l=Ze(1),u=Ze(r),c=Eo(he(o,Ed(ke(i,u)))),d=he(Oe(l,o),Ed(ke(Oe(l,i),u))),f=Oe(c,d);return ti(f,a,s)}const xq=M({logLoss_:vq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bq(t,e,n,r=lr.SUM_BY_NONZERO_WEIGHTS){const s=$(t,"labels","meanSquaredError"),o=$(e,"predictions","meanSquaredError");let i=null;n!=null&&(i=$(n,"weights","meanSquaredError")),Qr(s.shape,o.shape,"Error in meanSquaredError: ");const a=vR(s,o);return ti(a,i,r)}const wq=M({meanSquaredError_:bq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sq(t,e){const n=$(t,"labels","sigmoidCrossEntropyWithLogits"),r=$(e,"logits","sigmoidCrossEntropyWithLogits");Qr(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=$m(r),o=he(r,n),i=rR(Qa(Eo(jr(r))));return ke(Oe(s,o),i)}function Cq(t,e,n,r=0,s=lr.SUM_BY_NONZERO_WEIGHTS){let o=$(t,"multiClassLabels","sigmoidCrossEntropy");const i=$(e,"logits","sigmoidCrossEntropy");let a=null;if(n!=null&&(a=$(n,"weights","sigmoidCrossEntropy")),Qr(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){const u=Ze(r),c=Ze(1),d=Ze(.5);o=ke(he(o,Oe(c,u)),he(d,u))}const l=Sq(o,i);return ti(l,a,s)}const _q=M({sigmoidCrossEntropy_:Cq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eq(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Yo((s,o,i)=>{const l=oR(o,[n],!0),u=Oe(nn(o,"float32"),l);i([s,u]);const c=Eo(he(u,s));return{value:St(c,[n]),gradFunc:(h,p)=>{const[m,v]=p,g=es(h.shape,[n]);return[he(ae(h,g),Oe(nn(m,"float32"),Qa(v))),he(ae(h,g),Oe(Qa(v),nn(m,"float32")))]}}})(t,e)}function Tq(t,e,n,r=0,s=lr.SUM_BY_NONZERO_WEIGHTS){let o=$(t,"onehotLabels","softmaxCrossEntropy");const i=$(e,"logits","softmaxCrossEntropy");let a=null;if(n!=null&&(a=$(n,"weights","softmaxCrossEntropy")),Qr(o.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){const u=Ze(r),c=Ze(1),d=Ze(o.shape[1]);o=ke(he(o,Oe(c,u)),st(u,d))}const l=Eq(o,i);return ti(l,a,s)}const Nq=M({softmaxCrossEntropy_:Tq});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $q(t,e,n,r){const s=$(t,"indices","sparseFillEmptyRows","int32"),o=$(e,"values","sparseFillEmptyRows"),i=$(n,"denseShape","sparseFillEmptyRows","int32"),a=$(r,"defaultValue","sparseFillEmptyRows",o.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:s,values:o,denseShape:i,defaultValue:a},u=z.runKernel(FI,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const kq=M({sparseFillEmptyRows_:$q});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iq(t,e,n){const r=$(t,"inputIndices","sparseReshape","int32"),s=$(e,"inputShape","sparseReshape","int32"),o=$(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const i={inputIndices:r,inputShape:s,newShape:o},a=z.runKernel(MI,i);return{outputIndices:a[0],outputShape:a[1]}}const Oq=M({sparseReshape_:Iq});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rq(t,e,n){const r=$(t,"data","sparseSegmentMean"),s=$(e,"indices","sparseSegmentMean","int32"),o=$(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);const i={data:r,indices:s,segmentIds:o};return z.runKernel(jI,i)}const Dq=M({sparseSegmentMean_:Rq});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aq(t,e,n){const r=$(t,"data","sparseSegmentSum"),s=$(e,"indices","sparseSegmentSum","int32"),o=$(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);const i={data:r,indices:s,segmentIds:o};return z.runKernel(BI,i)}const Pq=M({sparseSegmentSum_:Aq});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lq(t,e,n,r,s,o,i,a){const l=$(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=$(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const c={separator:n,nGramWidths:r,leftPad:s,rightPad:o,padWidth:i,preserveShortSequences:a},d={data:l,dataSplits:u},f=z.runKernel(GI,d,c);return{nGrams:f[0],nGramsSplits:f[1]}}const Fq=M({stringNGrams_:Lq});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mq(t,e,n=!0){const r=$(t,"input","stringSplit","string"),s=$(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const o={skipEmpty:n},i={input:r,delimiter:s},a=z.runKernel(HI,i,o);return{indices:a[0],values:a[1],shape:a[2]}}const jq=M({stringSplit_:Mq});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bq(t,e){const n=$(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:n};return z.runKernel(qI,s,r)}const Uq=M({stringToHashBucketFast_:Bq});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zq(t,e,n,r=!0){const s=$(t,"input","staticRegexReplace","string"),o={pattern:e,rewrite:n,replaceGlobal:r};return z.runKernel(WI,{x:s},o)}const Wq=M({staticRegexReplace_:zq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vq={fft:Ix,ifft:xp,rfft:Ox,irfft:yR},Gq={hammingWindow:m8,hannWindow:ER,frame:TR,stft:x8},Px={flipLeftRight:C8,grayscaleToRGB:E8,resizeNearestNeighbor:Q8,resizeBilinear:X8,rgbToGrayscale:N8,rotateWithOffset:k8,cropAndResize:w8,nonMaxSuppression:O8,nonMaxSuppressionAsync:j8,nonMaxSuppressionWithScore:U8,nonMaxSuppressionWithScoreAsync:W8,nonMaxSuppressionPadded:G8,nonMaxSuppressionPaddedAsync:q8,threshold:eq,transform:nq},Hq={bandPart:sq,gramSchmidt:iq,qr:lq},qq={absoluteDifference:dq,computeWeightedLoss:ti,cosineDistance:hq,hingeLoss:mq,huberLoss:yq,logLoss:xq,meanSquaredError:wq,sigmoidCrossEntropy:_q,softmaxCrossEntropy:Nq},Kq={sparseFillEmptyRows:kq,sparseReshape:Oq,sparseSegmentMean:Dq,sparseSegmentSum:Pq},Xq={stringNGrams:Fq,stringSplit:jq,stringToHashBucketFast:Uq,staticRegexReplace:Wq};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yq=new Map,Qq=new Map;class Zq{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Ca{constructor(){this.classNameMap={}}static getMap(){return Ca.instance==null&&(Ca.instance=new Ca),Ca.instance}static register(e){Ca.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Jq(t,e,n){D(t.className!=null,()=>"Class being registered does not have the static className property defined."),D(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),D(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,s=e+">"+r;return Ca.register(t),Yq.set(s,t),Qq.set(t,s),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fl extends Zq{minimize(e,n=!1,r){const{value:s,grads:o}=this.computeGradients(e,r);if(r!=null){const i=r.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return Kt(o),n?s:(s.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return MV(e,n)}dispose(){this.iterations_!=null&&Kt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Ze(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(fl,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e7 extends fl{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=z.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=z.registeredVariables[r],i=!1;this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accum_grad`,variable:Ke(()=>Vr(o).variable(i))}),this.accumulatedUpdates[s]==null&&(this.accumulatedUpdates[s]={originalName:`${r}/accum_var`,variable:Ke(()=>Vr(o).variable(i))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedGrads[s].variable,u=this.accumulatedUpdates[s].variable;Ke(()=>{const c=ke(he(l,this.rho),he(Ss(a),1-this.rho)),d=he(st(Xo(ke(u,this.epsilon)),Xo(ke(l,this.epsilon))),a),f=ke(he(u,this.rho),he(Ss(d),1-this.rho));l.assign(c),u.assign(f);const h=ke(he(d,-this.learningRate),o);o.assign(h)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Kt(this.accumulatedGrads.map(e=>e.variable)),Kt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t7 extends fl{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=z.registeredVariables[r];this.accumulatedGrads[s]==null&&(this.accumulatedGrads[s]={originalName:`${r}/accumulator`,variable:Ke(()=>Hd(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[s].tensor:e[r];if(i==null)return;const a=this.accumulatedGrads[s].variable;Ke(()=>{const l=ke(a,Ss(i));a.assign(l);const u=ke(he(st(i,Xo(ke(l,z.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Kt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n7 extends fl{static get className(){return"Adam"}constructor(e,n,r,s=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ke(()=>{this.accBeta1=Ze(n).variable(),this.accBeta2=Ze(r).variable()}),s==null&&(this.epsilon=z.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ke(()=>{const r=Oe(1,this.accBeta1),s=Oe(1,this.accBeta2);n.forEach((o,i)=>{const a=z.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:Ke(()=>Vr(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:Ke(()=>Vr(a).variable(l))});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,f=ke(he(c,this.beta1),he(u,1-this.beta1)),h=ke(he(d,this.beta2),he(Ss(u),1-this.beta2)),p=st(f,r),m=st(h,s);c.assign(f),d.assign(h);const v=ke(he(st(p,ke(Xo(m),this.epsilon)),-this.learningRate),a);a.assign(v)}),this.accBeta1.assign(he(this.accBeta1,this.beta1)),this.accBeta2.assign(he(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Kt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Kt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),Ke(()=>{this.accBeta1.assign(_d(this.beta1,this.iterations_+1)),this.accBeta2.assign(_d(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r7 extends fl{static get className(){return"Adamax"}constructor(e,n,r,s=null,o=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=s,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ke(()=>{this.iteration=Ze(0).variable(),this.accBeta1=Ze(n).variable()}),s==null&&(this.epsilon=z.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);Ke(()=>{const r=Oe(1,this.accBeta1),s=st(-this.learningRate,ke(he(this.iteration,this.decay),1));n.forEach((o,i)=>{const a=z.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:Vr(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:Vr(a).variable(l)});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const c=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,f=ke(he(c,this.beta1),he(u,1-this.beta1)),h=he(d,this.beta2),p=jr(u),m=uR(h,p);c.assign(f),d.assign(m);const v=ke(he(st(s,r),st(f,ke(m,this.epsilon))),a);a.assign(v)}),this.iteration.assign(ke(this.iteration,1)),this.accBeta1.assign(he(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Kt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Kt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IR extends fl{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=Array.isArray(e)?e[s].tensor:e[r];if(o==null)return;const i=z.registeredVariables[r];Ke(()=>{const a=ke(he(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=vo(Ze(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s7 extends IR{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=Ze(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=z.registeredVariables[r];this.accumulations[s]==null&&(this.accumulations[s]={originalName:`${r}/momentum`,variable:Ke(()=>Vr(o).variable(!1))});const i=this.accumulations[s].variable,a=Array.isArray(e)?e[s].tensor:e[r];a!=null&&Ke(()=>{let l;const u=ke(he(this.m,i),a);this.useNesterov?l=ke(he(this.c,ke(a,he(u,this.m))),o):l=ke(he(this.c,u),o),i.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Kt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o7 extends fl{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,s=null,o=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=s,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,s==null&&(this.epsilon=z.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,s)=>{const o=z.registeredVariables[r],i=!1;this.accumulatedMeanSquares[s]==null&&(this.accumulatedMeanSquares[s]={originalName:`${r}/rms`,variable:Ke(()=>Vr(o).variable(i))}),this.accumulatedMoments[s]==null&&(this.accumulatedMoments[s]={originalName:`${r}/momentum`,variable:Ke(()=>Vr(o).variable(i))}),this.accumulatedMeanGrads[s]==null&&this.centered&&(this.accumulatedMeanGrads[s]={originalName:`${r}/mg`,variable:Ke(()=>Vr(o).variable(i))});const a=Array.isArray(e)?e[s].tensor:e[r];if(a==null)return;const l=this.accumulatedMeanSquares[s].variable,u=this.accumulatedMoments[s].variable;Ke(()=>{const c=ke(he(l,this.decay),he(Ss(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[s].variable,f=ke(he(d,this.decay),he(a,1-this.decay)),h=st(he(a,this.learningRate),Xo(Oe(c,ke(Ss(f),this.epsilon)))),p=ke(he(u,this.momentum),h);l.assign(c),d.assign(f),u.assign(p);const m=Oe(o,p);o.assign(m)}else{const d=ke(he(l,this.decay),he(Ss(a),1-this.decay)),f=ke(he(u,this.momentum),st(he(a,this.learningRate),Xo(ke(d,this.epsilon))));l.assign(d),u.assign(f);const h=Oe(o,f);o.assign(h)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Kt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Kt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Kt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(s=>({originalName:s.name,variable:s.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i7=[e7,t7,n7,r7,s7,o7,IR];function a7(){for(const t of i7)Jq(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l7="model",u7=".json",c7=".weights.bin";function s_(t){return new Promise(e=>setTimeout(e)).then(t)}class Ja{constructor(e){if(!Y().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Ja.URL_SCHEME)&&(e=e.slice(Ja.URL_SCHEME.length)),(e==null||e.length===0)&&(e=l7),this.modelJsonFileName=e+u7,this.weightDataFileName=e+c7}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=ao.join(e.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],o=IO(e,s),i=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),a=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(a.download=this.modelJsonFileName,a.href=i,await s_(()=>a.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await s_(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Wd(e)}}}}Ja.URL_SCHEME="downloads://";class d7{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=s=>{const o=JSON.parse(s.target.result),i=o.modelTopology;if(i==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(o.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const l=hx(o,u=>this.loadWeights(u));e(l)},r.onerror=s=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const i of e)n.push(...i.weights),r.push(...i.paths);const s=this.checkManifestAndWeightFiles(e),o=r.map(i=>this.loadWeightsFile(i,s[i]));return Promise.all(o).then(i=>[n,i])}loadWeightsFile(e,n){return new Promise((r,s)=>{const o=new FileReader;o.onload=i=>{const a=i.target.result;r(a)},o.onerror=i=>s(`Failed to weights data from file of path '${e}'.`),o.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(o=>t_(o.name)),s={};for(const o of e)o.paths.forEach(i=>{const a=t_(i);if(n.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(n.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);s[i]=this.weightsFiles[r.indexOf(a)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const f7=t=>Y().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Ja.URL_SCHEME)?h7(t.slice(Ja.URL_SCHEME.length)):null;Dt.registerSaveRouter(f7);function h7(t="model"){return new Ja(t)}function p7(t){return new d7(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o_(t,e,n,r){i(t),n=n??0,r=r??1,a(n,r);let s=0;const o=l=>(l.then(u=>{const c=n+ ++s/t.length*(r-n);return e(c),u}),l);function i(l){D(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){D(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),D(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),D(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(t.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function OR(t,e){e==null&&(e={});const n=e.fetchFunc==null?Y().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),s=0,o=.5,a=(e.onProgress==null?await Promise.all(r):await o_(r,e.onProgress,s,o)).map(d=>d.arrayBuffer()),l=.5,u=1;return e.onProgress==null?await Promise.all(a):await o_(a,e.onProgress,l,u)}function m7(t,e){var n;const r=e.fetchFunc==null?Y().platform.fetch:e.fetchFunc;let s=0,o;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async i=>{for(var a;s<t.length;){o||(o=(await r(t[s],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:u}=await o.read();if(l){s++,o=void 0,(a=e.onProgress)===null||a===void 0||a.call(e,s/t.length);continue}i.enqueue(u);return}i.close()}})}async function g7(t,e="",n,r){return RR(i=>OR(i,{requestInit:r}))(t,e,n)}function RR(t){return async(e,n="",r)=>{const s=e.map(()=>!1),o={},i=r!=null?r.map(()=>!1):[],a=[];if(e.forEach((h,p)=>{let m=0;h.weights.forEach(v=>{const g="quantization"in v?v.quantization.dtype:v.dtype,x=qa[g]*pe(v.shape),b=()=>{s[p]=!0,o[p]==null&&(o[p]=[]),o[p].push({manifestEntry:v,groupOffset:m,sizeBytes:x})};r!=null?r.forEach((_,N)=>{_===v.name&&(b(),i[N]=!0)}):b(),a.push(v.name),m+=x})}),!i.every(h=>h)){const h=r.filter((p,m)=>!i[m]);throw new Error(`Could not find weights in manifest with names: ${h.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=s.reduce((h,p,m)=>(p&&h.push(m),h),[]),u=[];l.forEach(h=>{e[h].paths.forEach(p=>{const m=n+(n.endsWith("/")?"":"/")+p;u.push(m)})});const c=await t(u),d={};let f=0;return l.forEach(h=>{const p=e[h].paths.length,m=new ao(c.slice(f,f+p));o[h].forEach(g=>{const x=m.slice(g.groupOffset,g.groupOffset+g.sizeBytes),b=NO(x,[g.manifestEntry]);for(const _ in b)d[_]=b[_]}),f+=p}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y7="application/octet-stream",v7="application/json";class Lx{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(D(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=Y().platform.fetch,D(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&D(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=IO(e,r);if(n.body.append("model.json",new Blob([JSON.stringify(s)],{type:v7}),"model.json"),e.weightData!=null){const i=ao.join(e.weightData);n.body.append("model.weights.bin",new Blob([i],{type:y7}),"model.weights.bin")}const o=await this.fetch(this.path,n);if(o.ok)return{modelArtifactsInfo:Wd(e),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const r=n.modelTopology,s=n.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return hx(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),r=Y0(e.weightsManifest),s=()=>m7(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:s})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=x7(n),o=this.weightPathPrefix||r,i=[],a=[];for(const l of e)for(const u of l.paths)this.weightUrlConverter!=null?a.push(this.weightUrlConverter(u)):i.push(o+u+s);return this.weightUrlConverter&&i.push(...await Promise.all(a)),i}async loadWeights(e){const n=await this.getWeightUrls(e),r=Y0(e),s=await OR(n,this.loadOptions);return[r,s]}}Lx.URL_SCHEME_REGEX=/^https?:\/\//;function x7(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),s=n>e?t.substring(n):"";return[r+"/",s]}function sv(t){return t.match(Lx.URL_SCHEME_REGEX)!=null}const DR=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>sv(r)):n=sv(t),n)return Fx(t,e)}return null};Dt.registerSaveRouter(DR);Dt.registerLoadRouter(DR);function Fx(t,e){return new Lx(t,e)}function b7(t,e){return Fx(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sy{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class AR{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class w7{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function S7(t,e,n,r){const s=arguments;return new w7(PR(...s))}function PR(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new sy(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new sy({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new sy({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function C7(t){return new AR(t)}function _7(t){return new AR(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LR=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:ao,browserFiles:p7,browserHTTPRequest:b7,concatenateArrayBuffers:E5,copyModel:q5,decodeWeights:NO,decodeWeightsStream:kO,encodeWeights:x5,fromMemory:S7,fromMemorySync:PR,getLoadHandlers:D5,getModelArtifactsForJSON:hx,getModelArtifactsForJSONSync:OO,getModelArtifactsInfoForJSON:Wd,getSaveHandlers:R5,getWeightSpecs:Y0,http:Fx,isHTTPScheme:sv,listModels:G5,loadWeights:g7,moveModel:K5,registerLoadRouter:O5,registerSaveRouter:I5,removeModel:H5,weightsLoaderFactory:RR,withSaveHandler:C7,withSaveHandlerSync:_7},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let ga;function E7(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,s=!1,o=!1,i=!1,a=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)o=!0;else if(t.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(W0(j0,z.backendName)!=null){const p={pixels:t},m={numChannels:e};return z.runKernel(j0,p,m)}const[u,c]=s?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(i)d=t.getContext("2d").getImageData(0,0,u,c).data;else if(r||n)d=t.data;else if(o||s||a){if(ga==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")ga=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else ga=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});ga.canvas.width=u,ga.canvas.height=c,ga.drawImage(t,0,0,u,c),d=ga.getImageData(0,0,u,c).data}let f;if(e===4)f=new Int32Array(d);else{const p=u*c;f=new Int32Array(p*e);for(let m=0;m<p;m++)for(let v=0;v<e;++v)f[m*e+v]=d[m*4+v]}return bR(f,[c,u,e],"int32")}const T7=M({fromPixels_:E7});function FR(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(pe(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const s=e.shape,o=s[s.length-1];let i=1;for(let d=0;d<s.length-1;++d)i*=s[d];const a=t.shape,l=s.slice();l.pop();let u=1;for(let d=o;d<n;++d)u*=a[d],l.push(a[d]);const c=[...$n(t.shape).map(d=>d/u),1].slice(0,o);return[l,i,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ov=-2,N7=-1;function MR(t,e,n){const r=t.shape.length;D(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),D(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)D(e[s]+n[s]<=t.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+n[s]}) would overflow input.shape[${s}] (${t.shape[s]})`)}function $7(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function jR(t,e,n){const r=[];for(let s=0;s<t.length;s++)r[s]=Math.ceil((e[s]-t[s])/n[s]);return r}function BR(t,e,n,r){const s=[...t];for(let o=s.length;o<r.length;o++)s.push(1);for(let o=0;o<n;o++)o===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function UR(t,e,n){return n<=t?n:n-(e-1)}function zR(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function k7(t,e,n,r,s,o,i,a,l){const u=t.length;let c=new Array(u),d=new Array(u),f=new Array(u);if(e.length&&n>0){const h=e[0],p=n+1;c=WR(i,h,p,r,t),d=VR(a,h,p,s,t),f=BR(o,h,p,t)}else for(let h=0;h<u;h++)c[h]=HR(i,r,o,t,h,l),d[h]=qR(a,s,o,t,h,l),f[h]=GR(o,h,l);return{begin:c,end:d,strides:f}}function WR(t,e,n,r,s){const o=[...s],i=zR(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const l=UR(e,n,a);let u=r[l];t&1<<l&&(u=0),o[a]=u}return o}function VR(t,e,n,r,s){const o=[...s],i=zR(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const l=UR(e,n,a);let u=r[l];t&1<<l&&(u=Number.MAX_SAFE_INTEGER),o[a]=u}for(let a=0;a<o.length;a++){const l=s[a];o[a]<0&&(o[a]+=l),o[a]=up(0,o[a],s[a])}return o}function GR(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function HR(t,e,n,r,s,o){let i=e[s];const a=n[s]||1;(t&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),i=up(0,i,l-1),i}function qR(t,e,n,r,s,o){let i=e[s];const a=n[s]||1;(t&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=r[s];return i<0&&(i+=l),a>0?i=up(0,i,l):i=up(-1,i,l-1),i}function Mx(t,e,n){let r=n.length;for(let s=0;s<n.length;s++)if(n[s]>1){r=s;break}for(let s=r+1;s<n.length;s++)if(e[s]>0||n[s]!==t[s])return!1;return!0}function jx(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function KR(t,e,n){let r;const s=t.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(i=>{D(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(s).fill(-1):typeof n=="number"?o=[n,...new Array(s-1).fill(-1)]:n.length<s?o=n.concat(new Array(s-n.length).fill(-1)):o=n,o=o.map((i,a)=>i>=0?i:(D(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-r[a])),[r,o]}function XR(t,e,n,r,s,o,i,a,l){let u;if(r==null?(u=new Array(e.length),u.fill(1)):u=r,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let c=!1;const d={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)c&&1<<b&a&&d.numAddAxisAfterEllipsis++,1<<b&i&&(c=!0);c||(d.ellipsisMask|=1<<d.dims,d.dims++);const f={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};I7(d,f);let h=!0,p=!0,m=!0;const v=[],g=[];for(let b=0;b<t.length;++b){if(f.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const _=!!(f.shrinkAxisMask&1<<b),N=t[b];if(N===-1){v.push(_?1:-1);continue}const E=[f.beginMask&1<<b,f.endMask&1<<b],R=[f.strides[b]>0?0:-1,f.strides[b]>0?N:N-1];if(_&&f.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&f.strides[b]===1;const P=!!(f.beginMask&1<<b&&f.endMask&1<<b);if(f.beginValid&&f.endValid){if(_){const ee=f.begin[b]<0?N+f.begin[b]:f.begin[b];if(f.begin[b]=ee,f.end[b]=f.begin[b]+1,ee<0||ee>=N)throw Error(`slice index ${f.begin[b]} of dimension ${b} out of bounds.`)}else f.begin[b]=i_(f.begin[b],0,f.strides[b],N,E,R),f.end[b]=i_(f.end[b],1,f.strides[b],N,E,R);const H=f.strides[b]===1&&f.begin[b]===0&&f.end[b]===N;h=h&&H,p=p&&(b===0&&f.strides[b]===1||H)}else h=h&&f.strides[b]===1&&P,p=p&&(b===0&&f.strides[b]===1||P);let B,F=!1;if(f.beginValid&&f.endValid?(B=f.end[b]-f.begin[b],F=!0):_?(B=1,F=!0):P&&N>=0&&(f.strides[b]<0?B=-N:B=N,F=!0),F){let H;B===0||B<0!=f.strides[b]<0?H=0:H=Math.trunc(B/f.strides[b])+(B%f.strides[b]!==0?1:0),v.push(H)}else v.push(-1)}for(let b=0;b<f.finalShapeGatherIndices.length;++b){const _=f.finalShapeGatherIndices[b];_>=0?g.push(v[_]):_===ov&&g.push(1)}return{finalShapeSparse:g.filter((b,_)=>f.finalShapeGatherIndices[_]!==ov),finalShape:g,isIdentity:h,sliceDim0:p,isSimpleSlice:m,begin:f.begin,end:f.end,strides:f.strides}}function I7(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const s=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<s;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(ov),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(N7),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function i_(t,e,n,r,s,o){if(s[e])return n>0?o[e]:o[e+1&1];{const i=t<0?r+t:t;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const O7=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:MR,computeFlatOffset:jx,computeOutShape:jR,getNormalizedAxes:k7,isSliceContinous:Mx,maskToAxes:$7,parseSliceParams:KR,sliceInfo:XR,startForAxis:HR,startIndicesWithElidedDims:WR,stopForAxis:qR,stopIndicesWithElidedDims:VR,stridesForAxis:GR,stridesWithElidedDims:BR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R7=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function D7(){return new Promise(t=>R7(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YR(t,e){const n=t[0].length;t.forEach((s,o)=>{D(s.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),D(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((s,o)=>{for(let i=0;i<n;i++)D(i===e||s[i]===r[i],()=>`Error in concat${n}D: Shape of tensors[${o}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${o}.`)})}function el(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Qs;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Qs||(Qs={}));function QR(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let s=1;s<n.length;++s){const o=n[s],i=r[r.length-n.length+s],a=r[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+t}] = ${o} but shape[${s+t}] = ${a}`)}else r[i]=o}return r}function ZR(t){const e={FIRST_DIM_SIZE:Qs.FIRST_DIM_SIZE,VALUE_ROWIDS:Qs.VALUE_ROWIDS,ROW_LENGTHS:Qs.ROW_LENGTHS,ROW_SPLITS:Qs.ROW_SPLITS,ROW_LIMITS:Qs.ROW_LIMITS,ROW_STARTS:Qs.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function JR(t){return t.length===0?0:t[0]===Qs.FIRST_DIM_SIZE?t.length-1:t.length}function eD(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(n,r-1);++s){const o=t[s],i=e[s+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-t.length}] = ${o} but ragged tensor input.flatValues.shape[${s-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bx=30;function Am(t){return t<=Bx?t:L0(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tD(t,e,n){const r=n*(typeof t=="number"?t:t[0]),s=e*(typeof t=="number"?t:t[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ux(t,e,n,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(t[0]/n),s=s.concat(t.slice(1));else{s=s.concat(t[0]);const o=e.length;for(let i=0;i<o;++i)s=s.concat([t[i+1]/e[i],e[i]]);s=s.concat(t.slice(o+1))}return s}function zx(t,e,n=!0){const r=[];if(n){r.push(e);for(let s=e+1;s<t;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],o=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?o.push(i):s.push(i);r.push(...s),r.push(0),r.push(...o)}return r}function Wx(t,e,n,r=!0){const s=[];r?s.push(t[0]/n):s.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?r?s.push(e[o-1]*t[o]):s.push(t[o]/e[o-1]):s.push(t[o]);return s}function nD(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function rD(t,e,n){const r=t.slice(0,1);for(let s=0;s<n;++s)r.push(t[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sD=1.7580993408473768,oD=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iD=.3275911,aD=.254829592,lD=-.284496736,uD=1.421413741,cD=-1.453152027,dD=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iv(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function A7(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function P7(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function L7(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<t.length;s+=4)n[Math.floor(s/4)]=t[s],r[Math.floor(s/4)]=t[s+1];return{real:n,imag:r}}function F7(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function M7(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function j7(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let s=0;s<Math.ceil(t/2);s++){const o=(e?2:-2)*Math.PI*(s/t);n[s]=Math.cos(o),r[s]=Math.sin(o)}return{real:n,imag:r}}function B7(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),s=Math.cos(r),o=Math.sin(r);return{real:s,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oy="->",U7=/->/g,a_=",",l_="...";function fD(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(U7,"").length)/oy.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${oy}").`);const[r,s]=t.split(oy);D(r.indexOf(l_)===-1,()=>`The ellipsis notation ("${l_}") is not supported yet.`);const o=r.split(a_),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let f=0;f<s.length;++f){const h=s[f];if(!o.some(p=>p.indexOf(h)!==-1))throw new Error(`Output subscripts contain the label ${h} not present in the input subscripts.`);a.indexOf(h)===-1&&a.push(h)}for(let f=0;f<r.length;++f){const h=r[f];a.indexOf(h)===-1&&h!==a_&&a.push(h)}const l=new Array(o.length);for(let f=0;f<i;++f){if(new Set(o[f].split("")).size!==o[f].length)throw new Error(`Found duplicate axes in input component ${o[f]}. Support for duplicate axes in input is not implemented yet.`);l[f]=[];for(let h=0;h<o[f].length;++h)l[f].push(a.indexOf(o[f][h]))}const u=a.length,c=s.length,d=[];for(let f=c;f<u;++f)d.push(f);return{allDims:a,summedDims:d,idDims:l}}function hD(t,e){let n=new Array(t);n.fill(-1);for(let s=0;s<e.length;++s)n[e[s]]=s;const r=[];for(let s=0;s<t;++s)n[s]===-1&&r.push(s);return n=n.filter(s=>s!==-1),{permutationIndices:n,expandDims:r}}function pD(t,e,n){const r=new Array(t);for(let s=0;s<n.length;++s){const o=n[s].shape;for(let i=0;i<e[s].length;++i)r[e[s][i]]===void 0?r[e[s][i]]=o[i]:D(r[e[s][i]]===o[i],()=>`Expected dimension ${r[e[s][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function mD(t,e){const n=t,r=[];let s=0;t.length===0&&n.push(-1),s=t.length+1;for(let i=0;i<s;++i)r.push([]);const o=[];for(let i=0;i<n.length;++i){const a=n[i],l=z7(e,a);for(const u of l)o.indexOf(u)===-1&&(r[i].push(u),o.push(u))}return{path:n,steps:r}}function gD(t){return t.every((e,n)=>e===n)}function z7(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function yD(t,e,n=0){let r=[];if(typeof e=="number")D(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const s=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);D(s<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[o]=t.shape[n]-i}D(t.shape[n]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vD(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function xD(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function bD(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wD(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function SD(t,e){return`size ${t} must be non-negative, not ${e}`}function CD(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function _D(t,e){const n=pe(t),r=pe(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function ED(t,e){const n=pe(t),r=pe(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function av(){return"segment ids must be >= 0"}function TD(){return"segment ids are not increasing"}function ND(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function $D(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kD(t,e){let n=!1,r;for(t<=Bx?(r=t,n=!0):r=L0(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=L0(t,r+1);return r}function ID(t,e,n){const r=[],s=t.length;for(let o=0;o<s;o++)o!==e?r.push(t[o]):r.push(n);return r}function OD(t,e,n,r){const s=e.shape.length,o=t.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>o)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${o}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],a=[];let l=1,u=1,c=1;for(let d=0;d<r;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)a.push(t.shape[d]),u*=t.shape[d];for(let d=r;d<s;d++)a.push(e.shape[d]);for(let d=n+1;d<o;d++)a.push(t.shape[d]),c*=t.shape[d];return{batchSize:l,sliceSize:c,outerSize:u,dimSize:i,outputShape:a}}const W7=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:OD,computeOutShape:ID,segOpComputeOptimalWindowSize:kD},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _u(t){try{return t.map(e=>bu(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function RD(t){return t.map(e=>Pa(e))}const V7=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:aD,ERF_A2:lD,ERF_A3:uD,ERF_A4:cD,ERF_A5:dD,ERF_P:iD,PARALLELIZE_THRESHOLD:Bx,get RowPartitionType(){return Qs},SELU_SCALE:oD,SELU_SCALEALPHA:sD,applyActivation:Rm,assertAndGetBroadcastShape:nt,assertAxesAreInnerMostDims:lo,assertParamsConsistent:YR,assignToTypedArray:M7,axesAreInnerMostDims:gx,calculateShapes:km,checkEinsumDimSizes:pD,checkPadOnDimRoundingMode:$s,combineLocations:QO,combineRaggedTensorToTensorShapes:QR,complexWithEvenIndex:P7,complexWithOddIndex:L7,computeConv2DInfo:Jr,computeConv3DInfo:Gd,computeDefaultPad:px,computeDilation2DInfo:zO,computeOptimalWindowSize:Am,computeOutAndReduceShapes:No,computeOutShape:el,computePool2DInfo:ul,computePool3DInfo:Vd,convertConv2DDataFormat:Lu,decodeEinsumEquation:fD,eitherStridesOrDilationsAreOne:$r,expandShapeToKeepDim:es,exponent:B7,exponents:j7,fromStringArrayToUint8:RD,fromUint8ToStringArray:_u,getAxesPermutation:ks,getBroadcastDims:mp,getComplexWithIndex:F7,getEinsumComputePath:mD,getEinsumPermutation:hD,getFusedBiasGradient:Om,getFusedDyActivation:Im,getImageCenter:tD,getInnerMostAxes:Is,getPermuted:zx,getRaggedRank:JR,getReductionAxes:KO,getReshaped:Ux,getReshapedPermuted:Wx,getRowPartitionTypesHelper:ZR,getSliceBeginCoords:nD,getSliceSize:rD,getSparseFillEmptyRowsIndicesDenseShapeMismatch:vD,getSparseFillEmptyRowsNegativeIndexErrorMessage:xD,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:bD,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:CD,getSparseReshapeInputOutputMismatchErrorMessage:ED,getSparseReshapeInputOutputMultipleErrorMessage:_D,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:wD,getSparseReshapeNegativeOutputDimErrorMessage:SD,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:$D,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:av,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:TD,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:ND,getUndoAxesPermutation:yx,isIdentityPermutation:gD,log:zU,mergeRealAndImagArrays:iv,prepareAndValidate:FR,prepareSplitSize:yD,segment_util:W7,shouldFuse:Dm,slice_util:O7,splitRealAndImagArrays:A7,stridesOrDilationsArePositive:Ya,tupleValuesAreOne:Cd,upcastType:To,validateDefaultValueShape:eD,validateInput:Rx,validateUpdateShape:wR,warn:Js},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */a7();const lv="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",an=480,ln=288,xh=25,ki=2*xh,DD=["b","k","n","p","q","r","B","K","N","P","Q","R"],u_=["b","k","n","p","q","r"],wp=["a1","b1","c1","d1","e1","f1","g1","h1","a2","b2","c2","d2","e2","f2","g2","h2","a3","b3","c3","d3","e3","f3","g3","h3","a4","b4","c4","d4","e4","f4","g4","h4","a5","b5","c5","d5","e5","f5","g5","h5","a6","b6","c6","d6","e6","f6","g6","h6","a7","b7","c7","d7","e7","f7","g7","h7","a8","b8","c8","d8","e8","f8","g8","h8"],Vs=128,Mf=8*Vs,Vx=["h1","a1","a8","h8"],G7=()=>{const t={};return DD.forEach((e,n)=>{t[e]=n}),t},Rc=G7(),H7=()=>{const t={};return wp.forEach((e,n)=>{t[e]=n}),t},Gs=H7(),c_=["#FF3838","#FF9D97","#FF701F","#FFB21D","#CFD231","#48F90A","#92CC17","#3DDB86","#1A9334","#00D4BB","#2C99A8","#00C2FF"],uv=16/9,AD={audio:!1,video:{facingMode:{ideal:"environment"},width:{ideal:640},aspectRatio:uv,resizeMode:"none"}},PD=t=>{t.clearRect(0,0,t.canvas.width,t.canvas.height)},LD=t=>{const e=t.getContext("2d");e.globalAlpha=.8;const n=e.canvas.width,r=e.canvas.height;PD(e);const o=`${Math.max(Math.round(Math.max(n,r)/40),14)}px Arial`,i=parseInt(o,10),a=Math.max(Math.min(n,r)/200,2.5);e.textBaseline="top",e.lineWidth=a,e.font=o;const l=n/an,u=r/ln;return[e,i,a,l,u]},FD=(t,e,n,r,s)=>{t.strokeStyle=n,e.forEach((o,i)=>{t.strokeRect(o[0]*r,o[1]*s,1,1)})},q7=(t,e,n,r,s)=>{t.strokeStyle=n,t.beginPath();const o=e.length;for(let i=0;i<o;i++)t.moveTo(e[i][0]*r,e[i][1]*s),t.lineTo(e[(i+1)%o][0]*r,e[(i+1)%o][1]*s);t.stroke()},K7=(t,e,n,r,s,o,i)=>{t.fillStyle=e;const a=t.measureText(s).width,l=r-i-o/2,u=n-a/2;t.fillRect(u,l,a+i,o+i),t.fillStyle="#ffffff",t.fillText(s,u,l)},X7=(t,e)=>{const[n,r,s,o,i]=LD(t);FD(n,e,"blue",o,i)},Wo=11102230246251565e-32,zn=134217729,Y7=(3+8*Wo)*Wo;function iy(t,e,n,r,s){let o,i,a,l,u=e[0],c=r[0],d=0,f=0;c>u==c>-u?(o=u,u=e[++d]):(o=c,c=r[++f]);let h=0;if(d<t&&f<n)for(c>u==c>-u?(i=u+o,a=o-(i-u),u=e[++d]):(i=c+o,a=o-(i-c),c=r[++f]),o=i,a!==0&&(s[h++]=a);d<t&&f<n;)c>u==c>-u?(i=o+u,l=i-o,a=o-(i-l)+(u-l),u=e[++d]):(i=o+c,l=i-o,a=o-(i-l)+(c-l),c=r[++f]),o=i,a!==0&&(s[h++]=a);for(;d<t;)i=o+u,l=i-o,a=o-(i-l)+(u-l),u=e[++d],o=i,a!==0&&(s[h++]=a);for(;f<n;)i=o+c,l=i-o,a=o-(i-l)+(c-l),c=r[++f],o=i,a!==0&&(s[h++]=a);return(o!==0||h===0)&&(s[h++]=o),h}function Q7(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function qd(t){return new Float64Array(t)}const Z7=(3+16*Wo)*Wo,J7=(2+12*Wo)*Wo,eK=(9+64*Wo)*Wo*Wo,Tl=qd(4),d_=qd(8),f_=qd(12),h_=qd(16),or=qd(4);function tK(t,e,n,r,s,o,i){let a,l,u,c,d,f,h,p,m,v,g,x,b,_,N,E,R,P;const B=t-s,F=n-s,H=e-o,ee=r-o;_=B*ee,f=zn*B,h=f-(f-B),p=B-h,f=zn*ee,m=f-(f-ee),v=ee-m,N=p*v-(_-h*m-p*m-h*v),E=H*F,f=zn*H,h=f-(f-H),p=H-h,f=zn*F,m=f-(f-F),v=F-m,R=p*v-(E-h*m-p*m-h*v),g=N-R,d=N-g,Tl[0]=N-(g+d)+(d-R),x=_+g,d=x-_,b=_-(x-d)+(g-d),g=b-E,d=b-g,Tl[1]=b-(g+d)+(d-E),P=x+g,d=P-x,Tl[2]=x-(P-d)+(g-d),Tl[3]=P;let oe=Q7(4,Tl),de=J7*i;if(oe>=de||-oe>=de||(d=t-B,a=t-(B+d)+(d-s),d=n-F,u=n-(F+d)+(d-s),d=e-H,l=e-(H+d)+(d-o),d=r-ee,c=r-(ee+d)+(d-o),a===0&&l===0&&u===0&&c===0)||(de=eK*i+Y7*Math.abs(oe),oe+=B*c+ee*a-(H*u+F*l),oe>=de||-oe>=de))return oe;_=a*ee,f=zn*a,h=f-(f-a),p=a-h,f=zn*ee,m=f-(f-ee),v=ee-m,N=p*v-(_-h*m-p*m-h*v),E=l*F,f=zn*l,h=f-(f-l),p=l-h,f=zn*F,m=f-(f-F),v=F-m,R=p*v-(E-h*m-p*m-h*v),g=N-R,d=N-g,or[0]=N-(g+d)+(d-R),x=_+g,d=x-_,b=_-(x-d)+(g-d),g=b-E,d=b-g,or[1]=b-(g+d)+(d-E),P=x+g,d=P-x,or[2]=x-(P-d)+(g-d),or[3]=P;const V=iy(4,Tl,4,or,d_);_=B*c,f=zn*B,h=f-(f-B),p=B-h,f=zn*c,m=f-(f-c),v=c-m,N=p*v-(_-h*m-p*m-h*v),E=H*u,f=zn*H,h=f-(f-H),p=H-h,f=zn*u,m=f-(f-u),v=u-m,R=p*v-(E-h*m-p*m-h*v),g=N-R,d=N-g,or[0]=N-(g+d)+(d-R),x=_+g,d=x-_,b=_-(x-d)+(g-d),g=b-E,d=b-g,or[1]=b-(g+d)+(d-E),P=x+g,d=P-x,or[2]=x-(P-d)+(g-d),or[3]=P;const W=iy(V,d_,4,or,f_);_=a*c,f=zn*a,h=f-(f-a),p=a-h,f=zn*c,m=f-(f-c),v=c-m,N=p*v-(_-h*m-p*m-h*v),E=l*u,f=zn*l,h=f-(f-l),p=l-h,f=zn*u,m=f-(f-u),v=u-m,R=p*v-(E-h*m-p*m-h*v),g=N-R,d=N-g,or[0]=N-(g+d)+(d-R),x=_+g,d=x-_,b=_-(x-d)+(g-d),g=b-E,d=b-g,or[1]=b-(g+d)+(d-E),P=x+g,d=P-x,or[2]=x-(P-d)+(g-d),or[3]=P;const I=iy(W,f_,4,or,h_);return h_[I-1]}function jf(t,e,n,r,s,o){const i=(e-o)*(n-s),a=(t-s)*(r-o),l=i-a,u=Math.abs(i+a);return Math.abs(l)>=Z7*u?l:-tK(t,e,n,r,s,o,u)}const p_=Math.pow(2,-52),Bf=new Uint32Array(512);class Gx{static from(e,n=iK,r=aK){const s=e.length,o=new Float64Array(s*2);for(let i=0;i<s;i++){const a=e[i];o[2*i]=n(a),o[2*i+1]=r(a)}return new Gx(o)}constructor(e){const n=e.length>>1;if(n>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:e,_hullPrev:n,_hullNext:r,_hullTri:s,_hullHash:o}=this,i=e.length>>1;let a=1/0,l=1/0,u=-1/0,c=-1/0;for(let F=0;F<i;F++){const H=e[2*F],ee=e[2*F+1];H<a&&(a=H),ee<l&&(l=ee),H>u&&(u=H),ee>c&&(c=ee),this._ids[F]=F}const d=(a+u)/2,f=(l+c)/2;let h=1/0,p,m,v;for(let F=0;F<i;F++){const H=ay(d,f,e[2*F],e[2*F+1]);H<h&&(p=F,h=H)}const g=e[2*p],x=e[2*p+1];h=1/0;for(let F=0;F<i;F++){if(F===p)continue;const H=ay(g,x,e[2*F],e[2*F+1]);H<h&&H>0&&(m=F,h=H)}let b=e[2*m],_=e[2*m+1],N=1/0;for(let F=0;F<i;F++){if(F===p||F===m)continue;const H=sK(g,x,b,_,e[2*F],e[2*F+1]);H<N&&(v=F,N=H)}let E=e[2*v],R=e[2*v+1];if(N===1/0){for(let ee=0;ee<i;ee++)this._dists[ee]=e[2*ee]-e[0]||e[2*ee+1]-e[1];ql(this._ids,this._dists,0,i-1);const F=new Uint32Array(i);let H=0;for(let ee=0,oe=-1/0;ee<i;ee++){const de=this._ids[ee];this._dists[de]>oe&&(F[H++]=de,oe=this._dists[de])}this.hull=F.subarray(0,H),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(jf(g,x,b,_,E,R)<0){const F=m,H=b,ee=_;m=v,b=E,_=R,v=F,E=H,R=ee}const P=oK(g,x,b,_,E,R);this._cx=P.x,this._cy=P.y;for(let F=0;F<i;F++)this._dists[F]=ay(e[2*F],e[2*F+1],P.x,P.y);ql(this._ids,this._dists,0,i-1),this._hullStart=p;let B=3;r[p]=n[v]=m,r[m]=n[p]=v,r[v]=n[m]=p,s[p]=0,s[m]=1,s[v]=2,o.fill(-1),o[this._hashKey(g,x)]=p,o[this._hashKey(b,_)]=m,o[this._hashKey(E,R)]=v,this.trianglesLen=0,this._addTriangle(p,m,v,-1,-1,-1);for(let F=0,H,ee;F<this._ids.length;F++){const oe=this._ids[F],de=e[2*oe],V=e[2*oe+1];if(F>0&&Math.abs(de-H)<=p_&&Math.abs(V-ee)<=p_||(H=de,ee=V,oe===p||oe===m||oe===v))continue;let W=0;for(let ne=0,U=this._hashKey(de,V);ne<this._hashSize&&(W=o[(U+ne)%this._hashSize],!(W!==-1&&W!==r[W]));ne++);W=n[W];let I=W,O;for(;O=r[I],jf(de,V,e[2*I],e[2*I+1],e[2*O],e[2*O+1])>=0;)if(I=O,I===W){I=-1;break}if(I===-1)continue;let j=this._addTriangle(I,oe,r[I],-1,-1,s[I]);s[oe]=this._legalize(j+2),s[I]=j,B++;let A=r[I];for(;O=r[A],jf(de,V,e[2*A],e[2*A+1],e[2*O],e[2*O+1])<0;)j=this._addTriangle(A,oe,O,s[oe],-1,s[A]),s[oe]=this._legalize(j+2),r[A]=A,B--,A=O;if(I===W)for(;O=n[I],jf(de,V,e[2*O],e[2*O+1],e[2*I],e[2*I+1])<0;)j=this._addTriangle(O,oe,I,-1,s[I],s[O]),this._legalize(j+2),s[O]=j,r[I]=I,B--,I=O;this._hullStart=n[oe]=I,r[I]=n[A]=oe,r[oe]=A,o[this._hashKey(de,V)]=oe,o[this._hashKey(e[2*I],e[2*I+1])]=I}this.hull=new Uint32Array(B);for(let F=0,H=this._hullStart;F<B;F++)this.hull[F]=H,H=r[H];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,n){return Math.floor(nK(e-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:n,_halfedges:r,coords:s}=this;let o=0,i=0;for(;;){const a=r[e],l=e-e%3;if(i=l+(e+2)%3,a===-1){if(o===0)break;e=Bf[--o];continue}const u=a-a%3,c=l+(e+1)%3,d=u+(a+2)%3,f=n[i],h=n[e],p=n[c],m=n[d];if(rK(s[2*f],s[2*f+1],s[2*h],s[2*h+1],s[2*p],s[2*p+1],s[2*m],s[2*m+1])){n[e]=m,n[a]=f;const g=r[d];if(g===-1){let b=this._hullStart;do{if(this._hullTri[b]===d){this._hullTri[b]=e;break}b=this._hullPrev[b]}while(b!==this._hullStart)}this._link(e,g),this._link(a,r[i]),this._link(i,d);const x=u+(a+1)%3;o<Bf.length&&(Bf[o++]=x)}else{if(o===0)break;e=Bf[--o]}}return i}_link(e,n){this._halfedges[e]=n,n!==-1&&(this._halfedges[n]=e)}_addTriangle(e,n,r,s,o,i){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,s),this._link(a+1,o),this._link(a+2,i),this.trianglesLen+=3,a}}function nK(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}function ay(t,e,n,r){const s=t-n,o=e-r;return s*s+o*o}function rK(t,e,n,r,s,o,i,a){const l=t-i,u=e-a,c=n-i,d=r-a,f=s-i,h=o-a,p=l*l+u*u,m=c*c+d*d,v=f*f+h*h;return l*(d*v-m*h)-u*(c*v-m*f)+p*(c*h-d*f)<0}function sK(t,e,n,r,s,o){const i=n-t,a=r-e,l=s-t,u=o-e,c=i*i+a*a,d=l*l+u*u,f=.5/(i*u-a*l),h=(u*c-a*d)*f,p=(i*d-l*c)*f;return h*h+p*p}function oK(t,e,n,r,s,o){const i=n-t,a=r-e,l=s-t,u=o-e,c=i*i+a*a,d=l*l+u*u,f=.5/(i*u-a*l),h=t+(u*c-a*d)*f,p=e+(i*d-l*c)*f;return{x:h,y:p}}function ql(t,e,n,r){if(r-n<=20)for(let s=n+1;s<=r;s++){const o=t[s],i=e[o];let a=s-1;for(;a>=n&&e[t[a]]>i;)t[a+1]=t[a--];t[a+1]=o}else{const s=n+r>>1;let o=n+1,i=r;xc(t,s,o),e[t[n]]>e[t[r]]&&xc(t,n,r),e[t[o]]>e[t[r]]&&xc(t,o,r),e[t[n]]>e[t[o]]&&xc(t,n,o);const a=t[o],l=e[a];for(;;){do o++;while(e[t[o]]<l);do i--;while(e[t[i]]>l);if(i<o)break;xc(t,o,i)}t[n+1]=t[i],t[i]=a,r-o+1>=i-n?(ql(t,e,o,r),ql(t,e,n,i-1)):(ql(t,e,n,i-1),ql(t,e,o,r))}}function xc(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function iK(t){return t[0]}function aK(t){return t[1]}var lK={},uK=Object.create,MD=Object.defineProperty,cK=Object.getOwnPropertyDescriptor,dK=Object.getOwnPropertyNames,fK=Object.getPrototypeOf,hK=Object.prototype.hasOwnProperty,Hx=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,n)=>(typeof require<"u"?require:e)[n]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+t+'" is not supported')}),qx=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),pK=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of dK(e))!hK.call(t,s)&&s!==n&&MD(t,s,{get:()=>e[s],enumerable:!(r=cK(e,s))||r.enumerable});return t},mK=(t,e,n)=>(n=t!=null?uK(fK(t)):{},pK(e||!t||!t.__esModule?MD(n,"default",{value:t,enumerable:!0}):n,t)),gK=qx((t,e)=>{e.exports=function(n){return n&&typeof n=="object"&&typeof n.copy=="function"&&typeof n.fill=="function"&&typeof n.readUInt8=="function"}}),yK=qx((t,e)=>{typeof Object.create=="function"?e.exports=function(n,r){n.super_=r,n.prototype=Object.create(r.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(n,r){n.super_=r;var s=function(){};s.prototype=r.prototype,n.prototype=new s,n.prototype.constructor=n}}),vK=qx(t=>{var e=/%[sdj%]/g;t.format=function(I){if(!b(I)){for(var O=[],j=0;j<arguments.length;j++)O.push(s(arguments[j]));return O.join(" ")}for(var j=1,A=arguments,ne=A.length,U=String(I).replace(e,function(J){if(J==="%%")return"%";if(j>=ne)return J;switch(J){case"%s":return String(A[j++]);case"%d":return Number(A[j++]);case"%j":try{return JSON.stringify(A[j++])}catch{return"[Circular]"}default:return J}}),Q=A[j];j<ne;Q=A[++j])v(Q)||!R(Q)?U+=" "+Q:U+=" "+s(Q);return U},t.deprecate=function(I,O){if(N(global.process))return function(){return t.deprecate(I,O).apply(this,arguments)};if(process.noDeprecation===!0)return I;var j=!1;function A(){if(!j){if(process.throwDeprecation)throw new Error(O);process.traceDeprecation?console.trace(O):console.error(O),j=!0}return I.apply(this,arguments)}return A};var n={},r;t.debuglog=function(I){if(N(r)&&(r=lK.NODE_DEBUG||""),I=I.toUpperCase(),!n[I])if(new RegExp("\\b"+I+"\\b","i").test(r)){var O=process.pid;n[I]=function(){var j=t.format.apply(t,arguments);console.error("%s %d: %s",I,O,j)}}else n[I]=function(){};return n[I]};function s(I,O){var j={seen:[],stylize:i};return arguments.length>=3&&(j.depth=arguments[2]),arguments.length>=4&&(j.colors=arguments[3]),m(O)?j.showHidden=O:O&&t._extend(j,O),N(j.showHidden)&&(j.showHidden=!1),N(j.depth)&&(j.depth=2),N(j.colors)&&(j.colors=!1),N(j.customInspect)&&(j.customInspect=!0),j.colors&&(j.stylize=o),l(j,I,j.depth)}t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function o(I,O){var j=s.styles[O];return j?"\x1B["+s.colors[j][0]+"m"+I+"\x1B["+s.colors[j][1]+"m":I}function i(I,O){return I}function a(I){var O={};return I.forEach(function(j,A){O[j]=!0}),O}function l(I,O,j){if(I.customInspect&&O&&F(O.inspect)&&O.inspect!==t.inspect&&!(O.constructor&&O.constructor.prototype===O)){var A=O.inspect(j,I);return b(A)||(A=l(I,A,j)),A}var ne=u(I,O);if(ne)return ne;var U=Object.keys(O),Q=a(U);if(I.showHidden&&(U=Object.getOwnPropertyNames(O)),B(O)&&(U.indexOf("message")>=0||U.indexOf("description")>=0))return c(O);if(U.length===0){if(F(O)){var G=O.name?": "+O.name:"";return I.stylize("[Function"+G+"]","special")}if(E(O))return I.stylize(RegExp.prototype.toString.call(O),"regexp");if(P(O))return I.stylize(Date.prototype.toString.call(O),"date");if(B(O))return c(O)}var J="",re=!1,be=["{","}"];if(p(O)&&(re=!0,be=["[","]"]),F(O)){var ue=O.name?": "+O.name:"";J=" [Function"+ue+"]"}if(E(O)&&(J=" "+RegExp.prototype.toString.call(O)),P(O)&&(J=" "+Date.prototype.toUTCString.call(O)),B(O)&&(J=" "+c(O)),U.length===0&&(!re||O.length==0))return be[0]+J+be[1];if(j<0)return E(O)?I.stylize(RegExp.prototype.toString.call(O),"regexp"):I.stylize("[Object]","special");I.seen.push(O);var De;return re?De=d(I,O,j,Q,U):De=U.map(function(Ae){return f(I,O,j,Q,Ae,re)}),I.seen.pop(),h(De,J,be)}function u(I,O){if(N(O))return I.stylize("undefined","undefined");if(b(O)){var j="'"+JSON.stringify(O).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return I.stylize(j,"string")}if(x(O))return I.stylize(""+O,"number");if(m(O))return I.stylize(""+O,"boolean");if(v(O))return I.stylize("null","null")}function c(I){return"["+Error.prototype.toString.call(I)+"]"}function d(I,O,j,A,ne){for(var U=[],Q=0,G=O.length;Q<G;++Q)W(O,String(Q))?U.push(f(I,O,j,A,String(Q),!0)):U.push("");return ne.forEach(function(J){J.match(/^\d+$/)||U.push(f(I,O,j,A,J,!0))}),U}function f(I,O,j,A,ne,U){var Q,G,J;if(J=Object.getOwnPropertyDescriptor(O,ne)||{value:O[ne]},J.get?J.set?G=I.stylize("[Getter/Setter]","special"):G=I.stylize("[Getter]","special"):J.set&&(G=I.stylize("[Setter]","special")),W(A,ne)||(Q="["+ne+"]"),G||(I.seen.indexOf(J.value)<0?(v(j)?G=l(I,J.value,null):G=l(I,J.value,j-1),G.indexOf(`
`)>-1&&(U?G=G.split(`
`).map(function(re){return"  "+re}).join(`
`).substr(2):G=`
`+G.split(`
`).map(function(re){return"   "+re}).join(`
`))):G=I.stylize("[Circular]","special")),N(Q)){if(U&&ne.match(/^\d+$/))return G;Q=JSON.stringify(""+ne),Q.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Q=Q.substr(1,Q.length-2),Q=I.stylize(Q,"name")):(Q=Q.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Q=I.stylize(Q,"string"))}return Q+": "+G}function h(I,O,j){var A=0,ne=I.reduce(function(U,Q){return A++,Q.indexOf(`
`)>=0&&A++,U+Q.replace(/\u001b\[\d\d?m/g,"").length+1},0);return ne>60?j[0]+(O===""?"":O+`
 `)+" "+I.join(`,
  `)+" "+j[1]:j[0]+O+" "+I.join(", ")+" "+j[1]}function p(I){return Array.isArray(I)}t.isArray=p;function m(I){return typeof I=="boolean"}t.isBoolean=m;function v(I){return I===null}t.isNull=v;function g(I){return I==null}t.isNullOrUndefined=g;function x(I){return typeof I=="number"}t.isNumber=x;function b(I){return typeof I=="string"}t.isString=b;function _(I){return typeof I=="symbol"}t.isSymbol=_;function N(I){return I===void 0}t.isUndefined=N;function E(I){return R(I)&&ee(I)==="[object RegExp]"}t.isRegExp=E;function R(I){return typeof I=="object"&&I!==null}t.isObject=R;function P(I){return R(I)&&ee(I)==="[object Date]"}t.isDate=P;function B(I){return R(I)&&(ee(I)==="[object Error]"||I instanceof Error)}t.isError=B;function F(I){return typeof I=="function"}t.isFunction=F;function H(I){return I===null||typeof I=="boolean"||typeof I=="number"||typeof I=="string"||typeof I=="symbol"||typeof I>"u"}t.isPrimitive=H,t.isBuffer=gK();function ee(I){return Object.prototype.toString.call(I)}function oe(I){return I<10?"0"+I.toString(10):I.toString(10)}var de=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function V(){var I=new Date,O=[oe(I.getHours()),oe(I.getMinutes()),oe(I.getSeconds())].join(":");return[I.getDate(),de[I.getMonth()],O].join(" ")}t.log=function(){console.log("%s - %s",V(),t.format.apply(t,arguments))},t.inherits=yK(),t._extend=function(I,O){if(!O||!R(O))return I;for(var j=Object.keys(O),A=j.length;A--;)I[j[A]]=O[j[A]];return I};function W(I,O){return Object.prototype.hasOwnProperty.call(I,O)}}),Nl=32,jD=t=>t.reduce((e,n)=>e.concat(Array.isArray(n)?jD(n):n),[]),BD=t=>ArrayBuffer.isView(t)&&!(t instanceof DataView),UD=t=>t.reduce((e,n)=>e*n,1),zD=t=>Array.isArray(t)||BD(t)?[t.length].concat(zD(t[0])):[],Kx=t=>[...t.slice(1).map((e,n)=>t.slice(n+1).reduce((r,s)=>r*s,1)),1],xK=t=>{let{constructor:{name:e="Float32Array"}={}}=t||{};switch(e){case"Int8Array":return"int8";case"Uint8Array":return"uint8";case"Int16Array":return"int16";case"Uint16Array":return"uint16";case"Int32Array":return"int32";case"Uint32Array":return"uint32";case"Uint8ClampedArray":return"uint8c";case"Float32Array":return"float32";case"Float64Array":return"float64";default:return"float64"}},Eu=t=>{switch(t){case"int8":return Int8Array;case"uint8":return Uint8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"uint8c":return Uint8ClampedArray;case"float32":return Float32Array;case"float64":return Float64Array;default:return Float64Array}},ro=(...t)=>new hl(...t),Me=class{constructor(e){ie(this,"x");ie(this,"shape");ie(this,"shapem1");ie(this,"strides");ie(this,"backstrides");ie(this,"length");ie(this,"lengthm1");ie(this,"nd");ie(this,"ndm1");ie(this,"index");ie(this,"coords");ie(this,"pos");ie(this,"factors");this.x=ro(e);let{shape:n,strides:r,length:s}=this.x;this.length=s,this.lengthm1=s-1,this.nd=n.length,this.ndm1=this.nd-1,this.shape=Array(Nl).fill(0),this.strides=Array(Nl).fill(0),this.shapem1=Array(Nl).fill(0),this.coords=Array(Nl).fill(0),this.backstrides=Array(Nl).fill(0),this.factors=Array(Nl).fill(0),this.nd!==0&&(this.factors[this.nd-1]=1);let o;for(o=0;o<this.nd;o+=1)this.shape[o]=n[o],this.shapem1[o]=n[o]-1,this.strides[o]=r[o],this.backstrides[o]=r[o]*this.shapem1[o],this.coords[o]=0,o>0&&(this.factors[this.ndm1-o]=this.factors[this.nd-o]*n[this.nd-o]);this.index=0,this.pos=0}done(){return this.index>this.lengthm1}current(){let e=this.done();return{value:e?void 0:this.pos,done:e}}next(){let e=this.current();if(e.done)return e;let{ndm1:n,shapem1:r,strides:s,backstrides:o}=this,i;for(i=n;i>=0;i-=1){if(this.coords[i]<r[i]){this.coords[i]+=1,this.pos+=s[i];break}this.coords[i]=0,this.pos-=o[i]}return this.index+=1,e}[Symbol.iterator](){return this}},ju=class{constructor(...t){ie(this,"iters");ie(this,"shape");ie(this,"nd");ie(this,"length");ie(this,"lengthm1");ie(this,"numiter");ie(this,"index");ie(this,"pos");this.iters=t.map(a=>new Me(a)),this.numiter=t.length;let e,n;for(e=0,n=0;e<this.numiter;e+=1)n=Math.max(n,this.iters[e].x.shape.length);this.nd=n,this.shape=Array(n).fill(0);let r,s,o,i;for(e=0;e<n;e+=1)for(this.shape[e]=1,s=0;s<this.numiter;s+=1)if(r=this.iters[s],o=e+r.x.shape.length-n,o>=0){if(i=r.x.shape[o],i==1)continue;if(this.shape[e]==1)this.shape[e]=i;else if(this.shape[e]!==i)throw new Error("shape mismatch")}for(i=this.shape.reduce((a,l)=>a*l,1),this.length=i,this.lengthm1=i-1,e=0;e<this.numiter;e+=1)for(r=this.iters[e],r.nd=this.nd,r.ndm1=this.nd-1,r.length=i,r.lengthm1=i-1,n=r.x.shape.length,n!==0&&(r.factors[this.nd-1]=1),s=0;s<this.nd;s+=1)r.shape[s]=this.shape[s],r.shapem1[s]=this.shape[s]-1,o=s+n-this.nd,o<0||r.x.shape[o]!==this.shape[s]?r.strides[s]=0:r.strides[s]=r.x.strides[o],r.backstrides[s]=r.strides[s]*r.shapem1[s],s>0&&(r.factors[this.nd-s-1]=r.factors[this.nd-s]*this.shape[this.nd-s]);this.index=0,this.pos=Array(this.numiter).fill(0)}done(){return this.index>this.lengthm1}current(){let t=this.done();return{value:t?void 0:this.pos,done:t}}next(){let t=this.current();if(t.done)return t;this.index+=1;let{numiter:e}=this,n,r;for(r=0;r<e;r+=1)n=this.iters[r],this.pos[r]=n.pos,n.next();return t}[Symbol.iterator](){return this}},{abs:bK}=Math;function wK(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=bK(t[n]);return this}var{acos:SK}=Math;function CK(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=SK(t[n]);return this}var{acosh:_K}=Math;function EK(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=_K(t[n]);return this}var tn;try{tn=Hx("nblas")}catch{}var m_=tn&&tn.NoTrans;tn&&tn.Trans;function TK(t,e,n,r,s,o,i){if(r.length/s!==e||o.length/i!==e)throw new Error("lengths do not match");switch(t){case"float64":return tn.daxpy(e,n,r,s,o,i);case"float32":return tn.saxpy(e,n,r,s,o,i);default:throw new Error("wrong dtype")}}function NK(t,e,n,r,s,o){if(n.length/r!==e||s.length/o!==e)throw new Error("lengths do not match");switch(t){case"float64":return tn.ddot(e,n,r,s,o);case"float32":return tn.sdot(e,n,r,s,o);default:throw new Error("wrong dtype")}}function $K(t,e,n,r){if(n.length/r!==e)throw new Error("lengths do not match");switch(t){case"float64":return tn.idamax(e,n,r);case"float32":return tn.isamax(e,n,r);default:throw new Error("wrong dtype")}}function kK(t,e,n,r,s,o,i,a,l,u,c,d,f,h){let{length:p}=a,{length:m}=u,{length:v}=f;if(e===tn.NoTrans&&p!==l*r||e===tn.Trans&&p!==l*o)throw new Error("lengths do not match");if(n===tn.NoTrans&&m!==c*o||n===tn.Trans&&m!==c*s)throw new Error("lengths do not match");if(v!==h*r)throw new Error("lengths do not match");switch(t){case"float64":return tn.dgemm(e,n,r,s,o,i,a,l,u,c,d,f,h);case"float32":return tn.sgemm(e,n,r,s,o,i,a,l,u,c,d,f,h);default:throw new Error("wrong dtype")}}function IK(t,e,n,r){if(n.length/r!==e)throw new Error("lengths do not match");switch(t){case"float64":return tn.dnrm2(e,n,r);case"float32":return tn.snrm2(e,n,r);default:throw new Error("wrong dtype")}}function OK(t,e,n,r,s){if(r.length/s!==e)throw new Error("lengths do not match");switch(t){case"float64":return tn.dscal(e,n,r,s);case"float32":return tn.sscal(e,n,r,s);default:throw new Error("wrong dtype")}}function RK(t,e=1){let{data:n,length:r,strides:s,dtype:o}=this,{data:i,strides:a}=ro(t);try{let l=a[a.length-1],u=s[s.length-1];if(l!==u)throw new Error("inc_x and inc_y must be equal");TK(o,r,e,i,l,n,u)}catch{let l=new ju(this,t);for(let[u,c]of l)n[u]+=e*i[c]}return this}var{acos:DK}=Math;function AK(t){return DK(this.dot(ro(t))/this.norm()/ro(t).norm())}var{asin:PK}=Math;function LK(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=PK(t[n]);return this}var{asinh:FK}=Math;function MK(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=FK(t[n]);return this}var{atan:jK}=Math;function BK(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=jK(t[n]);return this}var{atanh:UK}=Math;function zK(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=UK(t[n]);return this}var xo=(...t)=>new hl(new Float64Array(t.reduce((e,n)=>e*n,1)),{shape:t}).fill(0),WK=(t,e)=>ro(t).augment(ro(e));function VK(t){let[e,n]=this.shape,[r,s]=ro(t).shape,{data:o}=this,{data:i}=ro(t);if(r===0||s===0)return this;if(e!==r)throw new Error("rows do not match");let a=xo(e,n+s),{data:l}=a,u,c;for(u=0;u<e;u+=1)for(c=0;c<n;c+=1)l[u*(n+s)+c]=o[u*n+c];for(u=0;u<r;u+=1)for(c=0;c<s;c+=1)l[u*(n+s)+(c+n)]=i[u*s+c];return a}function GK(t,e){let{data:n}=this,{data:r}=ro(t),s=new ju(this,t);for(let[o,i]of s)n[o]=e(n[o],r[i],o);return this}var{cbrt:HK}=Math;function qK(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=HK(t[n]);return this}var{ceil:KK}=Math;function XK(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=KK(t[n]);return this}function YK(...t){let{shape:e,length:n}=this;if(t.length===1){let[r]=t;if(r<0||r>n-1||!Number.isFinite(r))throw new Error("index out of bounds")}else if(!e.every((r,s)=>r>t[s]&&Number.isFinite(t[s])&&t[s]>=0))throw new Error("index out of bounds")}function QK(t){if(this.shape.length!==1&&t.shape.length!==1)throw new Error("combine operation not permitted for multidimensional arrays");let{length:e,data:n}=this,{length:r,data:s}=t;if(r===0)return this;if(e===0)return this.data=new(Eu(t.dtype))(s),this.length=r,this.dtype=t.dtype,this;let o=e+r,i=new(Eu(this.dtype))(o);return i.set(n),i.set(s,e),this.data=i,this.length=o,this.shape=[o],this}function ZK(){let t=xo(...this.shape),{data:e}=this,{data:n}=t,r=new ju(this,t);for(let[s,o]of r)n[o]=e[s];return t}var{cos:JK}=Math;function e9(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=JK(t[n]);return this}var{cosh:t9}=Math;function n9(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=t9(t[n]);return this}function r9(t){let{length:e}=this,{length:n}=t;if(e!==3||n!==3)throw new Error("vectors must have three components");let r=this.y*t.z-this.z*t.y,s=this.z*t.x-this.x*t.z,o=this.x*t.y-this.y*t.x;return this.x=r,this.y=s,this.z=o,this}function s9(){this.square();let[t]=this.shape,[e,n]=this.copy().lu_factor(),{data:r}=e,s=1,o=1,i;for(i=0;i<t;i+=1)s*=r[i*t+i],i!==n[i]-1&&(o*=-1);return o*s}function o9(){this.square();let{length:t}=this,[e,n]=this.shape,r=Math.min(e,n);return this.reshape(t).slice(0,t,r+1)}function i9(t){let{data:e,length:n,strides:r,dtype:s}=this,{data:o,strides:i}=t,a=0;try{let l=i[i.length-1],u=r[r.length-1];if(l!==u)throw new Error("inc_x and inc_y must be equal");a=NK(s,n,o,l,e,u)}catch{let l=new ju(this,t);for(let[u,c]of l)a+=e[u]*o[c]}return a}var WD=t=>{let e=new hl(new Float64Array(t*t),{shape:[t,t]}),{data:n}=e,r;for(r=0;r<t;r+=1)n[r*t+r]=1;return e},Dc;try{Dc=Hx("nlapack")}catch{}var Uf=(t,e,n,r,s,o,i)=>{let[a]=t.shape,{data:l}=t,u=l[r*a+s],c=1/(e+n);l[r*a+s]=u-n*(l[o*a+i]+c*u),l[o*a+i]+=n*(u-c*l[o*a+i])};function a9(){this.square();let[t]=this.shape;try{["float32","float64"].includes(this.dtype)||(this.dtype="float32",this.data=Eu(this.dtype).from(this.data));let e=Dc.NoEigenvector,n=Dc.Eigenvector,r=xo(t),s=xo(t),o=xo(t,t),i=xo(t,t),{data:a}=this,{data:l}=r,{data:u}=s,{data:c}=o,{data:d}=i;return this.dtype==="float64"&&Dc.dgeev(e,n,t,a,t,l,u,c,t,d,t),this.dtype==="float32"&&Dc.sgeev(e,n,t,a,t,l,u,c,t,d,t),[r,i]}catch{let{data:e}=this,n=WD(t),r=0,s=0,o=0,i=0,a=0;do{for(s=0;s<t;s+=1)for(o=s+1;o<t;o+=1)Math.abs(e[s*t+o])>=r&&(r=Math.abs(e[s*t+o]),i=s,a=o);let l;if(Math.abs(e[i*t+a])<Math.abs(e[a*t+a])*1e-36)l=e[i*t+a]/e[a*t+a];else{let f=e[a*t+a]/2*e[i*t+a];l=1/(Math.abs(f)+Math.sqrt(f*f+1))}let u=1/Math.sqrt(l*l+1),c=l*u,d=e[i*t+a];for(e[i*t+a]=0,e[i*t+i]-=l*d,e[a*t+a]+=l*d,s=0;s<i;s+=1)Uf(this,u,c,s,i,s,a);for(s=i+1;s<a;s+=1)Uf(this,u,c,i,s,s,a);for(s=a+1;s<t;s+=1)Uf(this,u,c,i,s,a,s);for(s=0;s<t;s+=1)Uf(n,u,c,s,i,s,a)}while(r>=1e-9);return[this.diagonal(),n]}}function l9(t,e=1e-6){let{data:n}=this,{data:r}=t,s=new ju(this,t);for(let[o,i]of s)if(Math.abs(n[o]-r[i])>e)return!1;return!0}function u9(t){let{shape:e}=this,{shape:n}=t;if(!e.every((r,s)=>r===n[s]))throw new Error(`shapes ${e} and ${n} do not match`)}function c9(t){let{length:e}=this,{length:n}=t;if(e!==n)throw new Error(`lengths ${e} and ${n} do not match`)}var{exp:d9}=Math;function f9(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=d9(t[n]);return this}var{expm1:h9}=Math;function p9(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=h9(t[n]);return this}function m9(t=0){let{data:e}=this,n=new Me(this);for(let r of n)e[r]=t instanceof Function?t(r):t;return this}var{floor:g9}=Math;function y9(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=g9(t[n]);return this}function v9(t){let{data:e}=this,n=new Me(this);for(let r of n)t.call(this,e[r],r,e)}var{fround:x9}=Math;function b9(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=x9(t[n]);return this}function w9(){let{shape:[t,e],data:n}=this,r=0,s,o,i,a,l;for(i=0;i<t;i+=1){if(e<=r)return this;for(a=i;n[a*e+r]===0;)if(a+=1,t===a&&(a=i,r+=1,e===r))return this;if(i!==a&&this.swap(i,a),o=n[i*e+r],o!==0)for(l=0;l<e;l+=1)n[i*e+l]/=o;for(a=0;a<t;a+=1)if(s=n[a*e+r],a!==i)for(l=0;l<e;l+=1)n[a*e+l]-=n[i*e+l]*s;r+=1}for(i=0;i<t;i+=1){for(o=0,a=0;a<e;a+=1)o===0&&(o=n[i*e+a]);if(o!==0)for(l=0;l<e;l+=1)n[i*e+l]/=o}return this}function S9(...t){this.check(...t);let{data:e,shape:n}=this,{length:r}=n,s=t[r-1],o,i;for(o=0;o<r-1;o+=1){let a=1;for(i=o+1;i<r;i+=1)a*=n[i];s+=t[o]*a}return e[s]}var tl;try{tl=Hx("nlapack")}catch{}function VD(t,e,n,r,s,o){if(r.length!==e*n)throw new Error("lengths do not match");switch(t){case"float64":return tl.dgetrf(e,n,r,s,o);case"float32":return tl.sgetrf(e,n,r,s,o);default:throw new Error("wrong dtype")}}function C9(t,e,n,r,s){if(n.length!==e*e)throw new Error("lengths do not match");switch(t){case"float64":return tl.dgetri(e,n,r,s);case"float32":return tl.sgetri(e,n,r,s);default:throw new Error("wrong dtype")}}function _9(t,e,n,r,s,o,i,a){if(r.length!==s*e||i.length!==a*n)throw new Error("lengths do not match");switch(t){case"float64":return tl.dgesv(e,n,r,s,o,i,a);case"float32":return tl.sgesv(e,n,r,s,o,i,a);default:throw new Error("wrong dtype")}}function E9(){this.square();let{shape:[t],dtype:e}=this;try{let{data:n}=this,r=new Int32Array(t);return VD(e,t,t,n,t,r),C9(e,t,n,t,r),this}catch{let n=WD(t),r=WK(this,n).gauss(),s=xo(t,t),o=xo(t,t),{data:i}=r,{data:a}=s,{data:l}=o,u=new Me(r),[c,d]=u.coords;for(let f of u)d<t?a[c*t+d]=i[f]:l[c*t+(d-t)]=i[f],[c,d]=u.coords;if(!s.equals(n))throw new Error("matrix is not invertible");return o}}var{log:T9}=Math;function N9(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=T9(t[n]);return this}var{log10:$9}=Math;function k9(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=$9(t[n]);return this}var{log1p:I9}=Math;function O9(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=I9(t[n]);return this}var{log2:R9}=Math;function D9(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=R9(t[n]);return this}function A9(){let[t,e]=this.copy().lu_factor(),n=t.copy(),r=t.copy(),{data:s}=n,{data:o}=r,i=new Me(t),[a,l]=i.coords;for(let u of i)l<a?o[u]=0:s[u]=a===l?1:0,[a,l]=i.coords;return[n,r,e]}function P9(){let{data:t,shape:[e],dtype:n}=this,r=new Int32Array(e);try{VD(n,e,e,t,e,r)}catch{let s,o,i,a,l,u,c;for(c=0;c<e;c+=1){for(a=c,s=Math.abs(t[c*e+c]),u=c+1;u<e;u+=1)o=Math.abs(t[u*e+c]),s<o&&(s=o,a=u);for(r[c]=a+1,a!==c&&this.swap(c,a),i=t[c*e+c],l=c+1;l<e;l+=1)t[l*e+c]/=i;for(l=c+1;l<e;l+=1){for(u=c+1;u<e-1;u+=2)t[l*e+u]-=t[l*e+c]*t[c*e+u],t[l*e+u+1]-=t[l*e+c]*t[c*e+u+1];u===e-1&&(t[l*e+u]-=t[l*e+c]*t[c*e+u])}}}return[this,r]}function L9(t){let{data:e}=this,n=new Me(this),r=t.bind(this),s=this.copy(),{data:o}=s;for(let i of n)o[i]=r(e[i],i,e);return s}function F9(){let{data:t,length:e,strides:n,dtype:r}=this,s=Number.NEGATIVE_INFINITY;try{let o=n[n.length-1];s=t[$K(r,e,t,o)]}catch{let o=new Me(this);for(let i of o){let a=t[i];s<a&&(s=a)}}return s}function M9(){let{data:t,length:e}=this,n=new Me(this),r=0;for(let s of n)r+=t[s];return r/e}function j9(){let{data:t}=this,e=new Me(this),n=Number.POSITIVE_INFINITY;for(let r of e){let s=t[r];n>s&&(n=s)}return n}var B9=(t,e)=>new hl(new Float64Array(t*e),{shape:[t,e]});function U9(t){let{shape:[e,n],data:r,dtype:s}=this.copy(),{shape:[o,i],data:a}=t.copy();if(n!==o)throw new Error("sizes do not match");let l=B9(e,i),{data:u}=l;try{kK(s,m_,m_,e,i,n,1,r,n,a,i,0,u,i)}catch{let c=new Me(l),d,[f,h]=c.coords;for(let p of c){let m=0;for(d=0;d<n;d+=1)m+=r[f*n+d]*a[d*i+h];u[p]=m,[f,h]=c.coords}}return l}var{sqrt:z9}=Math;function W9(){let{data:t,length:e,strides:n,dtype:r}=this,s=0;try{let o=n[n.length-1];s=IK(r,e,t,o)}catch{s=z9(this.dot(this))}return s}function V9(){return this.scale(1/this.norm())}var{pow:G9}=Math;function H9(t){let{data:e}=this,n=new Me(this);for(let r of n)e[r]=G9(e[r],t);return this}function q9(){let{data:t}=this,e=new Me(this),n=1;for(let r of e)n*=t[r];return n}function K9(t){let{data:e}=this,{data:n}=t,r=new ju(this,t);for(let[s,o]of r)e[s]*=n[o];return this}function X9(t){return t.scale(this.dot(t)/t.dot(t))}function Y9(t){if(this.shape.length!==1)throw new Error("push operation not permitted for multidimensional arrays");let{data:e,length:n}=this,r=n+1,s=new(Eu(this.dtype))(r);return s.set(e),s[n]=t,this.data=s,this.length=r,this.shape=[r],this}function Q9(t=1e-6){let{data:e}=this.copy().gauss(),n=new Me(this),r=0,[s,o]=n.coords;for(let i of n)r<=s&&o>=s&&Math.abs(e[i])>t&&(r+=1),[s,o]=n.coords;return r}function Z9(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=1/t[n];return this}function J9(t,e){let{data:n,length:r}=this;if(r===0&&typeof e>"u")throw new Error("Reduce of empty array with no initial value.");let s=new Me(this),o=t.bind(this),i;typeof e>"u"?(i=n[0],s.next()):i=e;for(let a of s)i=o(i,n[a],a,n);return i}function eX(...t){let{length:e}=this;if(t.reduce((n,r)=>n*r,1)!==e)throw new Error(`shape ${t} does not match length ${e}`);return this.shape=t,this.strides=Kx(t),this}var{round:tX}=Math;function nX(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=tX(t[n]);return this}function rX(t,e,n=1){this.check(t,0),this.check(e,0);let[,r]=this.shape,{data:s}=this,o;for(o=0;o<r;o+=1)s[t*r+o]+=s[e*r+o]*n;return this}function sX(t){let{data:e,length:n,strides:r,dtype:s}=this;try{let o=r[r.length-1];OK(s,n,t,e,o)}catch{let o=new Me(this);for(let i of o)e[i]*=t}return this}function oX(...t){let e=t.slice(0,-1),n=t[t.length-1];this.check(...e);let{shape:r}=this,s=e[e.length-1],o;for(o=0;o<e.length-1;o+=1)s+=e[o]*r[o+1];this.data[s]=n}var{sign:iX}=Math;function aX(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=iX(t[n]);return this}var{sin:lX}=Math;function uX(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=lX(t[n]);return this}var{sinh:cX}=Math;function dX(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=cX(t[n]);return this}function fX(t=0,e=this.shape[0],n=1){let{data:r,shape:s}=this,o=s.length;if(t<0||e<0)return this.slice(t<0?s[s.length-1]+t:t,e<0?s[s.length-1]+e:e);if(t>e)return this.slice(e,t,n);if(n<=0)throw new Error("step argument has to be a positive integer");let i=[Math.ceil((e-t)/Math.abs(n)),...s.slice(1)],a=UD(i),l=Kx(i),u=o>1?r.subarray(t*i[i.length-1],e*i[i.length-1]):r.subarray(t,e);return l[0]*=n,new hl(u,{shape:i,length:a,strides:l})}function hX(t){let{data:e,dtype:n}=this,{data:r,shape:[s,o]}=t;try{let i=new Int32Array(s);_9(n,s,o,e,s,i,r,o)}catch{let[i,a]=this.lu_factor(),{data:l}=i,{data:u}=t,c,d,f;for(c=0;c<a.length;c+=1)c!==a[c]-1&&t.swap(c,a[c]-1);for(f=0;f<o;f+=1){for(c=0;c<s;c+=1)for(d=0;d<c;d+=1)u[c*o+f]-=l[c*s+d]*u[d*o+f];for(c=s-1;c>=0;c-=1){for(d=c+1;d<s;d+=1)u[c*o+f]-=l[c*s+d]*u[d*o+f];u[c*o+f]/=l[c*s+c]}}}return t}var{sqrt:pX}=Math;function mX(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=pX(t[n]);return this}function gX(){let{length:t}=this.shape,[e,n]=this.shape;if(t!==2||e!==n)throw new Error("matrix is not square")}function yX(t){return this.add(t,-1)}function vX(){let{data:t}=this,e=new Me(this),n=0;for(let r of e)n+=t[r];return n}function xX(t,e){this.check(t,0),this.check(e,0);let{data:n}=this,[,r]=this.shape,s=n.slice(t*r,(t+1)*r);return n.copyWithin(t*r,e*r,(e+1)*r),n.set(s,e*r),this}var{tan:bX}=Math;function wX(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=bX(t[n]);return this}var{tanh:SX}=Math;function CX(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=SX(t[n]);return this}function _X(t=0,e=0){let{data:n,shape:r,strides:s}=this,{length:o}=r;if(e>=o)return n[t];let i=r[e],a=s[e],l=[];for(let u=0;u<i;u++){let c=this.toArray(t,e+1);if(c===null)return null;l[u]=c,t+=a}return l}var EX=mK(vK());function g_(){return`array(${(0,EX.inspect)(this.toArray(),{depth:10,breakLength:40})}, dtype=${this.dtype})`}function TX(){let[t,e]=this.shape,{data:n}=this,r=Math.min(t,e),s=0,o;for(o=0;o<r;o+=1)s+=n[o*e+o];return s}function NX(){if(this.shape.length<2)return this;let t=this.shape[0];return this.shape[0]=this.shape[1],this.shape[1]=t,t=this.strides[0],this.strides[0]=this.strides[1],this.strides[1]=t,this}var{trunc:$X}=Math;function kX(){let{data:t}=this,e=new Me(this);for(let n of e)t[n]=$X(t[n]);return this}var IX=Symbol.for("nodejs.util.inspect.custom"),Age,nT,hl=(nT=class{constructor(t,e){ie(this,"data",new Float64Array(0));ie(this,"dtype","float64");ie(this,"length",0);ie(this,"shape",[0]);ie(this,"strides",[0]);ie(this,Age,g_);ie(this,"abs",wK);ie(this,"acos",CK);ie(this,"acosh",EK);ie(this,"add",RK);ie(this,"angle",AK);ie(this,"asin",LK);ie(this,"asinh",MK);ie(this,"atan",BK);ie(this,"atanh",zK);ie(this,"augment",VK);ie(this,"binOp",GK);ie(this,"cbrt",qK);ie(this,"ceil",XK);ie(this,"check",YK);ie(this,"combine",QK);ie(this,"copy",ZK);ie(this,"cos",e9);ie(this,"cosh",n9);ie(this,"cross",r9);ie(this,"det",s9);ie(this,"diagonal",o9);ie(this,"dot",i9);ie(this,"eig",a9);ie(this,"equals",l9);ie(this,"equidimensional",u9);ie(this,"equilateral",c9);ie(this,"exp",f9);ie(this,"expm1",p9);ie(this,"fill",m9);ie(this,"floor",y9);ie(this,"forEach",v9);ie(this,"fround",b9);ie(this,"gauss",w9);ie(this,"get",S9);ie(this,"inv",E9);ie(this,"log",N9);ie(this,"log10",k9);ie(this,"log1p",O9);ie(this,"log2",D9);ie(this,"lu",A9);ie(this,"lu_factor",P9);ie(this,"map",L9);ie(this,"max",F9);ie(this,"mean",M9);ie(this,"min",j9);ie(this,"multiply",U9);ie(this,"norm",W9);ie(this,"normalize",V9);ie(this,"pow",H9);ie(this,"prod",q9);ie(this,"product",K9);ie(this,"project",X9);ie(this,"push",Y9);ie(this,"rank",Q9);ie(this,"reciprocal",Z9);ie(this,"reduce",J9);ie(this,"reshape",eX);ie(this,"round",nX);ie(this,"row_add",rX);ie(this,"scale",sX);ie(this,"set",oX);ie(this,"sign",aX);ie(this,"sin",uX);ie(this,"sinh",dX);ie(this,"slice",fX);ie(this,"solve",hX);ie(this,"sqrt",mX);ie(this,"square",gX);ie(this,"subtract",yX);ie(this,"sum",vX);ie(this,"swap",xX);ie(this,"tan",wX);ie(this,"tanh",CX);ie(this,"toArray",_X);ie(this,"toString",g_);ie(this,"trace",TX);ie(this,"transpose",NX);ie(this,"trunc",kX);if(!t)return;if(t instanceof hl)return t;if(t instanceof Me){if(!e||!e.dtype)throw new Error("dtype is missing");t.shape&&(e.shape=t.shape);let i=t.length;t=new(Eu(e.dtype))(i)}let{shape:n=zD(t),length:r=UD(n),strides:s=Kx(n),dtype:o=xK(t)}=e||{};this.data=BD(t)?t:new(Eu(o))(jD(t)),this.shape=n,this.length=r,this.dtype=o,this.strides=s}get x(){return this.get(0)}set x(t){this.set(0,t)}get y(){return this.get(1)}set y(t){this.set(1,t)}get z(){return this.get(2)}set z(t){this.set(2,t)}get w(){return this.get(3)}set w(t){this.set(3,t)}get T(){return this.copy().transpose()}},Age=IX,nT);try{window.v=hl}catch{}const Pm=(t,e)=>{t[0].length==2&&(t=t.map(s=>[s[0],s[1],1]));const n=ro(t).multiply(e.T);for(let s=0;s<n.shape[0];s++){const o=n.get(s,0),i=n.get(s,1),a=n.get(s,2);n.set(s,0,o/a),n.set(s,1,i/a)}let r=n.toArray();return r=r.map(s=>s.slice(0,2)),r},GD=(t,e)=>{const n=xo(8,8),r=xo(8,1);for(let i=0;i<4;i++){const[a,l]=e[i],[u,c]=t[i];n.set(i*2,0,a),n.set(i*2,1,l),n.set(i*2,2,1),n.set(i*2,6,-u*a),n.set(i*2,7,-u*l),n.set(i*2+1,3,a),n.set(i*2+1,4,l),n.set(i*2+1,5,1),n.set(i*2+1,6,-c*a),n.set(i*2+1,7,-c*l),r.set(i*2,0,u),r.set(i*2+1,0,c)}const s=n.solve(r).toArray();return ro([...s,1],{shape:[3,3]})},HD=t=>GD([[Mf,Mf],[0,Mf],[0,0],[Mf,0]],t).inv(),qD=t=>{const e=Array.from({length:8},(o,i)=>.5+i),r=Array.from({length:8},(o,i)=>7.5-i).map(o=>e.map(i=>[i*Vs,o*Vs,1])).flat();return Pm(r,t)},KD=t=>{const e=[[-.5*Vs,-.5*Vs,1],[-.5*Vs,8.5*Vs,1],[8.5*Vs,8.5*Vs,1],[8.5*Vs,-.5*Vs,1]];return Pm(e,t)},Xx=t=>{var e,n;if(t.current===null)return!0;if(t.current.autoplay){if(((e=t.current)==null?void 0:e.srcObject)===null)return!0}else{const r=(n=t.current)==null?void 0:n.src;if(r===null||!r.startsWith("blob"))return!0}return!1},OX=t=>{const e=t.map(c=>c[0]),n=t.map(c=>c[1]),r=Math.min(...e),s=Math.max(...e),o=Math.min(...n),i=Math.max(...n),a=s-r,l=i-o;return{xmin:r,xmax:s,ymin:o,ymax:i,width:a,height:l}},Yx=(t,e=null,n=12)=>{let r;const s=t.current.videoWidth,o=t.current.videoHeight;if(e!==null){const c=OX(e);let d=Math.floor(c.width/n),f=Math.floor(c.width/n),h=Math.floor(c.height/n);const p=Math.floor(c.height/n),m=c.width+d+f,v=c.height+h+p,g=v/m,x=ln/an;if(g>x){const _=v/x-m;d+=Math.floor(_/2),f+=_-Math.floor(_/2)}else{const b=m*x;h+=b-v}r=[Math.round(Math.max(s*(c.xmin-d)/an,0)),Math.round(Math.max(o*(c.ymin-h)/ln,0)),Math.round(Math.min(s*(c.xmax+f)/an,s)),Math.round(Math.min(o*(c.ymax+p)/ln,o))]}else r=[0,0,s,o];const[i,a,l,u]=Ke(()=>{let c=T7(t.current);c=Le(c,[r[1],r[0],0],[r[3]-r[1],r[2]-r[0],3]);const d=c.shape[0],f=c.shape[1],h=d/f,p=ln/an;let m=ln,v=an;h>p?v=Math.round(ln/h):m=Math.round(an*h),c=Px.resizeBilinear(c,[m,v]);const g=an-c.shape[1],x=ln-c.shape[0],b=Math.floor(g/2),_=g-b,N=Math.floor(x/2),E=x-N,R=[_,b,E,N];return c=Fu(c,[[E,N],[_,b],[0,0]],114),[Br(st(bp(c,[0,1,2]),255),0),f,d,R]});return{image4D:i,width:a,height:l,padding:u,roi:r}},RX=(t,e,n,r,s,o,i)=>{const{boxes:a,scores:l}=Ke(()=>{const u=Le(t,[0,0,2],[-1,-1,1]),c=Le(t,[0,0,3],[-1,-1,1]);let d=Oe(Le(t,[0,0,0],[-1,-1,1]),st(u,2)),f=Oe(Le(t,[0,0,1],[-1,-1,1]),st(c,2)),h=ke(d,u),p=ke(f,c);d=Oe(d,o[0]),h=Oe(h,o[0]),f=Oe(f,o[2]),p=Oe(p,o[2]),d=he(d,e/(an-o[0]-o[1])),h=he(h,e/(an-o[0]-o[1])),f=he(f,n/(ln-o[2]-o[3])),p=he(p,n/(ln-o[2]-o[3])),d=ke(d,i[0]),h=ke(h,i[0]),f=ke(f,i[1]),p=ke(p,i[1]),d=he(d,an/r),h=he(h,an/r),f=he(f,ln/s),p=he(p,ln/s);const m=Gi(cn([d,f,h,p],2)),v=Gi(Le(t,[0,0,4],[-1,-1,t.shape[2]-4]),[0]);return{boxes:m,scores:v}});return{boxes:a,scores:l}},XD=(t,e,n,r,s,o,i)=>{const{boxes:a,scores:l,cls:u}=Ke(()=>{let c=Le(t,[0,0,0],[-1,-1,1]),d=Le(t,[0,0,1],[-1,-1,1]),f=Le(t,[0,0,2],[-1,-1,1]),h=Le(t,[0,0,3],[-1,-1,1]);c=Oe(c,o[0]),f=Oe(f,o[0]),d=Oe(d,o[2]),h=Oe(h,o[2]),c=he(c,e/(an-o[0]-o[1])),f=he(f,e/(an-o[0]-o[1])),d=he(d,n/(ln-o[2]-o[3])),h=he(h,n/(ln-o[2]-o[3])),c=ke(c,i[0]),f=ke(f,i[0]),d=ke(d,i[1]),h=ke(h,i[1]),c=he(c,an/r),f=he(f,an/r),d=he(d,ln/s),h=he(h,ln/s);const p=Gi(cn([c,d,f,h],2)),m=Gi(Le(t,[0,0,4],[-1,-1,1])),v=Gi(Le(t,[0,0,5],[-1,-1,1]));return{boxes:p,scores:m,cls:v}});return{boxes:a,scores:l,cls:u}},DX=t=>Ke(()=>{const n=Le(t,[0,0],[-1,1]),r=Le(t,[0,1],[-1,1]),s=Le(t,[0,2],[-1,1]),o=Le(t,[0,3],[-1,1]),i=st(ke(n,s),2),a=st(ke(r,o),2);return cn([i,a],1)}),YD=(t,e,n)=>{const r=n/an,s=e/ln;return[r*t[0],s*t[1]-e-ki]},QD=(t,e,n)=>{const r=an/n,s=ln/e;return[r*t[0],s*(t[1]+e+ki)]},y_={h1:[50,-100],a1:[0,-100],a8:[0,-150],h8:[50,-150]},ZD=V1({name:"corners",initialState:y_,reducers:{cornersSet(t,e){t[e.payload.key]=e.payload.xy},cornersReset(){return y_}}}),JD=()=>q1(t=>t.corners),{cornersSet:Qx,cornersReset:AX}=ZD.actions,PX=ZD.reducer,v_=(t,e,n)=>Math.max(e,Math.min(t,n)),eA=(t,e)=>Array.from(Array(t),n=>Array(e).fill(0)),LX=Array.from({length:7},(t,e)=>e),FX=Array.from({length:7},(t,e)=>e),MX=FX.map(t=>LX.map(e=>[e,t])).flat(),jX=[[0,1],[1,1],[1,0],[0,0]],BX=async(t,e)=>{const n=La(e,1),r=await Px.nonMaxSuppressionAsync(t,n,100,.3,.1),s=Ke(()=>{const i=vx(t,r,0);return DX(i)}),o=s.arraySync();return Kt([r,s,t,e,n]),o},UX=async(t,e)=>{const n=t.current.videoWidth,r=t.current.videoHeight,{image4D:s,width:o,height:i,padding:a,roi:l}=Yx(t),u=e.current.predict(s),c=XD(u,o,i,n,r,a,l),d=c.boxes,f=Br(c.scores,1),h=Br(c.cls,1),p=HO([d,f,h],1),m=p.arraySync();return Kt([u,p,s,d,f,h,c]),m},zX=async(t,e,n)=>{const r=t.current.videoWidth,s=t.current.videoHeight,{image4D:o,width:i,height:a,padding:l,roi:u}=Yx(t,n),c=e.current.predict(o),d=RX(c,i,a,r,s,l,u);return Kt([c,o]),await BX(d.boxes,d.scores)},WX=t=>{const e=t.flat().map(o=>Math.round(o)),r=new Gx(e).triangles,s=[];for(let o=0;o<r.length;o+=3){const i=r[o],a=r[o+1],l=r[o+2],u=[i,a,l,-1];for(let c=0;c<r.length;c+=3){if(o===c)continue;const d=i===r[c]&&a===r[c+1]||i===r[c+1]&&a===r[c],f=a===r[c]&&l===r[c+1]||a===r[c+1]&&l===r[c],h=l===r[c]&&i===r[c+1]||l===r[c+1]&&i===r[c];if(d||f||h){u[3]=r[c+2];break}}u[3]!==-1&&s.push(u.map(c=>t[c]))}return s},VX=(t,e)=>{const n=Array.from({length:t.length},()=>Array(e.length).fill(0));for(let r=0;r<t.length;r++)for(let s=0;s<e.length;s++){const o=t[r][0]-e[s][0],i=t[r][1]-e[s][1];n[r][s]=Math.sqrt(o*o+i*i)}return n},tA=(t,e)=>{const n=MX.map(i=>[i[0]+e[0],i[1]+e[1]]),r=VX(n,t);let s=0;for(let i=0;i<r.length;i++)s+=Math.min(...r[i]);return 1/(1+s)},GX=t=>{const e=[0,0];for(let n=0;n<2;n++){let r=-7,s=1;const o={};for(;s-r>1;){const i=s+r>>1;[i,i+1].forEach(a=>{if(!(a in o)){const l=[0,0];l[n]=a,o[a]=tA(t,l)}}),o[i]>o[i+1]?s=i:r=i}e[n]=r+1}return e},x_=(t,e)=>{const n=GD(jX,t),r=Pm(e,n),s=GX(r);return[tA(r,s),n,s]},HX=t=>{const e=WX(t);if(e.length==0)return;let n,r,s;[n,r,s]=x_(e[0],t);for(let l=1;l<e.length;l++){const[u,c,d]=x_(e[l],t);u>n&&(n=u,r=c,s=d)}const o=r.inv(),i=[[s[0]-1,s[1]-1],[s[0]-1,s[1]+7],[s[0]+7,s[1]+7],[s[0]+7,s[1]-1]],a=Pm(i,o);for(let l=0;l<4;l++)a[l][0]=v_(a[l][0],0,an),a[l][1]=v_(a[l][1],0,ln);return a},b_=t=>{let e=t.reduce((n,r)=>[n[0]+r[0],n[1]+r[1]],[0,0]);return e=e.map(n=>n/t.length),e},w_=(t,e)=>{const n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)},qX=(t,e,n)=>{const r=b_(t),s=b_(e);let o=0,i=0;for(let l=0;l<4;l++){const u=[(n[l%4][0]+n[(l+1)%4][0])/2,(n[l%4][1]+n[(l+1)%4][1])/2],c=[(n[(l+2)%4][0]+n[(l+3)%4][0])/2,(n[(l+2)%4][1]+n[(l+3)%4][1])/2],d=1/(1+w_(s,u)+w_(r,c));d>i&&(i=d,o=l)}return{a1:n[o%4],h1:n[(o+1)%4],h8:n[(o+2)%4],a8:n[(o+3)%4]}},KX=async(t,e,n,r,s,o)=>{if(Xx(n))return;const i=await UX(n,t),a=i.filter(f=>f[5]<=5&&f[4]>.1).map(f=>[(f[0]+f[2])/2,(f[1]+f[3])/2]),l=i.filter(f=>f[5]>5&&f[4]>.1).map(f=>[(f[0]+f[2])/2,(f[1]+f[3])/2]);if(a.length==0||l.length==0){o(["No pieces to label corners"]);return}const u=await zX(n,e,i);if(u.length<5){o(["Need 5 xCorners",`Detected ${u.length}`]);return}const c=HX(u);if(c===void 0){o(["Failed to find corners"]);return}const d=qX(a,l,c);Vx.forEach(f=>{const h=d[f],p={xy:YD(h,r.current.height,r.current.width),key:f};s(Qx(p))}),X7(r.current,u),o(["Found corners","Ready to record"])},XX=async(t,e,n,r,s,o)=>{const i=Cu().numTensors;await KX(t,e,n,r,s,o);const a=Cu().numTensors;return i<a&&console.error(`Memory Leak! (${a} > ${i})`),()=>{dx()}},Lm=({piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,setText:s})=>{const o=Ns(),i=a=>{a.preventDefault(),XX(t,e,n,r,o,s)};return w.jsx(oo,{onClick:i,children:"Find Corners"})},Fm=({digital:t,setDigital:e})=>{const n=r=>{r.preventDefault(),e(!t)};return w.jsx(oo,{onClick:n,children:"Swap View"})},pl=({iconName:t})=>w.jsx("i",{className:`h4 bi ${t}`}),Zx=({playing:t,setPlaying:e})=>{const n=r=>{r.preventDefault(),e(!t)};return w.jsx(oo,{onClick:n,children:w.jsx(pl,{iconName:t?"bi-pause":"bi-play"})})};/**
 * @license
 * Copyright (c) 2023, Jeff Hlywa (jhlywa@gmail.com)
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice,
 *    this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */const Gn="w",as="b",wn="p",cv="n",bh="b",Ac="r",bi="q",Sn="k",ly="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",Ar=-1,YX={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},Fe={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},ze={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},uy={b:[16,32,17,15],w:[-16,-32,-17,-15]},S_={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},QX=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],ZX=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],JX={p:1,n:2,b:4,r:8,q:16,k:32},eY="pnbrqkPNBRQK",C_=[cv,bh,Ac,bi],tY=7,nY=6,rY=1,sY=0,zf={[Sn]:Fe.KSIDE_CASTLE,[bi]:Fe.QSIDE_CASTLE},hi={w:[{square:ze.a1,flag:Fe.QSIDE_CASTLE},{square:ze.h1,flag:Fe.KSIDE_CASTLE}],b:[{square:ze.a8,flag:Fe.QSIDE_CASTLE},{square:ze.h8,flag:Fe.KSIDE_CASTLE}]},oY={b:rY,w:nY},iY=["1-0","0-1","1/2-1/2","*"];function Fa(t){return t>>4}function kd(t){return t&15}function nA(t){return"0123456789".indexOf(t)!==-1}function Fr(t){const e=kd(t),n=Fa(t);return"abcdefgh".substring(e,e+1)+"87654321".substring(n,n+1)}function bc(t){return t===Gn?as:Gn}function aY(t){const e=t.split(/\s+/);if(e.length!==6)return{ok:!1,error:"Invalid FEN: must contain six space-delimited fields"};const n=parseInt(e[5],10);if(isNaN(n)||n<=0)return{ok:!1,error:"Invalid FEN: move number must be a positive integer"};const r=parseInt(e[4],10);if(isNaN(r)||r<0)return{ok:!1,error:"Invalid FEN: half move counter number must be a non-negative integer"};if(!/^(-|[abcdefgh][36])$/.test(e[3]))return{ok:!1,error:"Invalid FEN: en-passant square is invalid"};if(/[^kKqQ-]/.test(e[2]))return{ok:!1,error:"Invalid FEN: castling availability is invalid"};if(!/^(w|b)$/.test(e[1]))return{ok:!1,error:"Invalid FEN: side-to-move is invalid"};const s=e[0].split("/");if(s.length!==8)return{ok:!1,error:"Invalid FEN: piece data does not contain 8 '/'-delimited rows"};for(let i=0;i<s.length;i++){let a=0,l=!1;for(let u=0;u<s[i].length;u++)if(nA(s[i][u])){if(l)return{ok:!1,error:"Invalid FEN: piece data is invalid (consecutive number)"};a+=parseInt(s[i][u],10),l=!0}else{if(!/^[prnbqkPRNBQK]$/.test(s[i][u]))return{ok:!1,error:"Invalid FEN: piece data is invalid (invalid piece)"};a+=1,l=!1}if(a!==8)return{ok:!1,error:"Invalid FEN: piece data is invalid (too many squares in rank)"}}if(e[3][1]=="3"&&e[1]=="w"||e[3][1]=="6"&&e[1]=="b")return{ok:!1,error:"Invalid FEN: illegal en-passant square"};const o=[{color:"white",regex:/K/g},{color:"black",regex:/k/g}];for(const{color:i,regex:a}of o){if(!a.test(e[0]))return{ok:!1,error:`Invalid FEN: missing ${i} king`};if((e[0].match(a)||[]).length>1)return{ok:!1,error:`Invalid FEN: too many ${i} kings`}}return{ok:!0}}function lY(t,e){const n=t.from,r=t.to,s=t.piece;let o=0,i=0,a=0;for(let l=0,u=e.length;l<u;l++){const c=e[l].from,d=e[l].to,f=e[l].piece;s===f&&n!==c&&r===d&&(o++,Fa(n)===Fa(c)&&i++,kd(n)===kd(c)&&a++)}return o>0?i>0&&a>0?Fr(n):a>0?Fr(n).charAt(1):Fr(n).charAt(0):""}function pi(t,e,n,r,s,o=void 0,i=Fe.NORMAL){const a=Fa(r);if(s===wn&&(a===tY||a===sY))for(let l=0;l<C_.length;l++){const u=C_[l];t.push({color:e,from:n,to:r,piece:s,captured:o,promotion:u,flags:i|Fe.PROMOTION})}else t.push({color:e,from:n,to:r,piece:s,captured:o,flags:i})}function __(t){let e=t.charAt(0);return e>="a"&&e<="h"?t.match(/[a-h]\d.*[a-h]\d/)?void 0:wn:(e=e.toLowerCase(),e==="o"?Sn:e)}function cy(t){return t.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}class Jx{constructor(e=ly){ie(this,"_board",new Array(128));ie(this,"_turn",Gn);ie(this,"_header",{});ie(this,"_kings",{w:Ar,b:Ar});ie(this,"_epSquare",-1);ie(this,"_halfMoves",0);ie(this,"_moveNumber",0);ie(this,"_history",[]);ie(this,"_comments",{});ie(this,"_castling",{w:0,b:0});this.load(e)}clear(e=!1){this._board=new Array(128),this._kings={w:Ar,b:Ar},this._turn=Gn,this._castling={w:0,b:0},this._epSquare=Ar,this._halfMoves=0,this._moveNumber=1,this._history=[],this._comments={},this._header=e?this._header:{},this._updateSetup(this.fen())}removeHeader(e){e in this._header&&delete this._header[e]}load(e,n=!1){let r=e.split(/\s+/);if(r.length>=2&&r.length<6){const l=["-","-","0","1"];e=r.concat(l.slice(-(6-r.length))).join(" ")}r=e.split(/\s+/);const{ok:s,error:o}=aY(e);if(!s)throw new Error(o);const i=r[0];let a=0;this.clear(n);for(let l=0;l<i.length;l++){const u=i.charAt(l);if(u==="/")a+=8;else if(nA(u))a+=parseInt(u,10);else{const c=u<"a"?Gn:as;this.put({type:u.toLowerCase(),color:c},Fr(a)),a++}}this._turn=r[1],r[2].indexOf("K")>-1&&(this._castling.w|=Fe.KSIDE_CASTLE),r[2].indexOf("Q")>-1&&(this._castling.w|=Fe.QSIDE_CASTLE),r[2].indexOf("k")>-1&&(this._castling.b|=Fe.KSIDE_CASTLE),r[2].indexOf("q")>-1&&(this._castling.b|=Fe.QSIDE_CASTLE),this._epSquare=r[3]==="-"?Ar:ze[r[3]],this._halfMoves=parseInt(r[4],10),this._moveNumber=parseInt(r[5],10),this._updateSetup(this.fen())}fen(){var o,i;let e=0,n="";for(let a=ze.a8;a<=ze.h1;a++){if(this._board[a]){e>0&&(n+=e,e=0);const{color:l,type:u}=this._board[a];n+=l===Gn?u.toUpperCase():u.toLowerCase()}else e++;a+1&136&&(e>0&&(n+=e),a!==ze.h1&&(n+="/"),e=0,a+=8)}let r="";this._castling[Gn]&Fe.KSIDE_CASTLE&&(r+="K"),this._castling[Gn]&Fe.QSIDE_CASTLE&&(r+="Q"),this._castling[as]&Fe.KSIDE_CASTLE&&(r+="k"),this._castling[as]&Fe.QSIDE_CASTLE&&(r+="q"),r=r||"-";let s="-";if(this._epSquare!==Ar){const a=this._epSquare+(this._turn===Gn?16:-16),l=[a+1,a-1];for(const u of l){if(u&136)continue;const c=this._turn;if(((o=this._board[u])==null?void 0:o.color)===c&&((i=this._board[u])==null?void 0:i.type)===wn){this._makeMove({color:c,from:u,to:this._epSquare,piece:wn,captured:wn,flags:Fe.EP_CAPTURE});const d=!this._isKingAttacked(c);if(this._undoMove(),d){s=Fr(this._epSquare);break}}}}return[n,this._turn,r,s,this._halfMoves,this._moveNumber].join(" ")}_updateSetup(e){this._history.length>0||(e!==ly?(this._header.SetUp="1",this._header.FEN=e):(delete this._header.SetUp,delete this._header.FEN))}reset(){this.load(ly)}get(e){return this._board[ze[e]]||!1}put({type:e,color:n},r){if(eY.indexOf(e.toLowerCase())===-1||!(r in ze))return!1;const s=ze[r];return e==Sn&&!(this._kings[n]==Ar||this._kings[n]==s)?!1:(this._board[s]={type:e,color:n},e===Sn&&(this._kings[n]=s),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),!0)}remove(e){const n=this.get(e);return delete this._board[ze[e]],n&&n.type===Sn&&(this._kings[n.color]=Ar),this._updateCastlingRights(),this._updateEnPassantSquare(),this._updateSetup(this.fen()),n}_updateCastlingRights(){var r,s,o,i,a,l,u,c,d,f,h,p;const e=((r=this._board[ze.e1])==null?void 0:r.type)===Sn&&((s=this._board[ze.e1])==null?void 0:s.color)===Gn,n=((o=this._board[ze.e8])==null?void 0:o.type)===Sn&&((i=this._board[ze.e8])==null?void 0:i.color)===as;(!e||((a=this._board[ze.a1])==null?void 0:a.type)!==Ac||((l=this._board[ze.a1])==null?void 0:l.color)!==Gn)&&(this._castling.w&=~Fe.QSIDE_CASTLE),(!e||((u=this._board[ze.h1])==null?void 0:u.type)!==Ac||((c=this._board[ze.h1])==null?void 0:c.color)!==Gn)&&(this._castling.w&=~Fe.KSIDE_CASTLE),(!n||((d=this._board[ze.a8])==null?void 0:d.type)!==Ac||((f=this._board[ze.a8])==null?void 0:f.color)!==as)&&(this._castling.b&=~Fe.QSIDE_CASTLE),(!n||((h=this._board[ze.h8])==null?void 0:h.type)!==Ac||((p=this._board[ze.h8])==null?void 0:p.color)!==as)&&(this._castling.b&=~Fe.KSIDE_CASTLE)}_updateEnPassantSquare(){var o,i;if(this._epSquare===Ar)return;const e=this._epSquare+(this._turn===Gn?-16:16),n=this._epSquare+(this._turn===Gn?16:-16),r=[n+1,n-1];if(this._board[e]!==null||this._board[this._epSquare]!==null||((o=this._board[n])==null?void 0:o.color)!==bc(this._turn)||((i=this._board[n])==null?void 0:i.type)!==wn){this._epSquare=Ar;return}const s=a=>{var l,u;return!(a&136)&&((l=this._board[a])==null?void 0:l.color)===this._turn&&((u=this._board[a])==null?void 0:u.type)===wn};r.some(s)||(this._epSquare=Ar)}_attacked(e,n){for(let r=ze.a8;r<=ze.h1;r++){if(r&136){r+=7;continue}if(this._board[r]===void 0||this._board[r].color!==e)continue;const s=this._board[r],o=r-n;if(o===0)continue;const i=o+119;if(QX[i]&JX[s.type]){if(s.type===wn){if(o>0){if(s.color===Gn)return!0}else if(s.color===as)return!0;continue}if(s.type==="n"||s.type==="k")return!0;const a=ZX[i];let l=r+a,u=!1;for(;l!==n;){if(this._board[l]!=null){u=!0;break}l+=a}if(!u)return!0}}return!1}_isKingAttacked(e){const n=this._kings[e];return n===-1?!1:this._attacked(bc(e),n)}isAttacked(e,n){return this._attacked(n,ze[e])}isCheck(){return this._isKingAttacked(this._turn)}inCheck(){return this.isCheck()}isCheckmate(){return this.isCheck()&&this._moves().length===0}isStalemate(){return!this.isCheck()&&this._moves().length===0}isInsufficientMaterial(){const e={b:0,n:0,r:0,q:0,k:0,p:0},n=[];let r=0,s=0;for(let o=ze.a8;o<=ze.h1;o++){if(s=(s+1)%2,o&136){o+=7;continue}const i=this._board[o];i&&(e[i.type]=i.type in e?e[i.type]+1:1,i.type===bh&&n.push(s),r++)}if(r===2)return!0;if(r===3&&(e[bh]===1||e[cv]===1))return!0;if(r===e[bh]+2){let o=0;const i=n.length;for(let a=0;a<i;a++)o+=n[a];if(o===0||o===i)return!0}return!1}isThreefoldRepetition(){const e=[],n={};let r=!1;for(;;){const s=this._undoMove();if(!s)break;e.push(s)}for(;;){const s=this.fen().split(" ").slice(0,4).join(" ");n[s]=s in n?n[s]+1:1,n[s]>=3&&(r=!0);const o=e.pop();if(o)this._makeMove(o);else break}return r}isDraw(){return this._halfMoves>=100||this.isStalemate()||this.isInsufficientMaterial()||this.isThreefoldRepetition()}isGameOver(){return this.isCheckmate()||this.isStalemate()||this.isDraw()}moves({verbose:e=!1,square:n=void 0,piece:r=void 0}={}){const s=this._moves({square:n,piece:r});return e?s.map(o=>this._makePretty(o)):s.map(o=>this._moveToSan(o,s))}_moves({legal:e=!0,piece:n=void 0,square:r=void 0}={}){var h;const s=r?r.toLowerCase():void 0,o=n==null?void 0:n.toLowerCase(),i=[],a=this._turn,l=bc(a);let u=ze.a8,c=ze.h1,d=!1;if(s)if(s in ze)u=c=ze[s],d=!0;else return[];for(let p=u;p<=c;p++){if(p&136){p+=7;continue}if(!this._board[p]||this._board[p].color===l)continue;const{type:m}=this._board[p];let v;if(m===wn){if(o&&o!==m)continue;v=p+uy[a][0],this._board[v]||(pi(i,a,p,v,wn),v=p+uy[a][1],oY[a]===Fa(p)&&!this._board[v]&&pi(i,a,p,v,wn,void 0,Fe.BIG_PAWN));for(let g=2;g<4;g++)v=p+uy[a][g],!(v&136)&&(((h=this._board[v])==null?void 0:h.color)===l?pi(i,a,p,v,wn,this._board[v].type,Fe.CAPTURE):v===this._epSquare&&pi(i,a,p,v,wn,wn,Fe.EP_CAPTURE))}else{if(o&&o!==m)continue;for(let g=0,x=S_[m].length;g<x;g++){const b=S_[m][g];for(v=p;v+=b,!(v&136);){if(!this._board[v])pi(i,a,p,v,m);else{if(this._board[v].color===a)break;pi(i,a,p,v,m,this._board[v].type,Fe.CAPTURE);break}if(m===cv||m===Sn)break}}}}if((o===void 0||o===Sn)&&(!d||c===this._kings[a])){if(this._castling[a]&Fe.KSIDE_CASTLE){const p=this._kings[a],m=p+2;!this._board[p+1]&&!this._board[m]&&!this._attacked(l,this._kings[a])&&!this._attacked(l,p+1)&&!this._attacked(l,m)&&pi(i,a,this._kings[a],m,Sn,void 0,Fe.KSIDE_CASTLE)}if(this._castling[a]&Fe.QSIDE_CASTLE){const p=this._kings[a],m=p-2;!this._board[p-1]&&!this._board[p-2]&&!this._board[p-3]&&!this._attacked(l,this._kings[a])&&!this._attacked(l,p-1)&&!this._attacked(l,m)&&pi(i,a,this._kings[a],m,Sn,void 0,Fe.QSIDE_CASTLE)}}if(!e||this._kings[a]===-1)return i;const f=[];for(let p=0,m=i.length;p<m;p++)this._makeMove(i[p]),this._isKingAttacked(a)||f.push(i[p]),this._undoMove();return f}move(e,{strict:n=!1}={}){let r=null;if(typeof e=="string")r=this._moveFromSan(e,n);else if(typeof e=="object"){const o=this._moves();for(let i=0,a=o.length;i<a;i++)if(e.from===Fr(o[i].from)&&e.to===Fr(o[i].to)&&(!("promotion"in o[i])||e.promotion===o[i].promotion)){r=o[i];break}}if(!r)throw typeof e=="string"?new Error(`Invalid move: ${e}`):new Error(`Invalid move: ${JSON.stringify(e)}`);const s=this._makePretty(r);return this._makeMove(r),s}_push(e){this._history.push({move:e,kings:{b:this._kings.b,w:this._kings.w},turn:this._turn,castling:{b:this._castling.b,w:this._castling.w},epSquare:this._epSquare,halfMoves:this._halfMoves,moveNumber:this._moveNumber})}_makeMove(e){const n=this._turn,r=bc(n);if(this._push(e),this._board[e.to]=this._board[e.from],delete this._board[e.from],e.flags&Fe.EP_CAPTURE&&(this._turn===as?delete this._board[e.to-16]:delete this._board[e.to+16]),e.promotion&&(this._board[e.to]={type:e.promotion,color:n}),this._board[e.to].type===Sn){if(this._kings[n]=e.to,e.flags&Fe.KSIDE_CASTLE){const s=e.to-1,o=e.to+1;this._board[s]=this._board[o],delete this._board[o]}else if(e.flags&Fe.QSIDE_CASTLE){const s=e.to+1,o=e.to-2;this._board[s]=this._board[o],delete this._board[o]}this._castling[n]=0}if(this._castling[n]){for(let s=0,o=hi[n].length;s<o;s++)if(e.from===hi[n][s].square&&this._castling[n]&hi[n][s].flag){this._castling[n]^=hi[n][s].flag;break}}if(this._castling[r]){for(let s=0,o=hi[r].length;s<o;s++)if(e.to===hi[r][s].square&&this._castling[r]&hi[r][s].flag){this._castling[r]^=hi[r][s].flag;break}}e.flags&Fe.BIG_PAWN?n===as?this._epSquare=e.to-16:this._epSquare=e.to+16:this._epSquare=Ar,e.piece===wn?this._halfMoves=0:e.flags&(Fe.CAPTURE|Fe.EP_CAPTURE)?this._halfMoves=0:this._halfMoves++,n===as&&this._moveNumber++,this._turn=r}undo(){const e=this._undoMove();return e?this._makePretty(e):null}_undoMove(){const e=this._history.pop();if(e===void 0)return null;const n=e.move;this._kings=e.kings,this._turn=e.turn,this._castling=e.castling,this._epSquare=e.epSquare,this._halfMoves=e.halfMoves,this._moveNumber=e.moveNumber;const r=this._turn,s=bc(r);if(this._board[n.from]=this._board[n.to],this._board[n.from].type=n.piece,delete this._board[n.to],n.captured)if(n.flags&Fe.EP_CAPTURE){let o;r===as?o=n.to-16:o=n.to+16,this._board[o]={type:wn,color:s}}else this._board[n.to]={type:n.captured,color:s};if(n.flags&(Fe.KSIDE_CASTLE|Fe.QSIDE_CASTLE)){let o,i;n.flags&Fe.KSIDE_CASTLE?(o=n.to+1,i=n.to-1):(o=n.to-2,i=n.to+1),this._board[o]=this._board[i],delete this._board[i]}return n}pgn({newline:e=`
`,maxWidth:n=0}={}){const r=[];let s=!1;for(const f in this._header)r.push("["+f+' "'+this._header[f]+'"]'+e),s=!0;s&&this._history.length&&r.push(e);const o=f=>{const h=this._comments[this.fen()];if(typeof h<"u"){const p=f.length>0?" ":"";f=`${f}${p}{${h}}`}return f},i=[];for(;this._history.length>0;)i.push(this._undoMove());const a=[];let l="";for(i.length===0&&a.push(o(""));i.length>0;){l=o(l);const f=i.pop();if(!f)break;if(!this._history.length&&f.color==="b"){const h=`${this._moveNumber}. ...`;l=l?`${l} ${h}`:h}else f.color==="w"&&(l.length&&a.push(l),l=this._moveNumber+".");l=l+" "+this._moveToSan(f,this._moves({legal:!0})),this._makeMove(f)}if(l.length&&a.push(o(l)),typeof this._header.Result<"u"&&a.push(this._header.Result),n===0)return r.join("")+a.join(" ");const u=function(){return r.length>0&&r[r.length-1]===" "?(r.pop(),!0):!1},c=function(f,h){for(const p of h.split(" "))if(p){if(f+p.length>n){for(;u();)f--;r.push(e),f=0}r.push(p),f+=p.length,r.push(" "),f++}return u()&&f--,f};let d=0;for(let f=0;f<a.length;f++){if(d+a[f].length>n&&a[f].includes("{")){d=c(d,a[f]);continue}d+a[f].length>n&&f!==0?(r[r.length-1]===" "&&r.pop(),r.push(e),d=0):f!==0&&(r.push(" "),d++),r.push(a[f]),d+=a[f].length}return r.join("")}header(...e){for(let n=0;n<e.length;n+=2)typeof e[n]=="string"&&typeof e[n+1]=="string"&&(this._header[e[n]]=e[n+1]);return this._header}loadPgn(e,{strict:n=!1,newlineChar:r=`\r?
`}={}){function s(b){return b.replace(/\\/g,"\\")}function o(b){const _={},N=b.split(new RegExp(s(r)));let E="",R="";for(let P=0;P<N.length;P++){const B=/^\s*\[\s*([A-Za-z]+)\s*"(.*)"\s*\]\s*$/;E=N[P].replace(B,"$1"),R=N[P].replace(B,"$2"),E.trim().length>0&&(_[E]=R)}return _}e=e.trim();const a=new RegExp("^(\\[((?:"+s(r)+")|.)*\\])((?:\\s*"+s(r)+"){2}|(?:\\s*"+s(r)+")*$)").exec(e),l=a&&a.length>=2?a[1]:"";this.reset();const u=o(l);let c="";for(const b in u)b.toLowerCase()==="fen"&&(c=u[b]),this.header(b,u[b]);if(!n)c&&this.load(c,!0);else if(u.SetUp==="1"){if(!("FEN"in u))throw new Error("Invalid PGN: FEN tag must be supplied with SetUp tag");this.load(u.FEN,!0)}function d(b){return Array.from(b).map(function(_){return _.charCodeAt(0)<128?_.charCodeAt(0).toString(16):encodeURIComponent(_).replace(/%/g,"").toLowerCase()}).join("")}function f(b){return b.length==0?"":decodeURIComponent("%"+(b.match(/.{1,2}/g)||[]).join("%"))}const h=function(b){return b=b.replace(new RegExp(s(r),"g")," "),`{${d(b.slice(1,b.length-1))}}`},p=function(b){if(b.startsWith("{")&&b.endsWith("}"))return f(b.slice(1,b.length-1))};let m=e.replace(l,"").replace(new RegExp(`({[^}]*})+?|;([^${s(r)}]*)`,"g"),function(b,_,N){return _!==void 0?h(_):" "+h(`{${N.slice(1)}}`)}).replace(new RegExp(s(r),"g")," ");const v=/(\([^()]+\))+?/g;for(;v.test(m);)m=m.replace(v,"");m=m.replace(/\d+\.(\.\.)?/g,""),m=m.replace(/\.\.\./g,""),m=m.replace(/\$\d+/g,"");let g=m.trim().split(new RegExp(/\s+/));g=g.filter(b=>b!=="");let x="";for(let b=0;b<g.length;b++){const _=p(g[b]);if(_!==void 0){this._comments[this.fen()]=_;continue}const N=this._moveFromSan(g[b],n);if(N==null)if(iY.indexOf(g[b])>-1)x=g[b];else throw new Error(`Invalid move in PGN: ${g[b]}`);else x="",this._makeMove(N)}x&&Object.keys(this._header).length&&!this._header.Result&&this.header("Result",x)}_moveToSan(e,n){let r="";if(e.flags&Fe.KSIDE_CASTLE)r="O-O";else if(e.flags&Fe.QSIDE_CASTLE)r="O-O-O";else{if(e.piece!==wn){const s=lY(e,n);r+=e.piece.toUpperCase()+s}e.flags&(Fe.CAPTURE|Fe.EP_CAPTURE)&&(e.piece===wn&&(r+=Fr(e.from)[0]),r+="x"),r+=Fr(e.to),e.promotion&&(r+="="+e.promotion.toUpperCase())}return this._makeMove(e),this.isCheck()&&(this.isCheckmate()?r+="#":r+="+"),this._undoMove(),r}_moveFromSan(e,n=!1){const r=cy(e);let s=__(r),o=this._moves({legal:!0,piece:s});for(let f=0,h=o.length;f<h;f++)if(r===cy(this._moveToSan(o[f],o)))return o[f];if(n)return null;let i,a,l,u,c,d=!1;if(a=r.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/),a?(i=a[1],l=a[2],u=a[3],c=a[4],l.length==1&&(d=!0)):(a=r.match(/([pnbrqkPNBRQK])?([a-h]?[1-8]?)x?-?([a-h][1-8])([qrbnQRBN])?/),a&&(i=a[1],l=a[2],u=a[3],c=a[4],l.length==1&&(d=!0))),s=__(r),o=this._moves({legal:!0,piece:i||s}),!u)return null;for(let f=0,h=o.length;f<h;f++)if(l){if((!i||i.toLowerCase()==o[f].piece)&&ze[l]==o[f].from&&ze[u]==o[f].to&&(!c||c.toLowerCase()==o[f].promotion))return o[f];if(d){const p=Fr(o[f].from);if((!i||i.toLowerCase()==o[f].piece)&&ze[u]==o[f].to&&(l==p[0]||l==p[1])&&(!c||c.toLowerCase()==o[f].promotion))return o[f]}}else if(r===cy(this._moveToSan(o[f],o)).replace("x",""))return o[f];return null}ascii(){let e=`   +------------------------+
`;for(let n=ze.a8;n<=ze.h1;n++){if(kd(n)===0&&(e+=" "+"87654321"[Fa(n)]+" |"),this._board[n]){const r=this._board[n].type,o=this._board[n].color===Gn?r.toUpperCase():r.toLowerCase();e+=" "+o+" "}else e+=" . ";n+1&136&&(e+=`|
`,n+=8)}return e+=`   +------------------------+
`,e+="     a  b  c  d  e  f  g  h",e}perft(e){const n=this._moves({legal:!1});let r=0;const s=this._turn;for(let o=0,i=n.length;o<i;o++)this._makeMove(n[o]),this._isKingAttacked(s)||(e-1>0?r+=this.perft(e-1):r++),this._undoMove();return r}_makePretty(e){const{color:n,piece:r,from:s,to:o,flags:i,captured:a,promotion:l}=e;let u="";for(const h in Fe)Fe[h]&i&&(u+=YX[h]);const c=Fr(s),d=Fr(o),f={color:n,piece:r,from:c,to:d,san:this._moveToSan(e,this._moves({legal:!0})),flags:u,lan:c+d,before:this.fen(),after:""};return this._makeMove(e),f.after=this.fen(),this._undoMove(),a&&(f.captured=a),l&&(f.promotion=l,f.lan+=l),f}turn(){return this._turn}board(){const e=[];let n=[];for(let r=ze.a8;r<=ze.h1;r++)this._board[r]==null?n.push(null):n.push({square:Fr(r),type:this._board[r].type,color:this._board[r].color}),r+1&136&&(e.push(n),n=[],r+=8);return e}squareColor(e){if(e in ze){const n=ze[e];return(Fa(n)+kd(n))%2===0?"light":"dark"}return null}history({verbose:e=!1}={}){const n=[],r=[];for(;this._history.length>0;)n.push(this._undoMove());for(;;){const s=n.pop();if(!s)break;e?r.push(this._makePretty(s)):r.push(this._moveToSan(s,this._moves())),this._makeMove(s)}return r}_pruneComments(){const e=[],n={},r=s=>{s in this._comments&&(n[s]=this._comments[s])};for(;this._history.length>0;)e.push(this._undoMove());for(r(this.fen());;){const s=e.pop();if(!s)break;this._makeMove(s),r(this.fen())}this._comments=n}getComment(){return this._comments[this.fen()]}setComment(e){this._comments[this.fen()]=e.replace("{","[").replace("}","]")}deleteComment(){const e=this._comments[this.fen()];return delete this._comments[this.fen()],e}getComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>({fen:e,comment:this._comments[e]}))}deleteComments(){return this._pruneComments(),Object.keys(this._comments).map(e=>{const n=this._comments[e];return delete this._comments[e],{fen:e,comment:n}})}setCastlingRights(e,n){for(const s of[Sn,bi])n[s]!==void 0&&(n[s]?this._castling[e]|=zf[s]:this._castling[e]&=~zf[s]);this._updateCastlingRights();const r=this.getCastlingRights(e);return(n[Sn]===void 0||n[Sn]===r[Sn])&&(n[bi]===void 0||n[bi]===r[bi])}getCastlingRights(e){return{[Sn]:(this._castling[e]&zf[Sn])!==0,[bi]:(this._castling[e]&zf[bi])!==0}}moveNumber(){return this._moveNumber}}const wc={moves:"",fen:lv,start:lv,lastMove:"",greedy:!1},rA=V1({name:"game",initialState:wc,reducers:{gameSetMoves(t,e){t.moves=e.payload},gameSetFen(t,e){t.fen=e.payload},gameSetStart(t,e){t.start=e.payload},gameSetLastMove(t,e){t.lastMove=e.payload},gameResetMoves(t){t.moves=wc.moves},gameResetFen(t){t.fen=wc.fen},gameResetStart(t){t.start=wc.start},gameResetLastMove(t){t.lastMove=wc.lastMove},gameUpdate(t,e){return{start:t.start,moves:e.payload.moves,fen:e.payload.fen,lastMove:e.payload.lastMove,greedy:e.payload.greedy}}}}),uY=t=>t.pgn().replace(/\[.*?\]/g,"").replace(/\r?\n|\r/g,""),Kd=()=>q1(t=>t.game),eb=t=>`[FEN "${t.start}"]
 
`+t.moves,tb=(t,e=!1)=>{const n=t.history({verbose:!0}),r=uY(t),s=t.fen(),o=n.length===0?"":n[n.length-1].lan;return{moves:r,fen:s,lastMove:o,greedy:e}},dv=t=>{const e=new Jx(t.start);return e.loadPgn(eb(t)),e},{gameSetMoves:Fge,gameResetMoves:Bu,gameSetFen:cY,gameResetFen:Xd,gameSetStart:sA,gameResetStart:oA,gameSetLastMove:Mge,gameResetLastMove:jge,gameUpdate:nb}=rA.actions,dY=rA.reducer,iA=({setPlaying:t,setText:e})=>{const n=Ns(),r=s=>{s.preventDefault(),t(!1),n(Bu()),n(Xd()),e(["Reset to start position"])};return w.jsx(oo,{onClick:r,children:w.jsx(pl,{iconName:"bi-stop"})})},Mm=({setText:t,playing:e})=>{const n=eb(Kd()),r=s=>{s.preventDefault(),navigator.clipboard.writeText(n),e||t(["Copied PGN"])};return w.jsx(oo,{onClick:r,children:"Copy PGN"})};var jm={exports:{}},aA={},lA={exports:{}},fY="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",hY=fY,pY=hY;function uA(){}function cA(){}cA.resetWarningCache=uA;var mY=function(){function t(r,s,o,i,a,l){if(l!==pY){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:cA,resetWarningCache:uA};return n.PropTypes=n,n};lA.exports=mY();var rb=lA.exports;const qe=$u(rb);function dA(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=dA(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function E_(){for(var t,e,n=0,r="";n<arguments.length;)(t=arguments[n++])&&(e=dA(t))&&(r&&(r+=" "),r+=e);return r}const gY=Object.freeze(Object.defineProperty({__proto__:null,clsx:E_,default:E_},Symbol.toStringTag,{value:"Module"})),yY=rT(gY);var Xt={},$o={};Object.defineProperty($o,"__esModule",{value:!0});$o.dontSetMe=SY;$o.findInArray=vY;$o.int=wY;$o.isFunction=xY;$o.isNum=bY;function vY(t,e){for(var n=0,r=t.length;n<r;n++)if(e.apply(e,[t[n],n,t]))return t[n]}function xY(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function bY(t){return typeof t=="number"&&!isNaN(t)}function wY(t){return parseInt(t,10)}function SY(t,e,n){if(t[e])return new Error("Invalid prop ".concat(e," passed to ").concat(n," - do not set this, set it on the child."))}var ml={};Object.defineProperty(ml,"__esModule",{value:!0});ml.browserPrefixToKey=hA;ml.browserPrefixToStyle=CY;ml.default=void 0;ml.getPrefix=fA;var dy=["Moz","Webkit","O","ms"];function fA(){var t,e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";var r=(t=window.document)===null||t===void 0||(e=t.documentElement)===null||e===void 0?void 0:e.style;if(!r||n in r)return"";for(var s=0;s<dy.length;s++)if(hA(n,dy[s])in r)return dy[s];return""}function hA(t,e){return e?"".concat(e).concat(_Y(t)):t}function CY(t,e){return e?"-".concat(e.toLowerCase(),"-").concat(t):t}function _Y(t){for(var e="",n=!0,r=0;r<t.length;r++)n?(e+=t[r].toUpperCase(),n=!1):t[r]==="-"?n=!0:e+=t[r];return e}var EY=fA();ml.default=EY;function fv(t){"@babel/helpers - typeof";return fv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fv(t)}Object.defineProperty(Xt,"__esModule",{value:!0});Xt.addClassName=vA;Xt.addEvent=$Y;Xt.addUserSelectStyles=jY;Xt.createCSSTransform=PY;Xt.createSVGTransform=LY;Xt.getTouch=FY;Xt.getTouchIdentifier=MY;Xt.getTranslation=sb;Xt.innerHeight=RY;Xt.innerWidth=DY;Xt.matchesSelector=yA;Xt.matchesSelectorAndParentsTo=NY;Xt.offsetXYFromParent=AY;Xt.outerHeight=IY;Xt.outerWidth=OY;Xt.removeClassName=xA;Xt.removeEvent=kY;Xt.removeUserSelectStyles=BY;var Gr=$o,T_=TY(ml);function pA(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(pA=function(s){return s?n:e})(t)}function TY(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||fv(t)!=="object"&&typeof t!="function")return{default:t};var n=pA(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var i=s?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r}function N_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function mA(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?N_(Object(n),!0).forEach(function(r){gA(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):N_(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function gA(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Wf="";function yA(t,e){return Wf||(Wf=(0,Gr.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(n){return(0,Gr.isFunction)(t[n])})),(0,Gr.isFunction)(t[Wf])?t[Wf](e):!1}function NY(t,e,n){var r=t;do{if(yA(r,e))return!0;if(r===n)return!1;r=r.parentNode}while(r);return!1}function $Y(t,e,n,r){if(t){var s=mA({capture:!0},r);t.addEventListener?t.addEventListener(e,n,s):t.attachEvent?t.attachEvent("on"+e,n):t["on"+e]=n}}function kY(t,e,n,r){if(t){var s=mA({capture:!0},r);t.removeEventListener?t.removeEventListener(e,n,s):t.detachEvent?t.detachEvent("on"+e,n):t["on"+e]=null}}function IY(t){var e=t.clientHeight,n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,Gr.int)(n.borderTopWidth),e+=(0,Gr.int)(n.borderBottomWidth),e}function OY(t){var e=t.clientWidth,n=t.ownerDocument.defaultView.getComputedStyle(t);return e+=(0,Gr.int)(n.borderLeftWidth),e+=(0,Gr.int)(n.borderRightWidth),e}function RY(t){var e=t.clientHeight,n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,Gr.int)(n.paddingTop),e-=(0,Gr.int)(n.paddingBottom),e}function DY(t){var e=t.clientWidth,n=t.ownerDocument.defaultView.getComputedStyle(t);return e-=(0,Gr.int)(n.paddingLeft),e-=(0,Gr.int)(n.paddingRight),e}function AY(t,e,n){var r=e===e.ownerDocument.body,s=r?{left:0,top:0}:e.getBoundingClientRect(),o=(t.clientX+e.scrollLeft-s.left)/n,i=(t.clientY+e.scrollTop-s.top)/n;return{x:o,y:i}}function PY(t,e){var n=sb(t,e,"px");return gA({},(0,T_.browserPrefixToKey)("transform",T_.default),n)}function LY(t,e){var n=sb(t,e,"");return n}function sb(t,e,n){var r=t.x,s=t.y,o="translate(".concat(r).concat(n,",").concat(s).concat(n,")");if(e){var i="".concat(typeof e.x=="string"?e.x:e.x+n),a="".concat(typeof e.y=="string"?e.y:e.y+n);o="translate(".concat(i,", ").concat(a,")")+o}return o}function FY(t,e){return t.targetTouches&&(0,Gr.findInArray)(t.targetTouches,function(n){return e===n.identifier})||t.changedTouches&&(0,Gr.findInArray)(t.changedTouches,function(n){return e===n.identifier})}function MY(t){if(t.targetTouches&&t.targetTouches[0])return t.targetTouches[0].identifier;if(t.changedTouches&&t.changedTouches[0])return t.changedTouches[0].identifier}function jY(t){if(t){var e=t.getElementById("react-draggable-style-el");e||(e=t.createElement("style"),e.type="text/css",e.id="react-draggable-style-el",e.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,e.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,t.getElementsByTagName("head")[0].appendChild(e)),t.body&&vA(t.body,"react-draggable-transparent-selection")}}function BY(t){if(t)try{if(t.body&&xA(t.body,"react-draggable-transparent-selection"),t.selection)t.selection.empty();else{var e=(t.defaultView||window).getSelection();e&&e.type!=="Caret"&&e.removeAllRanges()}}catch{}}function vA(t,e){t.classList?t.classList.add(e):t.className.match(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)")))||(t.className+=" ".concat(e))}function xA(t,e){t.classList?t.classList.remove(e):t.className=t.className.replace(new RegExp("(?:^|\\s)".concat(e,"(?!\\S)"),"g"),"")}var ko={};Object.defineProperty(ko,"__esModule",{value:!0});ko.canDragX=WY;ko.canDragY=VY;ko.createCoreData=HY;ko.createDraggableData=qY;ko.getBoundPosition=UY;ko.getControlPosition=GY;ko.snapToGrid=zY;var Lr=$o,Kl=Xt;function UY(t,e,n){if(!t.props.bounds)return[e,n];var r=t.props.bounds;r=typeof r=="string"?r:KY(r);var s=ob(t);if(typeof r=="string"){var o=s.ownerDocument,i=o.defaultView,a;if(r==="parent"?a=s.parentNode:a=o.querySelector(r),!(a instanceof i.HTMLElement))throw new Error('Bounds selector "'+r+'" could not find an element.');var l=a,u=i.getComputedStyle(s),c=i.getComputedStyle(l);r={left:-s.offsetLeft+(0,Lr.int)(c.paddingLeft)+(0,Lr.int)(u.marginLeft),top:-s.offsetTop+(0,Lr.int)(c.paddingTop)+(0,Lr.int)(u.marginTop),right:(0,Kl.innerWidth)(l)-(0,Kl.outerWidth)(s)-s.offsetLeft+(0,Lr.int)(c.paddingRight)-(0,Lr.int)(u.marginRight),bottom:(0,Kl.innerHeight)(l)-(0,Kl.outerHeight)(s)-s.offsetTop+(0,Lr.int)(c.paddingBottom)-(0,Lr.int)(u.marginBottom)}}return(0,Lr.isNum)(r.right)&&(e=Math.min(e,r.right)),(0,Lr.isNum)(r.bottom)&&(n=Math.min(n,r.bottom)),(0,Lr.isNum)(r.left)&&(e=Math.max(e,r.left)),(0,Lr.isNum)(r.top)&&(n=Math.max(n,r.top)),[e,n]}function zY(t,e,n){var r=Math.round(e/t[0])*t[0],s=Math.round(n/t[1])*t[1];return[r,s]}function WY(t){return t.props.axis==="both"||t.props.axis==="x"}function VY(t){return t.props.axis==="both"||t.props.axis==="y"}function GY(t,e,n){var r=typeof e=="number"?(0,Kl.getTouch)(t,e):null;if(typeof e=="number"&&!r)return null;var s=ob(n),o=n.props.offsetParent||s.offsetParent||s.ownerDocument.body;return(0,Kl.offsetXYFromParent)(r||t,o,n.props.scale)}function HY(t,e,n){var r=t.state,s=!(0,Lr.isNum)(r.lastX),o=ob(t);return s?{node:o,deltaX:0,deltaY:0,lastX:e,lastY:n,x:e,y:n}:{node:o,deltaX:e-r.lastX,deltaY:n-r.lastY,lastX:r.lastX,lastY:r.lastY,x:e,y:n}}function qY(t,e){var n=t.props.scale;return{node:e.node,x:t.state.x+e.deltaX/n,y:t.state.y+e.deltaY/n,deltaX:e.deltaX/n,deltaY:e.deltaY/n,lastX:t.state.x,lastY:t.state.y}}function KY(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom}}function ob(t){var e=t.findDOMNode();if(!e)throw new Error("<DraggableCore>: Unmounted during event!");return e}var Bm={},Um={};Object.defineProperty(Um,"__esModule",{value:!0});Um.default=XY;function XY(){}function Sp(t){"@babel/helpers - typeof";return Sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sp(t)}Object.defineProperty(Bm,"__esModule",{value:!0});Bm.default=void 0;var fy=QY(L),Pr=ib(rb),YY=ib(Ru),Wn=Xt,mi=ko,hy=$o,Sc=ib(Um);function ib(t){return t&&t.__esModule?t:{default:t}}function bA(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(bA=function(s){return s?n:e})(t)}function QY(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||Sp(t)!=="object"&&typeof t!="function")return{default:t};var n=bA(e);if(n&&n.has(t))return n.get(t);var r={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var i=s?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(r,o,i):r[o]=t[o]}return r.default=t,n&&n.set(t,r),r}function $_(t,e){return tQ(t)||eQ(t,e)||JY(t,e)||ZY()}function ZY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JY(t,e){if(t){if(typeof t=="string")return k_(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k_(t,e)}}function k_(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function eQ(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r=[],s=!0,o=!1,i,a;try{for(n=n.call(t);!(s=(i=n.next()).done)&&(r.push(i.value),!(e&&r.length===e));s=!0);}catch(l){o=!0,a=l}finally{try{!s&&n.return!=null&&n.return()}finally{if(o)throw a}}return r}}function tQ(t){if(Array.isArray(t))return t}function nQ(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I_(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function rQ(t,e,n){return e&&I_(t.prototype,e),n&&I_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function sQ(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hv(t,e)}function hv(t,e){return hv=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},hv(t,e)}function oQ(t){var e=aQ();return function(){var r=Cp(t),s;if(e){var o=Cp(this).constructor;s=Reflect.construct(r,arguments,o)}else s=r.apply(this,arguments);return iQ(this,s)}}function iQ(t,e){if(e&&(Sp(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Vn(t)}function Vn(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function aQ(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cp(t){return Cp=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Cp(t)}function us(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var zs={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}},gi=zs.mouse,zm=function(t){sQ(n,t);var e=oQ(n);function n(){var r;nQ(this,n);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=e.call.apply(e,[this].concat(o)),us(Vn(r),"state",{dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:null}),us(Vn(r),"mounted",!1),us(Vn(r),"handleDragStart",function(a){if(r.props.onMouseDown(a),!r.props.allowAnyClick&&typeof a.button=="number"&&a.button!==0)return!1;var l=r.findDOMNode();if(!l||!l.ownerDocument||!l.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");var u=l.ownerDocument;if(!(r.props.disabled||!(a.target instanceof u.defaultView.Node)||r.props.handle&&!(0,Wn.matchesSelectorAndParentsTo)(a.target,r.props.handle,l)||r.props.cancel&&(0,Wn.matchesSelectorAndParentsTo)(a.target,r.props.cancel,l))){a.type==="touchstart"&&a.preventDefault();var c=(0,Wn.getTouchIdentifier)(a);r.setState({touchIdentifier:c});var d=(0,mi.getControlPosition)(a,c,Vn(r));if(d!=null){var f=d.x,h=d.y,p=(0,mi.createCoreData)(Vn(r),f,h);(0,Sc.default)("DraggableCore: handleDragStart: %j",p),(0,Sc.default)("calling",r.props.onStart);var m=r.props.onStart(a,p);m===!1||r.mounted===!1||(r.props.enableUserSelectHack&&(0,Wn.addUserSelectStyles)(u),r.setState({dragging:!0,lastX:f,lastY:h}),(0,Wn.addEvent)(u,gi.move,r.handleDrag),(0,Wn.addEvent)(u,gi.stop,r.handleDragStop))}}}),us(Vn(r),"handleDrag",function(a){var l=(0,mi.getControlPosition)(a,r.state.touchIdentifier,Vn(r));if(l!=null){var u=l.x,c=l.y;if(Array.isArray(r.props.grid)){var d=u-r.state.lastX,f=c-r.state.lastY,h=(0,mi.snapToGrid)(r.props.grid,d,f),p=$_(h,2);if(d=p[0],f=p[1],!d&&!f)return;u=r.state.lastX+d,c=r.state.lastY+f}var m=(0,mi.createCoreData)(Vn(r),u,c);(0,Sc.default)("DraggableCore: handleDrag: %j",m);var v=r.props.onDrag(a,m);if(v===!1||r.mounted===!1){try{r.handleDragStop(new MouseEvent("mouseup"))}catch{var g=document.createEvent("MouseEvents");g.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),r.handleDragStop(g)}return}r.setState({lastX:u,lastY:c})}}),us(Vn(r),"handleDragStop",function(a){if(r.state.dragging){var l=(0,mi.getControlPosition)(a,r.state.touchIdentifier,Vn(r));if(l!=null){var u=l.x,c=l.y;if(Array.isArray(r.props.grid)){var d=u-r.state.lastX||0,f=c-r.state.lastY||0,h=(0,mi.snapToGrid)(r.props.grid,d,f),p=$_(h,2);d=p[0],f=p[1],u=r.state.lastX+d,c=r.state.lastY+f}var m=(0,mi.createCoreData)(Vn(r),u,c),v=r.props.onStop(a,m);if(v===!1||r.mounted===!1)return!1;var g=r.findDOMNode();g&&r.props.enableUserSelectHack&&(0,Wn.removeUserSelectStyles)(g.ownerDocument),(0,Sc.default)("DraggableCore: handleDragStop: %j",m),r.setState({dragging:!1,lastX:NaN,lastY:NaN}),g&&((0,Sc.default)("DraggableCore: Removing handlers"),(0,Wn.removeEvent)(g.ownerDocument,gi.move,r.handleDrag),(0,Wn.removeEvent)(g.ownerDocument,gi.stop,r.handleDragStop))}}}),us(Vn(r),"onMouseDown",function(a){return gi=zs.mouse,r.handleDragStart(a)}),us(Vn(r),"onMouseUp",function(a){return gi=zs.mouse,r.handleDragStop(a)}),us(Vn(r),"onTouchStart",function(a){return gi=zs.touch,r.handleDragStart(a)}),us(Vn(r),"onTouchEnd",function(a){return gi=zs.touch,r.handleDragStop(a)}),r}return rQ(n,[{key:"componentDidMount",value:function(){this.mounted=!0;var s=this.findDOMNode();s&&(0,Wn.addEvent)(s,zs.touch.start,this.onTouchStart,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var s=this.findDOMNode();if(s){var o=s.ownerDocument;(0,Wn.removeEvent)(o,zs.mouse.move,this.handleDrag),(0,Wn.removeEvent)(o,zs.touch.move,this.handleDrag),(0,Wn.removeEvent)(o,zs.mouse.stop,this.handleDragStop),(0,Wn.removeEvent)(o,zs.touch.stop,this.handleDragStop),(0,Wn.removeEvent)(s,zs.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,Wn.removeUserSelectStyles)(o)}}},{key:"findDOMNode",value:function(){var s,o,i;return(s=this.props)!==null&&s!==void 0&&s.nodeRef?(o=this.props)===null||o===void 0||(i=o.nodeRef)===null||i===void 0?void 0:i.current:YY.default.findDOMNode(this)}},{key:"render",value:function(){return fy.cloneElement(fy.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}]),n}(fy.Component);Bm.default=zm;us(zm,"displayName","DraggableCore");us(zm,"propTypes",{allowAnyClick:Pr.default.bool,disabled:Pr.default.bool,enableUserSelectHack:Pr.default.bool,offsetParent:function(e,n){if(e[n]&&e[n].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:Pr.default.arrayOf(Pr.default.number),handle:Pr.default.string,cancel:Pr.default.string,nodeRef:Pr.default.object,onStart:Pr.default.func,onDrag:Pr.default.func,onStop:Pr.default.func,onMouseDown:Pr.default.func,scale:Pr.default.number,className:hy.dontSetMe,style:hy.dontSetMe,transform:hy.dontSetMe});us(zm,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1});(function(t){function e(U){"@babel/helpers - typeof";return e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},e(U)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return u.default}}),t.default=void 0;var n=p(L),r=f(rb),s=f(Ru),o=f(yY),i=Xt,a=ko,l=$o,u=f(Bm),c=f(Um),d=["axis","bounds","children","defaultPosition","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","position","positionOffset","scale"];function f(U){return U&&U.__esModule?U:{default:U}}function h(U){if(typeof WeakMap!="function")return null;var Q=new WeakMap,G=new WeakMap;return(h=function(re){return re?G:Q})(U)}function p(U,Q){if(!Q&&U&&U.__esModule)return U;if(U===null||e(U)!=="object"&&typeof U!="function")return{default:U};var G=h(Q);if(G&&G.has(U))return G.get(U);var J={},re=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var be in U)if(be!=="default"&&Object.prototype.hasOwnProperty.call(U,be)){var ue=re?Object.getOwnPropertyDescriptor(U,be):null;ue&&(ue.get||ue.set)?Object.defineProperty(J,be,ue):J[be]=U[be]}return J.default=U,G&&G.set(U,J),J}function m(){return m=Object.assign||function(U){for(var Q=1;Q<arguments.length;Q++){var G=arguments[Q];for(var J in G)Object.prototype.hasOwnProperty.call(G,J)&&(U[J]=G[J])}return U},m.apply(this,arguments)}function v(U,Q){if(U==null)return{};var G=g(U,Q),J,re;if(Object.getOwnPropertySymbols){var be=Object.getOwnPropertySymbols(U);for(re=0;re<be.length;re++)J=be[re],!(Q.indexOf(J)>=0)&&Object.prototype.propertyIsEnumerable.call(U,J)&&(G[J]=U[J])}return G}function g(U,Q){if(U==null)return{};var G={},J=Object.keys(U),re,be;for(be=0;be<J.length;be++)re=J[be],!(Q.indexOf(re)>=0)&&(G[re]=U[re]);return G}function x(U,Q){var G=Object.keys(U);if(Object.getOwnPropertySymbols){var J=Object.getOwnPropertySymbols(U);Q&&(J=J.filter(function(re){return Object.getOwnPropertyDescriptor(U,re).enumerable})),G.push.apply(G,J)}return G}function b(U){for(var Q=1;Q<arguments.length;Q++){var G=arguments[Q]!=null?arguments[Q]:{};Q%2?x(Object(G),!0).forEach(function(J){A(U,J,G[J])}):Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(G)):x(Object(G)).forEach(function(J){Object.defineProperty(U,J,Object.getOwnPropertyDescriptor(G,J))})}return U}function _(U,Q){return B(U)||P(U,Q)||E(U,Q)||N()}function N(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E(U,Q){if(U){if(typeof U=="string")return R(U,Q);var G=Object.prototype.toString.call(U).slice(8,-1);if(G==="Object"&&U.constructor&&(G=U.constructor.name),G==="Map"||G==="Set")return Array.from(U);if(G==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(G))return R(U,Q)}}function R(U,Q){(Q==null||Q>U.length)&&(Q=U.length);for(var G=0,J=new Array(Q);G<Q;G++)J[G]=U[G];return J}function P(U,Q){var G=U==null?null:typeof Symbol<"u"&&U[Symbol.iterator]||U["@@iterator"];if(G!=null){var J=[],re=!0,be=!1,ue,De;try{for(G=G.call(U);!(re=(ue=G.next()).done)&&(J.push(ue.value),!(Q&&J.length===Q));re=!0);}catch(Ae){be=!0,De=Ae}finally{try{!re&&G.return!=null&&G.return()}finally{if(be)throw De}}return J}}function B(U){if(Array.isArray(U))return U}function F(U,Q){if(!(U instanceof Q))throw new TypeError("Cannot call a class as a function")}function H(U,Q){for(var G=0;G<Q.length;G++){var J=Q[G];J.enumerable=J.enumerable||!1,J.configurable=!0,"value"in J&&(J.writable=!0),Object.defineProperty(U,J.key,J)}}function ee(U,Q,G){return Q&&H(U.prototype,Q),G&&H(U,G),Object.defineProperty(U,"prototype",{writable:!1}),U}function oe(U,Q){if(typeof Q!="function"&&Q!==null)throw new TypeError("Super expression must either be null or a function");U.prototype=Object.create(Q&&Q.prototype,{constructor:{value:U,writable:!0,configurable:!0}}),Object.defineProperty(U,"prototype",{writable:!1}),Q&&de(U,Q)}function de(U,Q){return de=Object.setPrototypeOf||function(J,re){return J.__proto__=re,J},de(U,Q)}function V(U){var Q=O();return function(){var J=j(U),re;if(Q){var be=j(this).constructor;re=Reflect.construct(J,arguments,be)}else re=J.apply(this,arguments);return W(this,re)}}function W(U,Q){if(Q&&(e(Q)==="object"||typeof Q=="function"))return Q;if(Q!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return I(U)}function I(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}function O(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function j(U){return j=Object.setPrototypeOf?Object.getPrototypeOf:function(G){return G.__proto__||Object.getPrototypeOf(G)},j(U)}function A(U,Q,G){return Q in U?Object.defineProperty(U,Q,{value:G,enumerable:!0,configurable:!0,writable:!0}):U[Q]=G,U}var ne=function(U){oe(G,U);var Q=V(G);function G(J){var re;return F(this,G),re=Q.call(this,J),A(I(re),"onDragStart",function(be,ue){(0,c.default)("Draggable: onDragStart: %j",ue);var De=re.props.onStart(be,(0,a.createDraggableData)(I(re),ue));if(De===!1)return!1;re.setState({dragging:!0,dragged:!0})}),A(I(re),"onDrag",function(be,ue){if(!re.state.dragging)return!1;(0,c.default)("Draggable: onDrag: %j",ue);var De=(0,a.createDraggableData)(I(re),ue),Ae={x:De.x,y:De.y};if(re.props.bounds){var Ye=Ae.x,ot=Ae.y;Ae.x+=re.state.slackX,Ae.y+=re.state.slackY;var Ft=(0,a.getBoundPosition)(I(re),Ae.x,Ae.y),yn=_(Ft,2),Ct=yn[0],It=yn[1];Ae.x=Ct,Ae.y=It,Ae.slackX=re.state.slackX+(Ye-Ae.x),Ae.slackY=re.state.slackY+(ot-Ae.y),De.x=Ae.x,De.y=Ae.y,De.deltaX=Ae.x-re.state.x,De.deltaY=Ae.y-re.state.y}var zt=re.props.onDrag(be,De);if(zt===!1)return!1;re.setState(Ae)}),A(I(re),"onDragStop",function(be,ue){if(!re.state.dragging)return!1;var De=re.props.onStop(be,(0,a.createDraggableData)(I(re),ue));if(De===!1)return!1;(0,c.default)("Draggable: onDragStop: %j",ue);var Ae={dragging:!1,slackX:0,slackY:0},Ye=!!re.props.position;if(Ye){var ot=re.props.position,Ft=ot.x,yn=ot.y;Ae.x=Ft,Ae.y=yn}re.setState(Ae)}),re.state={dragging:!1,dragged:!1,x:J.position?J.position.x:J.defaultPosition.x,y:J.position?J.position.y:J.defaultPosition.y,prevPropsPosition:b({},J.position),slackX:0,slackY:0,isElementSVG:!1},J.position&&!(J.onDrag||J.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element."),re}return ee(G,[{key:"componentDidMount",value:function(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}},{key:"componentWillUnmount",value:function(){this.setState({dragging:!1})}},{key:"findDOMNode",value:function(){var re,be,ue;return(re=(be=this.props)===null||be===void 0||(ue=be.nodeRef)===null||ue===void 0?void 0:ue.current)!==null&&re!==void 0?re:s.default.findDOMNode(this)}},{key:"render",value:function(){var re,be=this.props;be.axis,be.bounds;var ue=be.children,De=be.defaultPosition,Ae=be.defaultClassName,Ye=be.defaultClassNameDragging,ot=be.defaultClassNameDragged,Ft=be.position,yn=be.positionOffset;be.scale;var Ct=v(be,d),It={},zt=null,Mn=!!Ft,jn=!Mn||this.state.dragging,kr=Ft||De,vn={x:(0,a.canDragX)(this)&&jn?this.state.x:kr.x,y:(0,a.canDragY)(this)&&jn?this.state.y:kr.y};this.state.isElementSVG?zt=(0,i.createSVGTransform)(vn,yn):It=(0,i.createCSSTransform)(vn,yn);var Ot=(0,o.default)(ue.props.className||"",Ae,(re={},A(re,Ye,this.state.dragging),A(re,ot,this.state.dragged),re));return n.createElement(u.default,m({},Ct,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),n.cloneElement(n.Children.only(ue),{className:Ot,style:b(b({},ue.props.style),It),transform:zt}))}}],[{key:"getDerivedStateFromProps",value:function(re,be){var ue=re.position,De=be.prevPropsPosition;return ue&&(!De||ue.x!==De.x||ue.y!==De.y)?((0,c.default)("Draggable: getDerivedStateFromProps %j",{position:ue,prevPropsPosition:De}),{x:ue.x,y:ue.y,prevPropsPosition:b({},ue)}):null}}]),G}(n.Component);t.default=ne,A(ne,"displayName","Draggable"),A(ne,"propTypes",b(b({},u.default.propTypes),{},{axis:r.default.oneOf(["both","x","y","none"]),bounds:r.default.oneOfType([r.default.shape({left:r.default.number,right:r.default.number,top:r.default.number,bottom:r.default.number}),r.default.string,r.default.oneOf([!1])]),defaultClassName:r.default.string,defaultClassNameDragging:r.default.string,defaultClassNameDragged:r.default.string,defaultPosition:r.default.shape({x:r.default.number,y:r.default.number}),positionOffset:r.default.shape({x:r.default.oneOfType([r.default.number,r.default.string]),y:r.default.oneOfType([r.default.number,r.default.string])}),position:r.default.shape({x:r.default.number,y:r.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe})),A(ne,"defaultProps",b(b({},u.default.defaultProps),{},{axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1}))})(aA);var wA=aA,SA=wA.default,lQ=wA.DraggableCore;jm.exports=SA;jm.exports.default=SA;jm.exports.DraggableCore=lQ;var uQ=jm.exports;const cQ=$u(uQ),Vf=({name:t,xy:e})=>{const n={height:ki,width:ki,backgroundColor:"red",borderRadius:"50%",textAlign:"center",position:"absolute",userSelect:"none",opacity:.5},r={display:"flex",height:"100%",width:"100%",textAlign:"center",justifyContent:"center",alignItems:"center"},s=An.useRef(null),o=Ns();return w.jsx(cQ,{handle:"strong",bounds:"parent",position:{x:e[0],y:e[1]},defaultPosition:{x:e[0],y:e[1]},nodeRef:s,onStop:(i,a)=>{const l={xy:[a.x,a.y],key:t};console.log(l),o(Qx(l))},children:w.jsx("div",{className:"box no-cursor",style:n,ref:s,children:w.jsx("strong",{className:"cursor",style:r,children:t})})})},dQ=()=>{const t=JD();return w.jsxs(w.Fragment,{children:[w.jsx(Vf,{name:"a8",xy:t.a8}),w.jsx(Vf,{name:"h8",xy:t.h8}),w.jsx(Vf,{name:"h1",xy:t.h1}),w.jsx(Vf,{name:"a1",xy:t.a1})]})},Yd=({text:t})=>w.jsx("div",{className:"text-white",children:t.map(function(e,n){return w.jsx("div",{children:e},n)})}),Uu=()=>{const t=Zp(),e=()=>{t("/")};return w.jsx(oo,{onClick:e,children:w.jsx(pl,{iconName:"bi-house"})})},Qd=t=>{const e={minWidth:"200px"};return w.jsx("div",{ref:t.sidebarRef,className:"d-flex flex-column text-center px-1",style:e,children:w.jsx("ul",{className:"nav nav-pills flex-column",children:t.children})})},CA=t=>w.jsx("div",{className:"d-flex bg-dark h-100",children:t.children}),_A=(t,e,n,r)=>{const[s,o,i,a,l]=LD(t);FD(s,e,"blue",a,l),q7(s,n,"blue",a,l);for(let u=0;u<64;u++){let c=.1,d=-1;for(let p=0;p<12;p++)r[u][p]>c&&(c=r[u][p],d=p);if(d===-1)continue;const f=c_[d%c_.length],h=`${DD[d]}:${Math.round(100*c)}`;K7(s,f,e[u][0]*a,e[u][1]*l,h,o,i)}},py=(t,e,n=.6,r=.6)=>{let s=0;e.from.forEach(o=>{s+=1-Math.max(...t[o])-n});for(let o=0;o<e.to.length;o++)s+=t[e.to[o]][e.targets[o]]-r;return s},fQ=(t,e,n)=>{let r=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,i=null,a=null;const l=new Set;return e.forEach(u=>{if(!(u.move1.sans[0]in l)){l.add(u.move1.sans[0]);const f=py(t,u.move1);f>0&&n.add(u.move1.sans[0]),f>r&&(i=u.move1,r=f)}if(u.move2===null||u.moves===null||!n.has(u.move1.sans[0]))return;const c=py(t,u.move2);if(c<0)return;c>s&&(s=c);const d=py(t,u.moves);d>o&&(o=d,a=u.moves)}),{bestScore1:r,bestScore2:s,bestJointScore:o,bestMove:i,bestMoves:a}},hQ=t=>Ke(()=>{const n=Le(t,[0,0],[-1,1]),r=Le(t,[0,2],[-1,1]),s=Le(t,[0,3],[-1,1]),o=st(ke(n,r),2),i=Oe(s,st(Oe(r,n),3));return cn([o,i],1)}),EA=(t,e,n)=>Ke(()=>{const s=hQ(t),o=St(Ss(Oe(Br(s,1),Br(lu(e),0))),2),a=UO(o,1).arraySync(),l=s.arraySync();for(let u=0;u<a.length;u++)for(let c=0;c<4;c++){const d=(c+1)%4,f=n[c][0]-n[d][0],h=n[c][1]-n[d][1],p=l[u][0]-n[d][0],m=l[u][1]-n[d][1];f*m-h*p<0&&(a[u]=-1)}return a}),TA=(t,e,n)=>{const r=eA(64,12),s=t.arraySync(),o=e.arraySync();for(let i=0;i<n.length;i++){const a=n[i];if(a==-1)continue;const l=o[i],u=s[i];r[a][l]=Math.max(r[a][l],u)}return r},pQ=(t,e,n=.5)=>{for(let r=0;r<64;r++)for(let s=0;s<12;s++)t[r][s]=n*t[r][s]+(1-n)*e[r][s];return t},mQ=(t,e)=>{t.move(e);const n=t.history({verbose:!0}),r=n[n.length-1].lan;return t.undo(),r},NA=async(t,e,n)=>{const{image4D:r,width:s,height:o,padding:i,roi:a}=Yx(e,n),l=e.current.videoWidth,u=e.current.videoHeight,c=t.current.predict(r),{boxes:d,scores:f,cls:h}=XD(c,s,o,l,u,i,a);return Kt([r,c]),{boxes:d,scores:f,cls:h}},$A=(t,e)=>Vx.map(r=>QD(t.current[r],e.current.height,e.current.width)),gQ=(t,e,n,r,s,o,i,a,l,u,c,d)=>{let f=null,h,p,m,v,g,x;const b=async()=>{if(r.current===!1||Xx(e))f=null;else{if(f===null){m=$A(i,n);const ne=HD(m);f=qD(ne),h=KD(ne),p=eA(64,12),v=new Set,x={}}const _=performance.now(),N=Cu().numTensors,{boxes:E,scores:R,cls:P}=await NA(t,e,m),B=EA(E,f,h),F=TA(R,P,B);p=pQ(p,F);const{bestScore1:H,bestScore2:ee,bestJointScore:oe,bestMove:de,bestMoves:V}=fQ(p,l.current,v),W=performance.now(),I=(1e3/(W-_)).toFixed(1);let O=!1;if(V!==null&&d!=="play"){const ne=V.sans[0];O=ee>0&&oe>0&&v.has(ne),O&&(a.current.move(ne),v.clear(),x={})}let j=!1;if(de!==null&&!O&&H>0){const ne=de.sans[0];ne in x||(x[ne]=W);const U=W-x[ne]>1e3,Q=mQ(a.current,ne)!==u.current;j=U&&Q,j&&(a.current.move(ne),x={greedyMove:x[ne]})}if(O||j){const ne=d==="play"?!1:j,U=tb(a.current,ne);console.log("payload",U),o(nb(U))}s([`FPS: ${I}`,c.current]),_A(n.current,f,h,p),Kt([E,R,P]);const A=Cu().numTensors;N<A&&console.error(`Memory Leak! (${A} > ${N})`)}g=requestAnimationFrame(b)};return g=requestAnimationFrame(b),()=>{dx(),g&&window.cancelAnimationFrame(g)}},yQ=t=>{const e=L.useRef(t);return L.useEffect(()=>{e.current=t}),e},vQ=yQ,xQ=(t,e=100,n=!1)=>{const r=vQ(t),s=L.useRef(),o=[e,n,r];function i(){s.current&&clearTimeout(s.current),s.current=void 0}L.useEffect(()=>i,o);function a(){s.current=void 0}return L.useCallback(function(){const l=arguments,{current:u}=s;if(u===void 0&&n)return s.current=setTimeout(a,e),r.current.apply(null,l);u&&clearTimeout(u),s.current=setTimeout(()=>{s.current=void 0,r.current.apply(null,l)},e)},o)},bQ=(t,e,n)=>{const r=L.useState(t);return[r[0],xQ(r[1],e,n)]};function my(t,e,n,r){const s=L.useRef(n),o=L.useRef(r);L.useEffect(()=>{s.current=n,o.current=r}),L.useEffect(()=>{const i=t&&"current"in t?t.current:t;if(!i)return;let a=0;function l(...c){a||s.current.apply(this,c)}i.addEventListener(e,l);const u=o.current;return()=>{a=1,i.removeEventListener(e,l),u&&u()}},[t,e])}const wQ={},Yc=typeof window>"u"?null:window,SQ=Yc&&typeof Yc.visualViewport<"u"?Yc.visualViewport:null,O_=()=>[document.documentElement.clientWidth,document.documentElement.clientHeight],kA=function(t){t===void 0&&(t=wQ);const{wait:e,leading:n,initialWidth:r=0,initialHeight:s=0}=t,[o,i]=bQ(typeof document>"u"?[r,s]:O_,e,n),a=()=>i(O_);return my(Yc,"resize",a),my(SQ,"resize",a),my(Yc,"orientationchange",a),o},CQ=t=>kA(t)[1],_Q=t=>kA(t)[0];function EQ(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}const IA=L.createContext({dragDropManager:void 0});function os(t){return"Minified Redux error #"+t+"; visit https://redux.js.org/Errors?code="+t+" for the full message or use the non-minified dev environment for full errors. "}var R_=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}(),gy=function(){return Math.random().toString(36).substring(7).split("").join(".")},D_={INIT:"@@redux/INIT"+gy(),REPLACE:"@@redux/REPLACE"+gy(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+gy()}};function TQ(t){if(typeof t!="object"||t===null)return!1;for(var e=t;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function OA(t,e,n){var r;if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(os(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(os(1));return n(OA)(t,e)}if(typeof t!="function")throw new Error(os(2));var s=t,o=e,i=[],a=i,l=!1;function u(){a===i&&(a=i.slice())}function c(){if(l)throw new Error(os(3));return o}function d(m){if(typeof m!="function")throw new Error(os(4));if(l)throw new Error(os(5));var v=!0;return u(),a.push(m),function(){if(v){if(l)throw new Error(os(6));v=!1,u();var x=a.indexOf(m);a.splice(x,1),i=null}}}function f(m){if(!TQ(m))throw new Error(os(7));if(typeof m.type>"u")throw new Error(os(8));if(l)throw new Error(os(9));try{l=!0,o=s(o,m)}finally{l=!1}for(var v=i=a,g=0;g<v.length;g++){var x=v[g];x()}return m}function h(m){if(typeof m!="function")throw new Error(os(10));s=m,f({type:D_.REPLACE})}function p(){var m,v=d;return m={subscribe:function(x){if(typeof x!="object"||x===null)throw new Error(os(11));function b(){x.next&&x.next(c())}b();var _=v(b);return{unsubscribe:_}}},m[R_]=function(){return this},m}return f({type:D_.INIT}),r={dispatch:f,subscribe:d,getState:c,replaceReducer:h},r[R_]=p,r}function Ue(t,e,...n){if(NQ()&&e===void 0)throw new Error("invariant requires an error message argument");if(!t){let r;if(e===void 0)r=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{let s=0;r=new Error(e.replace(/%s/g,function(){return n[s++]})),r.name="Invariant Violation"}throw r.framesToPop=1,r}}function NQ(){return typeof process<"u"&&!0}function $Q(t,e,n){return e.split(".").reduce((r,s)=>r&&r[s]?r[s]:n||null,t)}function kQ(t,e){return t.filter(n=>n!==e)}function RA(t){return typeof t=="object"}function IQ(t,e){const n=new Map,r=o=>{n.set(o,n.has(o)?n.get(o)+1:1)};t.forEach(r),e.forEach(r);const s=[];return n.forEach((o,i)=>{o===1&&s.push(i)}),s}function OQ(t,e){return t.filter(n=>e.indexOf(n)>-1)}const ab="dnd-core/INIT_COORDS",Wm="dnd-core/BEGIN_DRAG",lb="dnd-core/PUBLISH_DRAG_SOURCE",Vm="dnd-core/HOVER",Gm="dnd-core/DROP",Hm="dnd-core/END_DRAG";function A_(t,e){return{type:ab,payload:{sourceClientOffset:e||null,clientOffset:t||null}}}const RQ={type:ab,payload:{clientOffset:null,sourceClientOffset:null}};function DQ(t){return function(n=[],r={publishSource:!0}){const{publishSource:s=!0,clientOffset:o,getSourceClientOffset:i}=r,a=t.getMonitor(),l=t.getRegistry();t.dispatch(A_(o)),AQ(n,a,l);const u=FQ(n,a);if(u==null){t.dispatch(RQ);return}let c=null;if(o){if(!i)throw new Error("getSourceClientOffset must be defined");PQ(i),c=i(u)}t.dispatch(A_(o,c));const f=l.getSource(u).beginDrag(a,u);if(f==null)return;LQ(f),l.pinSource(u);const h=l.getSourceType(u);return{type:Wm,payload:{itemType:h,item:f,sourceId:u,clientOffset:o||null,sourceClientOffset:c||null,isSourcePublic:!!s}}}}function AQ(t,e,n){Ue(!e.isDragging(),"Cannot call beginDrag while dragging."),t.forEach(function(r){Ue(n.getSource(r),"Expected sourceIds to be registered.")})}function PQ(t){Ue(typeof t=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function LQ(t){Ue(RA(t),"Item must be an object.")}function FQ(t,e){let n=null;for(let r=t.length-1;r>=0;r--)if(e.canDragSource(t[r])){n=t[r];break}return n}function MQ(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jQ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),r.forEach(function(s){MQ(t,s,n[s])})}return t}function BQ(t){return function(n={}){const r=t.getMonitor(),s=t.getRegistry();UQ(r),VQ(r).forEach((i,a)=>{const l=zQ(i,a,s,r),u={type:Gm,payload:{dropResult:jQ({},n,l)}};t.dispatch(u)})}}function UQ(t){Ue(t.isDragging(),"Cannot call drop while not dragging."),Ue(!t.didDrop(),"Cannot call drop twice during one drag operation.")}function zQ(t,e,n,r){const s=n.getTarget(t);let o=s?s.drop(r,t):void 0;return WQ(o),typeof o>"u"&&(o=e===0?{}:r.getDropResult()),o}function WQ(t){Ue(typeof t>"u"||RA(t),"Drop result must either be an object or undefined.")}function VQ(t){const e=t.getTargetIds().filter(t.canDropOnTarget,t);return e.reverse(),e}function GQ(t){return function(){const n=t.getMonitor(),r=t.getRegistry();HQ(n);const s=n.getSourceId();return s!=null&&(r.getSource(s,!0).endDrag(n,s),r.unpinSource()),{type:Hm}}}function HQ(t){Ue(t.isDragging(),"Cannot call endDrag while not dragging.")}function pv(t,e){return e===null?t===null:Array.isArray(t)?t.some(n=>n===e):t===e}function qQ(t){return function(n,{clientOffset:r}={}){KQ(n);const s=n.slice(0),o=t.getMonitor(),i=t.getRegistry(),a=o.getItemType();return YQ(s,i,a),XQ(s,o,i),QQ(s,o,i),{type:Vm,payload:{targetIds:s,clientOffset:r||null}}}}function KQ(t){Ue(Array.isArray(t),"Expected targetIds to be an array.")}function XQ(t,e,n){Ue(e.isDragging(),"Cannot call hover while not dragging."),Ue(!e.didDrop(),"Cannot call hover after drop.");for(let r=0;r<t.length;r++){const s=t[r];Ue(t.lastIndexOf(s)===r,"Expected targetIds to be unique in the passed array.");const o=n.getTarget(s);Ue(o,"Expected targetIds to be registered.")}}function YQ(t,e,n){for(let r=t.length-1;r>=0;r--){const s=t[r],o=e.getTargetType(s);pv(o,n)||t.splice(r,1)}}function QQ(t,e,n){t.forEach(function(r){n.getTarget(r).hover(e,r)})}function ZQ(t){return function(){if(t.getMonitor().isDragging())return{type:lb}}}function JQ(t){return{beginDrag:DQ(t),publishDragSource:ZQ(t),hover:qQ(t),drop:BQ(t),endDrag:GQ(t)}}class eZ{receiveBackend(e){this.backend=e}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const e=this,{dispatch:n}=this.store;function r(o){return(...i)=>{const a=o.apply(e,i);typeof a<"u"&&n(a)}}const s=JQ(this);return Object.keys(s).reduce((o,i)=>{const a=s[i];return o[i]=r(a),o},{})}dispatch(e){this.store.dispatch(e)}constructor(e,n){this.isSetUp=!1,this.handleRefCountChange=()=>{const r=this.store.getState().refCount>0;this.backend&&(r&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!r&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=e,this.monitor=n,e.subscribe(this.handleRefCountChange)}}function tZ(t,e){return{x:t.x+e.x,y:t.y+e.y}}function DA(t,e){return{x:t.x-e.x,y:t.y-e.y}}function nZ(t){const{clientOffset:e,initialClientOffset:n,initialSourceClientOffset:r}=t;return!e||!n||!r?null:DA(tZ(e,r),n)}function rZ(t){const{clientOffset:e,initialClientOffset:n}=t;return!e||!n?null:DA(e,n)}const Qc=[],ub=[];Qc.__IS_NONE__=!0;ub.__IS_ALL__=!0;function sZ(t,e){return t===Qc?!1:t===ub||typeof e>"u"?!0:OQ(e,t).length>0}class oZ{subscribeToStateChange(e,n={}){const{handlerIds:r}=n;Ue(typeof e=="function","listener must be a function."),Ue(typeof r>"u"||Array.isArray(r),"handlerIds, when specified, must be an array of strings.");let s=this.store.getState().stateId;const o=()=>{const i=this.store.getState(),a=i.stateId;try{a===s||a===s+1&&!sZ(i.dirtyHandlerIds,r)||e()}finally{s=a}};return this.store.subscribe(o)}subscribeToOffsetChange(e){Ue(typeof e=="function","listener must be a function.");let n=this.store.getState().dragOffset;const r=()=>{const s=this.store.getState().dragOffset;s!==n&&(n=s,e())};return this.store.subscribe(r)}canDragSource(e){if(!e)return!1;const n=this.registry.getSource(e);return Ue(n,`Expected to find a valid source. sourceId=${e}`),this.isDragging()?!1:n.canDrag(this,e)}canDropOnTarget(e){if(!e)return!1;const n=this.registry.getTarget(e);if(Ue(n,`Expected to find a valid target. targetId=${e}`),!this.isDragging()||this.didDrop())return!1;const r=this.registry.getTargetType(e),s=this.getItemType();return pv(r,s)&&n.canDrop(this,e)}isDragging(){return!!this.getItemType()}isDraggingSource(e){if(!e)return!1;const n=this.registry.getSource(e,!0);if(Ue(n,`Expected to find a valid source. sourceId=${e}`),!this.isDragging()||!this.isSourcePublic())return!1;const r=this.registry.getSourceType(e),s=this.getItemType();return r!==s?!1:n.isDragging(this,e)}isOverTarget(e,n={shallow:!1}){if(!e)return!1;const{shallow:r}=n;if(!this.isDragging())return!1;const s=this.registry.getTargetType(e),o=this.getItemType();if(o&&!pv(s,o))return!1;const i=this.getTargetIds();if(!i.length)return!1;const a=i.indexOf(e);return r?a===i.length-1:a>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return nZ(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return rZ(this.store.getState().dragOffset)}constructor(e,n){this.store=e,this.registry=n}}const P_=typeof global<"u"?global:self,AA=P_.MutationObserver||P_.WebKitMutationObserver;function PA(t){return function(){const n=setTimeout(s,0),r=setInterval(s,50);function s(){clearTimeout(n),clearInterval(r),t()}}}function iZ(t){let e=1;const n=new AA(t),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){e=-e,r.data=e}}const aZ=typeof AA=="function"?iZ:PA;class lZ{enqueueTask(e){const{queue:n,requestFlush:r}=this;n.length||(r(),this.flushing=!0),n[n.length]=e}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:e}=this;for(;this.index<e.length;){const n=this.index;if(this.index++,e[n].call(),this.index>this.capacity){for(let r=0,s=e.length-this.index;r<s;r++)e[r]=e[r+this.index];e.length-=this.index,this.index=0}}e.length=0,this.index=0,this.flushing=!1},this.registerPendingError=e=>{this.pendingErrors.push(e),this.requestErrorThrow()},this.requestFlush=aZ(this.flush),this.requestErrorThrow=PA(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class uZ{call(){try{this.task&&this.task()}catch(e){this.onError(e)}finally{this.task=null,this.release(this)}}constructor(e,n){this.onError=e,this.release=n,this.task=null}}class cZ{create(e){const n=this.freeTasks,r=n.length?n.pop():new uZ(this.onError,s=>n[n.length]=s);return r.task=e,r}constructor(e){this.onError=e,this.freeTasks=[]}}const LA=new lZ,dZ=new cZ(LA.registerPendingError);function fZ(t){LA.enqueueTask(dZ.create(t))}const cb="dnd-core/ADD_SOURCE",db="dnd-core/ADD_TARGET",fb="dnd-core/REMOVE_SOURCE",qm="dnd-core/REMOVE_TARGET";function hZ(t){return{type:cb,payload:{sourceId:t}}}function pZ(t){return{type:db,payload:{targetId:t}}}function mZ(t){return{type:fb,payload:{sourceId:t}}}function gZ(t){return{type:qm,payload:{targetId:t}}}function yZ(t){Ue(typeof t.canDrag=="function","Expected canDrag to be a function."),Ue(typeof t.beginDrag=="function","Expected beginDrag to be a function."),Ue(typeof t.endDrag=="function","Expected endDrag to be a function.")}function vZ(t){Ue(typeof t.canDrop=="function","Expected canDrop to be a function."),Ue(typeof t.hover=="function","Expected hover to be a function."),Ue(typeof t.drop=="function","Expected beginDrag to be a function.")}function mv(t,e){if(e&&Array.isArray(t)){t.forEach(n=>mv(n,!1));return}Ue(typeof t=="string"||typeof t=="symbol",e?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var ps;(function(t){t.SOURCE="SOURCE",t.TARGET="TARGET"})(ps||(ps={}));let xZ=0;function bZ(){return xZ++}function wZ(t){const e=bZ().toString();switch(t){case ps.SOURCE:return`S${e}`;case ps.TARGET:return`T${e}`;default:throw new Error(`Unknown Handler Role: ${t}`)}}function L_(t){switch(t[0]){case"S":return ps.SOURCE;case"T":return ps.TARGET;default:throw new Error(`Cannot parse handler ID: ${t}`)}}function F_(t,e){const n=t.entries();let r=!1;do{const{done:s,value:[,o]}=n.next();if(o===e)return!0;r=!!s}while(!r);return!1}class SZ{addSource(e,n){mv(e),yZ(n);const r=this.addHandler(ps.SOURCE,e,n);return this.store.dispatch(hZ(r)),r}addTarget(e,n){mv(e,!0),vZ(n);const r=this.addHandler(ps.TARGET,e,n);return this.store.dispatch(pZ(r)),r}containsHandler(e){return F_(this.dragSources,e)||F_(this.dropTargets,e)}getSource(e,n=!1){return Ue(this.isSourceId(e),"Expected a valid source ID."),n&&e===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(e)}getTarget(e){return Ue(this.isTargetId(e),"Expected a valid target ID."),this.dropTargets.get(e)}getSourceType(e){return Ue(this.isSourceId(e),"Expected a valid source ID."),this.types.get(e)}getTargetType(e){return Ue(this.isTargetId(e),"Expected a valid target ID."),this.types.get(e)}isSourceId(e){return L_(e)===ps.SOURCE}isTargetId(e){return L_(e)===ps.TARGET}removeSource(e){Ue(this.getSource(e),"Expected an existing source."),this.store.dispatch(mZ(e)),fZ(()=>{this.dragSources.delete(e),this.types.delete(e)})}removeTarget(e){Ue(this.getTarget(e),"Expected an existing target."),this.store.dispatch(gZ(e)),this.dropTargets.delete(e),this.types.delete(e)}pinSource(e){const n=this.getSource(e);Ue(n,"Expected an existing source."),this.pinnedSourceId=e,this.pinnedSource=n}unpinSource(){Ue(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(e,n,r){const s=wZ(e);return this.types.set(s,n),e===ps.SOURCE?this.dragSources.set(s,r):e===ps.TARGET&&this.dropTargets.set(s,r),s}constructor(e){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=e}}const CZ=(t,e)=>t===e;function _Z(t,e){return!t&&!e?!0:!t||!e?!1:t.x===e.x&&t.y===e.y}function EZ(t,e,n=CZ){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!n(t[r],e[r]))return!1;return!0}function TZ(t=Qc,e){switch(e.type){case Vm:break;case cb:case db:case qm:case fb:return Qc;case Wm:case lb:case Hm:case Gm:default:return ub}const{targetIds:n=[],prevTargetIds:r=[]}=e.payload,s=IQ(n,r);if(!(s.length>0||!EZ(n,r)))return Qc;const i=r[r.length-1],a=n[n.length-1];return i!==a&&(i&&s.push(i),a&&s.push(a)),s}function NZ(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Z(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),r.forEach(function(s){NZ(t,s,n[s])})}return t}const M_={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function kZ(t=M_,e){const{payload:n}=e;switch(e.type){case ab:case Wm:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case Vm:return _Z(t.clientOffset,n.clientOffset)?t:$Z({},t,{clientOffset:n.clientOffset});case Hm:case Gm:return M_;default:return t}}function IZ(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $l(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),r.forEach(function(s){IZ(t,s,n[s])})}return t}const OZ={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function RZ(t=OZ,e){const{payload:n}=e;switch(e.type){case Wm:return $l({},t,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case lb:return $l({},t,{isSourcePublic:!0});case Vm:return $l({},t,{targetIds:n.targetIds});case qm:return t.targetIds.indexOf(n.targetId)===-1?t:$l({},t,{targetIds:kQ(t.targetIds,n.targetId)});case Gm:return $l({},t,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case Hm:return $l({},t,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return t}}function DZ(t=0,e){switch(e.type){case cb:case db:return t+1;case fb:case qm:return t-1;default:return t}}function AZ(t=0){return t+1}function PZ(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),r.forEach(function(s){PZ(t,s,n[s])})}return t}function FZ(t={},e){return{dirtyHandlerIds:TZ(t.dirtyHandlerIds,{type:e.type,payload:LZ({},e.payload,{prevTargetIds:$Q(t,"dragOperation.targetIds",[])})}),dragOffset:kZ(t.dragOffset,e),refCount:DZ(t.refCount,e),dragOperation:RZ(t.dragOperation,e),stateId:AZ(t.stateId)}}function MZ(t,e=void 0,n={},r=!1){const s=jZ(r),o=new oZ(s,new SZ(s)),i=new eZ(s,o),a=t(i,e,n);return i.receiveBackend(a),i}function jZ(t){const e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return OA(FZ,t&&e&&e({name:"dnd-core",instanceId:"dnd-core"}))}function BZ(t,e){if(t==null)return{};var n=UZ(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function UZ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}let j_=0;const wh=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var zZ=L.memo(function(e){var{children:n}=e,r=BZ(e,["children"]);const[s,o]=WZ(r);return L.useEffect(()=>{if(o){const i=FA();return++j_,()=>{--j_===0&&(i[wh]=null)}}},[]),w.jsx(IA.Provider,{value:s,children:n})});function WZ(t){if("manager"in t)return[{dragDropManager:t.manager},!1];const e=VZ(t.backend,t.context,t.options,t.debugMode),n=!t.context;return[e,n]}function VZ(t,e=FA(),n,r){const s=e;return s[wh]||(s[wh]={dragDropManager:MZ(t,e,n,r)}),s[wh]}function FA(){return typeof global<"u"?global:window}var GZ=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var r,s,o;if(Array.isArray(e)){if(r=e.length,r!=n.length)return!1;for(s=r;s--!==0;)if(!t(e[s],n[s]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(o=Object.keys(e),r=o.length,r!==Object.keys(n).length)return!1;for(s=r;s--!==0;)if(!Object.prototype.hasOwnProperty.call(n,o[s]))return!1;for(s=r;s--!==0;){var i=o[s];if(!t(e[i],n[i]))return!1}return!0}return e!==e&&n!==n};const nl=typeof window<"u"?L.useLayoutEffect:L.useEffect;function MA(t,e,n){const[r,s]=L.useState(()=>e(t)),o=L.useCallback(()=>{const i=e(t);GZ(r,i)||(s(i),n&&n())},[r,t,n]);return nl(o),[r,o]}function HZ(t,e,n){const[r,s]=MA(t,e,n);return nl(function(){const i=t.getHandlerId();if(i!=null)return t.subscribeToStateChange(s,{handlerIds:[i]})},[t,s]),r}function jA(t,e,n){return HZ(e,t||(()=>({})),()=>n.reconnect())}function BA(t,e){const n=[...e||[]];return e==null&&typeof t!="function"&&n.push(t),L.useMemo(()=>typeof t=="function"?t():t,n)}function qZ(t){return L.useMemo(()=>t.hooks.dragSource(),[t])}function KZ(t){return L.useMemo(()=>t.hooks.dragPreview(),[t])}let yy=!1,vy=!1;class XZ{receiveHandlerId(e){this.sourceId=e}getHandlerId(){return this.sourceId}canDrag(){Ue(!yy,"You may not call monitor.canDrag() inside your canDrag() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return yy=!0,this.internalMonitor.canDragSource(this.sourceId)}finally{yy=!1}}isDragging(){if(!this.sourceId)return!1;Ue(!vy,"You may not call monitor.isDragging() inside your isDragging() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor");try{return vy=!0,this.internalMonitor.isDraggingSource(this.sourceId)}finally{vy=!1}}subscribeToStateChange(e,n){return this.internalMonitor.subscribeToStateChange(e,n)}isDraggingSource(e){return this.internalMonitor.isDraggingSource(e)}isOverTarget(e,n){return this.internalMonitor.isOverTarget(e,n)}getTargetIds(){return this.internalMonitor.getTargetIds()}isSourcePublic(){return this.internalMonitor.isSourcePublic()}getSourceId(){return this.internalMonitor.getSourceId()}subscribeToOffsetChange(e){return this.internalMonitor.subscribeToOffsetChange(e)}canDragSource(e){return this.internalMonitor.canDragSource(e)}canDropOnTarget(e){return this.internalMonitor.canDropOnTarget(e)}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.sourceId=null,this.internalMonitor=e.getMonitor()}}let xy=!1;class YZ{receiveHandlerId(e){this.targetId=e}getHandlerId(){return this.targetId}subscribeToStateChange(e,n){return this.internalMonitor.subscribeToStateChange(e,n)}canDrop(){if(!this.targetId)return!1;Ue(!xy,"You may not call monitor.canDrop() inside your canDrop() implementation. Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor");try{return xy=!0,this.internalMonitor.canDropOnTarget(this.targetId)}finally{xy=!1}}isOver(e){return this.targetId?this.internalMonitor.isOverTarget(this.targetId,e):!1}getItemType(){return this.internalMonitor.getItemType()}getItem(){return this.internalMonitor.getItem()}getDropResult(){return this.internalMonitor.getDropResult()}didDrop(){return this.internalMonitor.didDrop()}getInitialClientOffset(){return this.internalMonitor.getInitialClientOffset()}getInitialSourceClientOffset(){return this.internalMonitor.getInitialSourceClientOffset()}getSourceClientOffset(){return this.internalMonitor.getSourceClientOffset()}getClientOffset(){return this.internalMonitor.getClientOffset()}getDifferenceFromInitialOffset(){return this.internalMonitor.getDifferenceFromInitialOffset()}constructor(e){this.targetId=null,this.internalMonitor=e.getMonitor()}}function QZ(t,e,n){const r=n.getRegistry(),s=r.addTarget(t,e);return[s,()=>r.removeTarget(s)]}function ZZ(t,e,n){const r=n.getRegistry(),s=r.addSource(t,e);return[s,()=>r.removeSource(s)]}function gv(t,e,n,r){let s=n?n.call(r,t,e):void 0;if(s!==void 0)return!!s;if(t===e)return!0;if(typeof t!="object"||!t||typeof e!="object"||!e)return!1;const o=Object.keys(t),i=Object.keys(e);if(o.length!==i.length)return!1;const a=Object.prototype.hasOwnProperty.bind(e);for(let l=0;l<o.length;l++){const u=o[l];if(!a(u))return!1;const c=t[u],d=e[u];if(s=n?n.call(r,c,d,u):void 0,s===!1||s===void 0&&c!==d)return!1}return!0}function yv(t){return t!==null&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function JZ(t){if(typeof t.type=="string")return;const e=t.type.displayName||t.type.name||"the component";throw new Error(`Only native element nodes can now be passed to React DnD connectors.You can either wrap ${e} into a <div>, or turn it into a drag source or a drop target itself.`)}function eJ(t){return(e=null,n=null)=>{if(!L.isValidElement(e)){const o=e;return t(o,n),o}const r=e;return JZ(r),tJ(r,n?o=>t(o,n):t)}}function UA(t){const e={};return Object.keys(t).forEach(n=>{const r=t[n];if(n.endsWith("Ref"))e[n]=t[n];else{const s=eJ(r);e[n]=()=>s}}),e}function B_(t,e){typeof t=="function"?t(e):t.current=e}function tJ(t,e){const n=t.ref;return Ue(typeof n!="string","Cannot connect React DnD to an element with an existing string ref. Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs"),n?L.cloneElement(t,{ref:r=>{B_(n,r),B_(e,r)}}):L.cloneElement(t,{ref:e})}class nJ{receiveHandlerId(e){this.handlerId!==e&&(this.handlerId=e,this.reconnect())}get connectTarget(){return this.dragSource}get dragSourceOptions(){return this.dragSourceOptionsInternal}set dragSourceOptions(e){this.dragSourceOptionsInternal=e}get dragPreviewOptions(){return this.dragPreviewOptionsInternal}set dragPreviewOptions(e){this.dragPreviewOptionsInternal=e}reconnect(){const e=this.reconnectDragSource();this.reconnectDragPreview(e)}reconnectDragSource(){const e=this.dragSource,n=this.didHandlerIdChange()||this.didConnectedDragSourceChange()||this.didDragSourceOptionsChange();return n&&this.disconnectDragSource(),this.handlerId?e?(n&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragSource=e,this.lastConnectedDragSourceOptions=this.dragSourceOptions,this.dragSourceUnsubscribe=this.backend.connectDragSource(this.handlerId,e,this.dragSourceOptions)),n):(this.lastConnectedDragSource=e,n):n}reconnectDragPreview(e=!1){const n=this.dragPreview,r=e||this.didHandlerIdChange()||this.didConnectedDragPreviewChange()||this.didDragPreviewOptionsChange();if(r&&this.disconnectDragPreview(),!!this.handlerId){if(!n){this.lastConnectedDragPreview=n;return}r&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDragPreview=n,this.lastConnectedDragPreviewOptions=this.dragPreviewOptions,this.dragPreviewUnsubscribe=this.backend.connectDragPreview(this.handlerId,n,this.dragPreviewOptions))}}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didConnectedDragSourceChange(){return this.lastConnectedDragSource!==this.dragSource}didConnectedDragPreviewChange(){return this.lastConnectedDragPreview!==this.dragPreview}didDragSourceOptionsChange(){return!gv(this.lastConnectedDragSourceOptions,this.dragSourceOptions)}didDragPreviewOptionsChange(){return!gv(this.lastConnectedDragPreviewOptions,this.dragPreviewOptions)}disconnectDragSource(){this.dragSourceUnsubscribe&&(this.dragSourceUnsubscribe(),this.dragSourceUnsubscribe=void 0)}disconnectDragPreview(){this.dragPreviewUnsubscribe&&(this.dragPreviewUnsubscribe(),this.dragPreviewUnsubscribe=void 0,this.dragPreviewNode=null,this.dragPreviewRef=null)}get dragSource(){return this.dragSourceNode||this.dragSourceRef&&this.dragSourceRef.current}get dragPreview(){return this.dragPreviewNode||this.dragPreviewRef&&this.dragPreviewRef.current}clearDragSource(){this.dragSourceNode=null,this.dragSourceRef=null}clearDragPreview(){this.dragPreviewNode=null,this.dragPreviewRef=null}constructor(e){this.hooks=UA({dragSource:(n,r)=>{this.clearDragSource(),this.dragSourceOptions=r||null,yv(n)?this.dragSourceRef=n:this.dragSourceNode=n,this.reconnectDragSource()},dragPreview:(n,r)=>{this.clearDragPreview(),this.dragPreviewOptions=r||null,yv(n)?this.dragPreviewRef=n:this.dragPreviewNode=n,this.reconnectDragPreview()}}),this.handlerId=null,this.dragSourceRef=null,this.dragSourceOptionsInternal=null,this.dragPreviewRef=null,this.dragPreviewOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDragSource=null,this.lastConnectedDragSourceOptions=null,this.lastConnectedDragPreview=null,this.lastConnectedDragPreviewOptions=null,this.backend=e}}class rJ{get connectTarget(){return this.dropTarget}reconnect(){const e=this.didHandlerIdChange()||this.didDropTargetChange()||this.didOptionsChange();e&&this.disconnectDropTarget();const n=this.dropTarget;if(this.handlerId){if(!n){this.lastConnectedDropTarget=n;return}e&&(this.lastConnectedHandlerId=this.handlerId,this.lastConnectedDropTarget=n,this.lastConnectedDropTargetOptions=this.dropTargetOptions,this.unsubscribeDropTarget=this.backend.connectDropTarget(this.handlerId,n,this.dropTargetOptions))}}receiveHandlerId(e){e!==this.handlerId&&(this.handlerId=e,this.reconnect())}get dropTargetOptions(){return this.dropTargetOptionsInternal}set dropTargetOptions(e){this.dropTargetOptionsInternal=e}didHandlerIdChange(){return this.lastConnectedHandlerId!==this.handlerId}didDropTargetChange(){return this.lastConnectedDropTarget!==this.dropTarget}didOptionsChange(){return!gv(this.lastConnectedDropTargetOptions,this.dropTargetOptions)}disconnectDropTarget(){this.unsubscribeDropTarget&&(this.unsubscribeDropTarget(),this.unsubscribeDropTarget=void 0)}get dropTarget(){return this.dropTargetNode||this.dropTargetRef&&this.dropTargetRef.current}clearDropTarget(){this.dropTargetRef=null,this.dropTargetNode=null}constructor(e){this.hooks=UA({dropTarget:(n,r)=>{this.clearDropTarget(),this.dropTargetOptions=r,yv(n)?this.dropTargetRef=n:this.dropTargetNode=n,this.reconnect()}}),this.handlerId=null,this.dropTargetRef=null,this.dropTargetOptionsInternal=null,this.lastConnectedHandlerId=null,this.lastConnectedDropTarget=null,this.lastConnectedDropTargetOptions=null,this.backend=e}}function gl(){const{dragDropManager:t}=L.useContext(IA);return Ue(t!=null,"Expected drag drop context"),t}function sJ(t,e){const n=gl(),r=L.useMemo(()=>new nJ(n.getBackend()),[n]);return nl(()=>(r.dragSourceOptions=t||null,r.reconnect(),()=>r.disconnectDragSource()),[r,t]),nl(()=>(r.dragPreviewOptions=e||null,r.reconnect(),()=>r.disconnectDragPreview()),[r,e]),r}function oJ(){const t=gl();return L.useMemo(()=>new XZ(t),[t])}class iJ{beginDrag(){const e=this.spec,n=this.monitor;let r=null;return typeof e.item=="object"?r=e.item:typeof e.item=="function"?r=e.item(n):r={},r??null}canDrag(){const e=this.spec,n=this.monitor;return typeof e.canDrag=="boolean"?e.canDrag:typeof e.canDrag=="function"?e.canDrag(n):!0}isDragging(e,n){const r=this.spec,s=this.monitor,{isDragging:o}=r;return o?o(s):n===e.getSourceId()}endDrag(){const e=this.spec,n=this.monitor,r=this.connector,{end:s}=e;s&&s(n.getItem(),n),r.reconnect()}constructor(e,n,r){this.spec=e,this.monitor=n,this.connector=r}}function aJ(t,e,n){const r=L.useMemo(()=>new iJ(t,e,n),[e,n]);return L.useEffect(()=>{r.spec=t},[t]),r}function lJ(t){return L.useMemo(()=>{const e=t.type;return Ue(e!=null,"spec.type must be defined"),e},[t])}function uJ(t,e,n){const r=gl(),s=aJ(t,e,n),o=lJ(t);nl(function(){if(o!=null){const[a,l]=ZZ(o,s,r);return e.receiveHandlerId(a),n.receiveHandlerId(a),l}},[r,e,n,s,o])}function cJ(t,e){const n=BA(t,e);Ue(!n.begin,"useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)");const r=oJ(),s=sJ(n.options,n.previewOptions);return uJ(n,r,s),[jA(n.collect,r,s),qZ(s),KZ(s)]}function dJ(t){const n=gl().getMonitor(),[r,s]=MA(n,t);return L.useEffect(()=>n.subscribeToOffsetChange(s)),L.useEffect(()=>n.subscribeToStateChange(s)),r}function fJ(t){return L.useMemo(()=>t.hooks.dropTarget(),[t])}function hJ(t){const e=gl(),n=L.useMemo(()=>new rJ(e.getBackend()),[e]);return nl(()=>(n.dropTargetOptions=t||null,n.reconnect(),()=>n.disconnectDropTarget()),[t]),n}function pJ(){const t=gl();return L.useMemo(()=>new YZ(t),[t])}function mJ(t){const{accept:e}=t;return L.useMemo(()=>(Ue(t.accept!=null,"accept must be defined"),Array.isArray(e)?e:[e]),[e])}class gJ{canDrop(){const e=this.spec,n=this.monitor;return e.canDrop?e.canDrop(n.getItem(),n):!0}hover(){const e=this.spec,n=this.monitor;e.hover&&e.hover(n.getItem(),n)}drop(){const e=this.spec,n=this.monitor;if(e.drop)return e.drop(n.getItem(),n)}constructor(e,n){this.spec=e,this.monitor=n}}function yJ(t,e){const n=L.useMemo(()=>new gJ(t,e),[e]);return L.useEffect(()=>{n.spec=t},[t]),n}function vJ(t,e,n){const r=gl(),s=yJ(t,e),o=mJ(t);nl(function(){const[a,l]=QZ(o,s,r);return e.receiveHandlerId(a),n.receiveHandlerId(a),l},[r,e,s,n,o.map(i=>i.toString()).join("|")])}function xJ(t,e){const n=BA(t,e),r=pJ(),s=hJ(n.options);return vJ(n,r,s),[jA(n.collect,r,s),fJ(s)]}function zA(t){let e=null;return()=>(e==null&&(e=t()),e)}function bJ(t,e){return t.filter(n=>n!==e)}function wJ(t,e){const n=new Set,r=o=>n.add(o);t.forEach(r),e.forEach(r);const s=[];return n.forEach(o=>s.push(o)),s}class SJ{enter(e){const n=this.entered.length,r=s=>this.isNodeInDocument(s)&&(!s.contains||s.contains(e));return this.entered=wJ(this.entered.filter(r),[e]),n===0&&this.entered.length>0}leave(e){const n=this.entered.length;return this.entered=bJ(this.entered.filter(this.isNodeInDocument),e),n>0&&this.entered.length===0}reset(){this.entered=[]}constructor(e){this.entered=[],this.isNodeInDocument=e}}class CJ{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(e=>{Object.defineProperty(this.item,e,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${e}" until the drop event.`),null}})})}loadDataTransfer(e){if(e){const n={};Object.keys(this.config.exposeProperties).forEach(r=>{const s=this.config.exposeProperties[r];s!=null&&(n[r]={value:s(e,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,n)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(e,n){return n===e.getSourceId()}endDrag(){}constructor(e){this.config=e,this.item={},this.initializeExposedProperties()}}const WA="__NATIVE_FILE__",VA="__NATIVE_URL__",GA="__NATIVE_TEXT__",HA="__NATIVE_HTML__";var U_=Object.freeze({__proto__:null,FILE:WA,HTML:HA,TEXT:GA,URL:VA});function by(t,e,n){const r=e.reduce((s,o)=>s||t.getData(o),"");return r??n}const vv={[WA]:{exposeProperties:{files:t=>Array.prototype.slice.call(t.files),items:t=>t.items,dataTransfer:t=>t},matchesTypes:["Files"]},[HA]:{exposeProperties:{html:(t,e)=>by(t,e,""),dataTransfer:t=>t},matchesTypes:["Html","text/html"]},[VA]:{exposeProperties:{urls:(t,e)=>by(t,e,"").split(`
`),dataTransfer:t=>t},matchesTypes:["Url","text/uri-list"]},[GA]:{exposeProperties:{text:(t,e)=>by(t,e,""),dataTransfer:t=>t},matchesTypes:["Text","text/plain"]}};function _J(t,e){const n=vv[t];if(!n)throw new Error(`native type ${t} has no configuration`);const r=new CJ(n);return r.loadDataTransfer(e),r}function wy(t){if(!t)return null;const e=Array.prototype.slice.call(t.types||[]);return Object.keys(vv).filter(n=>{const r=vv[n];return r!=null&&r.matchesTypes?r.matchesTypes.some(s=>e.indexOf(s)>-1):!1})[0]||null}const EJ=zA(()=>/firefox/i.test(navigator.userAgent)),qA=zA(()=>!!window.safari);class z_{interpolate(e){const{xs:n,ys:r,c1s:s,c2s:o,c3s:i}=this;let a=n.length-1;if(e===n[a])return r[a];let l=0,u=i.length-1,c;for(;l<=u;){c=Math.floor(.5*(l+u));const h=n[c];if(h<e)l=c+1;else if(h>e)u=c-1;else return r[c]}a=Math.max(0,u);const d=e-n[a],f=d*d;return r[a]+s[a]*d+o[a]*f+i[a]*d*f}constructor(e,n){const{length:r}=e,s=[];for(let h=0;h<r;h++)s.push(h);s.sort((h,p)=>e[h]<e[p]?-1:1);const o=[],i=[];let a,l;for(let h=0;h<r-1;h++)a=e[h+1]-e[h],l=n[h+1]-n[h],o.push(a),i.push(l/a);const u=[i[0]];for(let h=0;h<o.length-1;h++){const p=i[h],m=i[h+1];if(p*m<=0)u.push(0);else{a=o[h];const v=o[h+1],g=a+v;u.push(3*g/((g+v)/p+(g+a)/m))}}u.push(i[i.length-1]);const c=[],d=[];let f;for(let h=0;h<u.length-1;h++){f=i[h];const p=u[h],m=1/o[h],v=p+u[h+1]-f-f;c.push((f-p-v)*m),d.push(v*m*m)}this.xs=e,this.ys=n,this.c1s=u,this.c2s=c,this.c3s=d}}const TJ=1;function KA(t){const e=t.nodeType===TJ?t:t.parentElement;if(!e)return null;const{top:n,left:r}=e.getBoundingClientRect();return{x:r,y:n}}function Gf(t){return{x:t.clientX,y:t.clientY}}function NJ(t){var e;return t.nodeName==="IMG"&&(EJ()||!(!((e=document.documentElement)===null||e===void 0)&&e.contains(t)))}function $J(t,e,n,r){let s=t?e.width:n,o=t?e.height:r;return qA()&&t&&(o/=window.devicePixelRatio,s/=window.devicePixelRatio),{dragPreviewWidth:s,dragPreviewHeight:o}}function kJ(t,e,n,r,s){const o=NJ(e),a=KA(o?t:e),l={x:n.x-a.x,y:n.y-a.y},{offsetWidth:u,offsetHeight:c}=t,{anchorX:d,anchorY:f}=r,{dragPreviewWidth:h,dragPreviewHeight:p}=$J(o,e,u,c),m=()=>{let E=new z_([0,.5,1],[l.y,l.y/c*p,l.y+p-c]).interpolate(f);return qA()&&o&&(E+=(window.devicePixelRatio-1)*p),E},v=()=>new z_([0,.5,1],[l.x,l.x/u*h,l.x+h-u]).interpolate(d),{offsetX:g,offsetY:x}=s,b=g===0||g,_=x===0||x;return{x:b?g:v(),y:_?x:m()}}let IJ=class{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var e;return!((e=this.globalContext)===null||e===void 0)&&e.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var e;return((e=this.optionsArgs)===null||e===void 0?void 0:e.rootElement)||this.window}constructor(e,n){this.ownerDocument=null,this.globalContext=e,this.optionsArgs=n}};function OJ(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{},r=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),r.forEach(function(s){OJ(t,s,n[s])})}return t}class RJ{profile(){var e,n;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((e=this.dragStartSourceIds)===null||e===void 0?void 0:e.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((n=this.dragOverTargetIds)===null||n===void 0?void 0:n.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const e=this.rootElement;if(e!==void 0){if(e.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");e.__isReactDndBackendSetUp=!0,this.addEventListeners(e)}}teardown(){const e=this.rootElement;if(e!==void 0&&(e.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var n;(n=this.window)===null||n===void 0||n.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(e,n,r){return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,n),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDragSource(e,n,r){this.sourceNodes.set(e,n),this.sourceNodeOptions.set(e,r);const s=i=>this.handleDragStart(i,e),o=i=>this.handleSelectStart(i);return n.setAttribute("draggable","true"),n.addEventListener("dragstart",s),n.addEventListener("selectstart",o),()=>{this.sourceNodes.delete(e),this.sourceNodeOptions.delete(e),n.removeEventListener("dragstart",s),n.removeEventListener("selectstart",o),n.setAttribute("draggable","false")}}connectDropTarget(e,n){const r=i=>this.handleDragEnter(i,e),s=i=>this.handleDragOver(i,e),o=i=>this.handleDrop(i,e);return n.addEventListener("dragenter",r),n.addEventListener("dragover",s),n.addEventListener("drop",o),()=>{n.removeEventListener("dragenter",r),n.removeEventListener("dragover",s),n.removeEventListener("drop",o)}}addEventListeners(e){e.addEventListener&&(e.addEventListener("dragstart",this.handleTopDragStart),e.addEventListener("dragstart",this.handleTopDragStartCapture,!0),e.addEventListener("dragend",this.handleTopDragEndCapture,!0),e.addEventListener("dragenter",this.handleTopDragEnter),e.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.addEventListener("dragover",this.handleTopDragOver),e.addEventListener("dragover",this.handleTopDragOverCapture,!0),e.addEventListener("drop",this.handleTopDrop),e.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(e){e.removeEventListener&&(e.removeEventListener("dragstart",this.handleTopDragStart),e.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),e.removeEventListener("dragend",this.handleTopDragEndCapture,!0),e.removeEventListener("dragenter",this.handleTopDragEnter),e.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),e.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),e.removeEventListener("dragover",this.handleTopDragOver),e.removeEventListener("dragover",this.handleTopDragOverCapture,!0),e.removeEventListener("drop",this.handleTopDrop),e.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const e=this.monitor.getSourceId(),n=this.sourceNodeOptions.get(e);return W_({dropEffect:this.altKeyPressed?"copy":"move"},n||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const e=this.monitor.getSourceId(),n=this.sourcePreviewNodeOptions.get(e);return W_({anchorX:.5,anchorY:.5,captureDraggingState:!1},n||{})}isDraggingNativeItem(){const e=this.monitor.getItemType();return Object.keys(U_).some(n=>U_[n]===e)}beginDragNativeItem(e,n){this.clearCurrentDragSourceNode(),this.currentNativeSource=_J(e,n),this.currentNativeHandle=this.registry.addSource(e,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(e){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=e;const n=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var r;return(r=this.rootElement)===null||r===void 0?void 0:r.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},n)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var e;(e=this.window)===null||e===void 0||e.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(e,n){e.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(n))}handleDragEnter(e,n){this.dragEnterTargetIds.unshift(n)}handleDragOver(e,n){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(n)}handleDrop(e,n){this.dropTargetIds.unshift(n)}constructor(e,n,r){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=s=>{const o=this.sourceNodes.get(s);return o&&KA(o)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=s=>!!(s&&this.document&&this.document.body&&this.document.body.contains(s)),this.endDragIfSourceWasRemovedFromDOM=()=>{const s=this.currentDragSourceNode;s==null||this.isNodeInDocument(s)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=s=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(s||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=s=>{if(s.defaultPrevented)return;const{dragStartSourceIds:o}=this;this.dragStartSourceIds=null;const i=Gf(s);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(o||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:i});const{dataTransfer:a}=s,l=wy(a);if(this.monitor.isDragging()){if(a&&typeof a.setDragImage=="function"){const c=this.monitor.getSourceId(),d=this.sourceNodes.get(c),f=this.sourcePreviewNodes.get(c)||d;if(f){const{anchorX:h,anchorY:p,offsetX:m,offsetY:v}=this.getCurrentSourcePreviewNodeOptions(),b=kJ(d,f,i,{anchorX:h,anchorY:p},{offsetX:m,offsetY:v});a.setDragImage(f,b.x,b.y)}}try{a==null||a.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(s.target);const{captureDraggingState:u}=this.getCurrentSourcePreviewNodeOptions();u?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(l)this.beginDragNativeItem(l);else{if(a&&!a.types&&(s.target&&!s.target.hasAttribute||!s.target.hasAttribute("draggable")))return;s.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=s=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var o;(o=this.currentNativeSource)===null||o===void 0||o.loadDataTransfer(s.dataTransfer)}if(!this.enterLeaveCounter.enter(s.target)||this.monitor.isDragging())return;const{dataTransfer:a}=s,l=wy(a);l&&this.beginDragNativeItem(l,a)},this.handleTopDragEnter=s=>{const{dragEnterTargetIds:o}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=s.altKey,o.length>0&&this.actions.hover(o,{clientOffset:Gf(s)}),o.some(a=>this.monitor.canDropOnTarget(a))&&(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=s=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var o;(o=this.currentNativeSource)===null||o===void 0||o.loadDataTransfer(s.dataTransfer)}},this.handleTopDragOver=s=>{const{dragOverTargetIds:o}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="none");return}this.altKeyPressed=s.altKey,this.lastClientOffset=Gf(s),this.scheduleHover(o),(o||[]).some(a=>this.monitor.canDropOnTarget(a))?(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?s.preventDefault():(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=s=>{this.isDraggingNativeItem()&&s.preventDefault(),this.enterLeaveCounter.leave(s.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=s=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var o;s.preventDefault(),(o=this.currentNativeSource)===null||o===void 0||o.loadDataTransfer(s.dataTransfer)}else wy(s.dataTransfer)&&s.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=s=>{const{dropTargetIds:o}=this;this.dropTargetIds=[],this.actions.hover(o,{clientOffset:Gf(s)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=s=>{const o=s.target;typeof o.dragDrop=="function"&&(o.tagName==="INPUT"||o.tagName==="SELECT"||o.tagName==="TEXTAREA"||o.isContentEditable||(s.preventDefault(),o.dragDrop()))},this.options=new IJ(n,r),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.registry=e.getRegistry(),this.enterLeaveCounter=new SJ(this.isNodeInDocument)}}let Hf;function DJ(){return Hf||(Hf=new Image,Hf.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),Hf}const AJ=function(e,n,r){return new RJ(e,n,r)};var Hi;(function(t){t.mouse="mouse",t.touch="touch",t.keyboard="keyboard"})(Hi||(Hi={}));class PJ{get delay(){var e;return(e=this.args.delay)!==null&&e!==void 0?e:0}get scrollAngleRanges(){return this.args.scrollAngleRanges}get getDropTargetElementsAtPoint(){return this.args.getDropTargetElementsAtPoint}get ignoreContextMenu(){var e;return(e=this.args.ignoreContextMenu)!==null&&e!==void 0?e:!1}get enableHoverOutsideTarget(){var e;return(e=this.args.enableHoverOutsideTarget)!==null&&e!==void 0?e:!1}get enableKeyboardEvents(){var e;return(e=this.args.enableKeyboardEvents)!==null&&e!==void 0?e:!1}get enableMouseEvents(){var e;return(e=this.args.enableMouseEvents)!==null&&e!==void 0?e:!1}get enableTouchEvents(){var e;return(e=this.args.enableTouchEvents)!==null&&e!==void 0?e:!0}get touchSlop(){return this.args.touchSlop||0}get delayTouchStart(){var e,n,r,s;return(s=(r=(e=this.args)===null||e===void 0?void 0:e.delayTouchStart)!==null&&r!==void 0?r:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&s!==void 0?s:0}get delayMouseStart(){var e,n,r,s;return(s=(r=(e=this.args)===null||e===void 0?void 0:e.delayMouseStart)!==null&&r!==void 0?r:(n=this.args)===null||n===void 0?void 0:n.delay)!==null&&s!==void 0?s:0}get window(){if(this.context&&this.context.window)return this.context.window;if(typeof window<"u")return window}get document(){var e;if(!((e=this.context)===null||e===void 0)&&e.document)return this.context.document;if(this.window)return this.window.document}get rootElement(){var e;return((e=this.args)===null||e===void 0?void 0:e.rootElement)||this.document}constructor(e,n){this.args=e,this.context=n}}function LJ(t,e,n,r){return Math.sqrt(Math.pow(Math.abs(n-t),2)+Math.pow(Math.abs(r-e),2))}function FJ(t,e,n,r,s){if(!s)return!1;const o=Math.atan2(r-e,n-t)*180/Math.PI+180;for(let i=0;i<s.length;++i){const a=s[i];if(a&&(a.start==null||o>=a.start)&&(a.end==null||o<=a.end))return!0}return!1}const MJ={Left:1,Right:2,Center:4},jJ={Left:0,Center:1,Right:2};function Sy(t){return t.button===void 0||t.button===jJ.Left}function BJ(t){return t.buttons===void 0||(t.buttons&MJ.Left)===0}function XA(t){return!!t.targetTouches}const UJ=1;function zJ(t){const e=t.nodeType===UJ?t:t.parentElement;if(!e)return;const{top:n,left:r}=e.getBoundingClientRect();return{x:r,y:n}}function WJ(t,e){if(t.targetTouches.length===1)return _p(t.targetTouches[0]);if(e&&t.touches.length===1&&t.touches[0].target===e.target)return _p(t.touches[0])}function _p(t,e){return XA(t)?WJ(t,e):{x:t.clientX,y:t.clientY}}const V_=(()=>{let t=!1;try{addEventListener("test",()=>{},Object.defineProperty({},"passive",{get(){return t=!0,!0}}))}catch{}return t})(),Cc={[Hi.mouse]:{start:"mousedown",move:"mousemove",end:"mouseup",contextmenu:"contextmenu"},[Hi.touch]:{start:"touchstart",move:"touchmove",end:"touchend"},[Hi.keyboard]:{keydown:"keydown"}};class Zc{profile(){var e;return{sourceNodes:this.sourceNodes.size,sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,targetNodes:this.targetNodes.size,dragOverTargetIds:((e=this.dragOverTargetIds)===null||e===void 0?void 0:e.length)||0}}get document(){return this.options.document}setup(){const e=this.options.rootElement;e&&(Ue(!Zc.isSetUp,"Cannot have two Touch backends at the same time."),Zc.isSetUp=!0,this.addEventListener(e,"start",this.getTopMoveStartHandler()),this.addEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.addEventListener(e,"move",this.handleTopMove),this.addEventListener(e,"move",this.handleTopMoveCapture,!0),this.addEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.addEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.addEventListener(e,"keydown",this.handleCancelOnEscape,!0))}teardown(){const e=this.options.rootElement;e&&(Zc.isSetUp=!1,this._mouseClientOffset={},this.removeEventListener(e,"start",this.handleTopMoveStartCapture,!0),this.removeEventListener(e,"start",this.handleTopMoveStart),this.removeEventListener(e,"move",this.handleTopMoveCapture,!0),this.removeEventListener(e,"move",this.handleTopMove),this.removeEventListener(e,"end",this.handleTopMoveEndCapture,!0),this.options.enableMouseEvents&&!this.options.ignoreContextMenu&&this.removeEventListener(e,"contextmenu",this.handleTopMoveEndCapture),this.options.enableKeyboardEvents&&this.removeEventListener(e,"keydown",this.handleCancelOnEscape,!0),this.uninstallSourceNodeRemovalObserver())}addEventListener(e,n,r,s=!1){const o=V_?{capture:s,passive:!1}:s;this.listenerTypes.forEach(function(i){const a=Cc[i][n];a&&e.addEventListener(a,r,o)})}removeEventListener(e,n,r,s=!1){const o=V_?{capture:s,passive:!1}:s;this.listenerTypes.forEach(function(i){const a=Cc[i][n];a&&e.removeEventListener(a,r,o)})}connectDragSource(e,n){const r=this.handleMoveStart.bind(this,e);return this.sourceNodes.set(e,n),this.addEventListener(n,"start",r),()=>{this.sourceNodes.delete(e),this.removeEventListener(n,"start",r)}}connectDragPreview(e,n,r){return this.sourcePreviewNodeOptions.set(e,r),this.sourcePreviewNodes.set(e,n),()=>{this.sourcePreviewNodes.delete(e),this.sourcePreviewNodeOptions.delete(e)}}connectDropTarget(e,n){const r=this.options.rootElement;if(!this.document||!r)return()=>{};const s=o=>{if(!this.document||!r||!this.monitor.isDragging())return;let i;switch(o.type){case Cc.mouse.move:i={x:o.clientX,y:o.clientY};break;case Cc.touch.move:var a,l;i={x:((a=o.touches[0])===null||a===void 0?void 0:a.clientX)||0,y:((l=o.touches[0])===null||l===void 0?void 0:l.clientY)||0};break}const u=i!=null?this.document.elementFromPoint(i.x,i.y):void 0,c=u&&n.contains(u);if(u===n||c)return this.handleMove(o,e)};return this.addEventListener(this.document.body,"move",s),this.targetNodes.set(e,n),()=>{this.document&&(this.targetNodes.delete(e),this.removeEventListener(this.document.body,"move",s))}}getTopMoveStartHandler(){return!this.options.delayTouchStart&&!this.options.delayMouseStart?this.handleTopMoveStart:this.handleTopMoveStartDelay}installSourceNodeRemovalObserver(e){this.uninstallSourceNodeRemovalObserver(),this.draggedSourceNode=e,this.draggedSourceNodeRemovalObserver=new MutationObserver(()=>{e&&!e.parentElement&&(this.resurrectSourceNode(),this.uninstallSourceNodeRemovalObserver())}),!(!e||!e.parentElement)&&this.draggedSourceNodeRemovalObserver.observe(e.parentElement,{childList:!0})}resurrectSourceNode(){this.document&&this.draggedSourceNode&&(this.draggedSourceNode.style.display="none",this.draggedSourceNode.removeAttribute("data-reactid"),this.document.body.appendChild(this.draggedSourceNode))}uninstallSourceNodeRemovalObserver(){this.draggedSourceNodeRemovalObserver&&this.draggedSourceNodeRemovalObserver.disconnect(),this.draggedSourceNodeRemovalObserver=void 0,this.draggedSourceNode=void 0}constructor(e,n,r){this.getSourceClientOffset=s=>{const o=this.sourceNodes.get(s);return o&&zJ(o)},this.handleTopMoveStartCapture=s=>{Sy(s)&&(this.moveStartSourceIds=[])},this.handleMoveStart=s=>{Array.isArray(this.moveStartSourceIds)&&this.moveStartSourceIds.unshift(s)},this.handleTopMoveStart=s=>{if(!Sy(s))return;const o=_p(s);o&&(XA(s)&&(this.lastTargetTouchFallback=s.targetTouches[0]),this._mouseClientOffset=o),this.waitingForDelay=!1},this.handleTopMoveStartDelay=s=>{if(!Sy(s))return;const o=s.type===Cc.touch.start?this.options.delayTouchStart:this.options.delayMouseStart;this.timeout=setTimeout(this.handleTopMoveStart.bind(this,s),o),this.waitingForDelay=!0},this.handleTopMoveCapture=()=>{this.dragOverTargetIds=[]},this.handleMove=(s,o)=>{this.dragOverTargetIds&&this.dragOverTargetIds.unshift(o)},this.handleTopMove=s=>{if(this.timeout&&clearTimeout(this.timeout),!this.document||this.waitingForDelay)return;const{moveStartSourceIds:o,dragOverTargetIds:i}=this,a=this.options.enableHoverOutsideTarget,l=_p(s,this.lastTargetTouchFallback);if(!l)return;if(this._isScrolling||!this.monitor.isDragging()&&FJ(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y,this.options.scrollAngleRanges)){this._isScrolling=!0;return}if(!this.monitor.isDragging()&&this._mouseClientOffset.hasOwnProperty("x")&&o&&LJ(this._mouseClientOffset.x||0,this._mouseClientOffset.y||0,l.x,l.y)>(this.options.touchSlop?this.options.touchSlop:0)&&(this.moveStartSourceIds=void 0,this.actions.beginDrag(o,{clientOffset:this._mouseClientOffset,getSourceClientOffset:this.getSourceClientOffset,publishSource:!1})),!this.monitor.isDragging())return;const u=this.sourceNodes.get(this.monitor.getSourceId());this.installSourceNodeRemovalObserver(u),this.actions.publishDragSource(),s.cancelable&&s.preventDefault();const c=(i||[]).map(p=>this.targetNodes.get(p)).filter(p=>!!p),d=this.options.getDropTargetElementsAtPoint?this.options.getDropTargetElementsAtPoint(l.x,l.y,c):this.document.elementsFromPoint(l.x,l.y),f=[];for(const p in d){if(!d.hasOwnProperty(p))continue;let m=d[p];for(m!=null&&f.push(m);m;)m=m.parentElement,m&&f.indexOf(m)===-1&&f.push(m)}const h=f.filter(p=>c.indexOf(p)>-1).map(p=>this._getDropTargetId(p)).filter(p=>!!p).filter((p,m,v)=>v.indexOf(p)===m);if(a)for(const p in this.targetNodes){const m=this.targetNodes.get(p);if(u&&m&&m.contains(u)&&h.indexOf(p)===-1){h.unshift(p);break}}h.reverse(),this.actions.hover(h,{clientOffset:l})},this._getDropTargetId=s=>{const o=this.targetNodes.keys();let i=o.next();for(;i.done===!1;){const a=i.value;if(s===this.targetNodes.get(a))return a;i=o.next()}},this.handleTopMoveEndCapture=s=>{if(this._isScrolling=!1,this.lastTargetTouchFallback=void 0,!!BJ(s)){if(!this.monitor.isDragging()||this.monitor.didDrop()){this.moveStartSourceIds=void 0;return}s.cancelable&&s.preventDefault(),this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.drop(),this.actions.endDrag()}},this.handleCancelOnEscape=s=>{s.key==="Escape"&&this.monitor.isDragging()&&(this._mouseClientOffset={},this.uninstallSourceNodeRemovalObserver(),this.actions.endDrag())},this.options=new PJ(r,n),this.actions=e.getActions(),this.monitor=e.getMonitor(),this.sourceNodes=new Map,this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.targetNodes=new Map,this.listenerTypes=[],this._mouseClientOffset={},this._isScrolling=!1,this.options.enableMouseEvents&&this.listenerTypes.push(Hi.mouse),this.options.enableTouchEvents&&this.listenerTypes.push(Hi.touch),this.options.enableKeyboardEvents&&this.listenerTypes.push(Hi.keyboard)}}const VJ=function(e,n={},r={}){return new Zc(e,n,r)},Id="abcdefgh".split(""),Sh={a8:"bR",b8:"bN",c8:"bB",d8:"bQ",e8:"bK",f8:"bB",g8:"bN",h8:"bR",a7:"bP",b7:"bP",c7:"bP",d7:"bP",e7:"bP",f7:"bP",g7:"bP",h7:"bP",a2:"wP",b2:"wP",c2:"wP",d2:"wP",e2:"wP",f2:"wP",g2:"wP",h2:"wP",a1:"wR",b1:"wN",c1:"wB",d1:"wQ",e1:"wK",f1:"wB",g1:"wN",h1:"wR"},GJ={a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},HJ={a:7,b:6,c:5,d:4,e:3,f:2,g:1,h:0},qJ=[7,6,5,4,3,2,1,0],KJ=[0,1,2,3,4,5,6,7],G_={wP:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),wR:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsxs("g",Object.assign({style:{opacity:"1",fill:"#ffffff",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[w.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),w.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),w.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14",style:{strokeLinecap:"butt"}}),w.jsx("path",{d:"M 34,14 L 31,17 L 14,17 L 11,14"}),w.jsx("path",{d:"M 31,17 L 31,29.5 L 14,29.5 L 14,17",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),w.jsx("path",{d:"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5"}),w.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wN:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[w.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#ffffff",stroke:"#000000"}}),w.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#ffffff",stroke:"#000000"}}),w.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#000000",stroke:"#000000"}}),w.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#000000",stroke:"#000000"}})]}))})),wB:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[w.jsxs("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt"}},{children:[w.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),w.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),w.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),w.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}})]}))})),wQ:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsxs("g",Object.assign({style:{fill:"#ffffff",stroke:"#000000",strokeWidth:"1.5",strokeLinejoin:"round"}},{children:[w.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z"}),w.jsx("path",{d:"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z"}),w.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30",style:{fill:"none"}}),w.jsx("path",{d:"M 12,33.5 C 18,32.5 27,32.5 33,33.5",style:{fill:"none"}}),w.jsx("circle",{cx:"6",cy:"12",r:"2"}),w.jsx("circle",{cx:"14",cy:"9",r:"2"}),w.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),w.jsx("circle",{cx:"31",cy:"9",r:"2"}),w.jsx("circle",{cx:"39",cy:"12",r:"2"})]}))})),wK:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsxs("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[w.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),w.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),w.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#ffffff",stroke:"#000000",strokeLinecap:"butt",strokeLinejoin:"miter"}}),w.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#ffffff",stroke:"#000000"}}),w.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30",style:{fill:"none",stroke:"#000000"}}),w.jsx("path",{d:"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5",style:{fill:"none",stroke:"#000000"}}),w.jsx("path",{d:"M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#000000"}})]}))})),bP:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsx("path",{d:"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z",style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"nonzero",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"miter",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}})})),bR:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsxs("g",Object.assign({style:{opacity:"1",fill:"#000000",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[w.jsx("path",{d:"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z ",style:{strokeLinecap:"butt"}}),w.jsx("path",{d:"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z ",style:{strokeLinecap:"butt"}}),w.jsx("path",{d:"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z ",style:{strokeLinecap:"butt"}}),w.jsx("path",{d:"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z ",style:{strokeLinecap:"butt",strokeLinejoin:"miter"}}),w.jsx("path",{d:"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z ",style:{strokeLinecap:"butt"}}),w.jsx("path",{d:"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z ",style:{strokeLinecap:"butt"}}),w.jsx("path",{d:"M 12,35.5 L 33,35.5 L 33,35.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),w.jsx("path",{d:"M 13,31.5 L 32,31.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),w.jsx("path",{d:"M 14,29.5 L 31,29.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),w.jsx("path",{d:"M 14,16.5 L 31,16.5",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}}),w.jsx("path",{d:"M 11,14 L 34,14",style:{fill:"none",stroke:"#ffffff",strokeWidth:"1",strokeLinejoin:"miter"}})]}))})),bN:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[w.jsx("path",{d:"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18",style:{fill:"#000000",stroke:"#000000"}}),w.jsx("path",{d:"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10",style:{fill:"#000000",stroke:"#000000"}}),w.jsx("path",{d:"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z",style:{fill:"#ffffff",stroke:"#ffffff"}}),w.jsx("path",{d:"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z",transform:"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)",style:{fill:"#ffffff",stroke:"#ffffff"}}),w.jsx("path",{d:"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z ",style:{fill:"#ffffff",stroke:"none"}})]}))})),bB:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsxs("g",Object.assign({style:{opacity:"1",fill:"none",fillRule:"evenodd",fillOpacity:"1",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[w.jsxs("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeLinecap:"butt"}},{children:[w.jsx("path",{d:"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z"}),w.jsx("path",{d:"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z"}),w.jsx("path",{d:"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z"})]})),w.jsx("path",{d:"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18",style:{fill:"none",stroke:"#ffffff",strokeLinejoin:"miter"}})]}))})),bQ:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsxs("g",Object.assign({style:{fill:"#000000",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}},{children:[w.jsx("path",{d:"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z",style:{strokeLinecap:"butt",fill:"#000000"}}),w.jsx("path",{d:"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z"}),w.jsx("path",{d:"M 11.5,30 C 15,29 30,29 33.5,30"}),w.jsx("path",{d:"m 12,33.5 c 6,-1 15,-1 21,0"}),w.jsx("circle",{cx:"6",cy:"12",r:"2"}),w.jsx("circle",{cx:"14",cy:"9",r:"2"}),w.jsx("circle",{cx:"22.5",cy:"8",r:"2"}),w.jsx("circle",{cx:"31",cy:"9",r:"2"}),w.jsx("circle",{cx:"39",cy:"12",r:"2"}),w.jsx("path",{d:"M 11,38.5 A 35,35 1 0 0 34,38.5",style:{fill:"none",stroke:"#000000",strokeLinecap:"butt"}}),w.jsxs("g",Object.assign({style:{fill:"none",stroke:"#ffffff"}},{children:[w.jsx("path",{d:"M 11,29 A 35,35 1 0 1 34,29"}),w.jsx("path",{d:"M 12.5,31.5 L 32.5,31.5"}),w.jsx("path",{d:"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5"}),w.jsx("path",{d:"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5"})]}))]}))})),bK:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",width:"45",height:"45"},{children:w.jsxs("g",Object.assign({style:{fill:"none",fillOpacity:"1",fillRule:"evenodd",stroke:"#000000",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"4",strokeDasharray:"none",strokeOpacity:"1"}},{children:[w.jsx("path",{d:"M 22.5,11.63 L 22.5,6",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"},id:"path6570"}),w.jsx("path",{d:"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25",style:{fill:"#000000",fillOpacity:"1",strokeLinecap:"butt",strokeLinejoin:"miter"}}),w.jsx("path",{d:"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37",style:{fill:"#000000",stroke:"#000000"}}),w.jsx("path",{d:"M 20,8 L 25,8",style:{fill:"none",stroke:"#000000",strokeLinejoin:"miter"}}),w.jsx("path",{d:"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5",style:{fill:"none",stroke:"#ffffff"}}),w.jsx("path",{d:"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37",style:{fill:"none",stroke:"#ffffff"}})]}))}))};function xv(t,e,n){const r=e/8,s=t==="white"?GJ:HJ,o=t==="white"?qJ:KJ,i=s[n[0]]*r+r/2,a=o[parseInt(n[1],10)-1]*r+r/2;return{x:i,y:a}}function H_(t){let e=!1;return Object.keys(Sh).forEach(n=>{t[n]!==Sh[n]&&(e=!0)}),Object.keys(t).forEach(n=>{Sh[n]!==t[n]&&(e=!0)}),e}function XJ(t,e){const n={removed:{},added:{}};return Object.keys(t).forEach(r=>{e[r]!==t[r]&&(n.removed[r]=t[r])}),Object.keys(e).forEach(r=>{t[r]!==e[r]&&(n.added[r]=e[r])}),n}function q_(t){return t==="start"?Sh:typeof t=="string"?YJ(t):t}function YJ(t){if(!QJ(t))return{};t=t.replace(/ .+$/,"");const e=t.split("/"),n={};let r=8;for(let s=0;s<8;s++){const o=e[s].split("");let i=0;for(let a=0;a<o.length;a++)if(o[a].search(/[1-8]/)!==-1){const l=parseInt(o[a],10);i=i+l}else{const l=Id[i]+r;n[l]=JJ(o[a]),i=i+1}r=r-1}return n}function QJ(t){t=t.replace(/ .+$/,""),t=ZJ(t);const e=t.split("/");if(e.length!==8)return!1;for(let n=0;n<8;n++)if(e[n].length!==8||e[n].search(/[^kqrnbpKQRNBP1]/)!==-1)return!1;return!0}function ZJ(t){return t.replace(/8/g,"11111111").replace(/7/g,"1111111").replace(/6/g,"111111").replace(/5/g,"11111").replace(/4/g,"1111").replace(/3/g,"111").replace(/2/g,"11")}function JJ(t){return t.toLowerCase()===t?"b"+t.toUpperCase():"w"+t.toUpperCase()}const eee=(t,e=!0,n,r)=>{const[s,o]=L.useState([]),[i,a]=L.useState([]),[l,u]=L.useState();L.useEffect(()=>{Array.isArray(t)&&o(t==null?void 0:t.filter(p=>p[0]!==p[1]))},[t]),L.useEffect(()=>{n==null||n(i)},[i]);function c(){a([]),u(void 0)}const d=(p,m)=>{e&&u([p,m,r])},f=[...i,...s];return{arrows:f,newArrow:l,clearArrows:c,drawNewArrow:d,setArrows:a,onArrowDrawEnd:(p,m)=>{if(p===m||!e)return;let v;const g=[p,m,r];f.every(([b,_])=>!(b===p&&_===m))?v=[...i,g]:v=i.filter(([b,_])=>!(b===p&&_===m)),u(void 0),a(v)}}},YA=L.createContext({}),ni=()=>L.useContext(YA),tee=L.forwardRef(({allowDragOutsideBoard:t=!0,animationDuration:e=300,areArrowsAllowed:n=!0,arePiecesDraggable:r=!0,arePremovesAllowed:s=!1,autoPromoteToQueen:o=!1,boardOrientation:i="white",boardWidth:a,children:l,clearPremovesOnRightClick:u=!0,customArrows:c,customArrowColor:d="rgb(255,170,0)",customBoardStyle:f,customDarkSquareStyle:h={backgroundColor:"#B58863"},customDropSquareStyle:p={boxShadow:"inset 0 0 1px 6px rgba(255,255,255,0.75)"},customLightSquareStyle:m={backgroundColor:"#F0D9B5"},customPieces:v,customPremoveDarkSquareStyle:g={backgroundColor:"#A42323"},customPremoveLightSquareStyle:x={backgroundColor:"#BD2828"},customSquare:b="div",customSquareStyles:_,dropOffBoardAction:N="snapback",id:E=0,isDraggablePiece:R=()=>!0,getPositionObject:P=()=>{},onArrowsChange:B=()=>{},onDragOverSquare:F=()=>{},onMouseOutSquare:H=()=>{},onMouseOverSquare:ee=()=>{},onPieceClick:oe=()=>{},onPieceDragBegin:de=()=>{},onPieceDragEnd:V=()=>{},onPieceDrop:W=()=>!0,onPromotionCheck:I=(ue,De,Ae)=>(Ae==="wP"&&ue[1]==="7"&&De[1]==="8"||Ae==="bP"&&ue[1]==="2"&&De[1]==="1")&&Math.abs(ue.charCodeAt(0)-De.charCodeAt(0))<=1,onPromotionPieceSelect:O,onSquareClick:j=()=>{},onSquareRightClick:A=()=>{},position:ne="start",promotionDialogVariant:U="default",promotionToSquare:Q=null,showBoardNotation:G=!0,showPromotionDialog:J=!1,snapToCursor:re=!0},be)=>{const[ue,De]=L.useState(q_(ne)),[Ae,Ye]=L.useState({removed:{},added:{}}),[ot,Ft]=L.useState(void 0),[yn,Ct]=L.useState(J&&!o),[It,zt]=L.useState(null),[Mn,jn]=L.useState(Q),[kr,vn]=L.useState([]),Ot=L.useRef(kr),[Rs,tr]=L.useState(),[Io,Ds]=L.useState(Object.assign(Object.assign({},G_),v)),[uo,As]=L.useState(!1),[Rn,oi]=L.useState(),[Oo,Ro]=L.useState(!1);L.useImperativeHandle(be,()=>({clearPremoves(ce=!0){pr(ce)}})),L.useEffect(()=>{Ds(Object.assign(Object.assign({},G_),v))},[v]),L.useEffect(()=>{Ct(J),jn(Q)},[Q,J]),L.useEffect(()=>{var ce,ye,Ie;Or();const Ne=q_(ne),$e=XJ(ue,Ne),Se=((ce=Object.keys($e.added))===null||ce===void 0?void 0:ce.length)<=2?(Ie=(ye=Object.entries($e.added))===null||ye===void 0?void 0:ye[0])===null||Ie===void 0?void 0:Ie[1][0]:void 0;if(Oo)De(Ne),Ro(!1),s&&Ir(Se),Rn&&clearTimeout(Rn);else if(uo)De(Ne),Ro(!1),s&&Ir(Se);else{H_(Ne)&&ot!==void 0?Ft(Se):H_(Ne)?Ft(void 0):Ft("b"),Ye($e),Ro(!0);const Ge=setTimeout(()=>{De(Ne),Ro(!1),s&&Ir(Se)},e);oi(Ge)}return As(!1),P(Ne),Wt(),()=>{clearTimeout(Rn)}},[ne]);const{arrows:co,newArrow:rn,clearArrows:Wt,drawNewArrow:xn,onArrowDrawEnd:Yt}=eee(c,n,B,d);function ii(ce,ye,Ie,Ne){if(ce===ye)return;if(Wt(),s&&Oo||s&&(ot===Ie[0]||Ot.current.filter(Se=>Se.piece[0]===Ie[0]).length>0)){const Se=[...Ot.current];Se.push({sourceSq:ce,targetSq:ye,piece:Ie}),Ot.current=Se,vn([...Se]),Or();return}if(!s&&Oo)return;const $e=Object.assign({},ue);As(!!Ne),Ft(Ie[0]),W.length?W(ce,ye,Ie)||(pr(),As(!1)):(N==="trash"&&!ye&&delete $e[ce],delete $e[ce],$e[ye]=Ie,De($e)),Or(),P($e)}function Ir(ce){if(Ot.current.length===0)return;const ye=Ot.current[0];if(ye.piece[0]!==void 0&&ye.piece[0]!==ce&&W.length)if(Ft(ye.piece[0]),As(!0),W(ye.sourceSq,ye.targetSq,ye.piece)){const Ne=[...Ot.current];Ne.shift(),Ot.current=Ne,vn([...Ne])}else pr()}function pr(ce=!0){ce&&Ft(void 0),Ot.current=[],vn([])}function Or(){zt(null),jn(null),Ct(!1)}function wl(ce){tr(ce)}function X(ce){if(Rs){if(Rs===ce){tr(void 0),u&&pr(!1),A(ce);return}}else tr(void 0)}function Z(){tr(void 0)}const se={animationDuration:e,arePiecesDraggable:r,arePremovesAllowed:s,boardOrientation:i,boardWidth:a,customArrowColor:d,customBoardStyle:f,customDarkSquareStyle:h,customDropSquareStyle:p,customLightSquareStyle:m,customPremoveDarkSquareStyle:g,customPremoveLightSquareStyle:x,customSquare:b,customSquareStyles:_,id:E,isDraggablePiece:R,onDragOverSquare:F,onMouseOutSquare:H,onMouseOverSquare:ee,onPieceClick:oe,onPieceDragBegin:de,onPieceDragEnd:V,onPieceDrop:W,onPromotionCheck:I,onPromotionPieceSelect:O,onSquareClick:j,showBoardNotation:G,snapToCursor:re,promotionDialogVariant:U,allowDragOutsideBoard:t,arrows:co,newArrow:rn,onArrowDrawEnd:Yt,chessPieces:Io,clearArrows:Wt,drawNewArrow:xn,clearCurrentRightClickDown:Z,currentPosition:ue,handleSetPosition:ii,isWaitingForAnimation:Oo,lastPieceColour:ot,onRightClickDown:wl,onRightClickUp:X,positionDifferences:Ae,promoteFromSquare:It,promoteToSquare:Mn,premoves:kr,setPromoteFromSquare:zt,setPromoteToSquare:jn,setShowPromoteDialog:Ct,showPromoteDialog:yn,autoPromoteToQueen:o,currentRightClickDown:Rs};return w.jsx(YA.Provider,Object.assign({value:se},{children:l}))});function nee({row:t,col:e}){const{boardOrientation:n,boardWidth:r,customDarkSquareStyle:s,customLightSquareStyle:o}=ni(),i=o.backgroundColor,a=s.backgroundColor,l=e===0,u=t===7,c=l&&u;function d(){return n==="white"?8-t:t+1}function f(){return n==="black"?Id[7-e]:Id[e]}function h(){return w.jsxs(w.Fragment,{children:[w.jsx("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:i}),X_(r))},{children:d()})),w.jsx("div",Object.assign({style:Object.assign(Object.assign({zIndex:3,position:"absolute"},{color:i}),K_(r))},{children:f()}))]})}function p(){return w.jsx("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},{color:e%2!==0?a:i}),K_(r))},{children:f()}))}function m(){return w.jsx("div",Object.assign({style:Object.assign(Object.assign({userSelect:"none",zIndex:3,position:"absolute"},n==="black"?{color:t%2===0?a:i}:{color:t%2===0?a:i}),X_(r))},{children:d()}))}return c?h():u?p():l?m():null}const K_=t=>({alignSelf:"flex-end",paddingLeft:t/8-t/48,fontSize:t/48}),X_=t=>({alignSelf:"flex-start",paddingRight:t/8-t/48,fontSize:t/48});function Y_({isPremovedPiece:t=!1,piece:e,square:n,squares:r}){const{animationDuration:s,arePiecesDraggable:o,arePremovesAllowed:i,boardWidth:a,boardOrientation:l,chessPieces:u,currentPosition:c,id:d,isDraggablePiece:f,isWaitingForAnimation:h,onPieceClick:p,onPieceDragBegin:m,onPieceDragEnd:v,positionDifferences:g,premoves:x,onPromotionCheck:b}=ni(),[_,N]=L.useState({opacity:1,zIndex:5,touchAction:"none",cursor:o&&f({piece:e,sourceSquare:n})?"-webkit-grab":"default"}),[{canDrag:E,isDragging:R},P,B]=cJ(()=>({type:"piece",item:()=>(m(e,n),{piece:e,square:n,id:d}),end:()=>v(e,n),collect:H=>({canDrag:f({piece:e,sourceSquare:n}),isDragging:!!H.isDragging()})}),[e,n,c,d]);B(DJ(),{captureDraggingState:!0}),L.useEffect(()=>{N(H=>Object.assign(Object.assign({},H),{opacity:R?0:1}))},[R]),L.useEffect(()=>{if(!i)return;let H=!1;!t&&x.find(ee=>ee.targetSq===n)&&(H=!0),x.find(ee=>ee.sourceSq===n&&ee.piece===e)&&(H=!0),N(ee=>Object.assign(Object.assign({},ee),{display:H?"none":"unset"}))},[c,x]),L.useEffect(()=>{var H;const ee=(H=g.removed)===null||H===void 0?void 0:H[n];if(!g.added||!ee)return;const oe=Object.entries(g.added).find(([de,V])=>V===ee||b(n,de,ee));if(h&&ee&&oe&&!t){const de=n,V=oe[0];if(de&&V){const W=a/8;N(I=>Object.assign(Object.assign({},I),{transform:`translate(${(l==="black"?-1:1)*(V.charCodeAt(0)-de.charCodeAt(0))*W}px, ${(l==="black"?-1:1)*(Number(de[1])-Number(V[1]))*W}px)`,transition:`transform ${s}ms`,zIndex:6}))}}},[g]),L.useEffect(()=>{const{sourceSq:H}=F();H&&N(ee=>Object.assign(Object.assign({},ee),{transform:"translate(0px, 0px)",transition:"transform 0ms"}))},[c]),L.useEffect(()=>{N(H=>Object.assign(Object.assign({},H),{cursor:o&&f({piece:e,sourceSquare:n})?"-webkit-grab":"default"}))},[n,c,o]);function F(){return{sourceSq:r[n]}}return w.jsx("div",Object.assign({ref:o&&E?P:null,onClick:()=>p(e),"data-piece":e,style:_},{children:typeof u[e]=="function"?u[e]({squareWidth:a/8,isDragging:R,square:n}):w.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:a/8,height:a/8},{children:w.jsx("g",{children:u[e]})}))}))}function ree({square:t,squareColor:e,setSquares:n,squareHasPremove:r,children:s}){const o=L.useRef(null),{autoPromoteToQueen:i,boardWidth:a,boardOrientation:l,clearArrows:u,currentPosition:c,currentRightClickDown:d,customBoardStyle:f,customDarkSquareStyle:h,customDropSquareStyle:p,customLightSquareStyle:m,customPremoveDarkSquareStyle:v,customPremoveLightSquareStyle:g,customSquare:x,customSquareStyles:b,drawNewArrow:_,handleSetPosition:N,isWaitingForAnimation:E,lastPieceColour:R,onArrowDrawEnd:P,onDragOverSquare:B,onMouseOutSquare:F,onMouseOverSquare:H,onPieceDrop:ee,onPromotionCheck:oe,onRightClickDown:de,onRightClickUp:V,onSquareClick:W,setPromoteFromSquare:I,setPromoteToSquare:O,setShowPromoteDialog:j}=ni(),[{isOver:A},ne]=xJ(()=>({accept:"piece",drop:U,collect:G=>({isOver:!!G.isOver()})}),[t,c,ee,E,R]);function U(G){oe(G.square,t,G.piece)?i?N(G.square,t,G.piece[0]==="w"?"wQ":"bQ"):(I(G.square),O(t),j(!0)):N(G.square,t,G.piece,!0)}L.useEffect(()=>{if(o.current){const{x:G,y:J}=o.current.getBoundingClientRect();n(re=>Object.assign(Object.assign({},re),{[t]:{x:G,y:J}}))}},[a,l]);const Q=Object.assign(Object.assign(Object.assign(Object.assign({},see(t,l,f)),e==="black"?h:m),r&&(e==="black"?v:g)),A&&p);return w.jsx("div",Object.assign({ref:ne,style:Q,"data-square-color":e,"data-square":t,onMouseOver:G=>{G.buttons===2&&d&&_(d,t),!(G.relatedTarget&&G.currentTarget.contains(G.relatedTarget))&&H(t)},onMouseOut:G=>{G.relatedTarget&&G.currentTarget.contains(G.relatedTarget)||F(t)},onMouseDown:G=>{G.button===2&&de(t)},onMouseUp:G=>{G.button===2&&(d&&P(d,t),V(t))},onDragEnter:()=>B(t),onClick:()=>{W(t),u()},onContextMenu:G=>{G.preventDefault()}},{children:typeof x=="string"?w.jsx(x,Object.assign({ref:o,style:Object.assign(Object.assign(Object.assign({},Z_(a)),Q_),!r&&(b==null?void 0:b[t]))},{children:s})):w.jsx(x,Object.assign({ref:o,square:t,squareColor:e,style:Object.assign(Object.assign(Object.assign({},Z_(a)),Q_),!r&&(b==null?void 0:b[t]))},{children:s}))}))}const Q_={display:"flex",justifyContent:"center"},Z_=t=>({width:t/8,height:t/8}),see=(t,e,n)=>n!=null&&n.borderRadius?t==="a1"?e==="white"?{borderBottomLeftRadius:n.borderRadius}:{borderTopRightRadius:n.borderRadius}:t==="a8"?e==="white"?{borderTopLeftRadius:n.borderRadius}:{borderBottomRightRadius:n.borderRadius}:t==="h1"?e==="white"?{borderBottomRightRadius:n.borderRadius}:{borderTopLeftRadius:n.borderRadius}:t==="h8"?e==="white"?{borderTopRightRadius:n.borderRadius}:{borderBottomLeftRadius:n.borderRadius}:{}:{};function oee(){const[t,e]=L.useState({}),{boardOrientation:n,boardWidth:r,currentPosition:s,id:o,premoves:i,showBoardNotation:a}=ni();return w.jsx("div",Object.assign({"data-boardid":o},{children:[...Array(8)].map((l,u)=>w.jsx("div",Object.assign({style:{display:"flex",flexWrap:"nowrap",width:r}},{children:[...Array(8)].map((c,d)=>{const f=n==="black"?Id[7-d]+(u+1):Id[d]+(8-u),h=d%2===u%2?"white":"black",p=i.find(v=>v.sourceSq===f||v.targetSq===f),m=i.find(v=>v.targetSq===f);return w.jsxs(ree,Object.assign({square:f,squareColor:h,setSquares:e,squareHasPremove:!!p},{children:[s[f]&&w.jsx(Y_,{piece:s[f],square:f,squares:t}),m&&w.jsx(Y_,{isPremovedPiece:!0,piece:m.piece,square:f,squares:t}),a&&w.jsx(nee,{row:u,col:d})]}),`${d}${u}`)})}),u.toString()))}))}const iee=()=>{const{arrows:t,newArrow:e,boardOrientation:n,boardWidth:r,customArrowColor:s}=ni(),o=[...t,e].filter(Boolean);return w.jsx("svg",Object.assign({width:r,height:r,style:{position:"absolute",top:"0",left:"0",pointerEvents:"none",zIndex:"10"}},{children:o.map((i,a)=>{const[l,u,c]=i;if(l===u)return null;const d=xv(n,r,l),f=xv(n,r,u);let h=r/32;const p=a===t.length;t.some(b=>b[0]!==l&&b[1]===u)&&!p&&(h=r/16);const m=f.x-d.x,v=f.y-d.y,g=Math.hypot(v,m),x={x:d.x+m*(g-h)/g,y:d.y+v*(g-h)/g};return w.jsxs(L.Fragment,{children:[w.jsx("marker",Object.assign({id:`arrowhead-${a}`,markerWidth:"2",markerHeight:"2.5",refX:"1.25",refY:"1.25",orient:"auto"},{children:w.jsx("polygon",{points:"0.3 0, 2 1.25, 0.3 2.5",fill:c??s})})),w.jsx("line",{x1:d.x,y1:d.y,x2:x.x,y2:x.y,opacity:p?"0.5":"0.65",stroke:c??s,strokeWidth:p?.9*r/40:r/40,markerEnd:`url(#arrowhead-${a})`})]},`${l}-${u}${p?"-active":""}`)})}))};function aee({option:t}){const[e,n]=L.useState(!1),{boardWidth:r,chessPieces:s,customDarkSquareStyle:o,customLightSquareStyle:i,handleSetPosition:a,onPromotionPieceSelect:l,promoteFromSquare:u,promoteToSquare:c,promotionDialogVariant:d}=ni(),f=()=>{switch(t[1]){case"Q":return o.backgroundColor;case"R":return i.backgroundColor;case"N":return d==="default"?i.backgroundColor:o.backgroundColor;case"B":return d==="default"?o.backgroundColor:i.backgroundColor}};return w.jsx("div",Object.assign({onClick:()=>{l!=null&&l.length?l(t):a(u,c,t,!0)},onMouseOver:()=>n(!0),onMouseOut:()=>n(!1),"data-piece":t,style:{cursor:"pointer",backgroundColor:e?f():`${f()}aa`,borderRadius:"4px",transition:"all 0.1s ease-out"}},{children:typeof s[t]=="function"?w.jsx("div",Object.assign({style:{transition:"all 0.1s ease-out",transform:e?"scale(1)":"scale(0.85)"}},{children:s[t]({squareWidth:r/8,isDragging:!1})})):w.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:r/8,height:r/8,style:{transition:"all 0.1s ease-out",transform:e?"scale(1)":"scale(0.85)"}},{children:w.jsx("g",{children:s[t]})}))}))}function lee(){const{boardOrientation:t,boardWidth:e,promotionDialogVariant:n,promoteToSquare:r}=ni(),s=(r==null?void 0:r[1])==="1"?"b":"w",o=[`${s??"w"}Q`,`${s??"w"}R`,`${s??"w"}N`,`${s??"w"}B`],i={default:{display:"grid",gridTemplateColumns:"1fr 1fr",transform:`translate(${-e/8}px, ${-e/8}px)`},vertical:{transform:`translate(${-e/16}px, ${-e/16}px)`},modal:{display:"flex",justifyContent:"center",alignItems:"center",transform:`translate(0px, ${3*e/8}px)`,width:"100%",height:`${e/4}px`,top:0,backgroundColor:"white",left:0}},a=xv(t,e,r||"a8");return w.jsx("div",Object.assign({style:Object.assign({position:"absolute",top:`${a==null?void 0:a.y}px`,left:`${a==null?void 0:a.x}px`,zIndex:1e3},i[n]),title:"Choose promotion piece"},{children:o.map(l=>w.jsx(aee,{option:l},l))}))}const uee={whiteKing:w.jsx("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{shapeRendering:"geometricPrecision",textRendering:"geometricPrecision",imageRendering:"crisp-edges"},viewBox:"0 0 4210 12970",x:"0px",y:"0px",fillRule:"evenodd",clipRule:"evenodd",width:"250",height:"250"},{children:w.jsx("g",{children:w.jsx("path",{style:{fill:"black",fillRule:"nonzero"},d:"M2105 0c169,0 286,160 249,315l200 0c-172,266 -231,479 -256,792 315,-24 530,-86 792,-255l0 897c-265,-171 -479,-231 -792,-256 18,234 75,495 185,682l339 0c233,0 369,269 225,456l545 0 -595 1916c130,94 158,275 59,402 465,0 416,568 51,568l-334 0 465 2867 332 0c250,0 381,306 199,485 162,63 273,220 273,399l0 633 168 0 0 475c-1403,0 -2807,0 -4210,0l0 -475 167 0 0 -633c0,-179 112,-336 274,-399 -181,-178 -52,-485 199,-485l332 0 465 -2867 -335 0c-353,0 -418,-568 51,-568 -98,-127 -70,-308 59,-402l-594 -1916c181,0 363,0 545,0 -144,-187 -9,-456 225,-456l339 0c110,-187 167,-448 185,-682 -315,25 -530,87 -793,256l0 -897c266,171 480,231 793,255 -25,-315 -87,-529 -256,-792l199 0c-36,-155 81,-315 250,-315zm-1994 10012l0 253 3988 0 0 -253c-1330,0 -2659,0 -3988,0zm484 -1060c-174,0 -316,142 -316,316l0 633 3652 0 0 -633c0,-174 -142,-316 -316,-316 -1007,0 -2013,0 -3020,0zm45 -457c-230,0 -225,345 0,345l2930 0c230,0 225,-345 0,-345 -977,0 -1953,0 -2930,0zm2020 -2978l-1111 0 -465 2867 2041 0 -465 -2867zm-1558 -456c-229,0 -224,345 0,345 669,0 1337,0 2005,0 230,0 225,-345 0,-345 -668,0 -1336,0 -2005,0zm1730 -457l-1454 0c-229,0 -224,345 0,345l1454 0c229,0 224,-345 0,-345zm-2064 -1862l544 1751c529,0 1057,0 1586,0l544 -1751c-892,0 -1783,0 -2674,0zm1085 -567l504 0c-126,-247 -163,-526 -177,-800 273,15 553,52 800,177l0 -504c-247,126 -527,163 -800,177 14,-273 51,-552 177,-799 -168,0 -336,0 -504,0 125,247 162,526 177,799 -274,-14 -553,-51 -800,-177l0 504c247,-125 527,-162 800,-177 -15,274 -52,553 -177,800zm969 111l-1434 0c-230,0 -225,345 0,345l1434 0c230,0 225,-345 0,-345zm-717 -2175c-105,0 -175,109 -133,204l266 0c42,-96 -30,-205 -133,-204z"})})}))};function cee({children:t}){try{return w.jsx(w.Fragment,{children:t})}catch(e){return console.log(e),w.jsx(QA,{showError:!0})}}function QA({showError:t=!1}){return w.jsxs("div",Object.assign({style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column"}},{children:[w.jsx("div",Object.assign({style:{width:250,height:250,transform:"rotate(90deg)"}},{children:uee.whiteKing})),t&&w.jsx("h1",{children:"Something went wrong"})]}))}function dee(){const t=L.useRef(null),{boardWidth:e,clearCurrentRightClickDown:n,onPromotionPieceSelect:r,setShowPromoteDialog:s,showPromoteDialog:o,customBoardStyle:i}=ni();return L.useEffect(()=>{function a(l){t.current&&!t.current.contains(l.target)&&n()}return document.addEventListener("mouseup",a),()=>{document.removeEventListener("mouseup",a)}},[]),e?w.jsx("div",Object.assign({style:{perspective:"1000px"}},{children:w.jsxs("div",Object.assign({ref:t,style:Object.assign(Object.assign({position:"relative"},fee(e)),i)},{children:[w.jsx(oee,{}),w.jsx(iee,{}),o&&w.jsxs(w.Fragment,{children:[w.jsx("div",{onClick:()=>{s(!1),r==null||r()},style:{position:"absolute",top:"0",left:"0",zIndex:"100",backgroundColor:"rgba(22,21,18,.7)",width:e,height:e}}),w.jsx(lee,{})]})]}))})):w.jsx(QA,{})}const fee=t=>({cursor:"default",height:t,width:t});function hee({boardContainer:t}){const{boardWidth:e,chessPieces:n,id:r,snapToCursor:s,allowDragOutsideBoard:o}=ni(),i=dJ(f=>({item:f.getItem(),clientOffset:f.getClientOffset(),sourceClientOffset:f.getSourceClientOffset(),isDragging:f.isDragging()})),{isDragging:a,item:l,clientOffset:u,sourceClientOffset:c}=i,d=L.useCallback((f,h)=>{if(!f||!h)return{display:"none"};let{x:p,y:m}=s?f:h;const v=e/8/2;if(s&&(p-=v,m-=v),!o){const{left:x,top:b}=t,_=x-v,N=b-v,E=x+e-v,R=b+e-v;p=Math.max(_,Math.min(p,E)),m=Math.max(N,Math.min(m,R))}const g=`translate(${p}px, ${m}px)`;return{transform:g,WebkitTransform:g,touchAction:"none"}},[e,o,s,t]);return a&&l.id===r?w.jsx("div",Object.assign({style:{position:"fixed",pointerEvents:"none",zIndex:10,left:0,top:0}},{children:w.jsx("div",Object.assign({style:d(u,c)},{children:typeof n[l.piece]=="function"?n[l.piece]({squareWidth:e/8,isDragging:!0}):w.jsx("svg",Object.assign({viewBox:"1 1 43 43",width:e/8,height:e/8},{children:w.jsx("g",{children:n[l.piece]})}))}))})):null}const pee=L.forwardRef((t,e)=>{const{customDndBackend:n,customDndBackendOptions:r}=t,s=EQ(t,["customDndBackend","customDndBackendOptions"]),[o,i]=L.useState(),[a,l]=L.useState(!1),[u,c]=L.useState(!1),[d,f]=L.useState(t.boardWidth),h=L.useRef(null),p=L.useRef(null),[m,v]=L.useState({left:0,top:0}),g=L.useMemo(()=>{var b;return(b=h.current)===null||b===void 0?void 0:b.getBoundingClientRect()},[h.current]);L.useEffect(()=>{v({left:g!=null&&g.left?g==null?void 0:g.left:0,top:g!=null&&g.top?g==null?void 0:g.top:0})},[g]),L.useEffect(()=>{c("ontouchstart"in window),l(!0),i(window)},[]),L.useEffect(()=>{var b;if(t.boardWidth===void 0&&(!((b=h.current)===null||b===void 0)&&b.offsetWidth)){const _=new ResizeObserver(()=>{var N;f((N=h.current)===null||N===void 0?void 0:N.offsetWidth)});return _.observe(h.current),()=>{_.disconnect()}}},[h.current,o]);const x=n||(u?VJ:AJ);return a&&o?w.jsx(cee,{children:w.jsxs("div",Object.assign({ref:p,style:{display:"flex",flexDirection:"column",width:"100%"}},{children:[w.jsx("div",{ref:h,style:{width:"100%"}}),w.jsx(zZ,Object.assign({backend:x,context:o,options:n?r:void 0},{children:d&&w.jsxs(tee,Object.assign({boardWidth:d},s,{ref:e},{children:[w.jsx(hee,{boardContainer:m}),w.jsx(dee,{})]}))}))]}))}):null}),mee={g1:[Gs.h1,Gs.f1,Rc.R],c1:[Gs.a1,Gs.d1,Rc.R],g8:[Gs.h8,Gs.f8,Rc.r],c8:[Gs.a8,Gs.d8,Rc.r]},gee=t=>{let e=t.piece;return t!=null&&t.promotion&&(e=t.promotion),t.color=="w"&&(e=e.toUpperCase()),Rc[e]},J_=t=>{const e=[Gs[t.from]],n=[Gs[t.to]],r=[gee(t)];if(t.flags.includes("k")||t.flags.includes("q")){const[o,i,a]=mee[t.to];e.push(o),n.push(i),r.push(a)}else if(t.flags.includes("e")){const o=Gs[t.to[0]+t.from[1]];e.push(o)}return{sans:[t.san],from:e,to:n,targets:r}},yee=(t,e)=>{const n=e.from.concat(e.to),r=t.from.filter(c=>!n.includes(c)),s=[],o=[];for(let c=0;c<t.to.length;c++)n.includes(t.to[c])||(s.push(t.to[c]),o.push(t.targets[c]));const i=r.concat(e.from),a=s.concat(e.to),l=o.concat(e.targets);return{sans:[t.sans[0],e.sans[0]],from:i,to:a,targets:l}},eE=t=>{const e=[];return t.moves({verbose:!0}).forEach(n=>{const r=J_(n);t.move(n);let s=!0;if(t.moves({verbose:!0}).forEach(o=>{const i=J_(o),a=yee(r,i),l={move1:r,move2:i,moves:a};e.push(l),s=!1}),s){const o={move1:r,move2:null,moves:null};e.push(o)}t.undo()}),e},vee=({piecesModelRef:t,canvasRef:e,videoRef:n,sidebarRef:r,playing:s,setPlaying:o,playingRef:i,setText:a,digital:l,mode:u,cornersRef:c})=>{const d=Kd(),[f,h]=L.useState(100),p=L.useRef(null),m=L.useRef(dv(d)),v=L.useRef(eE(m.current)),g=L.useRef(d.lastMove),x=L.useRef(""),b=_Q(),_=CQ(),N=Ns();L.useEffect(()=>{const O=dv(d);x.current=E(O),d.greedy===!0&&O.undo(),m.current=O,v.current=eE(O),g.current=d.lastMove},[d]);const E=O=>{const j=O.history();if(j.length==0)return"";if(j.length==1)return`1. ${j[j.length-1]}`;const A=j[j.length-2],ne=j[j.length-1],U=Math.floor(j.length/2);return j.length%2==0?`${U}.${A} ${ne}`:`${U}...${A} ${U+1}.${ne}`},R=async()=>{const O=await navigator.mediaDevices.getUserMedia(AD);return n.current!==null&&(n.current.srcObject=O),O},P=async()=>R(),B=()=>{let O=(b-r.current.offsetWidth-ki)/uv+ki;if(O>_&&(O=_),l){h(O);return}if(e.current.offsetHeight==0||e.current.offsetWidth==0)return;const j=(O-ki)*uv+ki,A=e.current.height,ne=e.current.width;p.current.style.width=`${j}px`,p.current.style.height=`${O}px`,p.current.width=j,p.current.height=O,e.current.width=n.current.offsetWidth,e.current.height=n.current.offsetHeight,Vx.forEach(U=>{const Q=QD(c.current[U],A,ne),G={xy:YD(Q,e.current.height,e.current.width),key:U};N(Qx(G))})};L.useEffect(()=>{B();let O=null;u!=="upload"&&(O=P()),gQ(t,n,e,i,a,N,c,m,v,g,x,u);const j=async()=>{const A=await O;A!==null&&A.getTracks().forEach(ne=>ne.stop())};return()=>{j()}},[]),L.useEffect(()=>{B()},[b,_,l]),L.useEffect(()=>{u!=="upload"||n.current.src===""||(i.current===!0?n.current.pause():n.current.play())},[s]);const F={position:"absolute",left:xh,top:xh},H={width:"100%",height:"100%",padding:xh},ee={width:"auto",height:"100%"},oe={position:"relative",backgroundColor:"#343a40",display:l?"none":"inline-block"},de={display:l?"inline-block":"none"},V=()=>{u!=="upload"&&window.setTimeout(()=>{if(!n.current)return;const O=n.current.srcObject.getVideoTracks();if(O.length==0)return;const j=O[0].getCapabilities();console.log("Capabilties",j),j.zoom&&O[0].applyConstraints({zoom:j.zoom.min}).catch(ne=>console.log(ne));const A=O[0].getSettings();console.log("Settings",A)},2e3)},W=()=>{B()},I=()=>{u==="upload"&&(n.current.currentTime=n.current.duration,n.current.pause),o(!1)};return w.jsxs("div",{className:"d-flex align-top justify-content-center",children:[w.jsxs("div",{ref:p,style:oe,children:[w.jsxs("div",{style:H,children:[w.jsx("video",{ref:n,autoPlay:u!=="upload",playsInline:!0,muted:!0,onLoadedMetadata:V,style:ee,onCanPlay:W,onEnded:I}),w.jsx("canvas",{ref:e,style:F})]}),w.jsx(dQ,{})]}),w.jsx("div",{style:de,children:w.jsx(pee,{position:d.fen,boardWidth:f})})]})};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xee=Y();xee.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var ls;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(ls||(ls={}));var tE;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(tE||(tE={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bee={};function ZA(t){return bee[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S(t,e,n,r,s){const o=e.inputParams[t];if(o&&o.inputIndexStart!==void 0){const a=o.inputIndexStart,l=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?a+1:o.inputIndexEnd,u=a<0?e.inputNames.length+a:a;if(o.type==="tensor")return En(e.inputNames[u],n,r,s);if(o.type==="tensors"){const f=e.inputs.slice(a,l);return e.inputNames.slice(a,l).filter((p,m)=>{var v;return((v=f[m])===null||v===void 0?void 0:v.op)!=="NoOp"}).map(p=>En(p,n,r,s))}const c=En(e.inputNames[u],n,r,s),d=c.dataSync();return o.type==="number"?d[0]:F0(c.shape,d)}const i=e.attrParams[t];return i&&i.value}function En(t,e,n,r){const[s,o]=xr(t,n);if(r!=null){const a=r.getHashTableHandleByName(s);if(a!=null)return a}const i=n.currentContextIds.find(a=>!!e[Ep(s,a)]);return i!==void 0?e[Ep(s,i)][o]:void 0}function nE(t,e,n){return e[Ep(t,n.currentContextId)]}function Fo(t,e){const[n,r,s]=xr(t,e);return[Ep(n,e&&e.currentContextId),r,s]}function Ep(t,e){return e?`${t}-${e}`:t}function xr(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const o=e.parseNodeNameCache.get(t);if(o!=null)return o}const r=t.split(":");let s;if(r.length===1)s=[t,0,void 0];else{const o=r[0],i=r.length===3?r[1]:void 0,a=Number(r[r.length-1]);s=[o,a,i]}return n&&e.parseNodeNameCache.set(t,s),s}function Ch(t,e,n){let r=S("pad",t,e,n);if(r==="explicit"){r=S("explicitPaddings",t,e,n);const s=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)s[o][0]=r[o*2],s[o][1]=r[o*2+1];return s}return r}function Mo(t){return t.kept?t:Wi(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wee=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],See=Object.freeze(Object.defineProperty({__proto__:null,json:wee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cee=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],_ee=Object.freeze(Object.defineProperty({__proto__:null,json:Cee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eee=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],Tee=Object.freeze(Object.defineProperty({__proto__:null,json:Eee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nee=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],$ee=Object.freeze(Object.defineProperty({__proto__:null,json:Nee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kee=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],Iee=Object.freeze(Object.defineProperty({__proto__:null,json:kee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oee=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Ree=Object.freeze(Object.defineProperty({__proto__:null,json:Oee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dee=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],Aee=Object.freeze(Object.defineProperty({__proto__:null,json:Dee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pee=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],Lee=Object.freeze(Object.defineProperty({__proto__:null,json:Pee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fee=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Mee=Object.freeze(Object.defineProperty({__proto__:null,json:Fee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jee=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],Bee=Object.freeze(Object.defineProperty({__proto__:null,json:jee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uee=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],zee=Object.freeze(Object.defineProperty({__proto__:null,json:Uee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wee=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],Vee=Object.freeze(Object.defineProperty({__proto__:null,json:Wee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gee=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],Hee=Object.freeze(Object.defineProperty({__proto__:null,json:Gee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qee=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],Kee=Object.freeze(Object.defineProperty({__proto__:null,json:qee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xee=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],Yee=Object.freeze(Object.defineProperty({__proto__:null,json:Xee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qee=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],Zee=Object.freeze(Object.defineProperty({__proto__:null,json:Qee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jee=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],ete=Object.freeze(Object.defineProperty({__proto__:null,json:Jee},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tte=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],nte=Object.freeze(Object.defineProperty({__proto__:null,json:tte},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rte=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],ste=Object.freeze(Object.defineProperty({__proto__:null,json:rte},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rE{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[See,_ee,Tee,$ee,Iee,Ree,Aee,Lee,Mee,Bee,zee,Vee,Hee,Kee,Yee,Zee,ete,nte,ste],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,s)=>(r[s.tfOpName]=s,r),{})}transformGraph(e,n={}){const r=e.node,s=[],o=[],i=[],a=r.reduce((m,v)=>(m[v.name]=this.mapNode(v),v.op.startsWith("Placeholder")?s.push(m[v.name]):v.op==="Const"?o.push(m[v.name]):(v.input==null||v.input.length===0)&&i.push(m[v.name]),m),{});let l=[];const u=[];let c={},d={};n!=null&&(c=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const f=Object.keys(a);f.forEach(m=>{const v=a[m];v.inputNames.forEach((g,x)=>{const[b,,_]=Fo(g),N=a[b];if(N.outputs!=null){const E=N.outputs.indexOf(_);if(E!==-1){const R=`${b}:${E}`;v.inputNames[x]=R}}v.inputs.push(N),N.children.push(v)})}),Object.keys(d).length===0?f.forEach(m=>{const v=a[m];v.children.length===0&&u.push(v)}):Object.keys(d).forEach(m=>{const[v]=Fo(m),g=a[v];g!=null&&(g.signatureKey=d[m],u.push(g))}),Object.keys(c).length>0?Object.keys(c).forEach(m=>{const[v]=Fo(m),g=a[v];g&&(g.signatureKey=c[m],l.push(g))}):l=s;let h={};e.library!=null&&e.library.function!=null&&(h=e.library.function.reduce((m,v)=>(m[v.signature.name]=this.mapFunction(v),m),{}));const p={nodes:a,inputs:l,outputs:u,weights:o,placeholders:s,signature:n,functions:h};return i.length>0&&(p.initNodes=i),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=ZA(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.slice(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((s,o)=>(s[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},s),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((s,o)=>{const i=o.type;let a;switch(o.type){case"string":a=bv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=bv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":a=Nv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Nv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":a=Sv(e.attr,o.tfName,o.defaultValue||0),a===void 0&&o.tfDeprecatedName&&(a=Sv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":a=Tv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Tv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":a=wv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=wv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":a=kv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=kv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":a=Ev(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Ev(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":a=$v(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=$v(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":a=Cv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Cv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":a=_v(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=_v(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":a=sE(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=sE(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${o.type} for op: ${e.op}`)}return s[o.name]={value:a,type:i},s},{})),r}mapFunction(e){const n=e.nodeDef,r=[],s=[];let o={};n!=null&&(o=n.reduce((d,f)=>(d[f.name]=this.mapNode(f),f.op==="Const"&&s.push(d[f.name]),d),{}));const i=[],a=[];e.signature.inputArg.forEach(d=>{const[f]=Fo(d.name),h={name:f,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:hb(d.type),type:"dtype"}},children:[]};h.signatureKey=d.name,i.push(h),o[f]=h}),Object.keys(o).forEach(d=>{const f=o[d];f.inputNames.forEach((h,p)=>{const[m,,v]=Fo(h),g=o[m];if(g.outputs!=null){const x=g.outputs.indexOf(v);if(x!==-1){const b=`${m}:${x}`;f.inputNames[p]=b}}f.inputs.push(g),g.children.push(f)})});const u=e.ret;e.signature.outputArg.forEach(d=>{const[f,h]=Fo(u[d.name]),p=o[f];p!=null&&(p.defaultOutput=h,a.push(p))});const c=this.mapArgsToSignature(e);return{nodes:o,inputs:i,outputs:a,weights:s,placeholders:r,signature:c}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function ote(t){const e=Y().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function JA(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):ote(t);return e?n:n.toLowerCase()}function bv(t,e,n,r=!1){const s=t[e];return s!=null?JA(s.s,r):n}function wv(t,e,n){const r=t[e];return r?r.b:n}function Sv(t,e,n){const r=t[e]||{},s=r.i!=null?r.i:r.f!=null?r.f:n;return typeof s=="number"?s:parseInt(s,10)}function hb(t){switch(typeof t=="string"&&(t=ls[t]),t){case ls.DT_FLOAT:case ls.DT_HALF:return"float32";case ls.DT_INT32:case ls.DT_INT64:case ls.DT_INT8:case ls.DT_UINT8:return"int32";case ls.DT_BOOL:return"bool";case ls.DT_DOUBLE:return"float32";case ls.DT_STRING:return"string";default:return null}}function sE(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function Cv(t,e,n){const r=t[e];return r&&r.type?hb(r.type):n}function _v(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(s=>hb(s)):n}function eP(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function Ev(t,e,n){const r=t[e];return r&&r.shape?eP(r.shape):n}function Tv(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):n}function Nv(t,e,n,r=!1){const s=t[e];return s&&s.list&&s.list.s?s.list.s.map(o=>JA(o,r)):n}function $v(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(s=>eP(s)):n}function kv(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ite{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,o)=>(s[o]=this.getAttr(o),s),{}))}getInput(e){return En(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return En(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return Sv(this.node.rawAttrs,e,n);if(r.s!=null)return bv(this.node.rawAttrs,e,n);if(r.b!=null)return wv(this.node.rawAttrs,e,n);if(r.shape!=null)return Ev(this.node.rawAttrs,e,n);if(r.type!=null)return Cv(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return Tv(this.node.rawAttrs,e,n);if(r.list.s!=null)return Nv(this.node.rawAttrs,e,n);if(r.list.shape!=null)return $v(this.node.rawAttrs,e,n);if(r.list.b!=null)return kv(this.node.rawAttrs,e,n);if(r.list.type!=null)return _v(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const In=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:EO,abs:jr,acos:az,acosh:uz,add:ke,addN:dz,all:hz,any:mz,argMax:yz,argMin:UO,asin:bz,asinh:Sz,atan:_z,atan2:Tz,atanh:$z,avgPool:WO,avgPool3d:Lz,basicLSTMCell:Wz,batchNorm:Cm,batchNorm2d:Kz,batchNorm3d:Yz,batchNorm4d:Zz,batchToSpaceND:VO,bincount:GO,bitwiseAnd:tW,booleanMaskAsync:jH,broadcastArgs:rW,broadcastTo:Kc,buffer:Lt,cast:nn,ceil:iW,clipByValue:lW,clone:Wi,complex:Ji,concat:cn,concat1d:cW,concat2d:HO,concat3d:hW,concat4d:mW,conv1d:vW,conv2d:_m,conv2dTranspose:wW,conv3d:CW,conv3dTranspose:NW,cos:kW,cosh:OW,cosineWindow:Dx,cumprod:DW,cumsum:PW,denseBincount:FW,depthToSpace:jW,depthwiseConv2d:mx,diag:zW,dilation2d:VW,div:st,divNoNan:XW,dot:QW,dropout:ZH,einsum:Rl,elu:YO,enclosingPowerOfTwo:_R,ensureShape:tV,equal:XO,erf:rV,euclideanNorm:fV,exp:Qa,expandDims:Br,expm1:gV,eye:JO,fft:Ix,fill:Hd,floor:eR,floorDiv:BO,fused:h8,gather:vx,gatherND:XH,greater:Tm,greaterEqual:tR,ifft:xp,imag:Nm,image:Px,inTopKAsync:e8,irfft:yR,isFinite:EV,isInf:NV,isNaN:kV,leakyRelu:nR,less:rv,lessEqual:xx,linalg:Hq,linspace:DV,localResponseNormalization:PV,log:Ed,log1p:rR,logSigmoid:zV,logSoftmax:GV,logSumExp:oR,logicalAnd:gp,logicalNot:iR,logicalOr:aR,logicalXor:QV,losses:qq,lowerBound:JV,matMul:ht,max:La,maxPool:lR,maxPool3d:n6,maxPoolWithArgmax:s6,maximum:uR,mean:yp,meshgrid:a6,min:nv,minimum:vp,mirrorPad:c6,mod:f6,moments:p6,movingAverage:zH,mul:he,multiRNNCell:g6,multinomial:v6,neg:Eo,norm:Em,notEqual:cR,oneHot:w6,ones:Ra,onesLike:C6,op:M,outerProduct:E6,pad:Fu,pad1d:$6,pad2d:I6,pad3d:R6,pad4d:A6,pool:j6,pow:_d,prelu:fR,print:jO,prod:z6,raggedGather:V6,raggedRange:H6,raggedTensorToTensor:K6,rand:Y6,randomGamma:gG,randomNormal:pR,randomStandardNormal:xG,randomUniform:kx,randomUniformInt:SG,range:Td,real:Nd,reciprocal:EG,relu:$m,relu6:mR,reshape:ae,reverse:Za,reverse1d:IG,reverse2d:RG,reverse3d:AG,reverse4d:LG,rfft:Ox,round:gR,rsqrt:jG,scalar:Ze,scatterND:VH,searchSorted:bx,selu:UG,separableConv2d:WG,setdiff1dAsync:GG,sigmoid:au,sign:qG,signal:Gq,sin:XG,sinh:QG,slice:Le,slice1d:JG,slice2d:tH,slice3d:rH,slice4d:oH,softmax:aH,softplus:sR,spaceToBatchND:dR,sparse:Kq,sparseToDense:qH,spectral:Vq,split:$d,sqrt:Xo,square:Ss,squaredDifference:vR,squeeze:Gi,stack:Qo,step:xR,stridedSlice:vH,string:Xq,sub:Oe,sum:St,tan:bH,tanh:tv,tensor:_o,tensor1d:xs,tensor2d:lu,tensor3d:bR,tensor4d:wH,tensor5d:SH,tensor6d:CH,tensorScatterUpdate:EH,tile:Xc,topk:NH,transpose:bp,truncatedNormal:kH,unique:OH,unsortedSegmentSum:DH,unstack:dl,upperBound:PH,variable:LH,where:Vi,whereAsync:CR,zeros:ta,zerosLike:Vr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ate=(t,e,n,r=In)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(S("a",t,e,n),S("b",t,e,n))];case"AddN":return[r.addN(S("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(S("a",t,e,n),S("b",t,e,n))];case"Mul":return[r.mul(S("a",t,e,n),S("b",t,e,n))];case"RealDiv":case"Div":return[r.div(S("a",t,e,n),S("b",t,e,n))];case"DivNoNan":return[r.divNoNan(S("a",t,e,n),S("b",t,e,n))];case"FloorDiv":return[r.floorDiv(S("a",t,e,n),S("b",t,e,n))];case"Sub":return[r.sub(S("a",t,e,n),S("b",t,e,n))];case"Minimum":return[r.minimum(S("a",t,e,n),S("b",t,e,n))];case"Maximum":return[r.maximum(S("a",t,e,n),S("b",t,e,n))];case"Pow":return[r.pow(S("a",t,e,n),S("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(S("a",t,e,n),S("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lte=(t,e,n,r=In)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(S("x",t,e,n))];case"Acos":return[r.acos(S("x",t,e,n))];case"Acosh":return[r.acosh(S("x",t,e,n))];case"Asin":return[r.asin(S("x",t,e,n))];case"Asinh":return[r.asinh(S("x",t,e,n))];case"Atan":return[r.atan(S("x",t,e,n))];case"Atan2":return[r.atan2(S("x",t,e,n),S("y",t,e,n))];case"Atanh":return[r.atanh(S("x",t,e,n))];case"Ceil":return[r.ceil(S("x",t,e,n))];case"Complex":return[r.complex(S("real",t,e,n),S("imag",t,e,n))];case"Cos":return[r.cos(S("x",t,e,n))];case"Cosh":return[r.cosh(S("x",t,e,n))];case"Elu":return[r.elu(S("x",t,e,n))];case"Erf":return[r.erf(S("x",t,e,n))];case"Exp":return[r.exp(S("x",t,e,n))];case"Expm1":return[r.expm1(S("x",t,e,n))];case"Floor":return[r.floor(S("x",t,e,n))];case"Log":return[r.log(S("x",t,e,n))];case"Log1p":return[r.log1p(S("x",t,e,n))];case"Imag":return[r.imag(S("x",t,e,n))];case"Neg":return[r.neg(S("x",t,e,n))];case"Reciprocal":return[r.reciprocal(S("x",t,e,n))];case"Real":return[r.real(S("x",t,e,n))];case"Relu":return[r.relu(S("x",t,e,n))];case"Round":return[r.round(S("x",t,e,n))];case"Selu":return[r.selu(S("x",t,e,n))];case"Sigmoid":return[r.sigmoid(S("x",t,e,n))];case"Sin":return[r.sin(S("x",t,e,n))];case"Sign":return[r.sign(S("x",t,e,n))];case"Sinh":return[r.sinh(S("x",t,e,n))];case"Softplus":return[r.softplus(S("x",t,e,n))];case"Sqrt":return[r.sqrt(S("x",t,e,n))];case"Square":return[r.square(S("x",t,e,n))];case"Tanh":return[r.tanh(S("x",t,e,n))];case"Tan":return[r.tan(S("x",t,e,n))];case"ClipByValue":return[r.clipByValue(S("x",t,e,n),S("clipValueMin",t,e,n),S("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(S("x",t,e,n))];case"Rsqrt":return[r.rsqrt(En(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu(S("x",t,e,n),S("alpha",t,e,n))];case"Prelu":return[r.prelu(S("x",t,e,n),S("alpha",t,e,n))];case"IsNan":return[r.isNaN(En(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(En(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(En(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ds(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){D(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const s=t[r],o=e[r];D(s<0||o<0||s===o,()=>n+` Shapes ${t} and ${e} must match`)}}}function oE(t){return!(typeof t=="number"||t.some(e=>e<0))}function _c(t,e,n){let r=Iv(t,n);const s=!oE(r);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&e.forEach(o=>{r=Iv(o.shape,r)}),!oE(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function Iv(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const s=t[r],o=e[r];if(s>=0&&o>=0&&s!==o)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=s>=0?s:o}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ute{constructor(e,n,r,s,o,i,a){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=s,this.identicalElementShapes=o,this.dynamicSize=i,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=Ze(0),vo(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),ds(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,vo(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,s)=>this.write(r,n[s]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return _o([],[0].concat(this.elementShape));const r=this.readMany(e);return ds(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Qo(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return _o([],[0].concat(this.elementShape));const n=[];for(let s=0;s<this.size();s++)n.push(s);const r=this.readMany(n);return ds(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),cn(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,dl(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const s=e.map(l=>(r+=l,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const o=r===0?0:n.size/r,i=[];Ke(()=>{n=ae(n,[1,r,o]);for(let l=0;l<e.length;++l){const c=[0,l===0?0:s[l-1],0],d=[1,e[l],o];i[l]=ae(Le(n,c,d),this.elementShape)}return i});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rl{get id(){return this.idTensor.id}constructor(e,n,r,s=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e!=null&&e.forEach(o=>{if(r!==o.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${o.dtype}`);ds(n,o.shape,"TensorList shape mismatch: "),vo(o)}),this.idTensor=Ze(0),this.maxNumElements=s,vo(this.idTensor)}copy(){return new rl([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);ds(e,this.elementShape,"TensorList shape mismatch: ");const s=_c(this.elementShape,this.tensors,e);return Ke(()=>{const o=this.tensors.map(i=>ae(i,s));return Qo(o,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=_c(this.elementShape,this.tensors,e),s=this.tensors.pop();return s.kept=!1,ds(s.shape,e,"TensorList shape mismatch: "),ae(s,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(ds(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");vo(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new rl([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);ds(this.tensors[e].shape,n,"TensorList shape mismatch: ");const s=_c(this.elementShape,this.tensors,n);return ae(this.tensors[e],s)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);ds(this.elementShape,n.shape,"TensorList shape mismatch: "),vo(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);ds(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=_c(this.elementShape,this.tensors,r);return e.length===0?_o([],[0].concat(s)):Ke(()=>{const o=e.map(i=>ae(this.tensors[i],s));return Qo(o,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);ds(this.elementShape,n,"TensorList shape mismatch: ");const r=_c(this.elementShape,this.tensors,n);return this.size()===0?_o([],[0].concat(r)):Ke(()=>{const s=this.tensors.map(o=>ae(o,r));return cn(s,0)})}}function cte(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const s=t.shape.slice(1);ds(s,e,"TensorList shape mismatch: ");const o=dl(t);return new rl(o,e,r)}function dte(t,e,n,r){return new rl([],t,e,r)}function fte(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(r!=null&&r!==-1&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const o=new rl([],n,t.dtype,r),i=dl(t,0);return e.forEach((a,l)=>{o.setItem(a,i[l])}),o}function hte(t,e,n){let r=0;const s=e.map(c=>(r+=c,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const o=t.shape.slice(1),i=Iv(o,n),a=r===0?0:t.size/r,l=Ke(()=>{const c=[];t=ae(t,[1,r,a]);for(let d=0;d<e.length;++d){const h=[0,d===0?0:s[d-1],0],p=[1,e[d],a];c[d]=ae(Le(t,h,p),i)}return t.dispose(),c}),u=new rl([],n,t.dtype,e.length);for(let c=0;c<l.length;c++)u.setItem(c,l[c]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pte=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=S("thenBranch",t,e,n),s=S("elseBranch",t,e,n),o=S("cond",t,e,n),i=S("args",t,e,n);return(await o.data())[0]?n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=S("body",t,e,n),s=S("cond",t,e,n),o=S("args",t,e,n),i=await n.functionMap[s].executeFunctionAsync(o,n.tensorArrayMap,n.tensorListMap),a=o.map(c=>c.id);let l=await i[0].data();i.forEach(c=>{!c.kept&&a.indexOf(c.id)===-1&&c.dispose()});let u=o;for(;l[0];){const c=u;u=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const d=u.map(h=>h.id);c.forEach(h=>{!h.kept&&a.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()});const f=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);l=await f[0].data(),f.forEach(h=>{!h.kept&&a.indexOf(h.id)===-1&&d.indexOf(h.id)===-1&&h.dispose()})}return u}case"LoopCond":{const r=S("pred",t,e,n);return[Mo(r)]}case"Switch":{const r=S("pred",t,e,n);let s=S("data",t,e,n);return s.kept||(s=Mo(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=t.inputNames.find(s=>En(s,e,n)!==void 0);if(r){const s=En(r,e,n);return[Mo(s)]}return}case"Enter":{const r=S("frameName",t,e,n),s=S("tensor",t,e,n);return n.enterFrame(r),[Mo(s)]}case"Exit":{const r=S("tensor",t,e,n);return n.exitFrame(),[Mo(r)]}case"NextIteration":{const r=S("tensor",t,e,n);return n.nextIteration(),[Mo(r)]}case"TensorArrayV3":{const r=S("size",t,e,n),s=S("dtype",t,e,n),o=S("elementShape",t,e,n),i=S("dynamicSize",t,e,n),a=S("clearAfterRead",t,e,n),l=S("identicalElementShapes",t,e,n),u=S("name",t,e,n),c=new ute(u,s,r,o,l,i,a);return n.addTensorArray(c),[c.idTensor,Ze(1)]}case"TensorArrayWriteV3":{const r=S("tensorArrayId",t,e,n),s=S("index",t,e,n),o=S("tensor",t,e,n),i=n.getTensorArray(r.id);return i.write(s,o),[i.idTensor]}case"TensorArrayReadV3":{const r=S("tensorArrayId",t,e,n),s=S("index",t,e,n);return[n.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=S("tensorArrayId",t,e,n),s=S("indices",t,e,n),o=S("dtype",t,e,n);return[n.getTensorArray(r.id).gather(s,o)]}case"TensorArrayScatterV3":{const r=S("tensorArrayId",t,e,n),s=S("indices",t,e,n),o=S("tensor",t,e,n),i=n.getTensorArray(r.id);return i.scatter(s,o),[i.idTensor]}case"TensorArrayConcatV3":{const r=S("tensorArrayId",t,e,n),s=n.getTensorArray(r.id),o=S("dtype",t,e,n);return[s.concat(o)]}case"TensorArraySplitV3":{const r=S("tensorArrayId",t,e,n),s=S("tensor",t,e,n),o=S("lengths",t,e,n),i=n.getTensorArray(r.id);return i.split(o,s),[i.idTensor]}case"TensorArraySizeV3":{const r=S("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return[Ze(s.size(),"int32")]}case"TensorArrayCloseV3":{const r=S("tensorArrayId",t,e,n),s=n.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=S("tensorListId",t,e,n),s=S("index",t,e,n),o=S("tensor",t,e,n),i=n.getTensorList(r.id);return i.setItem(s,o),[i.idTensor]}case"TensorListGetItem":{const r=S("tensorListId",t,e,n),s=S("index",t,e,n),o=S("elementShape",t,e,n),i=S("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(s,o,i)]}case"TensorListScatterV2":case"TensorListScatter":{const r=S("indices",t,e,n),s=S("tensor",t,e,n),o=S("elementShape",t,e,n),i=S("numElements",t,e,n),a=fte(s,r,o,i);return n.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=S("elementShape",t,e,n),s=S("elementDType",t,e,n);let o;t.op==="TensorListReserve"?o="numElements":o="maxNumElements";const i=S(o,t,e,n),a=t.op==="TensorListReserve"?-1:i,l=dte(r,s,i,a);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=S("tensorListId",t,e,n),s=S("indices",t,e,n),o=S("elementShape",t,e,n),i=S("elementDType",t,e,n);return[n.getTensorList(r.id).gather(s,i,o)]}case"TensorListStack":{const r=S("tensorListId",t,e,n),s=S("elementShape",t,e,n),o=S("elementDType",t,e,n),i=S("numElements",t,e,n);return[n.getTensorList(r.id).stack(s,o,i)]}case"TensorListFromTensor":{const r=S("tensor",t,e,n),s=S("elementShape",t,e,n),o=S("elementDType",t,e,n),i=cte(r,s,o);return n.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=S("tensorListId",t,e,n),s=n.getTensorList(r.id),o=S("dtype",t,e,n),i=S("elementShape",t,e,n);return[s.concat(o,i)]}case"TensorListPushBack":{const r=S("tensorListId",t,e,n),s=S("tensor",t,e,n),o=n.getTensorList(r.id);return o.pushBack(s),[o.idTensor]}case"TensorListPopBack":{const r=S("tensorListId",t,e,n),s=S("elementShape",t,e,n),o=S("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(s,o)]}case"TensorListSplit":{const r=S("tensor",t,e,n),s=S("elementShape",t,e,n),o=S("lengths",t,e,n),i=hte(r,o,s);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{const r=S("tensorListId",t,e,n),s=n.getTensorList(r.id);return[Ze(s.size(),"int32")]}case"TensorListResize":{const r=S("tensorListId",t,e,n),s=S("size",t,e,n),i=n.getTensorList(r.id).resize(s);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iE(t,e,n){const[r,s]=S("fusedOps",t,e,n),o=r==="biasadd",i=!o,a=s==="prelu",l=r==="fusedbatchnorm",u=S("numArgs",t,e,n);if(o){if(a&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&o&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const c=S("strides",t,e,n),d=Ch(t,e,n),f=S("dataFormat",t,e,n).toUpperCase(),h=S("dilations",t,e,n);let[p,m]=S("args",t,e,n);i&&(m=p,p=void 0);const v=S("leakyreluAlpha",t,e,n);return{stride:c,pad:d,dataFormat:f,dilations:h,biasArg:p,preluArg:m,activationFunc:s,leakyreluAlpha:v}}const mte=(t,e,n,r=In)=>{switch(t.op){case"Conv1D":{const s=S("stride",t,e,n),o=S("pad",t,e,n),i=S("dataFormat",t,e,n).toUpperCase(),a=S("dilation",t,e,n);return[r.conv1d(S("x",t,e,n),S("filter",t,e,n),s,o,i,a)]}case"Conv2D":{const s=S("strides",t,e,n),o=Ch(t,e,n),i=S("dataFormat",t,e,n).toUpperCase(),a=S("dilations",t,e,n);return[r.conv2d(S("x",t,e,n),S("filter",t,e,n),[s[1],s[2]],o,i,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:s,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=iE(t,e,n);return[r.fused.conv2d({x:S("x",t,e,n),filter:S("filter",t,e,n),strides:[s[1],s[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:c,leakyreluAlpha:d}=iE(t,e,n);return[r.fused.depthwiseConv2d({x:S("x",t,e,n),filter:S("filter",t,e,n),strides:[s[1],s[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:c,preluActivationWeights:u,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=S("outputShape",t,e,n),o=S("strides",t,e,n),i=Ch(t,e,n);return[r.conv2dTranspose(S("x",t,e,n),S("filter",t,e,n),s,[o[1],o[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=S("strides",t,e,n),o=Ch(t,e,n),i=S("dilations",t,e,n),a=S("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(S("input",t,e,n),S("filter",t,e,n),[s[1],s[2]],o,a,[i[1],i[2]])]}case"Conv3D":{const s=S("strides",t,e,n),o=S("pad",t,e,n),i=S("dataFormat",t,e,n).toUpperCase(),a=S("dilations",t,e,n);return[r.conv3d(S("x",t,e,n),S("filter",t,e,n),[s[1],s[2],s[3]],o,i,[a[1],a[2],a[3]])]}case"AvgPool":{const s=S("strides",t,e,n),o=S("pad",t,e,n),i=S("kernelSize",t,e,n);return[r.avgPool(S("x",t,e,n),[i[1],i[2]],[s[1],s[2]],o)]}case"MaxPool":{const s=S("strides",t,e,n),o=S("pad",t,e,n),i=S("kernelSize",t,e,n);return[r.maxPool(S("x",t,e,n),[i[1],i[2]],[s[1],s[2]],o)]}case"MaxPoolWithArgmax":{const s=S("strides",t,e,n),o=S("pad",t,e,n),i=S("kernelSize",t,e,n),a=S("includeBatchInIndex",t,e,n),{result:l,indexes:u}=r.maxPoolWithArgmax(S("x",t,e,n),[i[1],i[2]],[s[1],s[2]],o,a);return[l,u]}case"AvgPool3D":{const s=S("strides",t,e,n),o=S("pad",t,e,n),i=S("kernelSize",t,e,n);return[r.avgPool3d(S("x",t,e,n),[i[1],i[2],i[3]],[s[1],s[2],s[3]],o)]}case"MaxPool3D":{const s=S("strides",t,e,n),o=S("pad",t,e,n),i=S("kernelSize",t,e,n);return[r.maxPool3d(S("x",t,e,n),[i[1],i[2],i[3]],[s[1],s[2],s[3]],o)]}case"Dilation2D":{const s=S("strides",t,e,n),o=S("pad",t,e,n),i=S("dilations",t,e,n),a=s[1],l=s[2],u=i[1],c=i[2];return[r.dilation2d(S("x",t,e,n),S("filter",t,e,n),[a,l],o,[u,c],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gte=(t,e,n,r=In)=>{switch(t.op){case"Fill":{const s=S("shape",t,e,n),o=S("dtype",t,e,n),i=S("value",t,e,n);return[r.fill(s,i,o)]}case"LinSpace":{const s=S("start",t,e,n),o=S("stop",t,e,n),i=S("num",t,e,n);return[r.linspace(s,o,i)]}case"Multinomial":{const s=S("logits",t,e,n),o=S("numSamples",t,e,n),i=S("seed",t,e,n);return[r.multinomial(s,o,i)]}case"OneHot":{const s=S("indices",t,e,n),o=S("depth",t,e,n),i=S("onValue",t,e,n),a=S("offValue",t,e,n),l=S("dtype",t,e,n);return[r.oneHot(s,o,i,a,l)]}case"Ones":return[r.ones(S("shape",t,e,n),S("dtype",t,e,n))];case"OnesLike":return[r.onesLike(S("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(S("shape",t,e,n),S("dtype",t,e,n),S("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(S("shape",t,e,n),S("minval",t,e,n),S("maxval",t,e,n),S("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt(S("shape",t,e,n),S("minval",t,e,n),S("maxval",t,e,n),S("seed",t,e,n))];case"Range":{const s=S("start",t,e,n),o=S("stop",t,e,n),i=S("step",t,e,n);return[r.range(s,o,i,S("dtype",t,e,n))]}case"TruncatedNormal":{const s=S("shape",t,e,n),o=S("mean",t,e,n),i=S("stdDev",t,e,n),a=S("seed",t,e,n);return[r.truncatedNormal(s,o,i,S("dtype",t,e,n),a)]}case"Zeros":return[r.zeros(S("shape",t,e,n),S("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(S("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cy(t,e,n){const r=S("boxes",t,e,n),s=S("scores",t,e,n),o=S("maxOutputSize",t,e,n),i=S("iouThreshold",t,e,n),a=S("scoreThreshold",t,e,n),l=S("softNmsSigma",t,e,n);return{boxes:r,scores:s,maxOutputSize:o,iouThreshold:i,scoreThreshold:a,softNmsSigma:l}}const yte=async(t,e,n,r,s=In)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u,softNmsSigma:c}=Cy(t,e,n),d=await s.image.nonMaxSuppressionWithScoreAsync(o,i,a,l,u,c);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=Cy(t,e,n),c=S("padToMaxOutputSize",t,e,n),d=await s.image.nonMaxSuppressionPaddedAsync(o,i,a,l,u,c);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=Cy(t,e,n);return[await s.image.nonMaxSuppressionAsync(o,i,a,l,u)]}case"Where":{const o=s.cast(S("condition",t,e,n),"bool"),i=[await s.whereAsync(o)];return o.dispose(),i}case"ListDiff":return s.setdiff1dAsync(S("x",t,e,n),S("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vte=(t,e,n,r=In)=>{switch(t.op){case"LowerBound":{const s=S("sortedSequence",t,e,n),o=S("values",t,e,n);return[r.lowerBound(s,o)]}case"TopKV2":{const s=S("x",t,e,n),o=S("k",t,e,n),i=S("sorted",t,e,n),a=r.topk(s,o,i);return[a.values,a.indices]}case"UpperBound":{const s=S("sortedSequence",t,e,n),o=S("values",t,e,n);return[r.upperBound(s,o)]}case"Unique":{const s=S("x",t,e,n),o=r.unique(s);return[o.values,o.indices]}case"UniqueV2":{const s=S("x",t,e,n),o=S("axis",t,e,n),i=r.unique(s,o);return[i.values,i.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xte=(t,e,n,r=In)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const s=S("default",t,e,n);return[En(t.name,e,n)||s];case"Placeholder":return[En(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const c=S("x",t,e,n);return[Mo(c)]}case"IdentityN":return S("x",t,e,n).map(c=>Mo(c));case"Snapshot":const o=S("x",t,e,n);return[Mo(o)];case"Shape":return[r.tensor1d(S("x",t,e,n).shape,"int32")];case"ShapeN":return S("x",t,e,n).map(c=>r.tensor1d(c.shape));case"Size":return[r.scalar(S("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(S("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const i=S("x",t,e,n),a=S("data",t,e,n),l=S("message",t,e,n),u=S("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let c=0;c<a.length;c++)console.log(Array.prototype.slice.call(a[c].dataSync()).slice(0,u));return[i];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bte{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=Ze(0),this.tensorMap=new Map,vo(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Ze(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),Ke(()=>{const s=dl(n),o=r.length,i=s.length;D(o===i,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${i} elements.`);for(let a=0;a<o;a++){const l=r[a],u=s[a];vo(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return Ke(()=>{const s=[];for(let o=0;o<r.length;o++){const i=r[o],a=this.findWithDefault(i,n);s.push(a)}return Qo(s)})}findWithDefault(e,n){const r=this.tensorMap.get(e);return r??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wte=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const s=r.getHashTableHandleByName(t.name);if(s!=null)return[s];{const o=S("keyDType",t,e,n),i=S("valueDType",t,e,n),a=new bte(o,i);return r.addHashTable(t.name,a),[a.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const s=S("tableHandle",t,e,n,r),o=S("keys",t,e,n),i=S("values",t,e,n);return[await r.getHashTableById(s.id).import(o,i)]}case"LookupTableFind":case"LookupTableFindV2":{const s=S("tableHandle",t,e,n,r),o=S("keys",t,e,n),i=S("defaultValue",t,e,n);return[await r.getHashTableById(s.id).find(o,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=S("tableHandle",t,e,n,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ste=(t,e,n,r=In)=>{switch(t.op){case"ResizeBilinear":{const s=S("images",t,e,n),o=S("size",t,e,n),i=S("alignCorners",t,e,n),a=S("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(s,[o[0],o[1]],i,a)]}case"ResizeNearestNeighbor":{const s=S("images",t,e,n),o=S("size",t,e,n),i=S("alignCorners",t,e,n),a=S("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(s,[o[0],o[1]],i,a)]}case"CropAndResize":{const s=S("image",t,e,n),o=S("boxes",t,e,n),i=S("boxInd",t,e,n),a=S("cropSize",t,e,n),l=S("method",t,e,n),u=S("extrapolationValue",t,e,n);return[r.image.cropAndResize(s,o,i,a,l,u)]}case"ImageProjectiveTransformV3":{const s=S("images",t,e,n),o=S("transforms",t,e,n),i=S("outputShape",t,e,n),a=S("fillValue",t,e,n),l=S("interpolation",t,e,n),u=S("fillMode",t,e,n);return[r.image.transform(s,o,l.toLowerCase(),u.toLowerCase(),a,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cte=(t,e,n,r=In)=>{switch(t.op){case"Equal":return[r.equal(S("a",t,e,n),S("b",t,e,n))];case"NotEqual":return[r.notEqual(S("a",t,e,n),S("b",t,e,n))];case"Greater":return[r.greater(S("a",t,e,n),S("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(S("a",t,e,n),S("b",t,e,n))];case"Less":return[r.less(S("a",t,e,n),S("b",t,e,n))];case"LessEqual":return[r.lessEqual(S("a",t,e,n),S("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(S("a",t,e,n),S("b",t,e,n))];case"LogicalNot":return[r.logicalNot(S("a",t,e,n))];case"LogicalOr":return[r.logicalOr(S("a",t,e,n),S("b",t,e,n))];case"Select":case"SelectV2":return[r.where(S("condition",t,e,n),S("a",t,e,n),S("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd(S("a",t,e,n),S("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _te=(t,e,n,r=In)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(S("a",t,e,n),S("b",t,e,n),S("transposeA",t,e,n),S("transposeB",t,e,n))];case"Einsum":return[r.einsum(S("equation",t,e,n),...S("tensors",t,e,n))];case"Transpose":return[r.transpose(S("x",t,e,n),S("perm",t,e,n))];case"_FusedMatMul":const[s,o]=S("fusedOps",t,e,n),i=s==="biasadd",a=o==="prelu",l=S("numArgs",t,e,n),u=S("leakyreluAlpha",t,e,n);if(i){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[c,d]=S("args",t,e,n);return[r.fused.matMul({a:S("a",t,e,n),b:S("b",t,e,n),transposeA:S("transposeA",t,e,n),transposeB:S("transposeB",t,e,n),bias:c,activation:o,preluActivationWeights:d,leakyreluAlpha:u})];case"MatrixBandPart":return[r.linalg.bandPart(S("a",t,e,n),S("numLower",t,e,n),S("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ete=(t,e,n,r=In)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(S("x",t,e,n),S("axis",t,e,n),S("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(S("x",t,e,n),S("mean",t,e,n),S("variance",t,e,n),S("offset",t,e,n),S("scale",t,e,n),S("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm(S("x",t,e,n),S("mean",t,e,n),S("variance",t,e,n),S("offset",t,e,n),S("scale",t,e,n),S("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(S("x",t,e,n),S("radius",t,e,n),S("bias",t,e,n),S("alpha",t,e,n),S("beta",t,e,n))];case"Softmax":return[r.softmax(S("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(S("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tte=(t,e,n,r=In)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:s,outputDenseValues:o}=r.raggedGather(S("paramsNestedSplits",t,e,n),S("paramsDenseValues",t,e,n),S("indices",t,e,n),S("outputRaggedRank",t,e,n));return s.concat(o)}case"RaggedRange":{const{rtNestedSplits:s,rtDenseValues:o}=r.raggedRange(S("starts",t,e,n),S("limits",t,e,n),S("splits",t,e,n));return[s,o]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(S("shape",t,e,n),S("values",t,e,n),S("defaultValue",t,e,n),S("rowPartitionTensors",t,e,n),S("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nte=(t,e,n,r=In)=>{switch(t.op){case"Max":{const a=S("axis",t,e,n),l=S("keepDims",t,e,n);return[r.max(S("x",t,e,n),a,l)]}case"Mean":{const a=S("axis",t,e,n),l=S("keepDims",t,e,n);return[r.mean(S("x",t,e,n),a,l)]}case"Min":{const a=S("axis",t,e,n),l=S("keepDims",t,e,n);return[r.min(S("x",t,e,n),a,l)]}case"Sum":{const a=S("axis",t,e,n),l=S("keepDims",t,e,n);return[r.sum(S("x",t,e,n),a,l)]}case"All":{const a=S("axis",t,e,n),l=S("keepDims",t,e,n);return[r.all(S("x",t,e,n),a,l)]}case"Any":{const a=S("axis",t,e,n),l=S("keepDims",t,e,n);return[r.any(S("x",t,e,n),a,l)]}case"ArgMax":{const a=S("axis",t,e,n);return[r.argMax(S("x",t,e,n),a)]}case"ArgMin":{const a=S("axis",t,e,n);return[r.argMin(S("x",t,e,n),a)]}case"Prod":{const a=S("axis",t,e,n),l=S("keepDims",t,e,n);return[r.prod(S("x",t,e,n),a,l)]}case"Cumprod":{const a=S("axis",t,e,n),l=S("exclusive",t,e,n),u=S("reverse",t,e,n);return[r.cumprod(S("x",t,e,n),a,l,u)]}case"Cumsum":{const a=S("axis",t,e,n),l=S("exclusive",t,e,n),u=S("reverse",t,e,n);return[r.cumsum(S("x",t,e,n),a,l,u)]}case"Bincount":const s=S("x",t,e,n),o=S("weights",t,e,n),i=S("size",t,e,n);return[r.bincount(s,o,i)];case"DenseBincount":{const a=S("x",t,e,n),l=S("weights",t,e,n),u=S("size",t,e,n),c=S("binaryOutput",t,e,n);return[r.denseBincount(a,l,u,c)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $te=(t,e,n,r=In)=>{switch(t.op){case"ConcatV2":case"Concat":{const s=S("n",t,e,n),o=S("axis",t,e,n);let i=S("tensors",t,e,n);return i=i.slice(0,s),[r.concat(i,o)]}case"Gather":{const s=S("x",t,e,n),o=S("indices",t,e,n);return[r.gather(s,r.cast(o,"int32"),0)]}case"GatherV2":{const s=S("axis",t,e,n),o=S("batchDims",t,e,n),i=S("x",t,e,n),a=S("indices",t,e,n);return[r.gather(i,r.cast(a,"int32"),s,o)]}case"Reverse":{const s=S("dims",t,e,n),o=[];for(let a=0;a<s.length;a++)s[a]&&o.push(a);const i=S("x",t,e,n);return[r.reverse(i,o)]}case"ReverseV2":{const s=S("axis",t,e,n),o=S("x",t,e,n);return[r.reverse(o,s)]}case"Slice":{const s=S("begin",t,e,n),o=S("size",t,e,n);return[r.slice(S("x",t,e,n),s,o)]}case"StridedSlice":{const s=S("begin",t,e,n),o=S("end",t,e,n),i=S("strides",t,e,n),a=S("beginMask",t,e,n),l=S("endMask",t,e,n),u=S("ellipsisMask",t,e,n),c=S("newAxisMask",t,e,n),d=S("shrinkAxisMask",t,e,n),f=S("x",t,e,n);return[r.stridedSlice(f,s,o,i,a,l,u,c,d)]}case"Pack":return Ke(()=>{const s=S("axis",t,e,n),o=S("tensors",t,e,n),i=o[0].shape,a=r.squeeze(o[0]).shape,l=o.map(u=>{const c=Pt(u.shape,i);if(!c&&!Pt(r.squeeze(u).shape,a))throw new Error("the input tensors shape does not match");return c?u:r.reshape(u,i)});return[r.stack(l,s)]});case"Unpack":{const s=S("axis",t,e,n),o=S("tensor",t,e,n);return r.unstack(o,s)}case"Tile":{const s=S("reps",t,e,n);return[r.tile(S("x",t,e,n),s)]}case"Split":case"SplitV":{const s=S("axis",t,e,n),o=S("numOrSizeSplits",t,e,n),i=S("x",t,e,n);return r.split(i,o,s)}case"ScatterNd":{const s=S("indices",t,e,n),o=S("values",t,e,n),i=S("shape",t,e,n);return[r.scatterND(s,o,i)]}case"GatherNd":{const s=S("x",t,e,n),o=S("indices",t,e,n);return[r.gatherND(s,o)]}case"SparseToDense":{const s=S("sparseIndices",t,e,n),o=S("outputShape",t,e,n),i=S("sparseValues",t,e,n),a=S("defaultValue",t,e,n);return[r.sparseToDense(s,i,o,i.dtype===a.dtype?a:r.cast(a,i.dtype))]}case"TensorScatterUpdate":{const s=S("indices",t,e,n),o=S("values",t,e,n),i=S("tensor",t,e,n);return[r.tensorScatterUpdate(i,s,o)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kte=(t,e,n,r=In)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:o,emptyRowIndicator:i,reverseIndexMap:a}=r.sparse.sparseFillEmptyRows(S("indices",t,e,n),S("values",t,e,n),S("denseShape",t,e,n),S("defaultValue",t,e,n));return[s,o,i,a]}case"SparseReshape":{const{outputIndices:s,outputShape:o}=r.sparse.sparseReshape(S("inputIndices",t,e,n),S("inputShape",t,e,n),S("newShape",t,e,n));return[s,o]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(S("data",t,e,n),S("indices",t,e,n),S("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(S("data",t,e,n),S("indices",t,e,n),S("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ite=(t,e,n,r=In)=>{switch(t.op){case"FFT":return[r.fft(S("x",t,e,n))];case"IFFT":return[r.ifft(S("x",t,e,n))];case"RFFT":return[r.rfft(S("x",t,e,n))];case"IRFFT":return[r.irfft(S("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ote=(t,e,n,r=In)=>{switch(t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(S("input",t,e,n),S("pattern",t,e,n),S("rewrite",t,e,n),S("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:s,nGramsSplits:o}=r.string.stringNGrams(S("data",t,e,n),S("dataSplits",t,e,n),S("separator",t,e,n),S("nGramWidths",t,e,n),S("leftPad",t,e,n),S("rightPad",t,e,n),S("padWidth",t,e,n),S("preserveShortSequences",t,e,n));return[s,o]}case"StringSplit":{const{indices:s,values:o,shape:i}=r.string.stringSplit(S("input",t,e,n),S("delimiter",t,e,n),S("skipEmpty",t,e,n));return[s,o,i]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(S("input",t,e,n),S("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rte=(t,e,n,r=In)=>{switch(t.op){case"Cast":return[r.cast(S("x",t,e,n),S("dtype",t,e,n))];case"ExpandDims":{const s=S("axis",t,e,n);return[r.expandDims(S("x",t,e,n),s)]}case"Squeeze":{const s=S("axis",t,e,n);return[r.squeeze(S("x",t,e,n),s)]}case"Reshape":return[r.reshape(S("x",t,e,n),S("shape",t,e,n))];case"EnsureShape":return[r.ensureShape(S("x",t,e,n),S("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(S("x",t,e,n),S("padding",t,e,n),S("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(S("x",t,e,n),S("padding",t,e,n),S("constantValue",t,e,n))];case"SpaceToBatchND":{const s=S("blockShape",t,e,n),o=S("paddings",t,e,n);return[r.spaceToBatchND(S("x",t,e,n),s,o)]}case"BatchToSpaceND":{const s=S("blockShape",t,e,n),o=S("crops",t,e,n);return[r.batchToSpaceND(S("x",t,e,n),s,o)]}case"DepthToSpace":{const s=S("blockSize",t,e,n),o=S("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(S("x",t,e,n),s,o)]}case"BroadcastTo":return[r.broadcastTo(S("x",t,e,n),S("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(S("s0",t,e,n),S("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aE(t,e,n,r,s=Ke){const o=((i,a,l)=>{switch(i.category){case"arithmetic":return s(()=>ate(i,a,l));case"basic_math":return s(()=>lte(i,a,l));case"control":return pte(i,a,l);case"convolution":return s(()=>mte(i,a,l));case"creation":return s(()=>gte(i,a,l));case"dynamic":return yte(i,a,l);case"evaluation":return s(()=>vte(i,a,l));case"image":return s(()=>Ste(i,a,l));case"graph":return s(()=>xte(i,a,l));case"logical":return s(()=>Cte(i,a,l));case"matrices":return s(()=>_te(i,a,l));case"normalization":return s(()=>Ete(i,a,l));case"ragged":return s(()=>Tte(i,a,l));case"reduction":return s(()=>Nte(i,a,l));case"slice_join":return s(()=>$te(i,a,l));case"sparse":return s(()=>kte(i,a,l));case"spectral":return s(()=>Ite(i,a,l));case"string":return s(()=>Ote(i,a,l));case"transformation":return s(()=>Rte(i,a,l));case"hash_table":return wte(i,a,l,r);case"custom":const u=ZA(i.op);if(u&&u.customExecutor)return u.customExecutor(new ite(i,a,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return Ga(o)?o.then(i=>[].concat(i)):[].concat(o)}class lE{constructor(e={},n={},r={},s={},o){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=s,this.parseNodeNameCache=o,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uE(t,e,n,r){const s=new Set,o=[];let i=null,a=null;const l=new Set,u=new Set(Object.keys(t).map(f=>xr(f)[0]));r=r||[];const c=new Set(r.map(f=>xr(f.name)[0])),d=[...e];for(;d.length>0;){const f=d.pop();if((_a(f)||Bte(f)||Ute(f))&&i==null&&(i=f,a=i.children.map(h=>h.name).filter(h=>s.has(h))),s.add(f.name),n[f.name]==null&&!u.has(f.name)&&!c.has(f.name)){if(f.inputs.length===0){o.push(f.name);continue}f.inputs.forEach(h=>{l.has(h.name)||(l.add(h.name),d.push(h))})}}return{inputs:t,outputs:e,usedNodes:s,missingInputs:o,dynamicNode:i,syncInputs:a}}function Dte(t,e){const{usedNodes:n,inputs:r}=e,s=Object.keys(r).map(v=>xr(v)[0]).map(v=>t.nodes[v]),o=t.initNodes||[],i=v=>n.has(typeof v=="string"?v:v.name);function a(v){return[...new Map(v.map(g=>[g.name,g])).values()]}const l=a([...s,...t.weights,...o]).filter(i),u=a([...l,...Object.values(t.nodes)]).filter(i),c=new Map(u.map(v=>[v.name,v])),d={};for(const v of u){d[v.name]=d[v.name]||0;for(const g of v.children)i(g)||(d[g.name]=Number.POSITIVE_INFINITY),d[g.name]=(d[g.name]||0)+1}const f=Object.entries(d).filter(([,v])=>v===0).map(([v])=>v),h=[...f];for(;f.length>0;){const v=f.pop(),g=c.get(v);for(const x of g.children.filter(i))--d[x.name]===0&&(h.push(x.name),f.push(x.name))}const p=h.map(v=>c.get(v)),m=Ate(p,l);return Pte(m,l),m}function Ate(t,e){const n=new Map(t.map(i=>[i.name,i])),r=e.map(i=>i.name),s=new Set(r);for(;r.length>0;){const i=r.pop(),a=n.get(i);for(const l of a.children)!n.has(l.name)||s.has(l.name)||(s.add(l.name),r.push(l.name))}return t.filter(i=>s.has(i.name))}class qf extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function Pte(t,e){const n=new Map(t.map((a,l)=>[a.name,l])),r=new Set(e.map(a=>a.name)),s=a=>r.has(typeof a=="string"?a:a.name),o=new Set(t.map(a=>a.name)),i=a=>o.has(typeof a=="string"?a:a.name);for(const a of t){for(const l of a.children.filter(i)){if(!n.has(l.name))throw new qf(`Child ${l.name} of node ${a.name} is unreachable.`);if(n.get(a.name)>n.get(l.name))throw new qf(`Node ${a.name} is scheduled to run after its child ${l.name}.`)}if(!s(a))for(const l of a.inputs){if(!n.has(l.name))throw new qf(`Input ${l.name} of node ${a.name} is unreachable.`);if(n.get(l.name)>n.get(a.name))throw new qf(`Node ${a.name} is scheduled to run before its input ${l.name}.`)}}}function Lte(t){const e=new Map(t.map((a,l)=>[a.name,l])),n=Number.MAX_SAFE_INTEGER,r=t.map((a,l)=>_a(a)?n:l),s=a=>{const l=r[e.get(a.name)];return l??-1},o=t.map((a,l)=>a.children.map(s).reduce((u,c)=>Math.max(u,c),r[l])),i=new Map;for(let a=0;a<t.length;++a){const l=o[a];if(l===n)continue;const u=t[a],c=t[l];i.has(c.name)||i.set(c.name,[]),i.get(c.name).push(u)}return i}const Fte=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),Mte=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),jte=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function _a(t){return Fte.has(t.op)}function Bte(t){return Mte.has(t.op)}function Ute(t){return jte.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tp{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(s=>s.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new Tp(e.functions[r],this)})}getCompilationKey(e,n){const r=e.map(o=>o.name).sort(),s=n.map(o=>o.name).sort();return r.join(this.SEPARATOR)+"--"+s.join(this.SEPARATOR)}compile(e,n){const r=uE(e,n,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:o,syncInputs:i}=r;if(o!=null)throw new Error(`This execution contains the node '${o.name}', which has the dynamic op '${o.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(s.length>0){const u=n.map(d=>d.name),c=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${c}]. Missing the following inputs: [${s}]`)}const a=Dte(this.graph,r),l=Lte(a);return{orderedNodes:a,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return vo(n),n}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const s=r.map(f=>this.graph.nodes[xr(f)[0]]),o=n.map(f=>xr(f)[0]),i=new Set(o);let a=o.map(f=>this.graph.nodes[f]);a.length===0&&(a=this._outputs);const l=this.getCompilationKey(s,a);let u=this.compiledMap.get(l);u==null&&(u=this.compile(e,a),this.compiledMap.set(l,u));try{this.keepIntermediateTensors=Y().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){this.keepIntermediateTensors=!1,console.warn(f.message)}const c={},d={};return Ke(()=>{const f=new lE(this.weightMap,c,d,this.functionExecutorMap,this.parseNodeNameCache),h=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(g=>{const[x,b]=xr(g,f),_=[];_[b]=e[g],h[x]=_,this.keepIntermediateTensors&&(this.clonedTensorsMap[x]=this.cloneTensorList(_))});const p=this.getFrozenTensorIds(h),{orderedNodes:m,nodeLiveUntilMap:v}=u;for(const g of m){if(h[g.name])continue;const x=aE(g,h,f,this._resourceManager);if(Ga(x))throw new Error(`The execution of the op '${g.op}' returned a promise. Please use model.executeAsync() instead.`);h[g.name]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[g.name]=this.cloneTensorList(x)),this.checkTensorForDisposalWithNodeLiveUntilInfo(g,h,f,p,i,v.get(g.name))}return this.parent==null&&f.dispose(p),n.map(g=>En(g,h,f))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(s=>s.id)));return new Set(n)}checkTensorForDisposal(e,n,r,s,o,i,a){if(!(_a(n)||i.has(e))){for(const l of r[e])l!=null&&(a[l.id]=(a[l.id]||0)+n.children.length);for(const l of n.inputs){if(_a(l))continue;const u=nE(l.name,r,s);if(u!=null)for(const c of u){if(!c||c.kept||o.has(c.id))continue;const d=a[c.id];d===1?(c.dispose(),delete a[c.id]):d!=null&&a[c.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,r,s,o,i){function a(l){return _a(l)||o.has(l.name)}if(!(_a(e)||i==null))for(const l of i){if(a(l))continue;const u=nE(l.name,n,r);for(const c of u)!c||c.kept||s.has(c.id)||c.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,r=!1,s={},o={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=Y().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(f){this.keepIntermediateTensors=!1,console.warn(f.message)}const i=new lE(this.weightMap,s,o,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const a=await this.executeWithControlFlow(e,i,n,r),l=n.map(f=>En(f,a,i)),u=l.map(f=>f.id),c=Object.keys(e).map(f=>e[f].id),d=new Set([...u,...c,...this.weightIds]);return Object.values(a).forEach(f=>{f.forEach(h=>{h&&!h.isDisposed&&!d.has(h.id)&&h.dispose()})}),this.parent==null&&i.dispose(d),l}async executeFunctionAsync(e,n,r){const s=e.reduce((o,i,a)=>(o[this.inputs[a].name]=i,o),{});return this._executeAsync(s,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,s){const o=Object.keys(e),i=o.map(_=>this.graph.nodes[xr(_)[0]]),a=r.map(_=>xr(_)[0]),l=new Set(a);let u=a.map(_=>this.graph.nodes[_]);u.length===0&&(u=this._outputs);const{usedNodes:c,missingInputs:d,dynamicNode:f,syncInputs:h}=uE(e,u,this.weightMap,this._initNodes),p=[...i,...this.graph.weights,...this._initNodes||[]].map(_=>({node:_,contexts:n.currentContext})),m=Object.assign({},this.weightMap);Object.keys(e).forEach(_=>{const[N,E]=xr(_),R=[];R[E]=e[_],m[N]=R});const v={},g=this.getFrozenTensorIds(m),x={};for(;p.length>0;){const _=this.processStack(i,p,n,m,x,g,l,v,c);await Promise.all(_)}f==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=u.filter(_=>!_a(_)&&!En(_.name,m,n)).map(_=>_.name);if(b.length>0){let _="";throw f!=null&&(_=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${h}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${o}]. Consider providing the following inputs: [${d}]. ${_}`)}return m}processStack(e,n,r,s,o,i,a,l,u){const c=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let f="";if(d.node.op==="Enter"&&S("isConstant",d.node,s,r)&&([f]=Fo(d.node.name,r)),s[d.node.name]==null){const h=aE(d.node,s,r,this._resourceManager);f||([f]=Fo(d.node.name,r));const p=r.currentContext;Ga(h)?c.push(h.then(m=>(s[f]=m,this.keepIntermediateTensors&&(this.clonedTensorsMap[f]=this.cloneTensorList(m)),r.currentContext=p,this.checkTensorForDisposal(f,d.node,s,r,i,a,l),this.processChildNodes(d.node,n,r,s,o,u),m))):(s[f]=h,this.keepIntermediateTensors&&(this.clonedTensorsMap[f]=this.cloneTensorList(h)),this.checkTensorForDisposal(f,d.node,s,r,i,a,l),this.processChildNodes(d.node,n,r,s,o,u))}else this.processChildNodes(d.node,n,r,s,o,u)}return c}processChildNodes(e,n,r,s,o,i){e.children.forEach(a=>{const[l]=Fo(a.name,r);o[l]||!i.has(a.name)||(a.op==="Merge"?a.inputNames.some(u=>!!En(u,s,r))&&(o[l]=!0,n.push({contexts:r.currentContext,node:a})):a.inputNames.every(u=>!!En(u,s,r))&&(o[l]=!0,n.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[s]=xr(n),o=this.graph.nodes[s];if(o.attrParams.shape&&o.attrParams.shape.value){const i=o.attrParams.shape.value,a=i.length===r.shape.length&&r.shape.every((l,u)=>i[u]===-1||i[u]===l);D(a,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${i}], but was [${r.shape}]`)}o.attrParams.dtype&&o.attrParams.dtype.value&&D(r.dtype===o.attrParams.dtype.value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var n,r;const s={};for(const o in e){const i=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[o];i!=null?s[i.name]=e[o]:s[o]=e[o]}return s}checkInputs(e){const n=Object.keys(e).filter(r=>{const[s]=xr(r);return this.graph.nodes[s]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var r,s;const o=(s=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||s===void 0?void 0:s[n];return o!=null?o.name:n},{})}checkOutputs(e){e.forEach(n=>{const[r]=xr(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class zte{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wte="?tfjs-format=file",Vte="model.json";class Gte{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},r=LR){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new zte}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Ga(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await kO(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const r=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const o=this.artifacts.userDefinedMetadata;o.signature!=null&&(s=o.signature),o.structuredOutputKeys!=null&&(this.structuredOutputKeys=o.structuredOutputKeys)}if(this.signature=s,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new Tp(rE.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const o=rE.Instance.transformGraph(e.modelInitializer);this.initializer=new Tp(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof Yn?[e]:e,r={};return n.forEach((s,o)=>r[this.structuredOutputKeys[o]]=s),r}return e}predict(e,n){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,n){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var n;if(!(e instanceof Yn)&&!Array.isArray(e)){const o=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(o!=null)for(const i in o){const a=o[i];a.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[a.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let s=0;return this.inputNodes.reduce((o,i)=>{var a,l,u;const c=(u=(l=(a=this.signature)===null||a===void 0?void 0:a.inputs)===null||l===void 0?void 0:l[i])===null||u===void 0?void 0:u.resourceId;return c!=null?o[i]=this.resourceIdToCapturedInput[c]:o[i]=e[s++],o},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,r=Object.keys(n);for(let s=0;s<r.length;s++){const o=r[s],i=n[o];this.resourceIdToCapturedInput[i.resourceId]=e[s]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Kt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function cE(t,e={},n=LR){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=Hte(t));const r=new Gte(t,e,n);return await r.load(),r}function Hte(t){return t.endsWith("/")||(t=t+"/"),`${t}${Vte}${Wte}`}const qte=(t,e)=>{t.current!==void 0&&e.current!==void 0||g5().then(async()=>{Y().set("WEBGL_EXP_CONV",!0),Y().set("WEBGL_PACK",!1),Y().set("ENGINE_COMPILE_ONLY",!0);const n=ta([1,ln,an,3]),r=await cE("480S_pieces_float16/model.json"),s=r.execute(n),o=await cE("480L_xcorners_float16/model.json"),i=o.execute(n);Kt([n,s,i]);const a=TO();a.checkCompileCompletion(),a.getUniformLocations(),Y().set("ENGINE_COMPILE_ONLY",!1),t.current=r,e.current=o})},Kte=({piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,sidebarRef:s,playing:o,setPlaying:i,text:a,setText:l,digital:u,setDigital:c,cornersRef:d})=>w.jsxs(Qd,{sidebarRef:s,children:[w.jsx("li",{className:"my-1",children:w.jsx(gb,{videoRef:n})}),w.jsx("li",{className:"my-1",children:w.jsx(Lm,{piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,setText:l})}),w.jsx("li",{className:"my-1",children:w.jsx(tP,{piecesModelRef:t,videoRef:n,canvasRef:r,setText:l,cornersRef:d})}),w.jsx("li",{className:"my-1",children:w.jsxs("div",{className:"btn-group w-100",role:"group",children:[w.jsx(Zx,{playing:o,setPlaying:i}),w.jsx(iA,{setPlaying:i,setText:l})]})}),w.jsx("li",{className:"border-top"}),w.jsx("li",{className:"my-1",children:w.jsx(Yd,{text:a})}),w.jsx("li",{className:"border-top"}),w.jsx("li",{className:"my-1",children:w.jsxs("div",{className:"btn-group w-100",role:"group",children:[w.jsx(Fm,{digital:u,setDigital:c}),w.jsx(Mm,{setText:l,playing:o}),w.jsx(Uu,{})]})})]}),Xte=({videoRef:t,playing:e,setPlaying:n})=>{const r=s=>{s.preventDefault(),t.current.src.startsWith("blob")&&n(!e)};return w.jsx(oo,{onClick:r,children:w.jsx(pl,{iconName:e?"bi-pause":"bi-play"})})},Yte=({videoRef:t,setText:e})=>{const n=Ns(),r=s=>{s.preventDefault(),t.current.currentTime=0,n(Bu()),n(Xd()),e(["Rewound video","Reset PGN to start position"])};return w.jsx(oo,{onClick:r,children:w.jsx(pl,{iconName:"bi-skip-start"})})},Qte=({videoRef:t,canvasRef:e,setPlaying:n})=>{const r=L.useRef(null),[s,o]=L.useState(!1),i=()=>{if(t.current.src!==void 0){const u=t.current.src;t.current.src="",URL.revokeObjectURL(u)}PD(e.current.getContext("2d")),o(!1),r.current.value="",t.current.style.display="none"},a=u=>{const c=URL.createObjectURL(u.target.files[0]);t.current.src=c,t.current.style.display="block",o(!0)},l=()=>{s===!1?r.current.click():i(),n(!1)};return w.jsxs(w.Fragment,{children:[w.jsx("input",{type:"file",accept:"video/*",style:{display:"none"},onChange:a,ref:r}),w.jsx(oo,{onClick:l,children:w.jsx(pl,{iconName:s?"bi-folder-x":"bi-folder"})})]})},Zte=({videoRef:t})=>{const e=({playbackRate:n})=>{const r=s=>{s.preventDefault(),t.current.playbackRate=n};return w.jsxs("button",{type:"button",className:"btn btn-secondary btn-dark btn-outline-light w-100",onClick:r,children:[n,"x"]})};return w.jsxs("div",{className:"btn-group w-100",role:"group",children:[w.jsx(e,{playbackRate:1}),w.jsx(e,{playbackRate:2}),w.jsx(e,{playbackRate:4})]})},Jte=({videoRef:t,setPlaying:e,setText:n})=>{const r=Ns(),s=o=>{o.preventDefault(),t.current.src.startsWith("blob")&&(e(!1),r(Bu()),r(Xd()),n(["Reset to start position"]))};return w.jsx(oo,{onClick:s,children:w.jsx(pl,{iconName:"bi-stop"})})},ene=(t,e)=>{let n=t.fen();const r=e==="w"?"b":"w";n=n.replace(` ${r} `,` ${e} `);let s=null;for(let o=0;o<64;o++){const i=wp[o],a=t.get(i),l=a.type==="k",u=a.color===r,c=t.isAttacked(i,e);if(l&&u&&c)return s="Side to move has opponent in check",{fen:n,error:s}}return{fen:n,error:s}},tne=(t,e,n,r)=>{const s=Array(64).fill(-1);let o=-1,i=-1;for(let h=0;h<64;h++){const p=t[h][1];p>o&&(o=p,i=h)}s[i]=1;let a=-1,l=-1;for(let h=0;h<64;h++){if(h==i)continue;const p=t[h][7];p>a&&(a=p,l=h)}s[l]=7;const u=[0,2,3,4,5,6,8,9,10,11];for(let h=0;h<64;h++){if(s[h]!==-1)continue;let p=null,m=.3;u.forEach(v=>{const g=wp[h],x=g[1]==="1"||g[1]==="8";if(u_[v%6]==="p"&&x)return;const _=t[h][v];_>m&&(p=v,m=_)}),p!==null&&(s[h]=p)}const c=new Jx;c.clear();for(let h=0;h<64;h++){if(s[h]===-1)continue;const p=u_[s[h]%6],m=s[h]>5?"w":"b",v=wp[h];c.put({type:p,color:m},v)}const{fen:d,error:f}=ene(c,e);f===null?(n(sA(d)),n(cY(d)),n(Bu()),r(["Set starting FEN"])):r(["Invalid FEN:",f])},nne=async({piecesModelRef:t,videoRef:e,cornersRef:n,canvasRef:r,dispatch:s,setText:o,color:i})=>{if(Xx(e))return;const a=$A(n,r),l=HD(a),u=qD(l),c=KD(l),{boxes:d,scores:f,cls:h}=await NA(t,e,a),p=EA(d,u,c),m=TA(f,h,p);tne(m,i,s,o),_A(r.current,u,c,m),Kt([d,f,h])},rne=async({piecesModelRef:t,videoRef:e,cornersRef:n,canvasRef:r,dispatch:s,setText:o,color:i})=>{const a=Cu().numTensors;await nne({piecesModelRef:t,videoRef:e,cornersRef:n,canvasRef:r,dispatch:s,setText:o,color:i});const l=Cu().numTensors;return a<l&&console.error(`Memory Leak! (${l} > ${a})`),()=>{dx()}},tP=({piecesModelRef:t,videoRef:e,canvasRef:n,setText:r,cornersRef:s})=>{const o=["Normal","Infer (White to move)","Infer (Black to move)"],i=Ns(),[a,l]=L.useState(o[0]),u=(c,d)=>{if(c.preventDefault(),d==="Normal")i(oA()),i(Bu()),i(Xd());else{const f=d.includes("White to move")?"w":"b";rne({piecesModelRef:t,videoRef:e,cornersRef:s,canvasRef:n,dispatch:i,setText:r,color:f})}l(d)};return w.jsxs("div",{className:"dropdown",children:[w.jsxs("button",{className:"btn btn-dark btn-sm btn-outline-light dropdown-toggle w-100",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false",children:["Start: ",a]}),w.jsx("ul",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton1",children:o.map(c=>w.jsx("li",{children:w.jsx("a",{onClick:d=>u(d,c),className:"dropdown-item",href:"#",children:c})},c))})]})},sne=({videoRef:t,xcornersModelRef:e,piecesModelRef:n,canvasRef:r,sidebarRef:s,text:o,setText:i,playing:a,setPlaying:l,digital:u,setDigital:c,cornersRef:d})=>w.jsxs(Qd,{sidebarRef:s,children:[w.jsx("li",{className:"my-1",children:w.jsx(Qte,{videoRef:t,canvasRef:r,setPlaying:l})}),w.jsx("li",{className:"my-1",children:w.jsx(Lm,{piecesModelRef:n,xcornersModelRef:e,videoRef:t,canvasRef:r,setText:i})}),w.jsx("li",{className:"my-1",children:w.jsx(tP,{piecesModelRef:n,videoRef:t,canvasRef:r,setText:i,cornersRef:d})}),w.jsx("li",{className:"my-1",children:w.jsxs("div",{className:"btn-group w-100",role:"group",children:[w.jsx(Xte,{videoRef:t,playing:a,setPlaying:l}),w.jsx(Jte,{videoRef:t,setPlaying:l,setText:i}),w.jsx(Yte,{videoRef:t,setText:i})]})}),w.jsx("li",{className:"my-1",children:w.jsx(Zte,{videoRef:t})}),w.jsx("li",{className:"border-top"}),w.jsx("li",{className:"my-1",children:w.jsx(Yd,{text:o})}),w.jsx("li",{className:"border-top"}),w.jsx("li",{className:"my-1",children:w.jsxs("div",{className:"btn-group w-100",role:"group",children:[w.jsx(Fm,{digital:u,setDigital:c}),w.jsx(Mm,{setText:i,playing:a}),w.jsx(Uu,{})]})})]}),one=({setBoardNumber:t})=>{const e=n=>{t(parseInt(n.target.value))};return w.jsxs("div",{className:"text-white",children:[w.jsx("label",{className:"form-check-label",htmlFor:"board",children:"Board:"}),w.jsx("input",{type:"number",id:"board",onChange:e,min:1,max:64})]})},ine=({piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,sidebarRef:s,playing:o,setPlaying:i,text:a,setText:l,digital:u,setDigital:c,study:d,setStudy:f,setBoardNumber:h})=>w.jsxs(Qd,{sidebarRef:s,children:[w.jsx("li",{className:"my-1",children:w.jsx(gb,{videoRef:n})}),w.jsx("li",{className:"my-1",children:w.jsx(Lm,{piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,setText:l})}),w.jsx("li",{className:"my-1",children:w.jsxs("div",{className:"btn-group w-100",role:"group",children:[w.jsx(Zx,{playing:o,setPlaying:i}),w.jsx(iA,{setPlaying:i,setText:l})]})}),w.jsx("li",{className:"my-1",children:w.jsx(aP,{study:d,setStudy:f,onlyBroadcasts:!0})}),w.jsx("li",{className:"my-1",children:w.jsx(one,{setBoardNumber:h})}),w.jsx("li",{className:"border-top"}),w.jsx("li",{className:"my-1",children:w.jsx(Yd,{text:a})}),w.jsx("li",{className:"border-top"}),w.jsx("li",{className:"my-1",children:w.jsxs("div",{className:"btn-group w-100",role:"group",children:[w.jsx(Fm,{digital:u,setDigital:c}),w.jsx(Mm,{setText:l,playing:o}),w.jsx(Uu,{})]})})]}),ane=({setGameId:t,setColor:e,setText:n})=>{const r=ei().token,[s,o]=L.useState([]),[i,a]=L.useState(null),l=Ns(),u=async(d,f)=>{if(d.preventDefault(),(i==null?void 0:i.fullId)===f.fullId)return;a(f),t(f.gameId),e(f.color==="white"?"w":"b");const h=f.color==="white"?"White":"Black",p=f.opponent.username;n(["Starting game",`${h} vs ${p}`]);const m=new Jx(f.fen),v=tb(m);l(nb(v)),l(sA(f.fen))},c=async d=>{d.preventDefault();const f=await sU(r);o(f.nowPlaying)};return w.jsxs("div",{className:"dropdown",children:[w.jsx("button",{className:"btn btn-dark btn-sm btn-outline-light dropdown-toggle w-100",id:"deviceButton","data-bs-toggle":"dropdown","aria-expanded":"false",onClick:d=>c(d),children:i===null?"Select a Game":`Game: ${i.opponent.username}`}),w.jsx("ul",{className:"dropdown-menu","aria-labelledby":"deviceButton",children:s.map(d=>w.jsx("li",{children:w.jsxs("a",{onClick:f=>u(f,d),className:"dropdown-item",href:"#",children:[d.opponent.username," (",d.gameId,")"]})},d.fullId))})]})},lne=({piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,sidebarRef:s,playing:o,setPlaying:i,text:a,setText:l,digital:u,setDigital:c})=>{const d=ei().token,f=Kd(),h=L.useRef(f),[p,m]=L.useState(),[v,g]=L.useState(),x=Ns();L.useEffect(()=>{h.current=f},[f]),L.useEffect(()=>{const _=h.current.fen.split(" ")[1],N=h.current.lastMove;_===v||N===""||p===void 0||v===void 0||oU(d,p,N)},[h.current]);const b=async _=>{const N=_.moves;if(N===void 0)return;const E=N.split(" "),R=E[E.length-1];if(R===h.current.lastMove)return;const P=dv(h.current);P.move(R);const B=tb(P);console.log("payload",B),x(nb(B))};return L.useEffect(()=>{p!==void 0&&rU(d,b,p)},[p]),w.jsxs(Qd,{sidebarRef:s,children:[w.jsx("li",{className:"my-1",children:w.jsx(gb,{videoRef:n})}),w.jsx("li",{className:"my-1",children:w.jsx(ane,{setGameId:m,setColor:g,setText:l})}),w.jsx("li",{className:"my-1",children:w.jsx(Lm,{piecesModelRef:t,xcornersModelRef:e,videoRef:n,canvasRef:r,setText:l})}),w.jsx("li",{className:"my-1",children:w.jsx("div",{className:"btn-group w-100",role:"group",children:w.jsx(Zx,{playing:o,setPlaying:i})})}),w.jsx("li",{className:"border-top"}),w.jsx("li",{className:"my-1",children:w.jsx(Yd,{text:a})}),w.jsx("li",{className:"border-top"}),w.jsx("li",{className:"my-1",children:w.jsxs("div",{className:"btn-group w-100",role:"group",children:[w.jsx(Fm,{digital:u,setDigital:c}),w.jsx(Mm,{setText:l,playing:o}),w.jsx(Uu,{})]})})]})};var pb={};pb.match=pne;pb.parse=nP;var une=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,cne=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,dne=/^(?:(min|max)-)?(.+)/,fne=/(em|rem|px|cm|mm|in|pt|pc)?$/,hne=/(dpi|dpcm|dppx)?$/;function pne(t,e){return nP(t).some(function(n){var r=n.inverse,s=n.type==="all"||e.type===n.type;if(s&&r||!(s||r))return!1;var o=n.expressions.every(function(i){var a=i.feature,l=i.modifier,u=i.value,c=e[a];if(!c)return!1;switch(a){case"orientation":case"scan":return c.toLowerCase()===u.toLowerCase();case"width":case"height":case"device-width":case"device-height":u=hE(u),c=hE(c);break;case"resolution":u=fE(u),c=fE(c);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":u=dE(u),c=dE(c);break;case"grid":case"color":case"color-index":case"monochrome":u=parseInt(u,10)||1,c=parseInt(c,10)||0;break}switch(l){case"min":return c>=u;case"max":return c<=u;default:return c===u}});return o&&!r||!o&&r})}function nP(t){return t.split(",").map(function(e){e=e.trim();var n=e.match(une),r=n[1],s=n[2],o=n[3]||"",i={};return i.inverse=!!r&&r.toLowerCase()==="not",i.type=s?s.toLowerCase():"all",o=o.match(/\([^\)]+\)/g)||[],i.expressions=o.map(function(a){var l=a.match(cne),u=l[1].toLowerCase().match(dne);return{modifier:u[1],feature:u[2],value:l[2]}}),i})}function dE(t){var e=Number(t),n;return e||(n=t.match(/^(\d+)\s*\/\s*(\d+)$/),e=n[1]/n[2]),e}function fE(t){var e=parseFloat(t),n=String(t).match(hne)[1];switch(n){case"dpcm":return e/2.54;case"dppx":return e*96;default:return e}}function hE(t){var e=parseFloat(t),n=String(t).match(fne)[1];switch(n){case"em":return e*16;case"rem":return e*16;case"cm":return e*96/2.54;case"mm":return e*96/2.54/10;case"in":return e*96;case"pt":return e*72;case"pc":return e*72/12;default:return e}}var mne=pb.match,pE=typeof window<"u"?window.matchMedia:null;function gne(t,e,n){var r=this,s;pE&&!n&&(s=pE.call(window,t)),s?(this.matches=s.matches,this.media=s.media,s.addListener(a)):(this.matches=mne(t,e),this.media=t),this.addListener=o,this.removeListener=i,this.dispose=l;function o(u){s&&s.addListener(u)}function i(u){s&&s.removeListener(u)}function a(u){r.matches=u.matches,r.media=u.media}function l(){s&&s.removeListener(a)}}function yne(t,e,n){return new gne(t,e,n)}var vne=yne;const xne=$u(vne);var bne=/[A-Z]/g,wne=/^ms-/,_y={};function Sne(t){return"-"+t.toLowerCase()}function rP(t){if(_y.hasOwnProperty(t))return _y[t];var e=t.replace(bne,Sne);return _y[t]=wne.test(e)?"-"+e:e}function Cne(t,e){if(t===e)return!0;if(!t||!e)return!1;const n=Object.keys(t),r=Object.keys(e),s=n.length;if(r.length!==s)return!1;for(let o=0;o<s;o++){const i=n[o];if(t[i]!==e[i]||!Object.prototype.hasOwnProperty.call(e,i))return!1}return!0}const ir=qe.oneOfType([qe.string,qe.number]),mb={all:qe.bool,grid:qe.bool,aural:qe.bool,braille:qe.bool,handheld:qe.bool,print:qe.bool,projection:qe.bool,screen:qe.bool,tty:qe.bool,tv:qe.bool,embossed:qe.bool},sP={orientation:qe.oneOf(["portrait","landscape"]),scan:qe.oneOf(["progressive","interlace"]),aspectRatio:qe.string,deviceAspectRatio:qe.string,height:ir,deviceHeight:ir,width:ir,deviceWidth:ir,color:qe.bool,colorIndex:qe.bool,monochrome:qe.bool,resolution:ir,type:Object.keys(mb)},{type:Uge,..._ne}=sP,oP={minAspectRatio:qe.string,maxAspectRatio:qe.string,minDeviceAspectRatio:qe.string,maxDeviceAspectRatio:qe.string,minHeight:ir,maxHeight:ir,minDeviceHeight:ir,maxDeviceHeight:ir,minWidth:ir,maxWidth:ir,minDeviceWidth:ir,maxDeviceWidth:ir,minColor:qe.number,maxColor:qe.number,minColorIndex:qe.number,maxColorIndex:qe.number,minMonochrome:qe.number,maxMonochrome:qe.number,minResolution:ir,maxResolution:ir,..._ne},Ene={...mb,...oP};var Tne={all:Ene,types:mb,matchers:sP,features:oP};const Nne=t=>`not ${t}`,$ne=(t,e)=>{const n=rP(t);return typeof e=="number"&&(e=`${e}px`),e===!0?n:e===!1?Nne(n):`(${n}: ${e})`},kne=t=>t.join(" and "),Ine=t=>{const e=[];return Object.keys(Tne.all).forEach(n=>{const r=t[n];r!=null&&e.push($ne(n,r))}),kne(e)},One=L.createContext(void 0),Rne=t=>t.query||Ine(t),mE=t=>t?Object.keys(t).reduce((n,r)=>(n[rP(r)]=t[r],n),{}):void 0,iP=()=>{const t=L.useRef(!1);return L.useEffect(()=>{t.current=!0},[]),t.current},Dne=t=>{const e=L.useContext(One),n=()=>mE(t)||mE(e),[r,s]=L.useState(n);return L.useEffect(()=>{const o=n();Cne(r,o)||s(o)},[t,e]),r},Ane=t=>{const e=()=>Rne(t),[n,r]=L.useState(e);return L.useEffect(()=>{const s=e();n!==s&&r(s)},[t]),n},Pne=(t,e)=>{const n=()=>xne(t,e||{},!!e),[r,s]=L.useState(n),o=iP();return L.useEffect(()=>{if(o){const i=n();return s(i),()=>{i&&i.dispose()}}},[t,e]),r},Lne=t=>{const[e,n]=L.useState(t.matches);return L.useEffect(()=>{const r=s=>{n(s.matches)};return t.addListener(r),n(t.matches),()=>{t.removeListener(r)}},[t]),e},Fne=(t,e,n)=>{const r=Dne(e),s=Ane(t);if(!s)throw new Error("Invalid or missing MediaQuery!");const o=Pne(s,r),i=Lne(o),a=iP();return L.useEffect(()=>{a&&n&&n(i)},[i]),L.useEffect(()=>()=>{o&&o.dispose()},[]),i},Mne=()=>w.jsx("h1",{className:"text-white text-center w-100 p-3 h-2",children:"Please use your device in landscape mode"}),Kf=({mode:t})=>{const e=LM(),n=Ns(),r=JD(),s=ei().token,o=Kd().moves,i=Fne({orientation:"portrait"}),[a,l]=L.useState([]),[u,c]=L.useState(!1),[d,f]=L.useState(null),[h,p]=L.useState(-1),[m,v]=L.useState(!1),g=L.useRef(null),x=L.useRef(u),b=L.useRef(null),_=L.useRef(null),N=L.useRef(r);L.useEffect(()=>{t!=="broadcast"||d===null||h===-1||ZB(s,d.id).then(P=>{const B=P.split(/\n\n\n/);let F="";B.forEach(oe=>{oe.includes(`[Board "${h}"]`)&&(F=oe)});let H;if(F==="")H=['[Result "*"]',`[FEN "${lv}"]`,`[Board "${h}"]`,`[Site "${h}"]`,'[Annotator "ChessCam"]'];else{const oe=F.match(/\[(.*?)\]/g);if(oe===null)throw Error(`Could not find any tags in ${F}`);H=oe.filter(de=>{const V=["[Event","[Annotator","[Variant","[ECO","[Opening","[UTCDate","[UTCTime"];for(let W=0;W<V.length;W++)if(de.startsWith(V[W]))return!1;return!0})}const ee=[...H,"",o].join("\r");nU(s,ee,d.id)})},[o]),L.useEffect(()=>{x.current=u},[u]),L.useEffect(()=>{N.current=r},[r]),L.useEffect(()=>{qte(e.piecesModelRef,e.xcornersModelRef),n(AX()),n(oA()),n(Bu()),n(Xd())},[]);const E={playing:u,text:a,digital:m,study:d,setPlaying:c,setText:l,setDigital:v,setBoardNumber:p,setStudy:f,piecesModelRef:e.piecesModelRef,xcornersModelRef:e.xcornersModelRef,videoRef:g,canvasRef:b,sidebarRef:_,cornersRef:N,playingRef:x,mode:t},R=()=>{switch(t){case"record":return w.jsx(Kte,{...E});case"upload":return w.jsx(sne,{...E});case"play":return w.jsx(lne,{...E});case"broadcast":return w.jsx(ine,{...E})}};return w.jsx(CA,{children:i?w.jsx(Mne,{}):w.jsxs(w.Fragment,{children:[R(),w.jsx(vee,{...E})]})})},aP=({study:t,setStudy:e,onlyBroadcasts:n})=>{const[r,s]=L.useState([]),o=ei();L.useEffect(()=>{JB(o.token,s,o.username,n)},[]);const i=(a,l)=>{a.preventDefault(),e(l)};return w.jsxs("div",{className:"dropdown",children:[w.jsx("button",{className:"btn btn-dark btn-sm btn-outline-light dropdown-toggle w-100",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false",children:t===null?"Select a Study":`Study: ${t.name}`}),w.jsx("ul",{className:"dropdown-menu","aria-labelledby":"dropdownMenuButton1",children:r.map(a=>w.jsx("li",{children:w.jsxs("a",{onClick:l=>i(l,a),className:"dropdown-item",href:"#",children:[a.name," (",a.id,")"]})},a.id))})]})},gb=({videoRef:t})=>{const[e,n]=L.useState([]),[r,s]=L.useState(null),o=async(i,a)=>{if(i.preventDefault(),(r==null?void 0:r.deviceId)===a.deviceId)return;s(a);const l={...AD};l.video.deviceId=a.deviceId;const u=await navigator.mediaDevices.getUserMedia(l);t.current.srcObject=u};return L.useEffect(()=>{const i=[];navigator.mediaDevices.enumerateDevices().then(a=>{a.forEach(l=>{l.kind=="videoinput"&&i.push(l)})}).catch(a=>{console.error(`${a.name}: ${a.message}`)}),n(i)},[]),w.jsxs("div",{className:"dropdown",children:[w.jsx("button",{className:"btn btn-dark btn-sm btn-outline-light dropdown-toggle w-100",id:"deviceButton","data-bs-toggle":"dropdown","aria-expanded":"false",children:r===null?"Select a Device":`Device: ${r.label.split("(")[0]}`}),w.jsx("ul",{className:"dropdown-menu","aria-labelledby":"deviceButton",children:e.map(i=>w.jsx("li",{children:w.jsx("a",{onClick:a=>o(a,i),className:"dropdown-item",href:"#",children:i.label.split("(")[0]})},i.deviceId))})]})},jne=({study:t,setText:e,pgn:n})=>{const r=ei().token,s=()=>{const i=new Date,a=i.getFullYear(),l=String(i.getMonth()+1).padStart(2,"0"),u=String(i.getDate()).padStart(2,"0"),c=String(i.getHours()).padStart(2,"0"),d=String(i.getMinutes()).padStart(2,"0"),f=String(i.getSeconds()).padStart(2,"0");return`${a}-${l}-${u}-${c}-${d}-${f}`},o=async()=>{if(t===null){e(["Please select a study"]);return}const i=s();tU(r,n,i,t.id),e(["Exported game to",`"${t.name}/${i}"`])};return w.jsx(oo,{onClick:o,children:"Export Game"})},Bne=({pgn:t})=>{const[e,n]=L.useState(null),[r,s]=L.useState(["Select a study","Export the game"]);return w.jsxs(Qd,{children:[w.jsx("li",{className:"border-top"}),w.jsx("li",{className:"my-2",children:w.jsx(aP,{study:e,setStudy:n,onlyBroadcasts:!1})}),w.jsx("li",{className:"my-2",children:w.jsx(jne,{study:e,setText:s,pgn:t})}),w.jsx("li",{className:"border-top"}),w.jsx("li",{className:"my-2",children:w.jsx(Yd,{text:r})}),w.jsx("li",{className:"border-top"}),w.jsx("li",{className:"my-2",children:w.jsx(Uu,{})})]})},Une=({pgn:t})=>{const[e,n]=L.useState(""),r=ei().token,s=async()=>{const i=`https://lichess.org/embed/game/${(await eU(r,t)).id}?theme=brown&bg=dark`;n(i)};return L.useEffect(()=>{s()},[]),w.jsx("div",{className:"ratio ratio-21x9",children:w.jsx("iframe",{src:e})})},zne=()=>{const t=eb(Kd());return w.jsxs(CA,{children:[w.jsx(Bne,{pgn:t}),w.jsx(Une,{pgn:t})]})},Wne=()=>w.jsxs("div",{className:"page",children:[w.jsx("div",{className:"header",children:w.jsx("div",{className:"container",children:w.jsx("p",{className:"title",children:"Privacy Policy for ChessCam"})})}),w.jsx("div",{className:"translations-content-container",children:w.jsx("div",{className:"container",children:w.jsxs("div",{className:"tab-content translations-content-item en visible",id:"en",children:[w.jsx("h1",{children:"Privacy Policy"}),w.jsx("p",{children:"Last updated: December 08, 2023"}),w.jsx("p",{children:"This Privacy Policy describes Our policies and procedures on the collection, use and disclosure of Your information when You use the Service and tells You about Your privacy rights and how the law protects You."}),w.jsx("p",{children:"We use Your Personal data to provide and improve the Service. By using the Service, You agree to the collection and use of information in accordance with this Privacy Policy."}),w.jsx("h2",{children:"Interpretation and Definitions"}),w.jsx("h3",{children:"Interpretation"}),w.jsx("p",{children:"The words of which the initial letter is capitalized have meanings defined under the following conditions. The following definitions shall have the same meaning regardless of whether they appear in singular or in plural."}),w.jsx("h3",{children:"Definitions"}),w.jsx("p",{children:"For the purposes of this Privacy Policy:"}),w.jsxs("ul",{children:[w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"Account"})," means a unique account created for You to access our Service or parts of our Service."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"Affiliate"}),' means an entity that controls, is controlled by or is under common control with a party, where "control" means ownership of 50% or more of the shares, equity interest or other securities entitled to vote for election of directors or other managing authority.']})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"Application"})," refers to ChessCam, the software program provided by the Company."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"Company"}),' (referred to as either "the Company", "We", "Us" or "Our" in this Agreement) refers to ChessCam.']})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"Country"})," refers to: United Kingdom"]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"Device"})," means any device that can access the Service such as a computer, a cellphone or a digital tablet."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"Personal Data"})," is any information that relates to an identified or identifiable individual."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"Service"})," refers to the Application."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"Service Provider"})," means any natural or legal person who processes the data on behalf of the Company. It refers to third-party companies or individuals employed by the Company to facilitate the Service, to provide the Service on behalf of the Company, to perform services related to the Service or to assist the Company in analyzing how the Service is used."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"Usage Data"})," refers to data collected automatically, either generated by the use of the Service or from the Service infrastructure itself (for example, the duration of a page visit)."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"You"})," means the individual accessing or using the Service, or the company, or other legal entity on behalf of which such individual is accessing or using the Service, as applicable."]})})]}),w.jsx("h2",{children:"Collecting and Using Your Personal Data"}),w.jsx("h3",{children:"Types of Data Collected"}),w.jsx("h4",{children:"Personal Data"}),w.jsx("p",{children:"While using Our Service, We may ask You to provide Us with certain personally identifiable information that can be used to contact or identify You. Personally identifiable information may include, but is not limited to:"}),w.jsx("ul",{children:w.jsx("li",{children:"Usage Data"})}),w.jsx("h4",{children:"Usage Data"}),w.jsx("p",{children:"Usage Data is collected automatically when using the Service."}),w.jsx("p",{children:"Usage Data may include information such as Your Device's Internet Protocol address (e.g. IP address), browser type, browser version, the pages of our Service that You visit, the time and date of Your visit, the time spent on those pages, unique device identifiers and other diagnostic data."}),w.jsx("p",{children:"When You access the Service by or through a mobile device, We may collect certain information automatically, including, but not limited to, the type of mobile device You use, Your mobile device unique ID, the IP address of Your mobile device, Your mobile operating system, the type of mobile Internet browser You use, unique device identifiers and other diagnostic data."}),w.jsx("p",{children:"We may also collect information that Your browser sends whenever You visit our Service or when You access the Service by or through a mobile device."}),w.jsx("h3",{children:"Use of Your Personal Data"}),w.jsx("p",{children:"The Company may use Personal Data for the following purposes:"}),w.jsxs("ul",{children:[w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"To provide and maintain our Service"}),", including to monitor the usage of our Service."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"To manage Your Account:"})," to manage Your registration as a user of the Service. The Personal Data You provide can give You access to different functionalities of the Service that are available to You as a registered user."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"For the performance of a contract:"})," the development, compliance and undertaking of the purchase contract for the products, items or services You have purchased or of any other contract with Us through the Service."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"To contact You:"})," To contact You by email, telephone calls, SMS, or other equivalent forms of electronic communication, such as a mobile application's push notifications regarding updates or informative communications related to the functionalities, products or contracted services, including the security updates, when necessary or reasonable for their implementation."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"To provide You"})," with news, special offers and general information about other goods, services and events which we offer that are similar to those that you have already purchased or enquired about unless You have opted not to receive such information."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"To manage Your requests:"})," To attend and manage Your requests to Us."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"For business transfers:"})," We may use Your information to evaluate or conduct a merger, divestiture, restructuring, reorganization, dissolution, or other sale or transfer of some or all of Our assets, whether as a going concern or as part of bankruptcy, liquidation, or similar proceeding, in which Personal Data held by Us about our Service users is among the assets transferred."]})}),w.jsx("li",{children:w.jsxs("p",{children:[w.jsx("strong",{children:"For other purposes"}),": We may use Your information for other purposes, such as data analysis, identifying usage trends, determining the effectiveness of our promotional campaigns and to evaluate and improve our Service, products, services, marketing and your experience."]})})]}),w.jsx("p",{children:"We may share Your personal information in the following situations:"}),w.jsxs("ul",{children:[w.jsxs("li",{children:[w.jsx("strong",{children:"With Service Providers:"})," We may share Your personal information with Service Providers to monitor and analyze the use of our Service, to contact You."]}),w.jsxs("li",{children:[w.jsx("strong",{children:"For business transfers:"})," We may share or transfer Your personal information in connection with, or during negotiations of, any merger, sale of Company assets, financing, or acquisition of all or a portion of Our business to another company."]}),w.jsxs("li",{children:[w.jsx("strong",{children:"With Affiliates:"})," We may share Your information with Our affiliates, in which case we will require those affiliates to honor this Privacy Policy. Affiliates include Our parent company and any other subsidiaries, joint venture partners or other companies that We control or that are under common control with Us."]}),w.jsxs("li",{children:[w.jsx("strong",{children:"With business partners:"})," We may share Your information with Our business partners to offer You certain products, services or promotions."]}),w.jsxs("li",{children:[w.jsx("strong",{children:"With other users:"})," when You share personal information or otherwise interact in the public areas with other users, such information may be viewed by all users and may be publicly distributed outside."]}),w.jsxs("li",{children:[w.jsx("strong",{children:"With Your consent"}),": We may disclose Your personal information for any other purpose with Your consent."]})]}),w.jsx("h3",{children:"Retention of Your Personal Data"}),w.jsx("p",{children:"The Company will retain Your Personal Data only for as long as is necessary for the purposes set out in this Privacy Policy. We will retain and use Your Personal Data to the extent necessary to comply with our legal obligations (for example, if we are required to retain your data to comply with applicable laws), resolve disputes, and enforce our legal agreements and policies."}),w.jsx("p",{children:"The Company will also retain Usage Data for internal analysis purposes. Usage Data is generally retained for a shorter period of time, except when this data is used to strengthen the security or to improve the functionality of Our Service, or We are legally obligated to retain this data for longer time periods."}),w.jsx("h3",{children:"Transfer of Your Personal Data"}),w.jsx("p",{children:"Your information, including Personal Data, is processed at the Company's operating offices and in any other places where the parties involved in the processing are located. It means that this information may be transferred to  and maintained on  computers located outside of Your state, province, country or other governmental jurisdiction where the data protection laws may differ than those from Your jurisdiction."}),w.jsx("p",{children:"Your consent to this Privacy Policy followed by Your submission of such information represents Your agreement to that transfer."}),w.jsx("p",{children:"The Company will take all steps reasonably necessary to ensure that Your data is treated securely and in accordance with this Privacy Policy and no transfer of Your Personal Data will take place to an organization or a country unless there are adequate controls in place including the security of Your data and other personal information."}),w.jsx("h3",{children:"Delete Your Personal Data"}),w.jsx("p",{children:"You have the right to delete or request that We assist in deleting the Personal Data that We have collected about You."}),w.jsx("p",{children:"Our Service may give You the ability to delete certain information about You from within the Service."}),w.jsx("p",{children:"You may update, amend, or delete Your information at any time by signing in to Your Account, if you have one, and visiting the account settings section that allows you to manage Your personal information. You may also contact Us to request access to, correct, or delete any personal information that You have provided to Us."}),w.jsx("p",{children:"Please note, however, that We may need to retain certain information when we have a legal obligation or lawful basis to do so."}),w.jsx("h3",{children:"Disclosure of Your Personal Data"}),w.jsx("h4",{children:"Business Transactions"}),w.jsx("p",{children:"If the Company is involved in a merger, acquisition or asset sale, Your Personal Data may be transferred. We will provide notice before Your Personal Data is transferred and becomes subject to a different Privacy Policy."}),w.jsx("h4",{children:"Law enforcement"}),w.jsx("p",{children:"Under certain circumstances, the Company may be required to disclose Your Personal Data if required to do so by law or in response to valid requests by public authorities (e.g. a court or a government agency)."}),w.jsx("h4",{children:"Other legal requirements"}),w.jsx("p",{children:"The Company may disclose Your Personal Data in the good faith belief that such action is necessary to:"}),w.jsxs("ul",{children:[w.jsx("li",{children:"Comply with a legal obligation"}),w.jsx("li",{children:"Protect and defend the rights or property of the Company"}),w.jsx("li",{children:"Prevent or investigate possible wrongdoing in connection with the Service"}),w.jsx("li",{children:"Protect the personal safety of Users of the Service or the public"}),w.jsx("li",{children:"Protect against legal liability"})]}),w.jsx("h3",{children:"Security of Your Personal Data"}),w.jsx("p",{children:"The security of Your Personal Data is important to Us, but remember that no method of transmission over the Internet, or method of electronic storage is 100% secure. While We strive to use commercially acceptable means to protect Your Personal Data, We cannot guarantee its absolute security."}),w.jsx("h2",{children:"Children's Privacy"}),w.jsx("p",{children:"Our Service does not address anyone under the age of 13. We do not knowingly collect personally identifiable information from anyone under the age of 13. If You are a parent or guardian and You are aware that Your child has provided Us with Personal Data, please contact Us. If We become aware that We have collected Personal Data from anyone under the age of 13 without verification of parental consent, We take steps to remove that information from Our servers."}),w.jsx("p",{children:"If We need to rely on consent as a legal basis for processing Your information and Your country requires consent from a parent, We may require Your parent's consent before We collect and use that information."}),w.jsx("h2",{children:"Links to Other Websites"}),w.jsx("p",{children:"Our Service may contain links to other websites that are not operated by Us. If You click on a third party link, You will be directed to that third party's site. We strongly advise You to review the Privacy Policy of every site You visit."}),w.jsx("p",{children:"We have no control over and assume no responsibility for the content, privacy policies or practices of any third party sites or services."}),w.jsx("h2",{children:"Changes to this Privacy Policy"}),w.jsx("p",{children:"We may update Our Privacy Policy from time to time. We will notify You of any changes by posting the new Privacy Policy on this page."}),w.jsx("p",{children:'We will let You know via email and/or a prominent notice on Our Service, prior to the change becoming effective and update the "Last updated" date at the top of this Privacy Policy.'}),w.jsx("p",{children:"You are advised to review this Privacy Policy periodically for any changes. Changes to this Privacy Policy are effective when they are posted on this page."}),w.jsx("h2",{children:"Contact Us"}),w.jsx("p",{children:"If you have any questions about this Privacy Policy, You can contact us:"}),w.jsx("ul",{children:w.jsx("li",{children:"By email: camerachess1@gmail.com"})})]})})}),w.jsx("div",{className:"footer",children:w.jsx("div",{className:"container"})})]});function lP(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gE(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function uP(t,e,n){return e&&gE(t.prototype,e),n&&gE(t,n),t}function go(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ov(){return(Ov=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t}).apply(this,arguments)}function yE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function cP(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&dP(t,e)}function Rv(t){return(Rv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(t)}function dP(t,e){return(dP=Object.setPrototypeOf||function(n,r){return n.__proto__=r,n})(t,e)}function wi(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Vne(t,e){return!e||typeof e!="object"&&typeof e!="function"?wi(t):e}function fP(t){var e=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}();return function(){var n,r=Rv(t);if(e){var s=Rv(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return Vne(this,n)}}var _h={return:13,arrowLeft:37,arrowUp:38,arrowRight:39,arrowDown:40,space:32};_h.keyCodes=Object.keys(_h).reduce(function(t,e){return t[_h[e]]=e,t},{});var vr={"faq-row-wrapper":"styles_faq-row-wrapper__3vA1D","faq-row":"styles_faq-row__2YF3c","row-body":"styles_row-body__1NvUo","row-title":"styles_row-title__1YiiY","no-tabfocus":"styles_no-tabfocus__1HmyD","row-title-text":"styles_row-title-text__1MuhU","icon-wrapper":"styles_icon-wrapper__2cftw",closed:"styles_closed__39w54","row-content":"styles_row-content__QOGZd",animate:"styles_animate__3ecdr",static:"styles_static__3chYW",expanded:"styles_expanded__3elPy",expanding:"styles_expanding__2OAFB","row-content-text":"styles_row-content-text__2sgAB"};(function(t,e){e===void 0&&(e={});var n=e.insertAt;if(t&&typeof document<"u"){var r=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css",n==="top"&&r.firstChild?r.insertBefore(s,r.firstChild):r.appendChild(s),s.styleSheet?s.styleSheet.cssText=t:s.appendChild(document.createTextNode(t))}})(`.styles_faq-row-wrapper__3vA1D {
  background-color: var(--faq-bg-color, white); }
  .styles_faq-row-wrapper__3vA1D h2 {
    margin: 0;
    color: var(--title-text-color, black);
    font-size: var(--title-text-size, 30px); }
  .styles_faq-row-wrapper__3vA1D .styles_faq-row__2YF3c {
    display: flex;
    justify-content: space-between;
    padding: 5px 0;
    border-bottom: 1px solid #ccc; }
  .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c {
    flex-direction: column;
    position: relative; }
    .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY {
      padding: 10px 0;
      display: flex;
      justify-content: space-between;
      color: var(--row-title-color, black);
      font-size: var(--row-title-text-size, large);
      cursor: pointer;
      align-items: center; }
      .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY.styles_no-tabfocus__1HmyD {
        outline: none; }
      .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY .styles_row-title-text__1MuhU {
        padding-right: 3em; }
      .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY .styles_icon-wrapper__2cftw {
        max-width: 25px;
        max-height: 25px;
        margin: 0;
        padding: 0;
        color: var(--arrow-color, black);
        transform: rotate(0deg);
        transition: transform var(--transition-duration, 0.3s);
        position: absolute;
        top: 13px;
        right: 12px; }
        .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY .styles_icon-wrapper__2cftw svg {
          width: 100%;
          height: 100%; }
        .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY .styles_icon-wrapper__2cftw svg {
          fill: var(--arrow-color, black); }
      .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY.styles_closed__39w54 + .styles_row-content__QOGZd {
        visibility: hidden; }
        .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY.styles_closed__39w54 + .styles_row-content__QOGZd.styles_animate__3ecdr {
          opacity: 0;
          transition: height var(--transition-duration, 0.3s); }
        .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY.styles_closed__39w54 + .styles_row-content__QOGZd.styles_static__3chYW {
          display: none; }
      .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY.styles_expanded__3elPy + .styles_row-content__QOGZd {
        visibility: visible; }
        .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY.styles_expanded__3elPy + .styles_row-content__QOGZd.styles_static__3chYW {
          display: block; }
      .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY.styles_expanded__3elPy .styles_icon-wrapper__2cftw {
        transform: rotate(180deg); }
      .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-title__1YiiY.styles_expanding__2OAFB .styles_icon-wrapper__2cftw {
        transform: rotate(180deg); }
    .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-content__QOGZd {
      overflow: hidden;
      transition: height var(--transition-duration, 0.3s);
      transition-timing-function: var(--timing-function, ease); }
      .styles_faq-row-wrapper__3vA1D .styles_row-body__1NvUo .styles_faq-row__2YF3c .styles_row-content__QOGZd .styles_row-content-text__2sgAB {
        color: var(--row-content-color, black);
        font-size: var(--row-content-text-size, medium);
        padding: var(--row-content-padding-top, 0) var(--row-content-padding-right, 0) var(--row-content-padding-bottom, 0) var(--row-content-padding-left, 0); }
`);var hP=function(t){cP(n,L.PureComponent);var e=fP(n);function n(){var r;lP(this,n);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return go(wi(r=e.call.apply(e,[this].concat(o))),"state",{isExpanded:!1,ref:An.createRef(),rowRef:An.createRef(),height:0,rowClassName:"closed"}),go(wi(r),"finishTransition",function(){var a=r.state.isExpanded;r.setState({rowClassName:a?"expanded":"closed"})}),go(wi(r),"toggle",function(a){r.setState(function(){return{isExpanded:a}})}),go(wi(r),"expand",function(){r.setState(function(a){return{isExpanded:!a.isExpanded}})}),go(wi(r),"keyPress",function(a){var l=a.keyCode?a.keyCode:a.which;switch(_h.keyCodes[l]){case"space":case"return":a.preventDefault(),a.stopPropagation(),r.expand()}}),go(wi(r),"setHeight",function(){var a=r.state,l=a.ref,u=a.isExpanded,c=l.current.scrollHeight;r.setState({height:u?c:0})}),r}return uP(n,[{key:"getSnapshotBeforeUpdate",value:function(r,s){var o=s.isExpanded,i=this.state.isExpanded,a=this.props.config,l=(a=a===void 0?{}:a).animate,u=l===void 0||l;return i!==o?{rowClassName:i?u?"expanding":"expanded":u?"closing":"closed"}:null}},{key:"componentDidUpdate",value:function(r,s,o){var i=this.props.config,a=(i=i===void 0?{}:i).animate,l=a===void 0||a;o!==null&&this.setState(function(u){for(var c=1;c<arguments.length;c++){var d=arguments[c]!=null?arguments[c]:{};c%2?yE(Object(d),!0).forEach(function(f){go(u,f,d[f])}):Object.getOwnPropertyDescriptors?Object.defineProperties(u,Object.getOwnPropertyDescriptors(d)):yE(Object(d)).forEach(function(f){Object.defineProperty(u,f,Object.getOwnPropertyDescriptor(d,f))})}return u}({},o),l?this.setHeight:void 0)}},{key:"componentDidMount",value:function(){var r=this,s=this.state.rowRef;if(this.props.openOnload&&this.expand(),this.props.getRowOptions){var o={expand:function(){r.toggle(!0)},close:function(){r.toggle(!1)},scrollIntoView:function(i){i?s.current.scrollIntoView(i):s.current.scrollIntoView()}};this.props.getRowOptions(o)}}},{key:"render",value:function(){var r=this.props,s=r.data,o=s.title,i=s.content,a=r.config,l=(a=a===void 0?{}:a).animate,u=l===void 0||l,c=a.arrowIcon,d=a.expandIcon,f=a.collapseIcon,h=a.tabFocus,p=h!==void 0&&h,m=this.state,v=m.isExpanded,g=m.ref,x=m.height,b=m.rowClassName,_=m.rowRef,N={onClick:this.expand,role:"button","aria-expanded":v,"aria-controls":"react-faq-rowcontent-".concat(this.props.rowid),onKeyPress:this.keyPress,onKeyDown:this.keyPress};p&&(N.tabIndex=0);var E={role:"region",id:"react-faq-rowcontent-".concat(this.props.rowid),"aria-expanded":v,"aria-hidden":!v,onTransitionEnd:this.finishTransition};u&&(E.style={height:x});var R=["row-title",b,vr["row-title"],vr[b],p?"":vr["no-tabfocus"]].filter(Boolean).join(" "),P=null;P=d&&f?v?f:d:c||An.createElement("div",{dangerouslySetInnerHTML:{__html:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="black" width="36px" height="36px"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/><path d="M0 0h24v24H0V0z" fill="none"/></svg>'},className:"arrow-image ".concat(vr["arrow-image"]),alt:"Expand arrow"});var B=[vr["row-content"],"row-content",u?vr.animate:vr.static].join(" "),F=[vr["row-content-text"],"row-content-text"].join(" "),H=i&&typeof i=="string"?An.createElement("div",{className:F,dangerouslySetInnerHTML:{__html:i}}):An.createElement("div",{className:F},i);return An.createElement("section",{className:"faq-row ".concat(vr["faq-row"]),role:"listitem",ref:_},An.createElement("div",Ov({className:R},N),An.createElement("div",{className:"row-title-text ".concat(vr["row-title-text"]),id:"react-faq-rowtitle-".concat(this.props.rowid)},o),An.createElement("span",{className:"icon-wrapper ".concat(vr["icon-wrapper"]),"aria-hidden":"true"},P)),An.createElement("div",Ov({className:B},E,{ref:g}),H))}}]),n}();go(hP,"propTypes",{config:qe.object,data:qe.object,rowid:qe.number,getRowOptions:qe.func,openOnload:qe.bool});var pP=function(t){cP(n,L.PureComponent);var e=fP(n);function n(){var r;lP(this,n);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return go(wi(r=e.call.apply(e,[this].concat(o))),"state",{rowsOption:[]}),r}return uP(n,[{key:"componentDidMount",value:function(){this.props.getRowOptions&&this.props.getRowOptions(this.state.rowsOption)}},{key:"render",value:function(){var r=this,s=this.props.data||{},o=s.title,i=s.rows,a=i===void 0?[]:i,l=this.props,u=l.styles,c=u===void 0?{}:u,d=l.config,f=((d=d===void 0?{}:d).animate,d.openOnload),h={"--faq-bg-color":c.bgColor,"--title-text-color":c.titleTextColor,"--title-text-size":c.titleTextSize,"--row-title-color":c.rowTitleColor,"--row-title-text-size":c.rowTitleTextSize,"--row-content-color":c.rowContentColor,"--row-content-text-size":c.rowContentTextSize,"--row-content-padding-top":c.rowContentPaddingTop,"--row-content-padding-bottom":c.rowContentPaddingBottom,"--row-content-padding-right":c.rowContentPaddingRight,"--row-content-padding-left":c.rowContentPaddingLeft,"--arrow-color":c.arrowColor,"--transition-duration":c.transitionDuration,"--timing-function":c.timingFunc},p="faq-row-wrapper ".concat(vr["faq-row-wrapper"]),m="faq-title ".concat(vr["faq-row"]),v="faq-body ".concat(vr["row-body"]);return An.createElement("div",{className:p,style:h},o?An.createElement("section",{className:m},An.createElement("h2",null,o)):null,a.length?An.createElement("section",{className:v,role:"list"},a.map(function(g,x){return An.createElement(hP,{openOnload:f===x,data:g,key:x,rowid:x+1,config:r.props.config,getRowOptions:function(b){return r.state.rowsOption[x]=b}})})):null)}}]),n}();go(pP,"propTypes",{data:qe.object,styles:qe.object,config:qe.object,getRowOptions:qe.func});const Gne={title:"FAQ (How it works)",rows:[{title:"Where can I buy a stand?",content:w.jsxs("p",{children:["You can buy a stand for 12.99 at:",w.jsx("a",{target:"_blank",href:"https://www.amazon.co.uk/dp/B07NVBXYPJ",rel:"noreferrer",children:"https://www.amazon.co.uk/dp/B07NVBXYPJ"}),"."]})},{title:"Is there a mobile app?",content:w.jsxs("p",{children:["If you have an Android, you can download the free ChessCam app",w.jsx("a",{target:"_blank",href:"https://play.google.com/store/apps/details?id=com.camerachess.www.twa",rel:"noreferrer",children:"here"}),". If you have an IPhone, you can add ChessCam to your home screen from the browser. See ",w.jsx("a",{target:"blank",href:"https://support.google.com/chrome/answer/9658361?hl=en-GB&co=GENIE.Platform%3DiOS",rel:"noreferrer",children:"here"})," for more detail."]})},{title:"How do I setup my camera?",content:w.jsx("div",{children:w.jsxs("ul",{children:[w.jsx("li",{children:"Place your camera on the stand to the side of the board."}),w.jsx("li",{children:"Make sure that the stand is stable and that the camera can see all 4 corners."}),w.jsx("li",{children:"If you are using your devices native camera app and have 0.5x zoom available, use it."}),w.jsx("li",{children:"Make sure that the tallest piece (the king or queen) is still in shot when placed on the furthest square from the camera."}),w.jsx("li",{children:w.jsxs("figure",{className:"figure",children:[w.jsx("img",{src:"halfZoom.webp",className:"figure-img img-fluid rounded",alt:"0.5x zoom setup"}),w.jsx("figcaption",{className:"figure-caption text-white",children:"My setup with 0.5x zoom"})]})}),w.jsx("li",{children:w.jsxs("figure",{className:"figure",children:[w.jsx("img",{src:"fullZoom.webp",className:"figure-img img-fluid rounded",alt:"1x zoom setup"}),w.jsx("figcaption",{className:"figure-caption text-white",children:"My setup with 1x zoom"})]})})]})})},{title:"Will the app work if the board or the camera move mid-way through?",content:w.jsxs("p",{children:["If the camera moves so that the squares are not aligned then the app will break. When the corners algorithm is fast and consistent enough the app may support a moving board/camera. See ",w.jsx("a",{target:"_blank",href:"https://www.youtube.com/watch?v=XV8EKqScaKs",rel:"noreferrer",children:"https://www.youtube.com/watch?v=XV8EKqScaKs"})," for a brief demo."]})},{title:"How powerful does my device have to be?",content:w.jsx("p",{children:"The app works best if you can achieve at least 4 FPS."})},{title:"How do I record?",content:w.jsxs("ol",{children:[w.jsxs("li",{children:["Click the ",w.jsx("b",{children:"Record"})," button from the Home page. Alternatively, go straight to ",w.jsx("a",{target:"_blank",href:"https://www.chesscam.net/record",rel:"noreferrer",children:"https://www.chesscam.net/record"}),"."]}),w.jsx("li",{children:'Setup your device (see "How do I set up my camera?")'}),w.jsxs("li",{children:["Click ",w.jsx("b",{children:"Find Corners"}),' to align the 4 corners with your board. If they are not correct, then adjust them manually. Clockwise the corners go "h1", "a1", "a8", "h8", starting from the bottom-right corner (relative to White).']}),w.jsxs("li",{children:["Click the ",w.jsx("b",{children:"Play"})," button to start recording your game."]})]})},{title:"How do I upload a game?",content:w.jsxs("div",{children:[w.jsxs("ol",{children:[w.jsxs("li",{children:["Click the ",w.jsx("b",{children:"Upload"})," button from the Home page. Alternatively, go straight to ",w.jsx("a",{target:"_blank",href:"https://www.chesscam.net/upload",rel:"noreferrer",children:"https://www.chesscam.net/upload"}),"."]}),w.jsx("li",{children:'Setup your device (see "How do I set up my camera?")'}),w.jsxs("li",{children:["Click ",w.jsx("b",{children:"Find Corners"}),' to align the 4 corners with your board. If they are not correct, then adjust them manually. Clockwise the corners go "h1", "a1", "a8", "h8", starting from the bottom-right corner (relative to White).']}),w.jsxs("li",{children:["Click the ",w.jsx("b",{children:"Play"})," button to start recording your game."]})]}),w.jsx("p",{children:"You can adjust the speed to 1x, 2x or 4x, but you must pause the game first. It is recommended that you keep the speed at 1x."}),w.jsx("p",{children:"You can reset the video by clicking the back button."})]})},{title:"How do I save my game?",content:w.jsxs("p",{children:["After you have finished uploading or recording your game, copy it to the clipboard by clicking ",w.jsx("b",{children:"Copy PGN"}),"."]})},{title:"How do I export my game to Lichess?",content:w.jsxs("div",{children:["This guide assumes that you have already recorded or uploaded a game successfully.",w.jsxs("ol",{children:[w.jsxs("li",{children:["If you haven't done so already, click ",w.jsx("b",{children:"Login"})," from the home screen. After giving ChessCam permissions to the Lichess API you will be redirected back to the Home screen."]}),w.jsxs("li",{children:["Click ",w.jsx("b",{children:"Export"})," from the home screen."]}),w.jsx("li",{children:"Choose a study that you would like to export your game to. If none are listed then go and create one on the Lichess website."}),w.jsxs("li",{children:["Click ",w.jsx("b",{children:"Export Game"})," to save your game to your study. It will be saved as the current timestamp."]})]})]})},{title:"Does the app work offline?",content:w.jsx("p",{children:"If you have used the app once with an internet connection, then it will work offline in the future. In offline mode, you cannot export your game to Lichess, but you can still copy the PGN."})},{title:"How are illegal moves handled?",content:w.jsx("p",{children:"Illegal moves will be ignored by the app. There are plans to raise an alert when an illegal move is played."})},{title:"Are variants supported?",content:w.jsx("p",{children:"Not at the moment."})},{title:"When I upload a video, is it kept private?",content:w.jsx("p",{children:"When a video is uploaded it is processed locally ensuring full data privacy. ChessCam never receives any videos that a user uploads."})},{title:"How can I get in touch?",content:w.jsxs("div",{children:[w.jsxs("p",{children:["Message me on Lichess:",w.jsx("a",{target:"_blank",href:"https://lichess.org/@/BlindfoldBlunderer",rel:"noreferrer",children:"https://lichess.org/@/BlindfoldBlunderer"})]}),w.jsx("p",{children:"I am always happy to chat about any ideas or problems that you might have!"})]})}]},Hne={bgColor:"#212529",titleTextColor:"white",rowTitleColor:"white",rowContentColor:"white",arrowColor:"white"},qne=()=>w.jsxs("div",{className:"bg-dark h-100 text-white justify-content-center",children:[w.jsx(pP,{data:Gne,styles:Hne}),w.jsx(Uu,{})]});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ea={},Xf={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Kne(t,e){Ea[t]=e}function so(t,e){if(!(t in Ea)||e!=null){const r=Yne(t,e);if(r!==null)Ea[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=Ea[t];return n==null||n.isContextLost()?(delete Ea[t],so(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Ea[t])}function Xne(t){if(!Y().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Yne(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??Xne(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete Ea[t]},!1),Y().getBool("SOFTWARE_WEBGL_ENABLED")&&(Xf.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Xf)||n.getContext("experimental-webgl",Xf):n.getContext("webgl2",Xf)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Od;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(Od||(Od={}));var zr;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(zr||(zr={}));var Tn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Tn||(Tn={}));function Zd(t,e){return[e,t]}function Qne(t,e){return t*e}function Yf(t){const e=pe(t),n=Math.ceil(e/4);return A0(n)}function zu(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function Zne(t,e){const[n,r]=zu(t,e);return n*r*4}function yb(t,e){const n=t;let r,s,o,i,a,l,u,c,d,f;return Y().getNumber("WEBGL_VERSION")===2?(r=n.R32F,s=n.R16F,o=n.RGBA16F,i=n.RGBA32F,a=n.RED,u=4,c=1,d=n.HALF_FLOAT,f=n.FLOAT,l=n.RGBA8):(r=t.RGBA,s=t.RGBA,o=t.RGBA,i=n.RGBA,a=t.RGBA,u=4,c=4,d=e!=null?e.HALF_FLOAT_OES:null,f=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:c,textureTypeHalfFloat:d,textureTypeFloat:f}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xe(t,e){const n=e();return Y().getBool("DEBUG")&&Jne(t),n}function Jne(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+rre(t,e))}const ere=596e-10,tre=65504;function nre(t){return!!(Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||ere<Math.abs(t)&&Math.abs(t)<tre)}function rre(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Qf(t,e){return ri(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function sre(t,e){const n=ri(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(xe(t,()=>t.shaderSource(n,e)),xe(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function ore(t,e){const n=ri(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(xe(t,()=>t.shaderSource(n,e)),xe(t,()=>t.compileShader(n)),Y().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw mP(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const ire=/ERROR: [0-9]+:([0-9]+):/g;function mP(t,e){const n=ire.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],s=t.split(`
`),o=s.length.toString().length+2,i=s.map((d,f)=>su((f+1).toString(),o)+d);let a=0;for(let d=0;d<i.length;d++)a=Math.max(i[d].length,a);const l=i.slice(0,r-1),u=i.slice(r-1,r),c=i.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${su(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(c.join(`
`))}function are(t){return ri(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function lre(t,e){if(xe(t,()=>t.linkProgram(e)),!Y().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Ey(t,e){if(xe(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function ure(t,e){const n=ri(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return xe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),xe(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function cre(t,e){const n=ri(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return xe(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),xe(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function dre(t){return ri(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function fre(t,e){const n=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,s=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function hre(t){return ri(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function vE(t,e,n,r,s,o,i){const a=t.getAttribLocation(e,n);return a===-1?!1:(xe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),xe(t,()=>t.vertexAttribPointer(a,s,t.FLOAT,!1,o,i)),xe(t,()=>t.enableVertexAttribArray(a)),!0)}function pre(t,e,n){xre(t,n),xe(t,()=>t.activeTexture(t.TEXTURE0+n)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function mre(t,e,n){return ri(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function gre(t,e,n){return t.getUniformLocation(e,n)}function yre(t,e,n,r){xe(t,()=>pre(t,e,r)),xe(t,()=>t.uniform1i(n,r))}function Ty(t,e,n){xe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),xe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function xE(t,e){xe(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),xe(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Zf(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+vre(t,e))}function vre(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function ri(t,e,n){const r=xe(t,()=>e());if(r==null)throw new Error(n);return r}function xre(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const s=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${s}.`)}}function Tu(t,e=2){return pe(t.slice(0,t.length-e))}function Nu(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Jf(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Tu(t),...Nu(t)]),e}function bre(t,e=!1){let n=Y().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Y().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Y().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((a,l)=>l>=t.length-2?nx(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=ia(t).newShape);let s=pe(t),o=null;t.length<=1&&s<=n?o=[1,s]:t.length===2&&t[0]<=n&&t[1]<=n?o=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const i=o!=null&&Math.max(...o)>r&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=Tu(t);let l=2,u=2;t.length&&([l,u]=Nu(t)),s=a*(l/2)*(u/2),o=A0(s).map(c=>c*2)}else o=A0(s);return o}function eh(t){return t%2===0}function Np(t,e){if(t=t.slice(-2),e=e.slice(-2),Pt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||eh(n)&&eh(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&eh(t[0])&&eh(e[0])}let Ny,$y;function wre(t){if(Ny==null){const e=so(t);Ny=e.getParameter(e.MAX_TEXTURE_SIZE)}return Ny}function Sre(t){if($y==null){const e=so(t);$y=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,$y)}function Cre(t){if(t===0)return 0;let e;const n=so(t);return bs(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:bs(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function bs(t,e){return t.getExtension(e)!=null}function bE(t){try{if(so(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function _re(t){if(t===0)return!1;const e=so(t);if(t===1){if(!bs(e,"OES_texture_float"))return!1}else if(!bs(e,"EXT_color_buffer_float"))return!1;return Dv(e)}function Ere(t){if(t===0)return!1;const e=so(t);if(t===1){if(!bs(e,"OES_texture_float")||!bs(e,"WEBGL_color_buffer_float"))return!1}else{if(bs(e,"EXT_color_buffer_float"))return Dv(e);const r="EXT_color_buffer_half_float";if(bs(e,r)){const s=e.getExtension(r);return Tre(e,s)}return!1}return Dv(e)}function Dv(t){const e=yb(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const r=1,s=1;t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,r,s,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(o),i}function Tre(t,e){const n=yb(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const s=1,o=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,s,o,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(i),a}function Nre(t){return t!==2?!1:so(t).fenceSync!=null}function Jd(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&D(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Te=Y();Te.registerFlag("HAS_WEBGL",()=>Te.getNumber("WEBGL_VERSION")>0);Te.registerFlag("WEBGL_VERSION",()=>bE(2)?2:bE(1)?1:0);Te.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Te.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Te.get("WEBGL_VERSION")===2);Te.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Te.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Te.registerFlag("WEBGL_PACK",()=>Te.getBool("HAS_WEBGL"));Te.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_CLIP",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_REDUCE",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_LAZILY_UNPACK",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_CONV_IM2COL",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Te.getBool("WEBGL_PACK"));Te.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>wre(Te.getNumber("WEBGL_VERSION")));Te.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Sre(Te.getNumber("WEBGL_VERSION")));Te.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Te.getNumber("WEBGL_VERSION");return t===0?0:Cre(t)});Te.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Te.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!SO());Te.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>_re(Te.getNumber("WEBGL_VERSION")));Te.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Te.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Te.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Te.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Ere(Te.getNumber("WEBGL_VERSION")));Te.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Nre(Te.getNumber("WEBGL_VERSION")));Te.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Te.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Te.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Te.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>SO()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Te.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Te.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Te.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Te.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Te.registerFlag("WEBGL_EXP_CONV",()=>!1);Te.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Te.getBool("IS_TEST"));Te.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Te.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Te.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Te.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function er(){let t,e,n,r,s,o,i,a,l,u;return Y().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",s="texture",o="outputColor",i="out vec4 outputColor;",a=Y().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",s="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:s,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yl(t,e,n="index"){const r=$n(e);return r.map((s,o)=>{const i=`int ${t[o]} = ${n} / ${s}`,a=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${s}`:`index -= ${t[o]} * ${s}`;return`${i}; ${a};`}).join("")}function Km(t,e,n="index"){const r=$n(e);return r.map((s,o)=>{const i=`int ${t[o]} = ${n} / outShapeStrides[${o}]`,a=o===r.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * outShapeStrides[${o}]`:`index -= ${t[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function $re(t,e){const n=t.length,r=t.map(o=>`${e}[${o}]`),s=new Array(n-1);s[n-2]=r[n-1];for(let o=n-3;o>=0;--o)s[o]=`(${s[o+1]} * ${r[o+1]})`;return s}function kre(t,e,n="index"){const r=t.map((o,i)=>i),s=$re(r,e);return s.map((o,i)=>{const a=`int ${t[i]} = ${n} / ${s[i]}`,l=i===s.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${s[i]}`:`index -= ${t[i]} * ${s[i]}`;return`${a}; ${l};`}).join("")}function vb(t){const e=$n(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function xb(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const gP=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:yP}=V7;function Ire(t,e,n){const r=[];if(t.forEach(h=>{const p=pe(h.shapeInfo.logicalShape);if(h.shapeInfo.isUniform?r.push(`uniform float ${h.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${h.name};`),r.push(`uniform int offset${h.name};`)),n.enableShapeUniforms){const{uniformShape:m}=bb(n.packedInputs,h.shapeInfo.logicalShape,h.shapeInfo.texShape);switch(m.length){case 1:r.push(`uniform int ${h.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${h.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${h.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${h.name}Shape;`);break}r.push(`uniform ivec2 ${h.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(h=>{r.push(`uniform ${h.type} ${h.name}${h.arrayIndex?`[${h.arrayIndex}]`:""};`)});const s=r.join(`
`),o=t.map(h=>Ore(h,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,a=er(),l=Are(a);let u,c,d=Fre(a);return e.isPacked?(u=Rre(e.logicalShape,i,n.enableShapeUniforms),c=Lre(a)):(u=Dre(e.logicalShape,i,n.enableShapeUniforms),c=Pre(a)),n.packedInputs&&(d+=Ure),[d,l,c,s,u,o,n.userCode].join(`
`)}function Wu(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return Jre(t,e);case 1:return tse(t,e);case 2:return rse(t,e);case 3:return ose(t,e);case 4:return ase(t,e);case 5:return lse(t);case 6:return use(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function vP(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return Zre(t);case 1:return ese(t,e);case 2:return nse(t,e);case 3:return sse(t,e);default:return ise(t,e)}}function Ore(t,e,n=!1,r){let s="";n?s+=vP(t,r):s+=Wu(t,r);const o=t.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(n?s+=cse(t,e):s+=dse(t,e)),s}function Rre(t,e,n){switch(t.length){case 0:return xP();case 1:return zre(t,e,n);case 2:return Yre(t,e,n);case 3:return Vre(t,e,n);default:return Hre(t,e,n)}}function Dre(t,e,n){switch(t.length){case 0:return xP();case 1:return Wre(t,e,n);case 2:return Qre(t,e,n);case 3:return Gre(t,e,n);case 4:return qre(t,e,n);case 5:return Kre(t,e);case 6:return Xre(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function Are(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function Pre(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Lre(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Fre(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Mre}
    ${jre}
    ${Bre}
  `}const Mre=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,jre=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Bre=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Ure=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function xP(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function zre(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function Wre(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Vre(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[2]/2),o=s*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function Gre(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Km(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=yl(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function Hre(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(t[t.length-1]/2),o=s*Math.ceil(t[t.length-2]/2);let i=o,a="",l="b, r, c";for(let u=2;u<t.length-1;u++)i*=t[t.length-u-1],a=`
      int b${u} = index / ${i};
      index -= b${u} * ${i};
    `+a,l=`b${u}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${t.length}(${l});
    }
  `}function qre(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Km(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=yl(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function Kre(t,e){const n=yl(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Xre(t,e){const n=yl(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Yre(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Pt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function Qre(t,e,n){return Pt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function vl(t){return`offset${t}`}function Zre(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=er();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function Jre(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[s,o]=t.shapeInfo.texShape;if(s===1&&o===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=vl(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function ese(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=t.shapeInfo.texShape,o=er();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function tse(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Vu(t)}
      }
    `;const s=t.shapeInfo.texShape,o=s[0],i=s[1];if(i===1&&o===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=vl(n);return i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function nse(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=o[0],a=o[1],l=er();if(o!=null&&Pt(n,o))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=Math.ceil(n[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${c}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function rse(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape;if(o!=null&&Pt(n,o)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const f=o[0],h=o[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${h}.0, ${f}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:i,keptDims:a}=ia(n),l=i;if(l.length<n.length){const f=Gu(t,l),h=["row","col"];return`
      ${Wu(f,e)}
      float ${s}(int row, int col) {
        return ${s}(${Hu(h,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${Vu(t)}
      }
    `;const u=o[0],c=o[1],d=vl(r);return c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${r}, uv);
    }
  `:u===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${c}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${u}, ${c}, index);
    return sampleTexture(${r}, uv);
  }
`}function sse(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){const f=n.slice(1),h=[1,2],p=Gu(t,f),m=["b","row","col"];return`
        ${vP(p,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${Hu(m,h)});
        }
      `}const a=er();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const l=i[0],u=i[1],c=Math.ceil(n[2]/2),d=c*Math.ceil(n[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${d}, ${c}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function ose(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=ia(n),u=a;if(u.length<n.length){const m=Gu(t,u),v=["row","col","depth"];return`
        ${Wu(m,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${Hu(v,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${Vu(t)}
      }
    `;const c=t.shapeInfo.texShape,d=c[0],f=c[1],h=t.shapeInfo.flatOffset;if(f===o&&h==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${f}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(f===i&&h==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${f}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=vl(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${f}, index);
        return sampleTexture(${r}, uv);
      }
  `}function ise(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=er();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${n}, uv);
    }
  `;const o=t.shapeInfo.logicalShape,i=o.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],c=l[1],d=Math.ceil(o[i-1]/2);let f=d*Math.ceil(o[i-2]/2),h="int b, int row, int col",p=`b * ${f} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<i-1;m++)h=`int b${m}, `+h,f*=o[i-m-1],p=`b${m} * ${f} + `+p;return`
    vec4 ${r}(${h}) {
      int index = ${p};
      int texR = index / ${c};
      int texC = index - texR * ${c};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${c}, ${u});
      return ${s.texture2D}(${n}, uv);
    }
  `}function ase(t,e){const n=t.shapeInfo.logicalShape,r=t.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n[3],i=n[2]*o,a=n[1]*i,{newShape:l,keptDims:u}=ia(n);if(l.length<n.length){const x=Gu(t,l),b=["row","col","depth","depth2"];return`
      ${Wu(x,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${Hu(b,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${Vu(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1],p=`int stride2 = ${r}Shape[3];`,m=`int stride1 = ${r}Shape[2] * stride2;`,v=`int stride0 = ${r}Shape[1] * stride1;`;if(h===a&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(h===o&&c==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${r}, uv);
      }
    `;const g=vl(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${v}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${g});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${f}, ${h}, index + ${g});
      return sampleTexture(${r}, uv);
    }
  `}function lse(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),s=e[4],o=e[3]*s,i=e[2]*o,a=e[1]*i,{newShape:l,keptDims:u}=ia(e);if(l.length<e.length){const m=Gu(t,l),v=["row","col","depth","depth2","depth3"];return`
      ${Wu(m)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${Hu(v,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${s})) +
          depth3;
        ${Vu(t)}
      }
    `;const c=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,f=d[0],h=d[1];if(h===a&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(h===s&&c==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${h}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=vl(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${s} + depth3 + ${p};
      vec2 uv = uvFromFlat(${f}, ${h}, index);
      return sampleTexture(${n}, uv);
    }
  `}function use(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:s,keptDims:o}=ia(e);if(s.length<e.length){const v=Gu(t,s),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${Wu(v)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${Hu(g,o)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,u=e[2]*l,c=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${c}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${Vu(t)}
      }
    `;const d=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,h=f[0],p=f[1];if(p===c&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===i&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=vl(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${c} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${h}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Vu(t){const e=t.name,n=pe(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function cse(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=yP(t.shapeInfo.logicalShape,e.logicalShape),l=mt(i),u=i-o;let c;const d=["x","y","z","w","u","v"];o===0?c="":i<2&&a.length>=1?c="coords = 0;":c=a.map(x=>`coords.${d[x+u]} = 0;`).join(`
`);let f="";i<2&&o>0?f="coords":f=t.shapeInfo.logicalShape.map((x,b)=>`coords.${d[b+u]}`).join(", ");let h="return outputValue;";const m=pe(t.shapeInfo.logicalShape)===1,g=pe(e.logicalShape)===1;if(o===1&&!m&&!g)h=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!g)i===1?h=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:h=`
        return vec4(outputValue.x);
      `;else if(a.length){const x=o-2,b=o-1;a.indexOf(x)>-1&&a.indexOf(b)>-1?h="return vec4(outputValue.x);":a.indexOf(x)>-1?h="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(h="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${l} coords = getOutputCoords();
      ${c}
      vec4 outputValue = get${r}(${f});
      ${h}
    }
  `}function dse(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),s="get"+r+"AtOutCoords",o=e.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&Pt(i,o))return`
      float ${s}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=mt(l),c=yP(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let f;const h=["x","y","z","w","u","v"];a===0?f="":l<2&&c.length>=1?f="coords = 0;":f=c.map(m=>`coords.${h[m+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,v)=>`coords.${h[v+d]}`).join(", "),`
    float ${s}() {
      ${u} coords = getOutputCoords();
      ${f}
      return get${r}(${p});
    }
  `}function mt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function bb(t,e,n){const{newShape:r,keptDims:s}=ia(e),o=e.length,i=t&&o===3&&e[0]===1,a=i?e.slice(1):r,l=!t&&o>1&&!Pt(e,n)&&r.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:s}}function Gu(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Hu(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(t,e,n,r){const s=n.map((c,d)=>{const f={logicalShape:c.shape,texShape:c.isUniform?null:c.texData.texShape,isUniform:c.isUniform,isPacked:c.isUniform?!1:c.texData.isPacked,flatOffset:null};return c.texData!=null&&c.texData.slice!=null&&c.texData.slice.flatOffset>0&&(f.flatOffset=c.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:f}}),o=s.map(c=>c.shapeInfo),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=Ire(s,i,e),l=ore(t.gl,a),u=t.createProgram(l);return Y().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i},bP(t,e,u)))}function bP(t,e,n){const r=[],s=[];let o,i,a,l=null,u=null;u=t.getUniformLocation(n,"NAN",!1),Y().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const c=!1;for(const d of e.variableNames){const f={name:d,uniform:t.getUniformLocation(n,d,c),offset:t.getUniformLocation(n,`offset${d}`,c)};e.enableShapeUniforms&&(f.shape=t.getUniformLocation(n,`${d}Shape`,c),f.texShape=t.getUniformLocation(n,`${d}TexShape`,c)),r.push(f)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",c),a=t.getUniformLocation(n,"outShapeStrides",c),i=t.getUniformLocation(n,"outTexShape",c)),e.customUniforms)for(const d of e.customUniforms)s.push(t.getUniformLocation(n,d.name,c));return{variablesLocations:r,customUniformLocations:s,infLoc:l,nanLoc:u,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:i}}function wE(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const s=n.logicalShape,o=e[r],i=o.shape;if(!Pt(s,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${i} must match`);if(n.isUniform&&o.isUniform)return;const a=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!Pt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function hse(t,e,n,r,s){e.program.enableShapeUniforms||(wE(e.inShapeInfos,n),wE([e.outShapeInfo],[r]));const o=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):t.setOutputMatrixTexture(o.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),Y().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const u=n[l],{uniform:c,offset:d,shape:f,texShape:h}=e.variablesLocations[l];if(f){const{uniformShape:p}=bb(e.program.packedInputs,u.shape,u.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(f,new Int32Array(p));break;case 2:t.gl.uniform2iv(f,new Int32Array(p));break;case 3:t.gl.uniform3iv(f,new Int32Array(p));break;case 4:t.gl.uniform4iv(f,new Int32Array(p));break}}if(h&&t.gl.uniform2i(h,u.texData.texShape[0],u.texData.texShape[1]),c!=null){if(u.isUniform){if(pe(u.shape)<2)t.gl.uniform1f(c,u.uniformValues[0]);else{let p=u.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(c,p)}continue}u.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,c,l)}}const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=$n(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s)for(let l=0;l<e.program.customUniforms.length;++l){const u=e.program.customUniforms[l],c=e.customUniformLocations[l],d=s[l];if(u.type==="float")t.gl.uniform1fv(c,d);else if(u.type==="vec2")t.gl.uniform2fv(c,d);else if(u.type==="vec3")t.gl.uniform3fv(c,d);else if(u.type==="vec4")t.gl.uniform4fv(c,d);else if(u.type==="int")t.gl.uniform1iv(c,d);else if(u.type==="ivec2")t.gl.uniform2iv(c,d);else if(u.type==="ivec3")t.gl.uniform3iv(c,d);else if(u.type==="ivec4")t.gl.uniform4iv(c,d);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function pse(t,e,n){let r="";e.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:u,uniformShape:c,keptDims:d}=bb(t.packedInputs,i.shape,l);let f="",h="",p="";if(c.length===1&&t.packedInputs){const N=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];f=`${N[0]>1}_${N[1]>1}`}else if(c.length===2&&!t.packedInputs)h=`${c[0]>1}_${c[1]>1}`;else if(c.length>2&&!t.packedInputs){const N=$n(c);p=`${N[0]===l[1]}_${N[N.length-1]===l[1]}`}const m=i.shape.length,v=c.length===2&&Pt(i.shape,l),g=pe(i.shape)===1,x=mp(i.shape,n.shape),b=!t.packedInputs&&m===n.shape.length&&Pt(l,n.texData.texShape),_=t.packedInputs||c.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${m}_${b}_${u?d:""}_${c.length}_${g}_${x}_${v}_${f}_${h}_${p}_${_}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;r+=`${i.shape}_${l}_${a}`}});const s=t.userCode;let o=t.constructor.name;return o+="_"+r+"_"+s+`${Y().getNumber("WEBGL_VERSION")}`,o}function Fn(t){return Y().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mse{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Od.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=er();this.outputShape=e,this.enableShapeUniforms=Fn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Km(["r","c","d"],e):yl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gse{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Od.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=er();this.outputShape=e,this.enableShapeUniforms=Fn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Km(["r","c","d"],e):yl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yse{constructor(e){this.variableNames=["A"],this.outTexUsage=zr.DOWNLOAD;const n=er();this.outputShape=e,this.userCode=`
      ${gP}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vse{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=zr.DOWNLOAD;const n=er();this.outputShape=e,this.userCode=`
      ${gP}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xse={R:0,G:1,B:2,A:3};class SE{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=er();this.outputShape=e,this.enableShapeUniforms=Fn(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let i="";for(let a=0;a<r.length;a++){const l=r[a];i+=`
          if(offset == ${a}) {
            result = values[${xse[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?xb():vb(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${s.texture2D}(A, uv);
          ${i}
        }
        ${s.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bse{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=er();this.outputShape=e,this.enableShapeUniforms=Fn(this.outputShape.length);let s="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?xb():vb(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(t){const e=er(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return sre(t,n)}function Sse(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return ure(t,e)}function Cse(t){const e=new Uint16Array([0,1,2,2,1,3]);return cre(t,e)}function ef(t,e,n,r,s,o){fre(e,n);const i=dre(t),a=t.TEXTURE_2D;return xe(t,()=>t.bindTexture(a,i)),xe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),xe(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),xe(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),xe(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),Y().getNumber("WEBGL_VERSION")===1?xe(t,()=>t.texImage2D(a,0,r,e,n,0,s,o,null)):xe(t,()=>t.texStorage2D(a,1,r,e,n)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function wP(t){return t.internalFormatFloat}function _se(t,e,n,r){const[s,o]=Zd(e,n);return ef(t,s,o,wP(r),r.textureFormatFloat,t.FLOAT)}function SP(t){return t.internalFormatHalfFloat}function Ese(t,e,n,r){const[s,o]=Zd(e,n);return ef(t,s,o,SP(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function CP(t){return t.downloadTextureFormat}function Tse(t,e,n,r){const[s,o]=Zd(e,n);return ef(t,s,o,CP(r),t.RGBA,t.UNSIGNED_BYTE)}function _P(t){return t.internalFormatPackedFloat}function Nse(t,e,n,r){const[s,o]=zu(e,n);return ef(t,s,o,_P(r),t.RGBA,t.FLOAT)}function EP(t){return t.internalFormatPackedHalfFloat}function $se(t,e,n,r){const[s,o]=zu(e,n);return ef(t,s,o,EP(r),t.RGBA,r.textureTypeHalfFloat)}function kse(t,e,n){return xe(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),vE(t,e,"clipSpacePos",n,3,20,0)&&vE(t,e,"uv",n,2,20,12)}function Ise(t,e,n,r,s,o){xe(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,a,l;s instanceof Uint8Array?(i=new Uint8Array(n*r*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*r*4),a=t.FLOAT,l=o.internalFormatPackedFloat),i.set(s),Y().getNumber("WEBGL_VERSION")===2?xe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,a,i)):xe(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,a,i)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Ose(t,e,n){xe(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?Y().getNumber("WEBGL_VERSION")===2?xe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):xe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):Y().getNumber("WEBGL_VERSION")===2?xe(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):xe(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),xe(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Rse(t,e,n,r){const s=t.createBuffer();xe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,s));const a=4*4*e*n;return xe(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),xe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),xe(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),s}function Dse(t,e,n){const r=t,s=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function Ase(t,e,n,r){const[s,o]=Zd(e,n),i=4,a=new Uint8Array(Qne(e*n,i));return xe(t,()=>t.readPixels(0,0,s,o,r.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Pse(t,e,n,r,s,o,i,a){const l=t,u=new Float32Array(Zne(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function Lse(t,e,n){const r=new Float32Array(e*n*4);return xe(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ky{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=Y().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,Kne(n,e)):this.gl=so(n),e=this.gl,Y().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>xe(o,()=>o.createVertexArray()),this.bindVertexArray=i=>xe(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>xe(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>xe(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>xe(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>xe(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>xe(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>xe(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Y().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Qf(this.gl,o),bs(this.gl,i))this.textureHalfFloatExtension=Qf(this.gl,i);else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),bs(this.gl,s))this.colorBufferHalfFloatExtension=Qf(this.gl,s);else if(Y().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",bs(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(bs(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Sse(this.gl),this.indexBuffer=Cse(this.gl),this.framebuffer=hre(this.gl),this.textureConfig=yb(this.gl,this.textureHalfFloatExtension)}get debug(){return Y().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;xe(e,()=>e.finish()),xe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),xe(e,()=>e.deleteFramebuffer(this.framebuffer)),xe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),xe(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),xe(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),_se(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),Ese(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Tse(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Ose(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,s){this.throwIfDisposed(),Ise(this.gl,e,n,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),$se(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Nse(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(xE(this.gl,this.framebuffer),this.outputTexture=null),xe(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>Ase(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,s,o,i){return Pse(this.gl,e,n,r,s,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Dse(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const s=Rse(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(Y().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,o=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const i=s.clientWaitSync(o,0,0);return i===s.ALREADY_SIGNALED||i===s.CONDITION_SATISFIED},n=o}else Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>Lse(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=wse(n));const r=are(n);xe(n,()=>n.attachShader(r,this.vertexShader)),xe(n,()=>n.attachShader(r,e)),lre(n,r);const s=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&Ey(n,s),s}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;xe(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),kse(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(xe(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Ey(this.gl,this.program),xe(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?mre(this.gl,e,n):gre(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),xe(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),yre(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[s,o]=zu(n,r);this.setOutputMatrixTextureDriver(e,s,o)}setOutputMatrixWriteRegion(e,n,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,n)}setOutputPackedMatrixWriteRegion(e,n,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Ey(this.gl,this.program),Zf(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}xe(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),xe(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Qf(this.gl,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await jC(()=>this.disposed||this.isQueryAvailable(e,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=Fse(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in Y().platform&&(r=Y().platform.setTimeoutCustom.bind(Y().platform)),jC(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Ty(this.gl,e,this.framebuffer),this.debug&&Zf(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Ty(this.gl,this.outputTexture,this.framebuffer),this.debug&&Zf(this.gl)):xE(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const s=this.gl;Ty(s,e,this.framebuffer),this.debug&&Zf(s),this.outputTexture=e,xe(s,()=>s.viewport(0,0,n,r)),xe(s,()=>s.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,s){this.throwIfDisposed(),xe(this.gl,()=>this.gl.scissor(e,n,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Fse(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mse(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hr(t){return(e,n,r,s,o)=>{const i=nt(e,n),a=i.length,l=$n(i),u=pe(i),c=Qi(o,u),d=e.length,f=n.length,h=$n(e),p=$n(n),m=mp(e,i),v=mp(n,i);if(m.length+v.length===0)for(let g=0;g<c.length;++g)c[g]=t(r[g%r.length],s[g%s.length]);else for(let g=0;g<c.length;++g){const x=rx(g,a,l),b=x.slice(-d);m.forEach(R=>b[R]=0);const _=M0(b,d,h),N=x.slice(-f);v.forEach(R=>N[R]=0);const E=M0(N,f,p);c[g]=t(r[_],s[E])}return[c,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jse(t,e,n,r){if(r==="int32"){const s=Int32Array.from(t);return[e,"int32",s]}if(r==="bool"){const s=Sm([0],n),[o,i]=hr((a,l)=>a!==l?1:0)(e,[],t,s,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bse=hr((t,e)=>t+e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Use(t,e,n,r,s){const o=pe(r),i=Zi(s,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=s||(o>0?i[l]+=e[a]:i[l]+=1)}return i}function zse(t,e,n,r=!1){const s=t.shape[0],o=t.shape[1],i=Lt([s,n],e.dtype);for(let a=0;a<s;a++)for(let l=0;l<o;l++){const u=t.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(r?i.set(1,a,u):e.size>0?i.set(i.get(a,u)+e.get(a,l),a,u):i.set(i.get(a,u)+1,a,u))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wse=hr((t,e)=>t&e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function si(t){return(e,n,r)=>{const s=mn(n,e.length);for(let o=0;o<e.length;++o)s[o]=t(e[o],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vse=si(t=>Math.ceil(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gse(t,e,n,r){const s=mn(n,pe(e));if(r&&n!=="string"){let o=0;t.forEach(i=>{const a=pe(i.shape);s.set(i.vals,o),o+=a})}else{let o=0;t.forEach(i=>{const a=n==="string"?_u(i.vals):i.vals;let l=0;for(let u=0;u<i.shape[0];++u){const c=u*e[1]+o;for(let d=0;d<i.shape[1];++d)s[c+d]=a[l++]}o+=i.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hse=hr((t,e)=>t===e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qse=si(t=>Math.exp(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kse=si(t=>Math.expm1(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xse=si(t=>Math.floor(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yse=hr((t,e)=>Math.floor(t/e));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qse(t,e,n,r,s,o,i,a,l){const u=Lt([r,o],n);for(let c=0;c<r;c++){const d=[];let f=0;for(let h=0;h<s;h++){const p=t[c*s+h];f+=p*i[h],d.push(p)}if(f<0||f>=l/o)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let h=0;h<o;h++)u.values[c*o+h]=e.get(...e.indexToLoc(f*o+h))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zse(t,e,n){const r=Lt(n,t.dtype);for(let s=0;s<r.size;++s){const i=r.indexToLoc(s).slice(),a=i[0],l=i[2],u=e.locToIndex([a,l]);i[2]=e.values[u];const c=t.locToIndex(i);0<=c&&c<t.values.length&&(r.values[s]=t.values[c])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jse=hr((t,e)=>t>e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eoe=hr((t,e)=>t>=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const toe=hr((t,e)=>t<e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const noe=hr((t,e)=>t<=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function roe(t,e,n){const r=(e-t)/(n-1),s=Zi(n,"float32");s[0]=t;for(let o=1;o<s.length;o++)s[o]=s[o-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const soe=si(t=>Math.log(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ooe(t,e,n,r){const s=Qi(r,pe(n));for(let o=0;o<s.length;++o){const i=o*e;let a=t[i];for(let l=0;l<e;++l){const u=t[i+l];(Number.isNaN(u)||u>a)&&(a=u)}s[o]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ioe=hr((t,e)=>Math.max(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aoe=hr((t,e)=>Math.min(t,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TP=hr((t,e)=>t*e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function loe(t,e,n){const r=Pu(-1,n);return TP([],e,r,t,n)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uoe=hr((t,e)=>t!==e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function coe(t,e,n,r,s){const o=e.length,i=pe(e),a=$n(e),l=$n(s),u=Qi(n,pe(s));for(let c=0;c<i;++c){const d=rx(c,o,a),f=new Array(d.length);for(let p=0;p<f.length;p++)f[p]=d[r[p]];const h=M0(f,o,l);u[h]=t[c]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function doe(t,e,n,r){const[s,o]=No(t,r),i=To(e,"int32"),a=Zi(pe(s),i),l=pe(o);for(let u=0;u<a.length;++u){const c=u*l;let d=1;for(let f=0;f<l;++f)d*=n[c+f];a[u]=d}return{outVals:a,outShape:s,outDtype:i}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function foe(t,e,n){t.forEach((r,s)=>{if(r<0||r>=n){const o=rx(s,e.length,$n(e)).join(",");throw new Error(`indices[${o}] = ${r} is not in [0, ${n})`)}})}function hoe(t,e){for(let n=0;n<t.length;++n){const r=t[n],s=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let o=1;o<r.length;++o)if(r[o-1]>r[o])throw new Error("Ragged splits must be sorted in ascending order")}}function poe(t,e,n,r){const s=[];let o=0;const i=e.length-1+n.length,a=new Array(i).fill(null).map(()=>[0]);hoe(n,r);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const c=e[u+1];for(let d=1;d<l+1;++d)a[u].push(d*c)}for(let u=0;u<t.length;++u){let c=t[u],d=t[u]+1;for(let f=0;f<n.length;++f){const h=n[f],p=f+e.length-1;if(p>=0){const m=a[p],v=m[m.length-1]-h[c];for(let g=c;g<d;++g)a[p].push(h[g+1]+v)}c=h[c],d=h[d]}d!==c&&(s.push([c,d]),o+=d-c)}return{outSplits:a,valueSlices:s,numValues:o}}function moe(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,s=mn("int32",r);e.push(s),t[n].forEach((o,i)=>s[i]=o)}return e}function CE(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function goe(t,e,n,r,s,o){const i=CE(e,2)[1],a=CE(o,2)[1];let l=0;for(const u of n)for(let c=u[0];c<u[1];++c){for(let d=0;d<r;++d)s[l*a+d]=t[c*i+d];++l}}function yoe(t,e,n,r,s){const o=e.slice();o[0]=s;const i=mn(n,pe(o)),a=t.length,l=a===0?0:a/e[0];return goe(t,e,r,l,i,o),[i,o]}function voe(t,e,n,r,s,o,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(foe(o,i,l),r.length===0)throw new Error("params.rank must be nonzero");const u=r[0],{outSplits:c,valueSlices:d,numValues:f}=poe(o,i,t,u),h=moe(c),p=yoe(n,r,s,d,f);return[h,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _E=2147483647;function xoe(t,e,n,r,s,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(s.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=s.length===0,u=i.length===0,c=[];a||c.push(e[0]),l||c.push(s[0]),u||c.push(i[0]);for(let v=1;v<c.length;++v)if(c[v]!==c[v-1])throw new Error("starts, limits, and deltas must have the same shape");const d=c.length===0?1:c[0],f=mn("int32",d+1);f[0]=0;for(let v=0;v<d;++v){const g=a?t[0]:t[v],x=l?r[0]:r[v],b=u?o[0]:o[v];if(b===0)throw new Error("Requires delta != 0");let _;if(b>0&&x<g||b<0&&x>g)_=0;else if(_=Math.ceil(Math.abs((x-g)/b)),_>_E)throw new Error(`Requires ((limit - start) / delta) <= ${_E}`);f[v+1]=f[v]+_}const h=f[d],p=mn(n,h);let m=0;for(let v=0;v<d;++v){const g=f[v+1]-f[v];let x=a?t[0]:t[v];const b=u?o[0]:o[v];for(let _=0;_<g;++_)p[m++]=x,x+=b}return[f,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var is=Qs;class $p{constructor(e,n,r,s,o,i,a,l,u,c){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=s,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=ZR(c),this.raggedRank=JR(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===is.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===is.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case is.VALUE_ROWIDS:return $p.getMaxWidthValueRowID(n);case is.ROW_SPLITS:return $p.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${is[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let s=0;s<n-1;++s){const o=e[s+1]-e[s];o>r&&(r=o)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,s=e[0],o=0;for(let i=1;i<n;++i){const a=e[i];a!==s&&(s=a,o=Math.max(i-r,o),r=i)}return Math.max(n-r,o)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return TE(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;eD(r,n);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=QR(this.raggedRank,s,n);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,n,r){const s=Math.min(e,r),o=[];let i=0;for(let a=0;a<s;++a,i+=n)o.push(i);for(let a=s;a<e;++a)o.push(-1);return D(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,n,r,s){const o=e.length,i=[];for(let a=0;a<o-1;++a){const l=e[a+1]-e[a];let u=Math.min(s,l),c=n[a];c===-1&&(u=0);for(let d=0;d<u;++d)i.push(c),c+=r;for(let d=0;d<l-u;++d)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,r,s){const o=e.length,i=[];if(o===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let u=n[l];i.push(u);for(let c=1;c<o;++c){const d=e[c];if(d===l)u>=0&&(++a,a<s?u+=r:u=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);u=n[d]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,r,s){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case is.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,r,s);case is.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,r,s);default:throw new Error(`Unsupported partition type: ${is[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case is.FIRST_DIM_SIZE:return e[0];case is.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case is.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${is[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let l=s.length-2;l>=0;--l)s[l]=s[l+1]*r[l+1];const o=TE(r,!1),i=mn(this.valuesDType,pe(o));if(s[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,s[0],r[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,s[u],r[u]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(e,n,r,s){if(r.length===0)return;const o=this.values,i=r;let a=s.slice();a=a.slice(e+1);const l=pe(a),u=n.length;let c=this.defaultValue;if(c.length!==l&&c.length!==1){const p=this.defaultValueShape;Ke(()=>{const m=ae(c,p);c=Kc(m,a).dataSync()})}let d=0,f=0,h=0;for(let p=0;p<=u;++p){let m=p<u?n[p]:-1;if(m===h){++h;continue}if(f<h){const v=o.subarray(d*l),g=i.subarray(f*l),x=(h-f)*l;EE(g,v,x)}if(p>=u){const v=r.length;m=Math.floor(v/l)}if(m>h)if(this.defaultValue.length===1)i.subarray(h*l,m*l).fill(this.defaultValue[0]),h=m;else for(;m>h;){const v=i.slice(h*l);EE(v,c,l),++h}m<0?(d=p+1,f=h):(d=p,f=h,h=f+1)}}}function EE(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function TE(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function boe(t,e,n,r,s,o,i,a,l,u){return new $p(t,e,n,r,s,o,i,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(t,e,n,r){const s=t===e,o=t<e&&n<0,i=e<t&&n>1;if(s||o||i)return Zi(0,r);const a=Math.abs(Math.ceil((e-t)/n)),l=Zi(a,r);e<t&&n===1&&(n=-1),l[0]=t;for(let u=1;u<l.length;u++)l[u]=l[u-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Soe=si(t=>1/Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Coe(t,e,n,r,s,o,i,a,l,u){const c=[r/s,s],d=t.values,f=e.values;if(r===0)return Lt(n,e.dtype);const h=l instanceof wu?l:Lt(c,e.dtype);typeof l=="string"||typeof l=="number"?h.values.fill(l):typeof l=="boolean"&&h.values.fill(+l);for(let p=0;p<o;p++){const m=[];let v=0;for(let g=0;g<i;g++){const x=d[p*i+g];m.push(x),v+=x*a[g]}if(v<0||v>=r/s)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let g=0;g<s;g++)u?h.values[v*s+g]+=f[p*s+g]:h.values[v*s+g]=e.rank===0?f[0]:f[p*s+g]}return h}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _oe=si(t=>1/(1+Math.exp(-t)));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eoe(t,e,n,r,s){const o=Mx(r,e,n),i=pe(n),a=$n(r);if(o){const d=jx(e,a);return s==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=s==="string"?_u(t):t,u=Lt(r,s,l),c=Lt(n,s);for(let d=0;d<c.size;++d){const f=c.indexToLoc(d),h=f.map((p,m)=>p+e[m]);c.set(u.get(...h),...f)}return s==="string"?RD(c.values):c.values}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(t,e,n,r,s,o,i){const a=e[0],l=o[0],u=new Array(l),c=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(vD(a));const v=mn(n,0),g=mn(s,0);return[v,[0,d],g,u,c]}let f=!0,h=0;const p=new Array(l).fill(0);for(let v=0;v<a;++v){const g=t[v*d];if(g<0)throw new Error(xD(v,g));if(g>=l)throw new Error(bD(v,g,l));++p[g],f=f&&g>=h,h=g}let m=!0;for(let v=0;v<l;++v){const g=p[v]===0;u[v]=g,m=m&&!g,p[v]=Math.max(p[v],1),v>0&&(p[v]+=p[v-1])}if(m&&f){const v=t,g=r;for(let x=0;x<a;++x)c[x]=x;return[v,[a,d],g,u,c]}else{const v=p[l-1],g=mn(n,v*d),x=mn(s,v),b=new Array(l).fill(0);for(let _=0;_<a;++_){const N=t[_*d],E=b[N],R=(N===0?0:p[N-1])+E;b[N]++;for(let P=0;P<d;++P)g[R*d+P]=t[_*d+P];x[R]=r[_],c[_]=R}for(let _=0;_<l;++_)if(b[_]===0){const E=_===0?0:p[_-1];g[E*d+0]=_;for(let R=1;R<d;++R)g[E*d+R]=0;x[E]=i}return[g,[v,d],x,u,c]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Noe(t,e,n,r,s){const o=pe(r),i=e[0],a=s.length,l=[];let u=1,c=-1;for(let v=0;v<a;++v){const g=s[v];if(g===-1){if(c!==-1)throw new Error(wD(c,v));c=v,l.push(1)}else{if(g<0)throw new Error(SD(v,g));u*=g,l.push(g)}}if(c!==-1){if(u<=0)throw new Error(CD());const v=Math.trunc(o/u);if(u*v!==o)throw new Error(_D(r,l));l[c]=v}if(pe(l)!==o)throw new Error(ED(r,l));const f=r.length,h=[];if(f>0){h[f-1]=1;for(let v=f-2;v>=0;--v)h[v]=h[v+1]*r[v+1]}const p=[];if(a>0){p[a-1]=1;for(let v=a-2;v>=0;--v)p[v]=p[v+1]*l[v+1]}const m=mn(n,i*a);for(let v=0;v<i;++v){let g=0;for(let x=0;x<f;++x)g+=t[v*f+x]*h[x];for(let x=0;x<a;++x)m[v*a+x]=Math.trunc(g/p[x]),g%=p[x]}return[m,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $oe(t,e,n,r,s,o=!1,i=0){const a=r.length,l=[e[0],t.length/e[0]],u=l[1],d=a>0?s[a-1]+1:0;if(d<0)throw new Error(av());const f=e.slice();f[0]=d;const h=f.reduce((b,_)=>b*_,1),p=mn(n,h);if(a===0)return d>0&&p.fill(i),[p,f];if(d<=0)throw new Error(av());let m=0,v=1,g=0,x=s[m];for(;;){let b=0;if(v<a){if(b=s[v],x===b){++v;continue}if(x>=b)throw new Error(TD())}if(x<0||x>=d)throw new Error(ND(x,d));x>g&&p.fill(i,g*u,x*u);for(let _=m;_<v;++_){const N=r[_];if(N<0||N>=l[0])throw new Error($D(_,r[_],l[0]));for(let E=0;E<u;E++)p[x*u+E]+=t[N*u+E]}if(o)for(let _=0;_<u;_++)p[x*u+_]/=v-m;if(m=v,++v,g=x+1,x=b,v>a)break}return g<d&&p.fill(i,g*u,d*u),[p,f]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const koe=si(t=>Math.sqrt(t));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ioe=hr((t,e)=>{const n=t-e;return n*n});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ooe=si((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:s}=e;return t.replace(new RegExp(n,r?"g":""),s)});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Roe(t,e,n,r){const s=Lt(t,e.dtype);for(let o=0;o<s.size;o++){const i=s.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+r[l];s.set(e.get(...a),...i)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Doe{constructor(e,n,r,s,o,i){this.separator=Pa(e),this.nGramWidths=n,this.leftPad=Pa(r),this.rightPad=Pa(s),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,s,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),u=Math.max(0,l-a),c=Math.max(0,l-(o-(a+1))),d=i-(u+c),f=n+(u>0?0:a-l);let h=0;h+=u*this.leftPad.length;for(let x=0;x<d;++x)h+=e[f+x].length;h+=c*this.rightPad.length;const p=u+c+d-1;h+=p*this.separator.length,r[s+a]=new Uint8Array(h);const m=r[s+a];let v=0;const g=x=>x.forEach(b=>m[v++]=b);for(let x=0;x<u;++x)g(this.leftPad),g(this.separator);for(let x=0;x<d-1;++x)g(e[f+x]),g(this.separator);if(d>0){g(e[f+d-1]);for(let x=0;x<c;++x)g(this.separator),g(this.rightPad)}else{for(let x=0;x<c-1;++x)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const r=e.length,s=n.length;if(s>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<s;++u){let c=n[u]>=l;if(c=c&&n[u]<=r,!c)throw new Error(`Invalid split value ${n[u]}, must be in [${l}, ${r}]`);l=n[u]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const o=s-1,i=mn("int32",s);if(r===0||s===0){const l=new Array(r);for(let u=0;u<=o;++u)i[u]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const u=n[l]-n[l-1];let c=0;this.nGramWidths.forEach(d=>{c+=this.getNumNGrams(u,d)}),this.preserveShort&&u>0&&c===0&&(c=1),i[l]=i[l-1]+c}const a=new Array(i[o]);for(let l=0;l<o;++l){const u=n[l];let c=i[l];if(this.nGramWidths.forEach(d=>{const f=n[l+1]-n[l],h=this.getNumNGrams(f,d);this.createNGrams(e,u,a,c,h,d),c+=h}),this.preserveShort&&c===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const f=d+2*this.padWidth,h=1;this.createNGrams(e,u,a,c,h,f)}}return[a,i]}}function Aoe(t,e,n,r,s,o,i,a){return new Doe(n,r,s,o,i,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Poe(t,e,n,r){if(!t.length)return;if(e.length===0){for(let o=0;o<t.length;++o)r.push(t.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=t.indexOf(o);for(;i!==-1;){const a=t.subarray(0,i);(!n||a.length!==0)&&r.push(a),t=t.subarray(i+1),i=t.indexOf(o)}(!n||t.length!==0)&&r.push(t);return}let s=0;for(let o=0;o<t.length+1;o++)if(o===t.length||e.indexOf(t[o])!==-1){const i=t.subarray(s,o);(!n||i.length!==0)&&r.push(i),s=o+1}}function Loe(t,e,n){const r=t.length,s=[];let o=0,i=0;const a=new Array(r);for(let f=0;f<r;++f){const h=s.length;Poe(t[f],e,n,s);const p=s.length-h;a[f]=p,o+=p,i=Math.max(i,p)}const l=mn("int32",o*2),u=new Array(o),c=[r,i];let d=0;for(let f=0;f<r;++f)for(let h=0;h<a[f];++h)l[d*2]=f,l[d*2+1]=h,u[d]=s[d],++d;return[l,u,c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Foe(t,e){const n=mn("int32",t.length);for(let r=0;r<t.length;++r)n[r]=QU(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Moe=hr((t,e)=>t-e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function joe(t,e){const n=new Array(t.rank);for(let s=0;s<n.length;s++)n[s]=t.shape[s]*e[s];const r=Lt(n,t.dtype);for(let s=0;s<r.values.length;++s){const o=r.indexToLoc(s),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%t.shape[l];const a=t.locToIndex(i);r.values[s]=t.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pc=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function NP(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const a=r-n+1,l=e-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),d=.5*Math.sqrt(u*c*(a-c)/a)*Math.sign(l-a/2),f=Math.max(n,Math.floor(e-l*c/a+d)),h=Math.min(r,Math.floor(e+(a-l)*c/a+d));NP(t,e,f,h)}const s=t[e];let o=n,i=r;for(yc(t,n,e),Pc(t[r],s)>0&&yc(t,n,r);o<i;){for(yc(t,o,i),o++,i--;Pc(t[o],s)<0;)o=o+1;for(;Pc(t[i],s)>0;)i=i-1}Pc(t[n],s)===0?yc(t,n,i):(i=i+1,yc(t,i,r)),i<=e&&(n=i+1),e<=i&&(r=i-1)}}function Boe(t,e,n,r,s){const o=e[e.length-1],[i,a]=[t.length/o,o],l=Qi(n,i*r),u=Qi("int32",i*r);for(let d=0;d<i;d++){const f=d*a,h=t.subarray(f,f+a);let p=new Array(h.length);h.forEach((x,b)=>p[b]={value:x,index:b}),r<p.length&&(NP(p,r),p=p.slice(0,r)),s&&p.sort(Pc);const m=d*r,v=l.subarray(m,m+r),g=u.subarray(m,m+r);for(let x=0;x<r;x++)v[x]=p[x].value,g[x]=p[x].index}const c=e.slice();return c[c.length-1]=r,[Lt(c,n,l),Lt(c,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(t,e,n,r){const s=gn(e,n)[0],o=[1,n[0],1];for(let p=0;p<s;p++)o[0]*=n[p];o[1]=n[s];for(let p=s+1;p<n.length;p++)o[2]*=n[p];const i=new Map,a=new Int32Array(n[s]),l=new wu(o,r,t),u=[],c=o[0]===1&&o[2]===1;for(let p=0;p<n[s];p++){let m;if(c)m=t[p].toString();else{const g=[];for(let x=0;x<o[0];x++)for(let b=0;b<o[2];b++)g.push(l.get(x,p,b));m=g.join(",")}const v=i.get(m);if(v!=null)a[p]=v;else{const g=i.size;i.set(m,g),a[p]=g,u.push(p)}}const d=o.slice();d[1]=i.size;const f=new wu(d,r);u.forEach((p,m)=>{for(let v=0;v<o[0];v++)for(let g=0;g<o[2];g++)f.set(l.get(v,p,g),v,m,g)});const h=n.slice();return h[s]=d[1],{outputValues:f.values,outputShape:h,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zoe=Object.freeze(Object.defineProperty({__proto__:null,addImpl:Bse,bincountImpl:Use,bincountReduceImpl:zse,bitwiseAndImpl:Wse,castImpl:jse,ceilImpl:Vse,concatImpl:Gse,equalImpl:Hse,expImpl:qse,expm1Impl:Kse,floorDivImpl:Yse,floorImpl:Xse,gatherNdImpl:Qse,gatherV2Impl:Zse,greaterEqualImpl:eoe,greaterImpl:Jse,lessEqualImpl:noe,lessImpl:toe,linSpaceImpl:roe,logImpl:soe,maxImpl:ooe,maximumImpl:ioe,minimumImpl:aoe,multiplyImpl:TP,negImpl:loe,notEqualImpl:uoe,prodImpl:doe,raggedGatherImpl:voe,raggedRangeImpl:xoe,raggedTensorToTensorImpl:boe,rangeImpl:woe,rsqrtImpl:Soe,scatterImpl:Coe,sigmoidImpl:_oe,simpleAbsImpl:Mse,sliceImpl:Eoe,sparseFillEmptyRowsImpl:Toe,sparseReshapeImpl:Noe,sparseSegmentReductionImpl:$oe,sqrtImpl:koe,squaredDifferenceImpl:Ioe,staticRegexReplaceImpl:Ooe,stridedSliceImpl:Roe,stringNGramsImpl:Aoe,stringSplitImpl:Loe,stringToHashBucketFastImpl:Foe,subImpl:Moe,tileImpl:joe,topKImpl:Boe,transposeImpl:coe,uniqueImpl:Uoe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Woe,bincountImpl:$P,bincountReduceImpl:Voe,bitwiseAndImpl:Goe,castImpl:Hoe,ceilImpl:qoe,concatImpl:Koe,equalImpl:Xoe,expImpl:Yoe,expm1Impl:Qoe,floorImpl:Zoe,gatherNdImpl:Joe,gatherV2Impl:eie,greaterImpl:tie,greaterEqualImpl:nie,lessImpl:rie,lessEqualImpl:sie,linSpaceImpl:oie,logImpl:iie,maxImpl:aie,maximumImpl:lie,minimumImpl:uie,multiplyImpl:cie,negImpl:die,notEqualImpl:fie,prodImpl:hie,raggedGatherImpl:pie,raggedRangeImpl:mie,raggedTensorToTensorImpl:gie,rangeImpl:yie,rsqrtImpl:vie,scatterImpl:xie,sigmoidImpl:bie,simpleAbsImpl:kP,sliceImpl:wie,sparseFillEmptyRowsImpl:Sie,sparseReshapeImpl:Cie,sparseSegmentReductionImpl:IP,sqrtImpl:_ie,staticRegexReplaceImpl:Eie,stridedSliceImpl:Tie,stringNGramsImpl:Nie,stringSplitImpl:$ie,stringToHashBucketFastImpl:kie,subImpl:Iie,tileImpl:Oie,topKImpl:Rie,transposeImpl:wb,uniqueImpl:Die}=zoe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OP(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Qn(t,e){return e===1?[t]:OP(t,e)}function Aie(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pie{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Fn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Qn("rc",this.rank),r=mt(this.rank),s=this.getOutOfBoundsCondition(n),o=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let o=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;n.push(o)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RP{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Fn(this.outputShape.length);let r="";for(let s=0;s<4;s++){let o="thisRC = rc;";s%2===1&&(o+="thisRC.z += 1;"),s>1&&(o+="thisRC.y += 1;"),r+=`
        ${o}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${Lie(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?xb():vb(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function Lie(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?kre(["r","c","d"],"inputShape"):yl(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fie{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const s=$E(n,r),o=kE(e,s,r);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=NE(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return s===Tn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===Tn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===Tn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===Tn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===Tn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,n,r,s){if(this.freeTextures==null)return;const o=$E(r,s),i=kE(n,o,s);i in this.freeTextures||(this.freeTextures[i]=[]);const a=NE(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,s),l=Y().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[i],c=u&&u.indexOf(e);if(c==null||c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[c]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Mie(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function NE(t,e,n,r,s){const o=jie(e,r);let i;if(s){const[l,u]=zu(t[0],t[1]);i=l*u}else{const[l,u]=Zd(t[0],t[1]);i=l*u}const a=Mie(n,o);return i*a}function jie(t,e){switch(t){case Tn.PACKED_2X2_FLOAT32:return _P(e);case Tn.PACKED_2X2_FLOAT16:return EP(e);case Tn.UNPACKED_FLOAT32:return wP(e);case Tn.UNPACKED_FLOAT16:return SP(e);case Tn.PACKED_4X1_UNSIGNED_BYTE:return CP(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Bie(t){return Y().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Tn.PACKED_2X2_FLOAT32:Tn.UNPACKED_FLOAT32:t?Tn.PACKED_2X2_FLOAT16:Tn.UNPACKED_FLOAT16}function $E(t,e){if(t===zr.UPLOAD)return Tn.PACKED_2X2_FLOAT32;if(t===zr.RENDER||t==null)return Bie(e);if(t===zr.DOWNLOAD||t===zr.PIXELS)return Tn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function kE(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bo{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Fn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Os="if (isnan(x)) return x;",Uie="return x;",IE="return abs(x);",zie="return (x >= 0.0) ? x : (exp(x) - 1.0);",Wie=Os+`
  return (x < 0.0) ? 0.0 : x;
`,Vie=Os+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Si="return x;",Gie="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hie="return x;",qie=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Kie=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Xie=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Yie="return 1.0 / (1.0 + exp(-1.0 * x));";class Ii{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Fn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qie{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Fn(this.outputShape.length);const n=e.length,r=Qn("rc",n),s=mt(n),o=Aie(n,r),i=r.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zie=SR,Jie=1e-7,eae=1e-4,th={};function tae(t){return t in th||(th[t]={}),th[t]}const nae=Y().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),rae=600;function sae(){return Y().global.screen==null?1024:Y().global.screen.height*Y().global.screen.width*window.devicePixelRatio*rae/1024/1024}class Xm extends d${nextDataId(){return Xm.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Y().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof ky)n=e;else{const r=so(Y().getNumber("WEBGL_VERSION"),e);n=new ky(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=so(Y().getNumber("WEBGL_VERSION"));n=new ky(r),this.binaryCache=tae(Y().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Fie(this.gpgpu),this.numMBBeforeWarning=sae(),this.texData=new gU(this,fi())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,s,o,i){const a=this.makeTensorInfo(n,r),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[s,o]},l.texShape=[s,o];const u=Jf(n),c=new SE(u,!1,i),d=this.runWebGLProgram(c,[a],r,[[s,o]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,r){if((Y().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Y().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:n,dtype:r,values:e,usage:zr.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,s,o){if(Y().getBool("DEBUG")&&this.checkNumericalProblems(n),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:n,usage:zr.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=n;if(i!=null){let f;l?f=new Ii(a,Si):f=new bo(a,Si);const h=this.runWebGLProgram(f,[{dataId:e,shape:a,dtype:s}],s),p=this.readSync(h.dataId);return this.disposeIntermediateTensorInfo(h),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const u=this.activeTimers!=null;let c;u&&(c=Ks());let d;if(s==="complex64"){const f=this.readSync(o.real.dataId),h=this.readSync(o.imag.dataId);d=iv(f,h)}else d=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=Ks()-c),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:r,shape:s,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(o!=null){let p;l?p=new Ii(s,Si):p=new bo(s,Si);const m=this.runWebGLProgram(p,[{dataId:e,shape:s,dtype:i}],i),v=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),v}if(r!=null)return this.convertAndCacheOnCPU(e);if(Y().getBool("DEBUG")&&!Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Y().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,c;if(i!=="complex64"&&Y().get("WEBGL_BUFFER_SUPPORTED")){c=this.decode(e);const p=this.texData.get(c.dataId);u=this.gpgpu.createBufferFromTexture(p.texture.texture,...Yf(s))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],v=p[1];d=iv(m,v)}else if(u==null)d=this.getValuesFromTexture(e);else{const p=pe(s);d=this.gpgpu.downloadFloat32MatrixFromBuffer(u,p)}if(c!=null&&this.disposeIntermediateTensorInfo(c),u!=null){const p=this.gpgpu.gl;xe(p,()=>p.deleteBuffer(u))}const f=this.convertAndCacheOnCPU(e,d),h=this.pendingRead.get(e);return this.pendingRead.delete(e),h.forEach(p=>p(f)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&fi().removeDataId(e,this),this.pendingDeletes--),f}readToGPU(e,n={}){const r=this.texData.get(e),{values:s,shape:o,slice:i,dtype:a,isPacked:l,texture:u}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let h;l?h=new Ii(o,Si):h=new bo(o,Si);const p=this.runWebGLProgram(h,[{dataId:e,shape:o,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(u==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const c=this.decode(e,n.customTexShape),d=fi().makeTensorFromTensorInfo(c),f=this.texData.get(c.dataId);return Object.assign({tensorRef:d},f.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(s=>bu(s));return Lt(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Lt(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!nre(r))throw Y().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:s}=this.texData.get(e),o=pe(n);if(Y().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const f=this.decode(e),h=this.texData.get(f.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(h.texture.texture,...Yf(n)).subarray(0,o);return this.disposeIntermediateTensorInfo(f),p}const i=Y().getBool("WEBGL_PACK")&&s===!0,a=i?Jf(n):n,l=i?new vse(a):new yse(a),u=this.runWebGLProgram(l,[{shape:a,dtype:r,dataId:e}],"float32"),c=this.texData.get(u.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(c.texture.texture,c.texShape[0],c.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(u),d}timerAvailable(){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const o=Ha(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=Ha(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=yU(l),a.getExtraProfileInfo=()=>l.map((u,c)=>({name:i[c],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Ks(),endMs:null}}endTimer(e){return Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Ks(),e)}async getQueryTime(e){if(Y().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:s,usage:o,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(n,s,o,i)));const c=this.texData.get(e);c.texture=null,c.texShape=null,c.isPacked=!1,c.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=nae){return Y().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&pe(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Js("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return Zie(e.shape,n)}packedUnaryOp(e,n,r){const s=new Ii(e.shape,n),o=this.compileAndRun(s,[e],r);return fi().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=kP(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(Y().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,IE,e.dtype);const n=new bo(e.shape,IE),r=this.compileAndRun(n,[e]);return fi().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let s;if(n==="string"&&r!=null&&r.length>0&&bm(r[0])){const o=r.map(i=>Pa(i));s=this.write(o,e,n)}else s=this.write(r,e,n);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:n}}makeOutput(e,n,r){return fi().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new Qie(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Pie(e.shape),r=!0;return this.runWebGLProgram(n,[e],e.dtype,null,r)}packedReshape(e,n){const r=[Tu(e.shape),...Nu(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},o=[Tu(n),...Nu(n)],i=new RP(o,r),a=!0,l=[r],u=this.runWebGLProgram(i,[s],e.dtype,l,a);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:s,shape:o,dtype:i}=r;if(n!=null){const f=pe(o),h=n[0]*n[1]*4;D(f<=h,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Jf(o);let l;s?l=new gse(a):l=new mse(a);const u=!0,c=[n??Yf(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,c,u,n);return{dtype:i,shape:o,dataId:d.dataId}}runWebGLProgram(e,n,r,s,o=!1,i){const a=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Od.DENSE){const g=i??Yf(e.outputShape);l.texShape=g.map(x=>x*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),pe(a.shape)===0)return l.values=Qi(a.dtype,0),a;const u=[],c=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(g.dataId);if(x.texture==null){if(!e.packedInputs&&pe(g.shape)<=Y().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!x.isPacked!=!!e.packedInputs)g=x.isPacked?this.unpackTensor(g):this.packTensor(g),u.push(g),x=this.texData.get(g.dataId);else if(x.isPacked&&!Np(x.shape,g.shape)){const b=g,_=g.shape;g.shape=x.shape,g=this.packedReshape(g,_),u.push(g),x=this.texData.get(g.dataId),b.shape=_}return{shape:g.shape,texData:x,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},f=pse(e,c,d),h=this.getAndSaveBinary(f,()=>fse(this.gpgpu,e,c,d)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),Y().get("ENGINE_COMPILE_ONLY")||hse(this.gpgpu,h,c,d,s),u.forEach(g=>this.disposeIntermediateTensorInfo(g)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const v=Y().getNumber("WEBGL_FLUSH_THRESHOLD");if(v>0){const g=Ks();g-this.lastGlFlushTime>v&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!Y().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const g=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),g}return a}compileAndRun(e,n,r,s,o=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,s,o)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Y().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ke(()=>{if(!Y().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Y().getBool("DEBUG");Y().set("DEBUG",!1);const n=this.abs(Ze(1e-8)).dataSync()[0];if(Y().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Jie:eae}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:s,values:o,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const u=this.activeTimers!=null;let c;u&&(c=Ks());let d=n.texShape;if(d==null&&(d=bre(r,l),n.texShape=d),o!=null){const f=Jf(r);let h,p=d[1],m=d[0];const v=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!v)&&([p,m]=zu(d[0],d[1])),l?h=new bse(f,v):h=new SE(f,v);const g=v?[m,p]:d,x=this.makeTensorInfo(g,s),b=this.texData.get(x.dataId);v?b.usage=zr.PIXELS:b.usage=zr.UPLOAD,b.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),p,m,o);const _=[[m,p]],N=!0,E=this.runWebGLProgram(h,[x],s,_,N),R=this.texData.get(E.dataId);n.texShape=R.texShape,n.isPacked=R.isPacked,n.usage=R.usage,Y().get("ENGINE_COMPILE_ONLY")?this.disposeData(E.dataId):(n.texture=R.texture,n.values=null,this.texData.delete(E.dataId)),this.disposeIntermediateTensorInfo(x),u&&(this.uploadWaitMs+=Ks()-c)}else{const f=this.acquireTexture(d,a,s,l);n.texture=f}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:s}=r;return n!=null&&(r.values=oae(n,s)),r.values}acquireTexture(e,n,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,s)}computeBytes(e,n){return e[0]*e[1]*cp(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(n),s(!0)}catch(o){throw o}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await D7(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(mP(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:s,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:l}=bP(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:s,height:o,width:i,channels:a}=e,l=fi().backend;if(!l.gpgpu.gl.isTexture(s))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=l.writeTexture(s,n,r,o,i,a);return fi().makeTensorFromDataId(u,n,r,l)}}Xm.nextDataId=0;function oae(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */CO()&&v5("webgl",()=>new Xm,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sb=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class sl{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=nt(n,r),this.enableShapeUniforms=Fn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xl=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class qu{constructor(e,n,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=nt(n,r);const o=this.outputShape.length;this.enableShapeUniforms=Fn(o);let i="";if(s)if(o===0||pe(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${mt(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=Qn("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tr(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const iae={kernelName:ax,backendName:"webgl",kernelFunc:Tr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ua(t){const{inputs:e,backend:n}=t,{real:r,imag:s}=e,o=n.makeTensorInfo(r.shape,"complex64"),i=n.texData.get(o.dataId),a=Tr({inputs:{x:r},backend:n}),l=Tr({inputs:{x:s},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const aae={kernelName:M$,backendName:"webgl",kernelFunc:ua};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DP="return (a < 0.) ? b * a : a;",AP=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function lae(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{alpha:o}=r,i=n.makeTensorInfo([],"float32",Pu(o,"float32")),a=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(AP,s.shape,i.shape):new sl(DP,s.shape,i.shape),l=n.runWebGLProgram(a,[s,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const uae={kernelName:Nk,backendName:"webgl",kernelFunc:lae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PP="return (a < 0.) ? b * a : a;",LP=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function cae(t){const{inputs:e,backend:n}=t,{x:r,alpha:s}=e,o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(LP,r.shape,s.shape):new sl(PP,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],"float32")}const dae={kernelName:oI,backendName:"webgl",kernelFunc:cae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ku="if (isnan(x)) return x;";function tt({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:s,backend:o})=>{const{x:i}=s,a=o,l=r||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const d=a.texData.get(i.dataId),f=n(d.values,l);return a.makeTensorInfo(i.shape,l,f)}const u=Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let c;return u?c=new Ii(i.shape,e):c=new bo(i.shape,t),a.runWebGLProgram(c,[i],l)}}function On({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:u}=i,c=a;if(r&&l.dtype==="complex64"){const p=c.texData.get(l.dataId),m=c.texData.get(u.dataId),[v,g]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(b=>{const[_,N]=b,E={dataId:_.dataId,dtype:_.dtype,shape:l.shape},R={dataId:N.dataId,dtype:N.dtype,shape:u.shape},P=new sl(t,l.shape,u.shape);return c.runWebGLProgram(P,[E,R],To(_.dtype,N.dtype))}),x=ua({inputs:{real:v,imag:g},backend:c});return c.disposeIntermediateTensorInfo(v),c.disposeIntermediateTensorInfo(g),x}const d=o||To(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||c.shouldExecuteOnCPU([l,u]))&&s!=null){const p=c.texData.get(l.dataId).values,m=c.texData.get(u.dataId).values,v=l.dtype==="string"?_u(p):p,g=l.dtype==="string"?_u(m):m,[x,b]=s(l.shape,u.shape,v,g,d),_=c.makeTensorInfo(b,d),N=c.texData.get(_.dataId);return N.values=x,_}const f=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let h;return f?h=new qu(e,l.shape,u.shape,n):h=new sl(t,l.shape,u.shape),c.runWebGLProgram(h,[l,u],d)}}function Rd(t,e=!1){if(t==="linear")return e?Hie:Uie;if(t==="relu")return e?Kie:Wie;if(t==="elu")return e?qie:zie;if(t==="relu6")return e?Xie:Vie;if(t==="prelu")return e?LP:PP;if(t==="leakyrelu")return e?AP:DP;if(t==="sigmoid")return e?Yie:Gie;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FP{constructor(e,n,r,s=!1,o=!1,i=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Fn(this.outputShape.length);const c=s?e[1]:e[2],d=Math.ceil(c/2),f=s?"i * 2, rc.y":"rc.y, i * 2",h=o?"rc.z, i * 2":"i * 2, rc.z",p=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let v="",g="";a&&(l?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:v=`vec4 activation(vec4 x) {
          ${a}
        }`,g="result = activation(result);");const x=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let b="rc.x",_="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(_=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${v}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${_};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${f});
          vec4 b = getMatrixB(batchB, ${h});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OE={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class RE{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=nt(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DE="return a * b;";function Cb(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,o=To(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),u=new RE(OE.REAL,r.shape,s.shape),c=new RE(OE.IMAG,r.shape,s.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape}],f=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),p=ua({inputs:{real:f,imag:h},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),p}if(n.shouldExecuteOnCPU([r,s])){const a=n.texData.get(r.dataId),l=n.texData.get(s.dataId),[u,c]=cie(r.shape,s.shape,a.values,l.values,o),d=n.makeTensorInfo(c,o),f=n.texData.get(d.dataId);return f.values=u,d}let i;return Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new qu(DE,r.shape,s.shape):i=new sl(DE,r.shape,s.shape),n.runWebGLProgram(i,[r,s],o)}const fae={kernelName:Kk,backendName:"webgl",kernelFunc:Cb};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hae(t,e,n){const r=[Tu(t.shape),...Nu(t.shape)],s={dtype:t.dtype,shape:r,dataId:t.dataId},o=[Tu(e),...Nu(e)],i=new RP(o,r),a=!0,l=[r],u=n.runWebGLProgram(i,[s],t.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ge(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{shape:o}=r,i=n,a=pe(s.shape),l=xU(o,a),u=pe(l);D(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const c=i.texData.get(s.dataId);return c.isPacked&&!Np(s.shape,l)&&!(c.texture!==null&&Np(c.shape,l))?hae(s,l,i):(i.incRef(s.dataId),{dataId:s.dataId,shape:l,dtype:s.dtype})}const pae={kernelName:pI,backendName:"webgl",kernelFunc:ge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AE{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];const a=Math.floor(r/4)*4,l=r%4;let u="sumValue += dot(values, ones);";if(n!=null){const d=1/n;u=`sumValue += dot(values * ${vu(d)?d.toPrecision(2):d}, ones);`}let c="";o%r>0&&(c=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${c}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mae{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const c=Math.floor(r/4)*4,d=r%4;let f=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,h="vec4";n==="all"?(a="1.0",f=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,h="bvec4"):n==="any"&&(a="0.0",f=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,h="bvec4");let p="";o%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===2}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${f}
        } else if (${d===3}) {
          ${h} values = ${h}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gae(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=Am(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function bl(t,e,n,r){const s=gae(t.shape);let o=t;for(let i=0;i<s.length;i++){const{inSize:a,windowSize:l,outSize:u}=s[i];let c,d;n==="mean"?c=i===0?new AE({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},a):new AE({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u}):c=new mae({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:u},n),d=o,o=r.runWebGLProgram(c,[o],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yae{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[n[i]];this.outputShape=r,this.rank=r.length;const s=mt(this.rank),o=vae(n);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function vae(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<t.length;s++)r[t[s]]=n[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xae{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let c=0;c<r.length;c++)r[c]=e[n[c]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=mt(this.rank),o=OP("rc",this.rank),i=new Array(this.rank);for(let c=0;c<n.length;c++)i[n[c]]=o[c];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${r[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ym(t,e,n){const r=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new xae(t.shape,e):new yae(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bae(t,e,n,r){const s=e,o=t.shape.length,i=gn(s,t.shape);let a=i;const l=ks(a,o),u=l!=null;let c=t;u&&(c=Ym(t,l,r),a=Is(a.length,o)),lo("sum",a,o);const[d,f]=No(c.shape,a);let h=d;n&&(h=es(d,i));const p=pe(f),v=pe(t.shape)/p,g=ge({inputs:{x:c},attrs:{shape:[v,p]},backend:r}),x=cx(t.dtype),b=bl(g,x,"sum",r),_=ge({inputs:{x:b},attrs:{shape:h},backend:r});return r.disposeIntermediateTensorInfo(g),r.disposeIntermediateTensorInfo(b),u&&r.disposeIntermediateTensorInfo(c),_}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qm(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r;return bae(s,o,i,n)}const wae={kernelName:DI,backendName:"webgl",kernelFunc:Qm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jn(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{perm:o}=r,i=n,a=s.shape.length,l=new Array(a);for(let c=0;c<l.length;c++)l[c]=s.shape[o[c]];let u;if(i.shouldExecuteOnCPU([s])){const d=i.texData.get(s.dataId).values,f=wb(d,s.shape,s.dtype,o,l);u=i.makeTensorInfo(l,s.dtype);const h=i.texData.get(u.dataId);h.values=f}else u=Ym(s,o,i);return u}const Sae={kernelName:gh,backendName:"webgl",kernelFunc:Jn};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MP=1e3;function kp({a:t,b:e,transposeA:n,transposeB:r,backend:s,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const u=t.shape.length,c=e.shape.length,d=n?t.shape[u-2]:t.shape[u-1],f=r?e.shape[c-1]:e.shape[c-2],h=n?t.shape[u-1]:t.shape[u-2],p=r?e.shape[c-2]:e.shape[c-1],m=t.shape.slice(0,-2),v=e.shape.slice(0,-2),g=pe(m),x=pe(v),_=nt(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([h,p]);D(d===f,()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const N=n?[g,d,h]:[g,h,d],E=r?[x,p,f]:[x,f,p],R=ge({inputs:{x:t},backend:s,attrs:{shape:N}}),P=ge({inputs:{x:e},backend:s,attrs:{shape:E}}),B=[R,P],F=Math.max(g,x),H=n?R.shape[1]:R.shape[2],ee=o!=null,oe=i!=null,de=l==="leakyrelu",V=l!=null?Rd(l,!0):null,W=ee||oe||de||V!=null;let I;if((h===1||p===1)&&H>MP&&W===!1){let j=R,A=P;n&&(j=Jn({inputs:{x:R},backend:s,attrs:{perm:[0,2,1]}}),B.push(j)),r&&(A=Jn({inputs:{x:P},backend:s,attrs:{perm:[0,2,1]}}),B.push(A));const ne=p!==1,U=p===1;let Q=j;ne&&(Q=ge({inputs:{x:j},backend:s,attrs:{shape:[F,H,1]}}),B.push(Q));const G=p===1?2:1;let J=A;U&&(J=ge({inputs:{x:A},backend:s,attrs:{shape:[F,1,H]}}),B.push(J));const re=Cb({inputs:{a:Q,b:J},backend:s});I=Qm({inputs:{x:re},backend:s,attrs:{axis:G,keepDims:!0}}),B.push(re)}else{const j=To(t.dtype,e.dtype),A=new FP(N,E,[F,h,p],n,r,ee,V,oe,de),ne=[R,P];if(o!=null&&ne.push(o),oe&&ne.push(i),de){const U=s.makeTensorInfo([],"float32",Pu(a,"float32"));ne.push(U),B.push(U)}I=s.runWebGLProgram(A,ne,j)}const O=ge({inputs:{x:I},backend:s,attrs:{shape:_}});B.push(I);for(const j of B)s.disposeIntermediateTensorInfo(j);return O}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cae(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:c,leakyreluAlpha:d}=r;return kp({a:s,b:o,transposeA:l,transposeB:u,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:c})}const _ae={kernelName:B0,backendName:"webgl",kernelFunc:Cae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PE="return abs(x);";function Eae(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const o=n.texData.get(r.dataId),i=kP(o.values);return n.makeTensorInfo(r.shape,r.dtype,i)}let s;return Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Ii(r.shape,PE):s=new bo(r.shape,PE),n.runWebGLProgram(s,[r],r.dtype)}const Tae={kernelName:g$,backendName:"webgl",kernelFunc:Eae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nae=Os+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,$ae=tt({opSnippet:Nae}),kae={kernelName:y$,backendName:"webgl",kernelFunc:$ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iae=Os+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Oae=tt({opSnippet:Iae}),Rae={kernelName:v$,backendName:"webgl",kernelFunc:Oae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LE="return a + b;",Dae=On({opSnippet:LE,packedOpSnippet:LE,supportsComplex:!0,cpuKernelImpl:Woe}),Aae={kernelName:ox,backendName:"webgl",kernelFunc:Dae};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pae{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`float v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lae{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`vec4 v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eh(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return Tr({inputs:{x:r[0]},backend:n});if(r.length>Y().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),u=Eh({inputs:r.slice(0,l),backend:n}),c=Eh({inputs:r.slice(l),backend:n});return Eh({inputs:[u,c],backend:n})}const s=r.map(l=>l.dtype).reduce((l,u)=>To(l,u)),o=r.map(l=>l.shape),a=Y().getBool("WEBGL_PACK")?new Lae(r[0].shape,o):new Pae(r[0].shape,o);return n.runWebGLProgram(a,r,s)}const Fae={kernelName:x$,backendName:"webgl",kernelFunc:Eh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mae(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=gn(o,s.shape);let u=l;const c=ks(u,a);let d=s;c!=null&&(d=Jn({inputs:{x:s},backend:n,attrs:{perm:c}}),u=Is(u.length,a)),lo("all",u,a);const[f,h]=No(d.shape,u),p=pe(h),m=ge({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),v=bl(m,m.dtype,"all",n);let g;if(i){const x=es(f,l);g=ge({inputs:{x:v},backend:n,attrs:{shape:x}})}else g=ge({inputs:{x:v},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),g}const jae={kernelName:b$,backendName:"webgl",kernelFunc:Mae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bae(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=gn(o,s.shape);let u=l;const c=ks(u,a);let d=s;c!=null&&(d=Jn({inputs:{x:s},backend:n,attrs:{perm:c}}),u=Is(u.length,a)),lo("any",u,a);const[f,h]=No(d.shape,u),p=pe(h),m=ge({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),v=bl(m,m.dtype,"any",n);let g;if(i){const x=es(f,l);g=ge({inputs:{x:v},backend:n,attrs:{shape:x}})}else g=ge({inputs:{x:v},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),g}const Uae={kernelName:w$,backendName:"webgl",kernelFunc:Bae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zae{constructor(e,n,r){this.variableNames=["A"];const{windowSize:s,batchSize:o,outSize:i}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wae{constructor(e,n,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,D(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=mt(l),c=Qn("coords",l);let d,f;if(i===1){f=l+1;const P=mt(f);d=`
        ${P} sourceLocR = ${P}(${c.join()}, 0);
        ++${c[l-1]};
        ${P} sourceLocG = ${P}(${c.join()}, 0);
        ++${c[l-2]};
        ${P} sourceLocA = ${P}(${c.join()}, 0);
        --${c[l-1]};
        ${P} sourceLocB = ${P}(${c.join()}, 0);
        --${c[l-2]};`}else f=l,d=`
        ${u} sourceLocR = coords;
        ++${c[l-1]};
        ${u} sourceLocG = coords;
        ++${c[l-2]};
        ${u} sourceLocA = coords;
        --${c[l-1]};
        ${u} sourceLocB = coords;
        --${c[l-2]};`;const h=["x","y","z","w","u","v"].slice(0,f),p="."+h[f-1],m=h.map(P=>"int "+P),v=Qn("sourceLocR",f-1).concat("inIdx.r"),g=Qn("sourceLocG",f-1).concat("inIdx.g"),x=Qn("sourceLocB",f-1).concat("inIdx.b"),b=Qn("sourceLocA",f-1).concat("inIdx.a"),_=r==="max"?"greaterThan":"lessThan",N=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${v.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${b.join()})));`,E=`vec4(
            getAChannel(${v.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,R=s?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${h.join()}),
                                          vec2(${h.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${h.join()}),
                               vec2(${h.slice(-2).join()}));
      }
      ${R}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${c[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${c[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${E};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${N}
          vec4 candidate = ${E};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${_}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jP(t,e,n,r=null){let s=e.shape[0],o=e.shape[1];r!=null&&(s=r.shape[0],o=r.shape[1]);const i=Am(o),a={windowSize:i,inSize:o,batchSize:s,outSize:Math.ceil(o/i)},l=new zae(a,n,r==null),u=[e];r!=null&&u.push(r);const c=t.runWebGLProgram(l,u,"int32");if(c.shape[1]===1)return c;const d=jP(t,e,n,c);return t.disposeIntermediateTensorInfo(c),d}function BP(t,e,n,r=null){const s=r!=null?r.shape:e.shape,o=s[s.length-1],i=Am(o),a=new Wae(s,i,n,r==null),l=r==null?[e]:[e,r],u=t.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const c=BP(t,e,n,u);return t.disposeIntermediateTensorInfo(u),c}return u}function UP(t,e,n,r){const s=[n];if(lo("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!Y().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=t.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=t.unpackTensor(e),o.push(l));const[u,c]=No(l.shape,s),d=pe(c),f=ge({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});o.push(f);const h=jP(t,f,r);o.push(h);const p=ge({inputs:{x:h},backend:t,attrs:{shape:u}});return o.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return BP(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vae(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=gn(o,s.shape);const a=ks(i,s.shape.length);let l=s;const u=[];a!=null&&(l=Jn({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=Is(i.length,l.shape.length)),lo("argMax",[i[0]],l.shape.length);const c=UP(n,l,i[0],"max");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const Gae={kernelName:S$,backendName:"webgl",kernelFunc:Vae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hae(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o}=r;let i=gn(o,s.shape);const a=ks(i,s.shape.length);let l=s;const u=[];a!=null&&(l=Jn({inputs:{x:s},backend:n,attrs:{perm:a}}),u.push(l),i=Is(i.length,l.shape.length)),lo("argMin",[i[0]],l.shape.length);const c=UP(n,l,i[0],"min");return u.forEach(d=>n.disposeIntermediateTensorInfo(d)),c}const qae={kernelName:C$,backendName:"webgl",kernelFunc:Hae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kae=Os+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Xae=tt({opSnippet:Kae}),Yae={kernelName:_$,backendName:"webgl",kernelFunc:Xae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qae=Os+"return log(x + sqrt(x * x + 1.0));",Zae=tt({opSnippet:Qae}),Jae={kernelName:E$,backendName:"webgl",kernelFunc:Zae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ele=Os+`
  return atan(x);
`,tle=tt({opSnippet:ele}),nle={kernelName:T$,backendName:"webgl",kernelFunc:tle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rle=Sb+`
  return atan(a, b);
`,sle=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+xl+`
  return result;
`,ole=On({opSnippet:rle,packedOpSnippet:sle}),ile={kernelName:$$,backendName:"webgl",kernelFunc:ole};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ale=Os+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,lle=tt({opSnippet:ale}),ule={kernelName:N$,backendName:"webgl",kernelFunc:lle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dd{constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",v=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let x="0.0";if(m||(x="-1.0 / 1e-20"),r){const P=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${h}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f};
                wC += ${c}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${P} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?o?v:g:`wR * ${f} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let _=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(_="avgValue / max(count, 1.0)");const N=Math.floor(i/4)*4,E=i%4,R=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${h}, ${p});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${N}; wC += 4) {
            int xC = xCCorner + wC * ${c};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              getValue(batch, xR, xC + 3 * ${c}, d)
            );

            ${R}
          }

          int xC = xCCorner + ${N};
          if (${E===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${R}
          } else if (${E===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              initializationValue,
              initializationValue
            );

            ${R}
          } else if (${E===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${c}, d),
              getValue(batch, xR, xC + 2 * ${c}, d),
              initializationValue
            );

            ${R}
          }
        }
        setOutput(${_});
      }
    `}}class _b{constructor(e,n,r,s=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,d=e.dilationHeight,f=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,v=e.padInfo.front,g=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let _="0.0";if(b||(_="-1.0 / 1e-20"),r){const F=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${v}, ${g}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${h};
              wD += ${c}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${f}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${F} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const N="max";let E=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(E="avgValue / max(count, 1.0)");const R=Math.floor(i/4)*4,P=i%4,B=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${N}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${v}, ${g}, ${x});
      const float initializationValue = ${_};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${_});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${c}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${R}; wC += 4) {
              int xC = xCCorner + wC * ${f};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                getValue(batch, xD, xR, xC + 3 * ${f}, ch)
              );

              ${B}
            }

            int xC = xCCorner + ${R};
            if (${P===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${B}
            } else if (${P===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                initializationValue,
                initializationValue
              );

              ${B}
            } else if (${P===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${f}, ch),
                getValue(batch, xD, xR, xC + 2 * ${f}, ch),
                initializationValue
              );

              ${B}
            }
          }
        }
        setOutput(${E});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cle(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Jd(s,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,u=1;D($r(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=ul(s.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&Pt(c.inShape,c.outShape))return Tr({inputs:{x:s},backend:n});const d=new Dd(c,"avg",!1);return n.runWebGLProgram(d,[s],"float32")}const dle={kernelName:k$,backendName:"webgl",kernelFunc:cle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fle(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=r,c=[1,1,1],d=Vd(s.shape,o,i,c,a,l,u),f=new _b(d,"avg",!1);return n.runWebGLProgram(f,[s],"float32")}const hle={kernelName:I$,backendName:"webgl",kernelFunc:fle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ple{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=l-1-e.padInfo.top,d=u-1-e.padInfo.left,f=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${c}, ${d});
      const float avgMultiplier = float(${f});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class mle{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.effectiveFilterDepth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=d-1-e.padInfo.front,m=f-1-e.padInfo.top,v=h-1-e.padInfo.left,g=1/(n*r*s);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${v});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${c}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gle(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],f=Vd(i.shape,a,l,d,u,c),h=new mle(f);return n.runWebGLProgram(h,[s],i.dtype)}const yle={kernelName:DU,backendName:"webgl",kernelFunc:gle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vle(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o;Jd([s,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=r,c=ul(i.shape,a,l,1,u),d=new ple(c);return n.runWebGLProgram(d,[s],i.dtype)}const xle={kernelName:RU,backendName:"webgl",kernelFunc:vle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ble(t){const{inputs:e,backend:n,attrs:r}=t,{a:s,b:o}=e,{transposeA:i,transposeB:a}=r;return kp({a:s,b:o,transposeA:i,transposeB:a,backend:n})}const wle={kernelName:O$,backendName:"webgl",kernelFunc:ble};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sle{constructor(e,n,r,s,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],nt(e,n),nt(e,r);let a="0.0";s!=null&&(nt(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(nt(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cle{constructor(e,n,r,s,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],nt(e,n),nt(e,r);let a="vec4(0.0)";s!=null&&(nt(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(nt(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _le=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:s,variance:o,offset:i,scale:a}=t;D(s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),D(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),D(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const u=[r,s,o];let c=null;i!=null&&(c=i.shape,u.push(i));let d=null;a!=null&&(d=a.shape,u.push(a));const f=Y().getBool("WEBGL_PACK_NORMALIZATION")?new Cle(r.shape,s.shape,o.shape,c,d,l):new Sle(r.shape,s.shape,o.shape,c,d,l);return e.runWebGLProgram(f,u,u[0].dtype)},Ele={kernelName:yk,backendName:"webgl",kernelFunc:_le};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tle{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=mt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=Nle(this.rank);let s;const o=e.map((i,a)=>`sourceLoc.${Av[a]} = start[${a}] + coords.${Av[a]};`);s=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const Av=["x","y","z","w","u","v"];function Nle(t){if(t===1)return"sourceLoc";if(t<=6)return Av.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $le{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=mt(this.rank),r=Qn("coords",this.rank),s=Qn("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,i=`getChannel(getSource(${s.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${i};
        --${s[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${i};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${i};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((c,d)=>`start[${d}]`).join()});`:e.map((c,d)=>`${s[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kle(t,e,n,r){const s=r.texData.get(t.dataId),o=r.makeTensorInfo(n,t.dtype),i=r.texData.get(o.dataId);Object.assign(i,s),i.refCount=1,i.shape=n,i.dtype=t.dtype;let a=jx(e,$n(t.shape));s.slice&&(a+=s.slice.flatOffset),i.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||t.dataId};const l=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,l+1),o}function Xu(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,size:i}=r,[a,l]=KR(s,o,i);if(MR(s,a,l),pe(l)===0)return n.makeTensorInfo(l,s.dtype,[]);if(n.shouldExecuteOnCPU([s])||s.dtype==="string"){const d=n.texData.get(s.dataId),f=wie(d.values,a,l,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,f)}const{isPacked:u}=n.texData.get(s.dataId),c=Mx(s.shape,a,l);if(u||!c){const d=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $le(l):new Tle(l),f=[a];return n.runWebGLProgram(d,[s],s.dtype,f)}return n.uploadToGPU(s.dataId),kle(s,a,l,n)}const Ile={kernelName:TI,backendName:"webgl",kernelFunc:Xu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ole=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,crops:i}=r;D(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((x,b)=>x*b),l=Ux(s.shape,o,a),u=zx(l.length,o.length),c=Wx(s.shape,o,a),d=nD(i,o.length),f=rD(c,i,o.length),h=[],p=ge({inputs:{x:s},backend:n,attrs:{shape:l}}),m=Jn({inputs:{x:p},backend:n,attrs:{perm:u}}),v=ge({inputs:{x:m},backend:n,attrs:{shape:c}}),g=Xu({inputs:{x:v},backend:n,attrs:{begin:d,size:f}});return h.push(p),h.push(m),h.push(v),h.forEach(x=>n.disposeIntermediateTensorInfo(x)),g},Rle={kernelName:R$,backendName:"webgl",kernelFunc:Ole};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dle(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i}=r,a=n.readSync(s.dataId),l=n.readSync(o.dataId),u=$P(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}const Ale={kernelName:D$,backendName:"webgl",kernelFunc:Dle};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ple=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,Lle=`
  return float(int(a.r) & int(b.r));
`;function Fle(t){const{inputs:e,backend:n}=t,{a:r,b:s}=e,o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=Y().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,s])||i===1){const l=n.texData.get(r.dataId).values,u=n.texData.get(s.dataId).values,[c,d]=Goe(r.shape,s.shape,l,u,r.dtype),f=n.makeTensorInfo(d,r.dtype),h=n.texData.get(f.dataId);return h.values=c,f}let a;return o?a=new qu(Ple,r.shape,s.shape,!1):a=new sl(Lle,r.shape,s.shape),n.runWebGLProgram(a,[r,s],r.dtype)}const Mle={kernelName:A$,backendName:"webgl",kernelFunc:Fle};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jle(t){const{inputs:e,backend:n}=t,{s0:r,s1:s}=e,o=n.readSync(r.dataId),i=n.readSync(s.dataId),a=nt(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Ble={kernelName:P$,backendName:"webgl",kernelFunc:jle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ule="return float(a != b);",zP=On({opSnippet:Ule,cpuKernelImpl:fie,dtype:"bool"}),zle={kernelName:Yk,backendName:"webgl",kernelFunc:zP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tf(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Tr({inputs:{x:s.complexTensorInfos.real},backend:n})}const Wle={kernelName:dI,backendName:"webgl",kernelFunc:tf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vle="return float(int(x));";function Gle(t,e){const n=new bo(t.shape,Vle),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pv(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dtype:o}=r;if(o==="complex64"){if(s.dtype==="complex64")return Tr({inputs:{x:s},backend:n});const i=ta(s.shape),a=Pv({inputs:{x:s},backend:n,attrs:{dtype:"float32"}}),l=ua({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(s.dtype==="complex64"){const i=tf({inputs:{input:s},backend:n}),a=Pv({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(i),a}if(!SU(s.dtype,o)){const i=Tr({inputs:{x:s},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([s])){const i=n.texData.get(s.dataId).values,[a,l,u]=Hoe(i,s.shape,s.dtype,o);return n.makeTensorInfo(a,l,u)}if(o==="int32")return Gle(s,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",Qi("bool",1)),l=zP({inputs:{a:s,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${o}`)}const Hle={kernelName:ix,backendName:"webgl",kernelFunc:Pv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FE="return ceil(x);",qle=tt({opSnippet:FE,packedOpSnippet:FE,cpuKernelImpl:qoe}),Kle={kernelName:L$,backendName:"webgl",kernelFunc:qle};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xle{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yle{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qle(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{clipValueMin:o,clipValueMax:i}=r;let a;Y().getBool("WEBGL_PACK_CLIP")?a=new Yle(s.shape):a=new Xle(s.shape);const l=[[o],[i]];return n.runWebGLProgram(a,[s],s.dtype,l)}const Zle={kernelName:F$,backendName:"webgl",kernelFunc:Qle};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jle{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ME(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function eue(t){const{inputs:e,backend:n}=t,{x:r}=e,s=n.texData.get(r.dataId),o=new Jle(r.shape),i=[ME(r,s.complexTensorInfos.real),ME(r,s.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}const tue={kernelName:j$,backendName:"webgl",kernelFunc:eue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nue{constructor(e){this.outputShape=[],this.outputShape=el(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];r.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const s=n.length,o=n[n.length-1];r.push(`else setOutput(getT${s}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rue{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=el(e,n);const r=this.outputShape,s=r.length,o=mt(s),i=Qn("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((m,v)=>`T${v}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const u=a[n],c=a.slice(-2),d=a.join();let f=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${c.join()}));
        }`;for(let m=1;m<l.length;m++){const v=l[m-1];f+=`
        if (${u} < ${l[m]}  && ${u} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${nh(a,u,v)}),
            vec2(${nh(c,u,v)}));
        }`}const h=l.length,p=l[l.length-1];f+=`
        return getChannel(
          getT${h}(${nh(a,u,p)}),
          vec2(${nh(c,u,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${f}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[s-1]} = ${i[s-1]} + 1;
        if (${i[s-1]} < ${r[s-1]}) {
          result.g = getValue(${i});
        }

        ${i[s-2]} = ${i[s-2]} + 1;
        if (${i[s-2]} < ${r[s-2]}) {
          result.a = getValue(${i});
        }

        ${i[s-1]} = ${i[s-1]} - 1;
        if (${i[s-2]} < ${r[s-2]} &&
            ${i[s-1]} < ${r[s-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function nh(t,e,n){const r=t.indexOf(e);return t.map((o,i)=>i===r?`${o} - ${n}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zm(t){const{inputs:e,backend:n}=t,{input:r}=e,s=n.texData.get(r.dataId);return Tr({inputs:{x:s.complexTensorInfos.imag},backend:n})}const sue={kernelName:Ck,backendName:"webgl",kernelFunc:Zm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lc(t,e,n){const r=t[0].dtype;if(r==="complex64"){const h=t.map(x=>tf({inputs:{input:x},backend:n})),p=t.map(x=>Zm({inputs:{input:x},backend:n})),m=Lc(h,e,n),v=Lc(p,e,n),g=ua({inputs:{real:m,imag:v},backend:n});return h.forEach(x=>n.disposeIntermediateTensorInfo(x)),p.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),g}let s=n.shouldExecuteOnCPU(t);if(r==="string"&&(s=!0),s){const h=t.map(_=>{const E=[-1,pe(_.shape.slice(e))];return ge({inputs:{x:_},backend:n,attrs:{shape:E}})}),p=h.map(_=>({vals:n.readSync(_.dataId),shape:_.shape})),m=el(h.map(_=>_.shape),1),v=h[0].shape[0]===1,g=Koe(p,m,r,v),x=el(t.map(_=>_.shape),e),b=n.makeTensorInfo(x,r,g);return h.forEach(_=>n.disposeIntermediateTensorInfo(_)),b}const o=t.filter(h=>pe(h.shape)>0),i=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const h=i?new bo(t[0].shape,Si):new Ii(t[0].shape,Si);return n.runWebGLProgram(h,t,r)}const a=Y().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const h=[];for(let m=0;m<o.length;m+=a){const v=o.slice(m,m+a);h.push(Lc(v,e,n))}const p=Lc(h,e,n);for(const m of h)n.disposeIntermediateTensorInfo(m);return p}if(i){const h=new rue(o.map(p=>p.shape),e);return n.runWebGLProgram(h,o,r)}const{tensors2D:l,outShape:u}=oue(o,e,n),c=new nue(l.map(h=>h.shape)),d=n.runWebGLProgram(c,l,r);l.forEach(h=>n.disposeIntermediateTensorInfo(h));const f=ge({inputs:{x:d},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(d),f}function oue(t,e,n){const r=el(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>ge({inputs:{x:o},attrs:{shape:[-1,pe(o.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WP(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r,o=gn(s,e[0].shape)[0],i=e.map(u=>u.shape);YR(i,o);const a=el(e.map(u=>u.shape),o);if(pe(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>pe(u.shape)>0);return l.length===1?Tr({inputs:{x:l[0]},backend:n}):Lc(l,o,n)}const iue={kernelName:B$,backendName:"webgl",kernelFunc:WP};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VP{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,d=e.dilationWidth,f=e.filterHeight,h=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,v=e.dataFormat==="channelsLast",g=v?1:2,x=v?2:3,b=v?3:1;let _="",N="";r&&(s?_=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?_=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:_=`
          float activation(float x) {
            ${r}
          }
        `,N="result = activation(result);");const E=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${_}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${f}; wR++) {
          int xR = xRCorner + wR * ${c};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${h}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${v}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${v}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${v}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${v}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${E}
        ${N}
        setOutput(result);
      }
    `}}class aue{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,d=e.filterDepth,f=e.filterHeight,h=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${f}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h}; wC++) {
              int xC = xCCorner + wC * ${c};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GP{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Fn(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,c=e.filterWidth,d=c;let f=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let v=0;v<c;v++)f+=`
           vec4 xTexelC${v*2};
           int xTexelC${v*2}Ready;
           vec4 xTexelC${v*2+1};
           int xTexelC${v*2+1}Ready;
           vec4 xC${v};`;f+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let v=0;v<c;v++)f+=`
           xTexelC${v*2} = vec4(0.0);
           xTexelC${v*2}Ready = 0;
           xTexelC${v*2+1} = vec4(0.0);
           xTexelC${v*2+1}Ready = 0;
           xC${v} = vec4(0.0);`;f+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let v=0;v<(d+1)/2;v++){const g=v*2;if(f+=`
           xC = xCCorner + ${g*l};
           `,a===1){if(g<c&&(i%2===1?(f+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,l===1&&g>0?f+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:f+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):f+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<c)){const x=i%2===0?nx(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(f+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,l>1?f+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:f+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):x===1?f+=`
                     xC${g+1} = xTexelC${g};
                     `:f+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<c&&(i%2===1?(f+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<c&&(f+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(f+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<c&&(f+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<c&&(f+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<c&&(f+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}f+=`
     }
   `,f+=`
     }
   `,f+=`
     }
   `;let h="",p="";r&&(s?h=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:o?h=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:h=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${h}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${f}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lue{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Fn(this.outputShape.length);const{dataFormat:r}=n,s=er(),o=r==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let c=0;c<=1;c++)for(let d=0;d<=1;d++)u+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${c};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${c*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ip(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function HP({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=t.shape,u=r.texData.get(t.dataId),c=n.inChannels,d=l[0]*l[1]*l[2],f=n.outChannels,h=n.dataFormat==="channelsLast",p=!1,m=!1;let v;const g=[];if(o!=null){const _=Ip(o.shape,h);_!=null&&(o=ge({inputs:{x:o},backend:r,attrs:{shape:_}}),g.push(o))}if(s!=null){const _=Ip(s.shape,h);_!=null&&(s=ge({inputs:{x:s},backend:r,attrs:{shape:_}}),g.push(s))}if(!((d===1||f===1)&&c>MP)&&u.isPacked&&h&&u.texture!=null&&l[2]%2!==0&&Pt(u.shape.slice(-3),l.slice(-3))){const _=l[0]*l[1]*(l[2]+1),N={dataId:t.dataId,shape:[1,_,n.inChannels],dtype:t.dtype},E=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,D(Np(u.shape,N.shape),()=>`packed reshape ${u.shape} to ${N.shape} isn't free`);const R=ge({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(R);const P=kp({a:N,b:R,backend:r,transposeA:p,transposeB:m,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),B=r.texData.get(P.dataId);D(B.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=E,B.shape=n.outShape,v=Tr({inputs:{x:P},backend:r}),v.shape=n.outShape,g.push(P)}else{const _=n.outHeight*n.outWidth,N=ge({inputs:{x:t},backend:r,attrs:{shape:h?[n.batchSize,_,n.inChannels]:[n.batchSize,n.inChannels,_]}}),E=ge({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),R=kp({a:h?N:E,b:h?E:N,transposeA:!h,transposeB:m,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i});v=ge({inputs:{x:R},backend:r,attrs:{shape:n.outShape}}),g.push(N),g.push(E),g.push(R)}for(const _ of g)r.disposeIntermediateTensorInfo(_);return v}function qP({x:t,filter:e,convInfo:n,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:c,outWidth:d,outHeight:f,dataFormat:h}=n,p=h==="channelsLast",m=l*u*c,v=f*d,g=[n.batchSize,m,v],x=!0,b=!1,_=[];if(o!=null){const O=Ip(o.shape,p);O!=null&&(o=ge({inputs:{x:o},backend:r,attrs:{shape:O}}),_.push(o))}if(s!=null){const O=Ip(s.shape,p);O!=null&&(s=ge({inputs:{x:s},backend:r,attrs:{shape:O}}),_.push(s))}const N=ge({inputs:{x:e},backend:r,attrs:{shape:[1,m,pe(e.shape)/m]}});_.push(N);const E=new lue(g,n),R=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],P=r.runWebGLProgram(E,[t],"float32",R),B=ge({inputs:{x:P},backend:r,attrs:{shape:g}});_.push(P),_.push(B);const F=s!=null,H=o!=null,ee=a==="leakyrelu",oe=a?Rd(a,!0):null,de=new FP(p?B.shape:N.shape,p?N.shape:B.shape,p?[n.batchSize,v,n.outChannels]:[n.batchSize,n.outChannels,v],x,b,F,oe,H,ee),V=p?[B,N]:[N,B];if(s&&V.push(s),H&&V.push(o),ee){const O=r.makeTensorInfo([],"float32",Pu(i,"float32"));V.push(O),_.push(O)}const W=r.runWebGLProgram(de,V,"float32"),I=ge({inputs:{x:W},backend:r,attrs:{shape:n.outShape}});_.push(W);for(const O of _)r.disposeIntermediateTensorInfo(O);return I}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:c}=r,d=Lu(l),f=Jr(s.shape,o.shape,i,u,a,c,!1,d);let h;if(f.filterHeight===1&&f.filterWidth===1&&f.dilationHeight===1&&f.dilationWidth===1&&f.strideHeight===1&&f.strideWidth===1&&(f.padInfo.type==="SAME"||f.padInfo.type==="VALID"))h=HP({x:s,filter:o,convInfo:f,backend:n});else if(f.strideWidth<=2&&d==="channelsLast"&&Y().getBool("WEBGL_EXP_CONV")){const m=new GP(f),v=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];h=n.runWebGLProgram(m,[s,o],"float32",v)}else if(Y().getBool("WEBGL_CONV_IM2COL"))h=qP({x:s,filter:o,convInfo:f,backend:n});else{const m=new VP(f);h=n.runWebGLProgram(m,[s,o],"float32")}const p=ge({inputs:{x:h},backend:n,attrs:{shape:f.outShape}});return n.disposeIntermediateTensorInfo(h),p}const cue={kernelName:U$,backendName:"webgl",kernelFunc:uue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class due{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class fue{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=r-1-e.padInfo.left,u=i?1:2,c=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${c}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class hue{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class pue{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,u=r-1-e.padInfo.top,c=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${c});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:c}=r,d=Lu(l),f=Jr(s.shape,c,i,1,a,u,!1,d),h=new due(f);return n.runWebGLProgram(h,[s,o],"float32")}const gue={kernelName:z$,backendName:"webgl",kernelFunc:mue};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yue{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Fn(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,s=n-1-e.padInfo.top,o=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${s}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:c}=r,d=Lu(u),f=Jr(i,o.shape,a,1,l,c,!1,d);if(Y().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const h=[[f.strideHeight,f.strideWidth]],p=new yue(f);return n.runWebGLProgram(p,[s,o],"float32",h)}else{const h=new fue(f);return n.runWebGLProgram(h,[s,o],"float32")}}const xue={kernelName:W$,backendName:"webgl",kernelFunc:vue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=Gd(s.shape,o.shape,i,l,a),c=new aue(u);return n.runWebGLProgram(c,[s,o],"float32")}const wue={kernelName:V$,backendName:"webgl",kernelFunc:bue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,pad:a,filterShape:l}=r,u=Gd(s.shape,l,i,1,a),c=new hue(u);return n.runWebGLProgram(c,[s,o],"float32")}const Cue={kernelName:AU,backendName:"webgl",kernelFunc:Sue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ue(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{pad:i,strides:a,inputShape:l}=r,u=Gd(l,o.shape,a,1,i),c=new pue(u);return n.runWebGLProgram(c,[s,o],"float32")}const Eue={kernelName:G$,backendName:"webgl",kernelFunc:_ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tue=Ku+`
  return cos(x);
`,Nue=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${xl}
  return result;
`,$ue=tt({opSnippet:Tue,packedOpSnippet:Nue}),kue={kernelName:H$,backendName:"webgl",kernelFunc:$ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Iue=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Oue=tt({opSnippet:Iue}),Rue={kernelName:q$,backendName:"webgl",kernelFunc:Oue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Due{constructor(e,n,r,s,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,u]=e,[c]=n,[d,f]=r;this.outputShape=[c,d,f,u];const h=s==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[v,g,x]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,_,N]=f>1?[`${(l-1)/(f-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${v});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${_};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${N};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${h} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aue=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:s,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=r,c=new Due(s.shape,o.shape,a,l,u);return n.runWebGLProgram(c,[s,o,i],"float32")},Pue={kernelName:Y$,backendName:"webgl",kernelFunc:Aue};var Ad;(function(t){t.Prod="*",t.Sum="+"})(Ad||(Ad={}));class jE{constructor(e,n,r,s){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===Ad.Prod?"1.0":"0.0",a=r?i:`getX(${BE(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",c="";r?(u=s?`end != ${l-1}`:"end != 0",c=s?"end + 1":"end - 1"):(u=s?`end + pow2 < ${l}`:"end >= pow2",c=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${mt(o)} coords = getOutputCoords();
        int end = ${UE(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${c};
          ${UE(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${BE(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function BE(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function UE(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KP(t,e,n,r,s,o){const i=e.shape.length,a=ks([r],i);let l=e;a!=null&&(l=Jn({inputs:{x:e},backend:n,attrs:{perm:a}}));const u=Is(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const c=l.shape[u];let d=Tr({inputs:{x:l},backend:n});for(let f=0;f<=Math.ceil(Math.log2(c))-1;f++){const h=new jE(t,l.shape,!1,o),p=[[f]],m=d;d=n.runWebGLProgram(h,[d],d.dtype,p),n.disposeIntermediateTensorInfo(m)}if(s){const f=new jE(t,l.shape,s,o),h=d;d=n.runWebGLProgram(f,[d],d.dtype),n.disposeIntermediateTensorInfo(h)}if(a!=null){const f=yx(a),h=Jn({inputs:{x:d},backend:n,attrs:{perm:f}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),h}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return KP(Ad.Prod,s,n,o,i,a)}const Fue={kernelName:K$,backendName:"webgl",kernelFunc:Lue};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return KP(Ad.Sum,s,n,o,i,a)}const jue={kernelName:X$,backendName:"webgl",kernelFunc:Mue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,weights:o}=e,{size:i,binaryOutput:a}=r;if(s.shape.length===1){const l=n.readSync(s.dataId),u=n.readSync(o.dataId),c=$P(l,u,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}else if(s.shape.length===2){const l=n.bufferSync(s),u=n.bufferSync(o),c=Voe(l,u,i,a);return n.makeTensorInfo(c.shape,o.dtype,c.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const Uue={kernelName:Q$,backendName:"webgl",kernelFunc:Bue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zue{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockSize:o,dataFormat:i}=r,a=s.shape[0],l=i==="NHWC"?s.shape[1]:s.shape[2],u=i==="NHWC"?s.shape[2]:s.shape[3],c=i==="NHWC"?s.shape[3]:s.shape[1],d=l*o,f=u*o,h=c/(o*o),p=i==="NHWC"?[a,d,f,h]:[a,h,d,f],m=new zue(p,o,i);return n.runWebGLProgram(m,[s],s.dtype)}const Vue={kernelName:Z$,backendName:"webgl",kernelFunc:Wue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XP{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Fn(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",c="";r&&(s?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:u=`
          float activation(float x) {
            ${r}
          }
        `,c="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YP{constructor(e,n=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Fn(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,d=e.filterWidth,f=d;let h=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<d;g++)h+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;h+=`
    for (int r = 0; r < ${c}; r++) {
      `;for(let g=0;g<d;g++)h+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;h+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(f+1)/2;g++){const x=g*2;if(h+=`
          xC = xCCorner + ${x*u};
          `,l===1){if(x<d&&(a%2===1?(h+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,u===1&&x>0?h+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:h+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):h+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<d)){const b=a%2===0?nx(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(h+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,u>1?h+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:h+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):b===1?h+=`
                    xC${x+1} = xTexelC${x};
                    `:h+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<d&&(a%2===1?(h+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<d&&(h+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(h+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<d&&(h+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<d&&(h+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<d&&(h+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}h+=`
    }
  `,h+=`
      }
    `;let p="",m="";r&&(s?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,m="result = activation(result);");const v=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${h}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${v}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=r;let c=l;c==null&&(c=[1,1]),D($r(i,c),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const d=Jr(s.shape,o.shape,i,c,a,u,!0);let f;Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?f=new YP(d):f=new XP(d);const h=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(f,[s,o],"float32",h)}const Hue={kernelName:J$,backendName:"webgl",kernelFunc:Gue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class que{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Kue{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=n-1-e.padInfo.top,a=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xue(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:c}=r,d=Jr(s.shape,c,i,a,l,u,!0),f=new que(d);return n.runWebGLProgram(f,[s,o],"float32")}const Yue={kernelName:ek,backendName:"webgl",kernelFunc:Xue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Que(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:c}=r,d=Jr(c,o.shape,i,a,l,u,!0),f=new Kue(d);return n.runWebGLProgram(f,[s,o],"float32")}const Zue={kernelName:tk,backendName:"webgl",kernelFunc:Que};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jue{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ece(t){const{inputs:e,backend:n}=t,{x:r}=e,s=[...r.shape,...r.shape],o=pe(r.shape),i=ge({inputs:{x:r},backend:n,attrs:{shape:[o]}}),a=new Jue(o),l=n.runWebGLProgram(a,[i],i.dtype),u=ge({inputs:{x:l},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),u}const tce={kernelName:nk,backendName:"webgl",kernelFunc:ece};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nce{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:s,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:c}=e,{top:d,left:f}=s;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${d}, ${f});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${c};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o}=e,{strides:i,pad:a,dilations:l}=r,u=zO(s.shape,o.shape,i,a,"NHWC",l);let c;const d=new nce(u);c=n.runWebGLProgram(d,[s,o],"float32");const f=ge({inputs:{x:c},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(c),f}const sce={kernelName:rk,backendName:"webgl",kernelFunc:rce};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oce(t){const{inputs:e,backend:n,attrs:r}=t,{equation:s}=r,o=e,{allDims:i,summedDims:a,idDims:l}=fD(s,o.length);pD(i.length,l,o);const{path:u,steps:c}=mD(a,l),d=c.length;let f=null,h=i.length;const p=[];for(let m=0;m<d;++m){for(const v of c[m]){const{permutationIndices:g,expandDims:x}=hD(h,l[v]);let b;gD(g)?b=o[v]:(b=Jn({inputs:{x:o[v]},backend:n,attrs:{perm:g}}),p.push(b));const _=b.shape.slice();for(let N=0;N<x.length;++N)_.splice(x[N],0,1);Pt(b.shape,_)||(b=ge({inputs:{x:b},backend:n,attrs:{shape:_}}),p.push(b)),f===null?f=b:(f=Cb({inputs:{a:b,b:f},backend:n}),p.push(f))}m<d-1&&(u[m]>=0&&(f=Qm({inputs:{x:f},backend:n,attrs:{axis:u[m]-(i.length-h),keepDims:!1}}),p.push(f)),h--)}for(const m of p)m!==f&&n.disposeIntermediateTensorInfo(m);return f}const ice={kernelName:ok,backendName:"webgl",kernelFunc:oce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ace="return (x >= 0.0) ? x : (exp(x) - 1.0);",lce=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,uce=tt({opSnippet:ace,packedOpSnippet:lce}),cce={kernelName:ik,backendName:"webgl",kernelFunc:uce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dce="return (b >= 0.0) ? a : a * (b + 1.0);",fce=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,hce=t=>{const{inputs:e,backend:n}=t,{dy:r,y:s}=e,o=Y().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new qu(fce,r.shape,s.shape):new sl(dce,r.shape,s.shape);return n.runWebGLProgram(o,[r,s],r.dtype)},pce={kernelName:PU,backendName:"webgl",kernelFunc:hce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mce=`
  return vec4(equal(a, b));
`,gce="return float(a == b);",yce=On({opSnippet:gce,packedOpSnippet:mce,dtype:"bool",cpuKernelImpl:Xoe}),vce={kernelName:lk,backendName:"webgl",kernelFunc:yce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xce=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${iD};
  float a1 = ${aD};
  float a2 = ${lD};
  float a3 = ${uD};
  float a4 = ${cD};
  float a5 = ${dD};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,bce=tt({opSnippet:xce}),wce={kernelName:ak,backendName:"webgl",kernelFunc:bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sce=Ku+`
  return exp(x);
`,Cce=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,QP=tt({opSnippet:Sce,packedOpSnippet:Cce,cpuKernelImpl:Yoe,dtype:"float32"}),_ce={kernelName:uk,backendName:"webgl",kernelFunc:QP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lv(t){const{inputs:e,attrs:n,backend:r}=t,{dim:s}=n,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=s;return s<0&&(D(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+s+1),a.splice(l,0,1),ge({inputs:{x:o},backend:r,attrs:{shape:a}})}const Ece={kernelName:ck,backendName:"webgl",kernelFunc:Lv};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zE="return exp(x) - 1.0;",Tce=tt({opSnippet:zE,packedOpSnippet:zE,cpuKernelImpl:Qoe}),Nce={kernelName:dk,backendName:"webgl",kernelFunc:Tce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WE{constructor(e,n,r){this.variableNames=["real","imag"];const s=n[1];this.outputShape=n;const o=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZP(t,e,n){const r=n.texData.get(t.dataId),s=pe(t.shape),o=t.shape[t.shape.length-1],i=s/o,a=ge({inputs:{x:t},backend:n,attrs:{shape:[i,o]}}),l=a.shape,u=new WE("real",l,e),c=new WE("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],f=n.runWebGLProgram(u,d,"float32"),h=n.runWebGLProgram(c,d,"float32"),p=ua({inputs:{real:f,imag:h},backend:n});n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h);const m=ge({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ce(t){const{inputs:e,backend:n}=t,{input:r}=e;return ZP(r,!1,n)}const kce={kernelName:fk,backendName:"webgl",kernelFunc:$ce};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ice{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nf(t){const{backend:e,attrs:n}=t,{shape:r,value:s}=n;let{dtype:o}=n;if(o=o||zd(s),o==="string"){const i=mn(o,pe(r));return i.fill(s),e.makeTensorInfo(r,o,i)}else{const i=new Ice(r,s),a=[[s]];return e.runWebGLProgram(i,[],o,a)}}const Oce={kernelName:hk,backendName:"webgl",kernelFunc:nf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rce{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dce={kernelName:pk,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,s=new Rce(n.shape);return r.runWebGLProgram(s,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VE="return floor(x);",Ace=tt({opSnippet:VE,packedOpSnippet:VE,cpuKernelImpl:Zoe}),Pce={kernelName:mk,backendName:"webgl",kernelFunc:Ace};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lce=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Fce=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Mce=On({opSnippet:Lce,packedOpSnippet:Fce,dtype:"int32"}),jce={kernelName:gk,backendName:"webgl",kernelFunc:Mce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bce{constructor(e){this.variableNames=["A"];const n=er(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uce{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=er(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zce={kernelName:j0,backendName:"webgl",kernelFunc:Wce};let kl,Iy=Y().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Wce(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:s}=e;const{numChannels:o}=r,i=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[l,u]=i?[s.videoWidth,s.videoHeight]:[s.width,s.height],c=[u,l],d=[u,l,o];if(a||i){const m=Y().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(kl==null||m!==Iy)&&(Iy=m,kl=document.createElement("canvas").getContext("2d",{willReadFrequently:Iy})),kl.canvas.width=l,kl.canvas.height=u,kl.drawImage(s,0,0,l,u),s=kl.canvas}const f=n.makeTensorInfo(c,"int32");n.texData.get(f.dataId).usage=zr.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(f.dataId),s);const h=Y().getBool("WEBGL_PACK")?new Uce(d):new Bce(d),p=n.runWebGLProgram(h,[f],"int32");return n.disposeData(f.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:c,dilations:d,dimRoundingMode:f,activation:h,leakyreluAlpha:p}=r,m=Lu(c),v=Jr(s.shape,o.shape,l,d,u,f,!1,m);let g;const x=[],b=i!=null,_=a!=null,N=h==="leakyrelu",E=()=>{const P=[s,o],B=(F,H)=>{if(H==="NCHW"&&F.shape.length===1&&F.shape[0]!==1){const ee=ge({inputs:{x:F},backend:n,attrs:{shape:[F.shape[0],1,1]}});return x.push(ee),ee}return F};if(b&&P.push(B(i,c)),_&&P.push(B(a,c)),N){const F=n.makeTensorInfo([],"float32",Pu(p,"float32"));P.push(F),x.push(F)}return P};if(v.filterHeight===1&&v.filterWidth===1&&v.dilationHeight===1&&v.dilationWidth===1&&v.strideHeight===1&&v.strideWidth===1&&(v.padInfo.type==="SAME"||v.padInfo.type==="VALID"))g=HP({x:s,filter:o,convInfo:v,backend:n,bias:i,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else if(v.strideWidth<=2&&m==="channelsLast"&&Y().getBool("WEBGL_EXP_CONV")){const P=h?Rd(h,!0):null,B=new GP(v,b,P,_,N),F=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],H=E();g=n.runWebGLProgram(B,H,"float32",F)}else if(Y().getBool("WEBGL_CONV_IM2COL"))g=qP({x:s,filter:o,convInfo:v,backend:n,bias:i,activation:h,preluActivationWeights:a,leakyreluAlpha:p});else{const P=h?Rd(h,!1):null,B=new VP(v,b,P,_,N),F=E();g=n.runWebGLProgram(B,F,"float32")}const R=ge({inputs:{x:g},backend:n,attrs:{shape:v.outShape}});return x.push(g),x.forEach(P=>n.disposeIntermediateTensorInfo(P)),R}const Gce={kernelName:U0,backendName:"webgl",kernelFunc:Vce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:c,dimRoundingMode:d,activation:f,leakyreluAlpha:h}=r,p=[];let m=c;m==null&&(m=[1,1]),D($r(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const v=Jr(s.shape,o.shape,l,m,u,d,!0),g=Y().getBool("WEBGL_PACK_DEPTHWISECONV")&&v.strideWidth<=2&&v.outChannels/v.inChannels===1,x=f?Rd(f,g):null,b=[s,o],_=i!=null,N=a!=null,E=f==="leakyrelu";if(_&&b.push(i),N&&b.push(a),E){const F=n.makeTensorInfo([],"float32",Pu(h,"float32"));b.push(F),p.push(F)}let R;g?R=new YP(v,_,x,N,E):R=new XP(v,_,x,N,E);const P=[[v.padInfo.top,v.padInfo.left],[v.strideHeight,v.strideWidth],[v.dilationHeight,v.dilationWidth],[v.inHeight,v.inWidth]],B=n.runWebGLProgram(R,b,"float32",P);return p.forEach(F=>n.disposeIntermediateTensorInfo(F)),B}const qce={kernelName:z0,backendName:"webgl",kernelFunc:Hce};class Kce{constructor(e,n,r,s){this.sliceDim=e,this.strides=n,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const o=mt(r.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xce(t){const{inputs:e,backend:n}=t,{params:r,indices:s}=e,o=s.shape,i=o[o.length-1],a=pe(r.shape),[l,u,c,d]=FR(r,s),f=ge({inputs:{x:s},backend:n,attrs:{shape:[u,i]}}),h=ge({inputs:{x:r},backend:n,attrs:{shape:[pe(r.shape)/c,c]}});if(n.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const g=n.readSync(s.dataId),x=n.bufferSync(r),b=Joe(g,x,r.dtype,u,i,c,d,r.shape,a);return n.makeTensorInfo(l,r.dtype,b.values)}const p=new Kce(i,d,[u,c],r.shape),m=n.runWebGLProgram(p,[h,f],h.dtype),v=ge({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(m),v}const Yce={kernelName:xk,backendName:"webgl",kernelFunc:Xce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qce{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=mt(this.rank),s=Zce(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function Zce(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<t.length;s++)s===2?r.push("index"):r.push(`${n[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JP(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,indices:o}=e,{axis:i,batchDims:a}=r,l=gn(i,s.shape)[0];if(Y().get("DEBUG")){const x=n.readSync(o.dataId),b=s.shape[l];for(let _=0;_<x.length;++_){const N=x[_];D(N<=b-1&&N>=0,()=>`GatherV2: the index value ${N} is not in [0, ${b-1}]`)}}const u=OD(s,o,l,a),c=pe(o.shape),d=[],f=ge({inputs:{x:s},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),h=ge({inputs:{x:o},backend:n,attrs:{shape:[u.batchSize,c/u.batchSize]}});d.push(f),d.push(h);const p=[u.batchSize,u.outerSize,c/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([s,o])||s.dtype==="string"){const x=n.bufferSync(h),b=n.bufferSync(f),_=eie(b,x,p);return d.forEach(N=>n.disposeIntermediateTensorInfo(N)),n.makeTensorInfo(u.outputShape,_.dtype,_.values)}const m=new Qce(f.shape,p),v=n.runWebGLProgram(m,[f,h],f.dtype);d.push(v);const g=ge({inputs:{x:v},backend:n,attrs:{shape:u.outputShape}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),g}const Jce={kernelName:vk,backendName:"webgl",kernelFunc:JP};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ede="return float(a > b);",tde=`
  return vec4(greaterThan(a, b));
`,nde=On({opSnippet:ede,packedOpSnippet:tde,cpuKernelImpl:tie,dtype:"bool"}),rde={kernelName:bk,backendName:"webgl",kernelFunc:nde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sde="return float(a >= b);",ode=`
  return vec4(greaterThanEqual(a, b));
`,ide=On({opSnippet:sde,packedOpSnippet:ode,dtype:"bool",cpuKernelImpl:nie}),ade={kernelName:wk,backendName:"webgl",kernelFunc:ide};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lde(t){const{inputs:e,backend:n}=t,{input:r}=e;return ZP(r,!0,n)}const ude={kernelName:Sk,backendName:"webgl",kernelFunc:lde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cde="return float(!isnan(x) && !isinf(x));",dde=tt({opSnippet:cde,dtype:"bool"}),fde={kernelName:_k,backendName:"webgl",kernelFunc:dde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hde="return float(isinf(x));",pde=tt({opSnippet:hde,dtype:"bool"}),mde={kernelName:Ek,backendName:"webgl",kernelFunc:pde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gde="return float(isnan(x));",yde=tt({opSnippet:gde,dtype:"bool"}),vde={kernelName:Tk,backendName:"webgl",kernelFunc:yde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xde="return float(a < b);",bde=`
  return vec4(lessThan(a, b));
`,wde=On({opSnippet:xde,packedOpSnippet:bde,cpuKernelImpl:rie,dtype:"bool"}),Sde={kernelName:$k,backendName:"webgl",kernelFunc:wde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cde="return float(a <= b);",_de=`
  return vec4(lessThanEqual(a, b));
`,Ede=On({opSnippet:Cde,packedOpSnippet:_de,cpuKernelImpl:sie,dtype:"bool"}),Tde={kernelName:kk,backendName:"webgl",kernelFunc:Ede};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nde(t){const{backend:e,attrs:n}=t,{start:r,stop:s,num:o}=n,i=oie(r,s,o);return e.makeTensorInfo([i.length],"float32",i)}const $de={kernelName:Ik,backendName:"webgl",kernelFunc:Nde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kde=Ku+`
  return x < 0.0 ? 0./0. : log(x);
`,Ide=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Ode=tt({opSnippet:kde,packedOpSnippet:Ide,cpuKernelImpl:iie}),Rde={kernelName:Ok,backendName:"webgl",kernelFunc:Ode};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dde=Ku+`
  return log(1.0 + x);
`,Ade=tt({opSnippet:Dde}),Pde={kernelName:Rk,backendName:"webgl",kernelFunc:Ade};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lde="return float(a >= 1.0 && b >= 1.0);",Fde=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Mde=On({opSnippet:Lde,packedOpSnippet:Fde,dtype:"bool"}),jde={kernelName:Dk,backendName:"webgl",kernelFunc:Mde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bde="return float(!(x >= 1.0));",Ude=tt({opSnippet:Bde}),zde={kernelName:Ak,backendName:"webgl",kernelFunc:Ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wde="return float(a >= 1.0 || b >= 1.0);",Vde=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Gde=On({opSnippet:Wde,packedOpSnippet:Vde,dtype:"bool"}),Hde={kernelName:Pk,backendName:"webgl",kernelFunc:Gde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qde{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[];const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kde{constructor(e,n,r,s,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=e[3]-1;this.outputShape=e;let l;const u=`float(${r}) + float(${s}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xde=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=r,u=Y().getBool("WEBGL_PACK_NORMALIZATION")?new Kde(s.shape,o,i,a,l):new qde(s.shape,o,i,a,l);return n.runWebGLProgram(u,[s],s.dtype)},Yde={kernelName:Lk,backendName:"webgl",kernelFunc:Xde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qde{constructor(e,n,r,s,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=s,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zde=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:c}=r,d=new Qde(s.shape,a,l,u,c);return n.runWebGLProgram(d,[s,o,i],s.dtype)},Jde={kernelName:LU,backendName:"webgl",kernelFunc:Zde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function efe(t,e,n,r){const s=pe(e),i=pe(t.shape)/s,a=ge({inputs:{x:t},attrs:{shape:[i,s]},backend:r}),l=bl(a,t.dtype,"max",r),u=ge({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e3(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reductionIndices:o,keepDims:i}=r,a=s.shape.length,l=gn(o,s.shape);let u=l;const c=ks(u,a),d=c!=null,f=n.shouldExecuteOnCPU([s]);let h=s;if(d){if(f){const b=n.texData.get(h.dataId).values,_=new Array(a);for(let R=0;R<_.length;R++)_[R]=s.shape[c[R]];const N=wb(b,s.shape,s.dtype,c,_);h=n.makeTensorInfo(_,s.dtype);const E=n.texData.get(h.dataId);E.values=N}else h=Ym(s,c,n);u=Is(u.length,a)}lo("max",u,a);const[p,m]=No(h.shape,u);let v=p;i&&(v=es(p,l));let g;if(f){const b=n.texData.get(h.dataId).values,_=aie(b,pe(m),v,s.dtype);g=n.makeTensorInfo(v,s.dtype);const N=n.texData.get(g.dataId);N.values=_}else g=efe(h,m,v,n);return d&&n.disposeIntermediateTensorInfo(h),g}const tfe={kernelName:Fk,backendName:"webgl",kernelFunc:e3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nfe=Sb+`
  return max(a, b);
`,rfe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+xl+`
  return result;
`,sfe=On({opSnippet:nfe,packedOpSnippet:rfe,cpuKernelImpl:lie}),ofe={kernelName:Mk,backendName:"webgl",kernelFunc:sfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ife(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;Jd(s,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=r,u=1;D($r(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const c=ul(s.shape,o,i,u,a,l);if(c.filterWidth===1&&c.filterHeight===1&&Pt(c.inShape,c.outShape))return Tr({inputs:{x:s},backend:n});const d=new Dd(c,"max",!1);return n.runWebGLProgram(d,[s],s.dtype)}const afe={kernelName:jk,backendName:"webgl",kernelFunc:ife};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=r,c=[1,1,1],d=Vd(s.shape,o,i,c,a,u,l),f=new _b(d,"max",!1);return n.runWebGLProgram(f,[s],s.dtype)}const ufe={kernelName:Bk,backendName:"webgl",kernelFunc:lfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cfe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,l=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class dfe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,d=l-1-e.padInfo.front,f=u-1-e.padInfo.top,h=c-1-e.padInfo.left,p=l*u*c-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${f}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${c};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${c} +
                  wR * ${c} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ffe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:c}=r,d=[1,1,1],f=Vd(i.shape,a,l,d,u,c),h=new _b(f,"max",!0),p=n.runWebGLProgram(h,[i],i.dtype),m=new dfe(f),v=n.runWebGLProgram(m,[s,p],i.dtype);return n.disposeIntermediateTensorInfo(p),v}const hfe={kernelName:MU,backendName:"webgl",kernelFunc:ffe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pfe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:s,input:o,output:i}=e,a=o;Jd([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:c,dimRoundingMode:d}=r,f=ul(a.shape,l,u,1,c,d),h=!0,p=new Dd(f,"max",h),m=n.runWebGLProgram(p,[a],a.dtype),v=new cfe(f),g=n.runWebGLProgram(v,[s,m],a.dtype);return n.disposeIntermediateTensorInfo(m),g}const mfe={kernelName:FU,backendName:"webgl",kernelFunc:pfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gfe(t,e,n,r){let s=new Dd(n,"max",!1);const o=r.runWebGLProgram(s,[t],"float32");s=new Dd(n,"max",!0,!0,e);const i=r.runWebGLProgram(s,[t],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yfe={kernelName:Uk,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:s,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;D(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const u=[1,1];D($r(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const c=ul(r.shape,s,o,u,i),[d,f]=gfe(r,a,c,l);return[d,f]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vfe(t,e,n,r){const s=pe(e),i=pe(t.shape)/s,a=ge({inputs:{x:t},attrs:{shape:[i,s]},backend:r}),l=bl(a,"float32","mean",r),u=ge({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xfe={kernelName:zk,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:s,axis:o}=e,i=n,a=r.shape.length,l=gn(o,r.shape);let u=l;const c=ks(u,a),d=c!=null,f=i.shouldExecuteOnCPU([r]),h=[];let p=r;if(d){if(f){const _=i.texData.get(p.dataId).values,N=new Array(a);for(let P=0;P<N.length;P++)N[P]=r.shape[c[P]];const E=wb(_,r.shape,r.dtype,c,N);p=i.makeTensorInfo(N,r.dtype);const R=i.texData.get(p.dataId);R.values=E}else p=Ym(r,c,i);h.push(p),u=Is(u.length,a)}lo("sum",u,a);const[m,v]=No(p.shape,u);let g=m;s&&(g=es(m,l));const x=vfe(p,v,g,i);for(const b of h)i.disposeIntermediateTensorInfo(b);return x}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bfe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=gn(o,s.shape);let u=l;const c=ks(u,a);let d=s;c!=null&&(d=Jn({inputs:{x:s},backend:n,attrs:{perm:c}}),u=Is(u.length,s.shape.length)),lo("min",u,a);const[f,h]=No(d.shape,u),p=pe(h),m=ge({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),v=bl(m,m.dtype,"min",n);let g;if(i){const x=es(f,l);g=ge({inputs:{x:v},backend:n,attrs:{shape:x}})}else g=ge({inputs:{x:v},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),c!=null&&n.disposeIntermediateTensorInfo(d),g}const wfe={kernelName:Wk,backendName:"webgl",kernelFunc:bfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sfe=Sb+`
  return min(a, b);
`,Cfe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+xl+`
  return result;
`,_fe=On({opSnippet:Sfe,packedOpSnippet:Cfe,cpuKernelImpl:uie}),Efe={kernelName:Vk,backendName:"webgl",kernelFunc:_fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tfe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((c,d)=>c[0]+e[d]+c[1]);const s=e.length,o=mt(s),i=n.map(c=>c[0]).join(","),a=n.map((c,d)=>c[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),u=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nfe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const s=e.length,o=mt(s),i=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=Qn("rc",s),u=Qn("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,f=r==="reflect"?0:1;let h="";if(s===1){const p=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${f};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${f};
        }
        source -= start;
      `;h=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
      `}else{const p=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${f}) +
                gte * ((end - 1) * 2 - source + ${f});
        source -= start;
      `;h=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${u.join()}), ${d});
        ${l[s-1]} += 1;
        if(${c}) {
          ${p}
          result[1] = getChannel(getX(${u.join()}), ${d});
        }
        rc = outputLoc;
        ${l[s-2]} += 1;
        if(${l[s-2]} < ${this.outputShape[s-2]}) {
          ${p}
          result[2] = getChannel(getX(${u.join()}), ${d});
          ${l[s-1]} += 1;
          if(${c}) {
            ${p}
            result[3] = getChannel(getX(${u.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $fe=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:s,mode:o}=n,i=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Nfe(r.shape,s,o):new Tfe(r.shape,s,o);return e.runWebGLProgram(i,[r],r.dtype)},kfe={kernelName:Gk,backendName:"webgl",kernelFunc:$fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ife=`if (b == 0.0) return NAN;
  return mod(a, b);`,Ofe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+xl+`
  return result;
`,Rfe=On({opSnippet:Ife,packedOpSnippet:Ofe}),Dfe={kernelName:Hk,backendName:"webgl",kernelFunc:Rfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Afe{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pfe=`
if (a == b) {
  return 1.0;
};
return a / b;`,Lfe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,t3=On({opSnippet:Pfe,packedOpSnippet:Lfe,checkOutOfBounds:!0}),Ffe={kernelName:sk,backendName:"webgl",kernelFunc:t3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GE="return a - b;",n3=On({opSnippet:GE,packedOpSnippet:GE,supportsComplex:!0,cpuKernelImpl:Iie}),Mfe={kernelName:KI,backendName:"webgl",kernelFunc:n3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r3(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{dim:o}=r,i=gn([o],s.shape),a=e3({inputs:{x:s},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=es(a.shape,i),u=ge({inputs:{x:a},backend:n,attrs:{shape:l}}),c=n3({inputs:{a:s,b:u},backend:n}),d=QP({inputs:{x:c},backend:n}),f=Qm({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),h=ge({inputs:{x:f},backend:n,attrs:{shape:l}}),p=t3({inputs:{a:d,b:h},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(h),p}const jfe={kernelName:LI,backendName:"webgl",kernelFunc:r3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bfe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:s}=e,{numSamples:o,seed:i,normalized:a}=r,l=a?s:r3({inputs:{logits:s},backend:n,attrs:{dim:s.shape.length-1}}),u=l.shape[0],c=l.shape[1],d=new Afe(u,c,o),f=[[i]],h=n.runWebGLProgram(d,[l],"int32",f);return a||n.disposeIntermediateTensorInfo(l),h}const Ufe={kernelName:qk,backendName:"webgl",kernelFunc:Bfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zfe=Os+`
  return -x;
`,Wfe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Vfe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const o=n.texData.get(r.dataId),[i,a]=die(o.values,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,i)}let s;return Y().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Ii(r.shape,Wfe):s=new bo(r.shape,zfe),n.runWebGLProgram(s,[r],r.dtype)}const Gfe={kernelName:Xk,backendName:"webgl",kernelFunc:Vfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hfe=NR;function qfe(t){Js("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),{selectedIndices:d}=Hfe(u,c,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const Kfe={kernelName:Qk,backendName:"webgl",kernelFunc:qfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xfe=$R;function Yfe(t){Js("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),{selectedIndices:f,validOutputs:h}=Xfe(c,d,i,a,l,u);return[n.makeTensorInfo([f.length],"int32",new Int32Array(f)),n.makeTensorInfo([],"int32",new Int32Array([h]))]}const Qfe={kernelName:Zk,backendName:"webgl",kernelFunc:Yfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zfe=kR;function Jfe(t){Js("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=r,c=n.readSync(s.dataId),d=n.readSync(o.dataId),f=i,h=a,p=l,m=u,{selectedIndices:v,selectedScores:g}=Zfe(c,d,f,h,p,m);return[n.makeTensorInfo([v.length],"int32",new Int32Array(v)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const ehe={kernelName:Jk,backendName:"webgl",kernelFunc:Jfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class the{constructor(e,n,r,s){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nhe=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:s}=e,{dtype:o,depth:i,onValue:a,offValue:l}=r,u=pe(s.shape),c=new the(u,i,a,l),d=ge({inputs:{x:s},backend:n,attrs:{shape:[u]}}),f=n.runWebGLProgram(c,[d],o);n.disposeIntermediateTensorInfo(d);const h=[...s.shape,i],p=ge({inputs:{x:f},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(f),p},rhe={kernelName:tI,backendName:"webgl",kernelFunc:nhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Op(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const s=tf({inputs:{input:r},backend:n}),o=Op({inputs:{x:s},backend:n}),i=Zm({inputs:{input:r},backend:n}),a=Op({inputs:{x:i},backend:n}),l=ua({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return nf({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const she={kernelName:nO,backendName:"webgl",kernelFunc:Op};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s3(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=tf({inputs:{input:r},backend:n}),o=s3({inputs:{x:s},backend:n}),i=Zm({inputs:{input:r},backend:n}),a=Op({inputs:{x:i},backend:n}),l=ua({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return nf({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const ohe={kernelName:eI,backendName:"webgl",kernelFunc:s3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ihe(t){const{inputs:e,backend:n,attrs:r}=t,{axis:s}=r;if(e.length===1)return Lv({inputs:{input:e[0]},backend:n,attrs:{dim:s}});const o=e[0].shape,i=e[0].dtype;e.forEach(c=>{Qr(o,c.shape,"All tensors passed to stack must have matching shapes"),D(i===c.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(c=>{const d=Lv({inputs:{input:c},backend:n,attrs:{dim:s}});return a.push(d),d}),u=WP({inputs:l,backend:n,attrs:{axis:s}});return a.forEach(c=>n.disposeIntermediateTensorInfo(c)),u}const ahe={kernelName:nI,backendName:"webgl",kernelFunc:ihe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lhe{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,c)=>u[0]+e[c]+u[1]);const s=e.length,o=mt(s),i=n.map(u=>u[0]).join(","),a=n.map((u,c)=>u[0]+e[c]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uhe{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,v)=>m[0]+e[v]+m[1]);const s=e.length,o=mt(s),i=n.map(m=>m[0]).join(","),a=n.map((m,v)=>m[0]+e[v]).join(","),l=Qn("rc",s),u=Qn("source",s),c=`${l[s-1]} < ${this.outputShape[s-1]}`,d=s===1?"source":`vec2(${u.slice(-2).join()})`,f=[`${o} rc = outputLoc;`,`${l[s-1]} += 1;
       if(${c}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${l[s-2]} += 1;
       if(${l[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${l[s-1]} += 1;
         if(${c}) {`],h=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,v=s===1?2:4;m<v;m++)p+=`
        ${f[m]}
        if (${h}) {
          result[${m}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${m}] = getChannel(getX(${u.join()}), ${d});
        }
      `;p+=s===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o3=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{paddings:o,constantValue:i}=r;if(pe(s.shape)===0){const u=o.map((c,d)=>c[0]+s.shape[d]+c[1]);return nf({backend:n,attrs:{shape:u,value:i,dtype:s.dtype}})}const a=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new uhe(s.shape,o,i):new lhe(s.shape,o,i),l=[[i]];return n.runWebGLProgram(a,[s],s.dtype,l)},che={kernelName:rI,backendName:"webgl",kernelFunc:o3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dhe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,fhe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+xl+`
  return result;
`,hhe=On({opSnippet:dhe,packedOpSnippet:fhe}),phe={kernelName:sI,backendName:"webgl",kernelFunc:hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,l=[],u=gn(o,s.shape);let c=u;const d=ks(c,a);let f=s;d!=null&&(f=Jn({inputs:{x:s},backend:n,attrs:{perm:d}}),c=Is(c.length,a),l.push(f)),lo("prod",c,a);let h;if(n.shouldExecuteOnCPU([f])){const p=n.texData.get(f.dataId).values,{outVals:m,outShape:v,outDtype:g}=hie(f.shape,f.dtype,p,c);h=n.makeTensorInfo(v,g,m)}else{const[p,m]=No(f.shape,c),v=pe(m),g=ge({inputs:{x:f},backend:n,attrs:{shape:[-1,v]}}),x=cx(s.dtype),b=bl(g,x,"prod",n);h=ge({inputs:{x:b},backend:n,attrs:{shape:p}}),l.push(g),l.push(b)}if(i){l.push(h);const p=es(h.shape,u);h=ge({inputs:{x:h},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),h}const ghe={kernelName:iI,backendName:"webgl",kernelFunc:mhe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yhe(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:s,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=r,l=s.map(g=>n.readSync(g.dataId)),u=s.map(g=>g.shape),c=n.readSync(o.dataId),d=n.readSync(i.dataId),[f,h,p]=pie(l,u,c,o.shape,o.dtype,d,i.shape,a),m=f.map(g=>n.makeTensorInfo([g.length],"int32",g)),v=n.makeTensorInfo(p,o.dtype,h);return m.concat([v])}const vhe={kernelName:aI,backendName:"webgl",kernelFunc:yhe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xhe(t){const{inputs:e,backend:n}=t,{starts:r,limits:s,deltas:o}=e,i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=mie(i,r.shape,r.dtype,a,s.shape,l,o.shape),d=n.makeTensorInfo([u.length],"int32",u),f=n.makeTensorInfo([c.length],r.dtype,c);return[d,f]}const bhe={kernelName:lI,backendName:"webgl",kernelFunc:xhe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function whe(t){const{inputs:e,backend:n,attrs:r}=t,{shape:s,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=r,u=n.readSync(s.dataId),c=n.readSync(o.dataId),d=n.readSync(i.dataId),f=a.map(v=>n.readSync(v.dataId)),h=a.map(v=>v.shape),[p,m]=gie(u,s.shape,c,o.shape,o.dtype,d,i.shape,f,h,l);return n.makeTensorInfo(p,o.dtype,m)}const She={kernelName:uI,backendName:"webgl",kernelFunc:whe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i3=t=>{const{backend:e,attrs:n}=t,{start:r,stop:s,step:o,dtype:i}=n,a=yie(r,s,o,i);return e.makeTensorInfo([a.length],i,a)},Che={kernelName:cI,backendName:"webgl",kernelFunc:i3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _he="return 1.0 / x;",Ehe=tt({opSnippet:_he}),The={kernelName:fI,backendName:"webgl",kernelFunc:Ehe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nhe=Os+`
  return (x < 0.0) ? 0.0 : x;
`,$he=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,khe=tt({opSnippet:Nhe,packedOpSnippet:$he}),Ihe={kernelName:hI,backendName:"webgl",kernelFunc:khe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ohe=Os+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Rhe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Dhe=tt({opSnippet:Ohe,packedOpSnippet:Rhe}),Ahe={kernelName:yI,backendName:"webgl",kernelFunc:Dhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Phe{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let f;o?f="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lhe{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r];let f;o?f="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fhe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,u]=a,c=Y().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Lhe(s.shape,l,u,o,i):new Phe(s.shape,l,u,o,i);return n.runWebGLProgram(c,[s],"float32")}const Mhe={kernelName:gI,backendName:"webgl",kernelFunc:Fhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jhe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,i,a]=e,l=[r&&i>1?s-1:s,r&&a>1?o-1:o],u=[r&&i>1?i-1:i,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],f=1/c,h=1/d,p=Math.ceil(f)*2+2,m=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bhe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,a=new jhe(o.shape,s.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const Uhe={kernelName:BU,backendName:"webgl",kernelFunc:Bhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zhe{constructor(e,n,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],f=s?"0.5":"0.0";let h;o?h="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${c[0]/d[0]},
          ${c[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Whe{constructor(e,n,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,n,r,u];const c=[s&&n>1?a-1:a,s&&r>1?l-1:l],d=[s&&n>1?n-1:n,s&&r>1?r-1:r],f=s?"0.5":"0.0";let h;o?h="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${c[0]/d[0]},
          ${c[1]/d[1]},
          ${c[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${f})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vhe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[l,u]=a,c=Y().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Whe(s.shape,l,u,o,i):new zhe(s.shape,l,u,o,i);return n.runWebGLProgram(c,[s],s.dtype)}const Ghe={kernelName:mI,backendName:"webgl",kernelFunc:Vhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hhe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,s,o]=n,[,i,a]=e,l=[r&&i>1?s-1:s,r&&a>1?o-1:o],u=[r&&i>1?i-1:i,r&&a>1?a-1:a],c=l[0]/u[0],d=l[1]/u[1],f=1/c,h=1/d,p=Math.ceil(f)*2+2,m=Math.ceil(h)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${c});
        const float widthScale = float(${d});

        const float invHeightScale = float(${f});
        const float invWidthScale = float(${h});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qhe(t){const{inputs:e,backend:n,attrs:r}=t,{images:s,dy:o}=e,{alignCorners:i}=r,a=new Hhe(o.shape,s.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const Khe={kernelName:jU,backendName:"webgl",kernelFunc:qhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xhe{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,l)=>s(l)).join(","),i=mt(r);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yhe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=Qn("rc",r),o=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,i=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=mt(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(s.slice())};
          if(${o}){
            result.g = ${u(s.slice())};
          }
          if(${i}) {
            result.b = ${c(s.slice())};
            if(${o}) {
              result.a = ${d(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return f(p)}function u(p){return p[r-1]="("+p[r-1]+" + 1)",f(p)}function c(p){return p[r-2]="("+p[r-2]+" + 1)",f(p)}function d(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",f(p)}function f(p){const m=e.map((x,b)=>h(b,p)),v=m.join(","),g=m.slice(-2).join(",");return`getChannel(getX(${v}), vec2(${g}))`}function h(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qhe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{dims:o}=r,i=s.shape.length,a=gn(o,s.shape);if(i===0)return Tr({inputs:{x:s},backend:n});const l=Y().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Yhe(s.shape,a):new Xhe(s.shape,a);return n.runWebGLProgram(l,[s],s.dtype)}const Zhe={kernelName:vI,backendName:"webgl",kernelFunc:Qhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jhe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const epe={kernelName:sO,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:s,fillValue:o,center:i}=e,a=n,l=new Jhe(r.shape,o),[u,c]=tD(i,r.shape[1],r.shape[2]),d=[[u,c,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tpe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,npe=tt({opSnippet:tpe}),rpe={kernelName:xI,backendName:"webgl",kernelFunc:npe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const spe="return inversesqrt(x);",ope=tt({opSnippet:spe,cpuKernelImpl:vie}),ipe={kernelName:bI,backendName:"webgl",kernelFunc:ope};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eb{constructor(e,n,r,s,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const u=mt(o.length),c=mt(i.length);let d="";r===1?d="i":r===2&&(d="i, j");const f=`getIndices(${d})`;let h="";s===1?h="i":s===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let m="";l&&(m="coords[0], coords[1]");const v=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${v}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ape{constructor(e,n,r,s,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const u=mt(o.length),c=mt(i.length);let d="";r===1?d="i":r===2&&(d="i, j");const f=`getIndices(${d})`;let h="";s===1?h="i":s===2&&(h="i, coords[1]");const p=`getUpdates(${h})`;let m="";l&&(m="coords[0], coords[1]");const v=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides",x=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${f});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${v}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lpe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:s,updates:o}=e,{shape:i}=r,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=km(o,s,i),f=[d/u,u];if(d===0)return n.makeTensorInfo(i,s.dtype);const h=ge({inputs:{x:s},backend:n,attrs:{shape:[l,a]}}),p=ge({inputs:{x:o},backend:n,attrs:{shape:[l,u]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let v;Y().getBool("WEBGL_PACK")?v=new ape(l,a,h.shape.length,p.shape.length,c,f):v=new Eb(l,a,h.shape.length,p.shape.length,c,f);const g=n.runWebGLProgram(v,[p,h,m],p.dtype),x=ge({inputs:{x:g},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),x}const upe={kernelName:wI,backendName:"webgl",kernelFunc:lpe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cpe{constructor(e,n,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=Y().getNumber("WEBGL_VERSION")===2?o:i,l=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dpe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:s,values:o}=e,{side:i}=r,a=new cpe(s.shape[0],s.shape[1],o.shape[1],i),l=[[s.shape[1]]];return n.runWebGLProgram(a,[s,o],"int32",l)}const fpe={kernelName:CI,backendName:"webgl",kernelFunc:dpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hpe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let s,o;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)o="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let c=0;c<n.length;c++)u.push(`${a[c]}`),c<e&&l.push(`${a[c]}`);s=l.join(),o=u.join()}const i=mt(r);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ppe(t){const{inputs:e,backend:n}=t,{condition:r,t:s,e:o}=e,i=new hpe(r.shape.length,s.shape,s.shape.length);return n.runWebGLProgram(i,[r,s,o],To(s.dtype,o.dtype))}const mpe={kernelName:_I,backendName:"webgl",kernelFunc:ppe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gpe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${sD};
  float scale = ${oD};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,ype=tt({opSnippet:gpe}),vpe={kernelName:EI,backendName:"webgl",kernelFunc:ype};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xpe=Ku+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,bpe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,wpe=tt({opSnippet:xpe,packedOpSnippet:bpe,cpuKernelImpl:bie}),Spe={kernelName:II,backendName:"webgl",kernelFunc:wpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cpe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,_pe=tt({opSnippet:Cpe}),Epe={kernelName:kI,backendName:"webgl",kernelFunc:_pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tpe=Ku+`
  return sin(x);
`,Npe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${xl}
  return result;
`,$pe=tt({opSnippet:Tpe,packedOpSnippet:Npe}),kpe={kernelName:NI,backendName:"webgl",kernelFunc:$pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ipe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Ope=tt({opSnippet:Ipe}),Rpe={kernelName:$I,backendName:"webgl",kernelFunc:Ope};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dpe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Ape=tt({opSnippet:Dpe}),Ppe={kernelName:OI,backendName:"webgl",kernelFunc:Ape};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lpe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{blockShape:o,paddings:i}=r;D(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((g,x)=>g*x),l=[[0,0]];l.push(...i);for(let g=1+o.length;g<s.shape.length;++g)l.push([0,0]);const u=[],c=o3({inputs:{x:s},backend:n,attrs:{paddings:l,constantValue:0}}),d=Ux(c.shape,o,a,!1),f=zx(d.length,o.length,!1),h=Wx(c.shape,o,a,!1),p=ge({inputs:{x:c},backend:n,attrs:{shape:d}}),m=Jn({inputs:{x:p},backend:n,attrs:{perm:f}}),v=ge({inputs:{x:m},backend:n,attrs:{shape:h}});return u.push(c),u.push(p),u.push(m),u.forEach(g=>n.disposeIntermediateTensorInfo(g)),v},Fpe={kernelName:AI,backendName:"webgl",kernelFunc:Lpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mpe(t){const{inputs:e,backend:n}=t,{indices:r,values:s,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(r.dataId),l=n.readSync(s.dataId),u=n.readSync(o.dataId),c=n.readSync(i.dataId)[0],[d,f,h,p,m]=Sie(a,r.shape,r.dtype,l,s.dtype,u,c);return[n.makeTensorInfo(f,r.dtype,d),n.makeTensorInfo([f[0]],s.dtype,h),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(v=>Number(v)))),n.makeTensorInfo([m.length],r.dtype,new Int32Array(m))]}const jpe={kernelName:FI,backendName:"webgl",kernelFunc:Mpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bpe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:s,newShape:o}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.readSync(s.dataId)),a=n.readSync(r.dataId),l=Array.from(n.readSync(o.dataId)),[u,c,d]=Cie(a,r.shape,r.dtype,i,l);return[n.makeTensorInfo(c,r.dtype,u),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const Upe={kernelName:MI,backendName:"webgl",kernelFunc:Bpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zpe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=IP(i,r.shape,r.dtype,a,l,!0);return n.makeTensorInfo(c,r.dtype,u)}const Wpe={kernelName:jI,backendName:"webgl",kernelFunc:zpe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vpe(t){const{inputs:e,backend:n}=t,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=n.readSync(r.dataId),a=n.readSync(s.dataId),l=n.readSync(o.dataId),[u,c]=IP(i,r.shape,r.dtype,a,l);return n.makeTensorInfo(c,r.dtype,u)}const Gpe={kernelName:BI,backendName:"webgl",kernelFunc:Vpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hpe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:s,sparseValues:o,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:l,numUpdates:u,sliceSize:c,strides:d,outputSize:f}=km(o,s,a),h=!1;if(o.dtype==="string"){const g=n.bufferSync(s),x=n.bufferSync(o),b=bu(n.readSync(i.dataId)[0]),_=xie(g,x,a,f,c,u,l,d,b,h);return n.makeTensorInfo(a,_.dtype,_.values)}const p=new Eb(u,l,s.shape.length,o.shape.length,d,[f,1],h),m=n.runWebGLProgram(p,[o,s,i],o.dtype),v=ge({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),v}const qpe={kernelName:UI,backendName:"webgl",kernelFunc:Hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kpe(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{numOrSizeSplits:o,axis:i}=r,a=gn(i,s.shape)[0],l=yD(s,o,a),u=s.shape.length,c=new Array(u).fill(0),d=s.shape.slice();return l.map(f=>{const h=[...d];h[a]=f;const p=Xu({inputs:{x:s},backend:n,attrs:{begin:c,size:h}});return c[a]+=f,p})}const Xpe={kernelName:PI,backendName:"webgl",kernelFunc:Kpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HE="return sqrt(x);",Ype=tt({opSnippet:HE,packedOpSnippet:HE,cpuKernelImpl:_ie}),Qpe={kernelName:RI,backendName:"webgl",kernelFunc:Ype};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zpe="return x * x;",Jpe=tt({opSnippet:Zpe}),eme={kernelName:UU,backendName:"webgl",kernelFunc:Jpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qE="return (a - b) * (a - b);",tme=On({opSnippet:qE,packedOpSnippet:qE}),nme={kernelName:zI,backendName:"webgl",kernelFunc:tme};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");const o=n.readSync(s.dataId),i=_u(o),a=Eie(i,"string",r);return n.makeTensorInfo(s.shape,"string",a)}const sme={kernelName:WI,backendName:"webgl",kernelFunc:rme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ome({inputs:t,attrs:e,backend:n}){const{x:r}=t,s=Os+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new bo(r.shape,s);return n.runWebGLProgram(o,[r],r.dtype)}const ime={kernelName:rO,backendName:"webgl",kernelFunc:ome};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ame{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,o=mt(r.length),i=mt(r.length);let a="";if(s===1)a="coords * strides + begin";else{let l=0;a=r.map((u,c)=>(l++,r.length===1?`coords * strides[${c}] + begin[${c}]`:`coords[${l-1}] * strides[${c}] + begin[${c}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:c,newAxisMask:d,shrinkAxisMask:f}=r,{finalShapeSparse:h,finalShape:p,isIdentity:m,sliceDim0:v,isSimpleSlice:g,begin:x,end:b,strides:_}=XR(s.shape,o,i,a,l,u,c,d,f);let N;if(m)N=ge({inputs:{x:s},backend:n,attrs:{shape:p}});else if(v||g){D(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const R=jR(x,b,_),P=Xu({inputs:{x:s},backend:n,attrs:{begin:x,size:R}});N=ge({inputs:{x:P},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(P)}else if(n.shouldExecuteOnCPU([s])){const P=n.readSync(s.dataId),B=Lt(s.shape,s.dtype,P),F=Tie(h,B,_,x);N=n.makeTensorInfo(p,s.dtype,F.values)}else{const P=new ame(x,_,h);N=n.runWebGLProgram(P,[s],s.dtype)}const E=ge({inputs:{x:N},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(N),E}const ume={kernelName:VI,backendName:"webgl",kernelFunc:lme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cme(t){const{inputs:e,backend:n,attrs:r}=t,{separator:s,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=r,{data:c,dataSplits:d}=e,f=n.readSync(c.dataId),h=n.readSync(d.dataId),[p,m]=Nie(f,h,s,o,i,a,l,u);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const dme={kernelName:GI,backendName:"webgl",kernelFunc:cme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fme(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:s}=r,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(o.dataId),l=n.readSync(i.dataId)[0],[u,c,d]=$ie(a,l,s),f=c.length;return[n.makeTensorInfo([f,2],"int32",u),n.makeTensorInfo([f],"string",c),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const hme={kernelName:HI,backendName:"webgl",kernelFunc:fme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pme(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:s}=r,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(o.dataId),a=kie(i,s);return n.makeTensorInfo(o.shape,"int32",a)}const mme={kernelName:qI,backendName:"webgl",kernelFunc:pme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gme="return tan(x);",yme=tt({opSnippet:gme}),vme={kernelName:XI,backendName:"webgl",kernelFunc:yme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xme=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,bme=tt({opSnippet:xme}),wme={kernelName:YI,backendName:"webgl",kernelFunc:bme};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sme(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:s,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:u,strides:c,outputSize:d}=km(i,o,s.shape),f=[d/u,u];if(d===0)return n.makeTensorInfo(s.shape,o.dtype);const h=ge({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),p=ge({inputs:{x:i},backend:n,attrs:{shape:[l,u]}}),m=ge({inputs:{x:s},backend:n,attrs:{shape:f}}),v=new Eb(l,a,h.shape.length,p.shape.length,c,f,!1,!0),g=n.runWebGLProgram(v,[p,h,m],m.dtype),x=ge({inputs:{x:g},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),x}const Cme={kernelName:SI,backendName:"webgl",kernelFunc:Sme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _me{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[i]*n[i];this.outputShape=r,this.rank=r.length;const s=mt(this.rank),o=Eme(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function Eme(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<t.length;s++)r.push(`imod(${n[s]}, ${t[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{reps:o}=r;if(s.dtype==="string"||s.shape.length>5){const l=n.readSync(s.dataId),u=s.dtype==="string"?l.map(f=>bu(f)):l,c=Lt(s.shape,s.dtype,u),d=Oie(c,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new _me(s.shape,o);return n.runWebGLProgram(i,[s],s.dtype)}const Tme={kernelName:lx,backendName:"webgl",kernelFunc:a3};class Nme{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class $me{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ya(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function KE(t){let e=1;for(;e<t;)e*=2;return e}function kme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s}=e,{k:o,sorted:i}=r,a=Y().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Y().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=s.shape,c=u[u.length-1];if(n.shouldExecuteOnCPU([s])||c<a||o>l){const F=n.readSync(s.dataId),[H,ee]=Rie(F,u,s.dtype,o,i);return[n.makeTensorInfo(H.shape,H.dtype,H.values),n.makeTensorInfo(ee.shape,ee.dtype,ee.values)]}if(o===0)return u[u.length-1]=0,[n.makeTensorInfo(u,s.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(c===1)return[s,nf({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const d=n.texData.get(s.dataId),f=d!==null&&d.isPacked,h=f?n.unpackTensor(s):s,m=pe(u)/c,v=ge({inputs:{x:h},attrs:{shape:[m,c]},backend:n});f&&ya(n,h);const g=KE(o),x=KE(c);let b=null;const _=()=>b===null?[v,v]:[v,b],N=(F,H,ee)=>{const oe=_(),de=new Nme(ee),W=[[c],[b===null?1:0],[Number.NEGATIVE_INFINITY],[F],[H]],I=b;b=n.runWebGLProgram(de,oe,"int32",W),ya(n,I)};for(let F=1;F<g;F*=2){const H=F*2;for(let ee=F;ee>=1;ee/=2)N(H,ee,[m,x])}for(let F=x;F>g;F/=2){const H=_(),ee=new $me([m,F/2]),de=[[c],[b===null?1:0],[g]],V=b;b=n.runWebGLProgram(ee,H,"int32",de),ya(n,V);const W=g/2,I=W*2;for(let O=W;O>=1;O/=2)N(I,O,b.shape)}let E=b;b=Xu({inputs:{x:b},backend:n,attrs:{begin:0,size:[m,o]}}),ya(n,E);let R=JP({inputs:{x:v,indices:b},backend:n,attrs:{axis:1,batchDims:1}});ya(n,v);const P=u.slice(0,-1);P.push(o),E=b,b=ge({inputs:{x:b},attrs:{shape:P},backend:n}),ya(n,E);const B=R;return R=ge({inputs:{x:R},attrs:{shape:P},backend:n}),ya(n,B),[R,b]}const Ime={kernelName:QI,backendName:"webgl",kernelFunc:kme};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ome{constructor(e,n,r,s,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=r==="nearest"?1:2;let l;switch(s){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rme(t){const{inputs:e,backend:n,attrs:r}=t,{image:s,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=r,[c,d,f,h]=s.shape,[p,m]=u??[d,f],v=[c,p,m,h],g=new Ome(d,f,i,a,l,v);return n.runWebGLProgram(g,[s,o],"float32")}const Dme={kernelName:ZI,backendName:"webgl",kernelFunc:Rme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ame(t){const{inputs:e,attrs:n,backend:r}=t,{axis:s}=n,{x:o}=e;Jd(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=r.readSync(o.dataId),{outputValues:a,outputShape:l,indices:u}=Die(i,s,o.shape,o.dtype);return[r.makeTensorInfo(l,o.dtype,a),r.makeTensorInfo([u.length],"int32",u)]}const Pme={kernelName:JI,backendName:"webgl",kernelFunc:Ame};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lme(t){const{inputs:e,backend:n,attrs:r}=t,{value:s}=e;let{axis:o}=r;o<0&&(o+=s.shape.length);const i=s,a=i.shape.length,l=s.shape[o],u=new Array(a-1);let c=0;for(let m=0;m<a;m++)m!==o&&(u[c++]=i.shape[m]);const d=[],f=new Array(a).fill(0),h=i.shape.slice();h[o]=1;const p=new Array(l);for(let m=0;m<p.length;m++){f[o]=m;const v=Xu({inputs:{x:i},backend:n,attrs:{begin:f,size:h}}),g=ge({inputs:{x:v},backend:n,attrs:{shape:u}});p[m]=g,d.push(v)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const Fme={kernelName:eO,backendName:"webgl",kernelFunc:Lme};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mme{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/r);this.outputShape=[s,a];const l="0.0",u="sumValue",c=Math.floor(r/4)*4,d=r%4,f=`
        sumValue += dot(values, segFilter);
    `;let h="";o%r>0&&(h=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let p="";o%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${c}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${f}
        }

        int inIdx = inOffset + ${c};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${f}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${f}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${f}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jme(t){const{inputs:e,backend:n,attrs:r}=t,{x:s,segmentIds:o}=e,{numSegments:i}=r,a=s.shape.length,l=[];let u=0;const c=ks([u],a);let d=s;c!=null&&(d=Jn({inputs:{x:s},backend:n,attrs:{perm:c}}),l.push(d),u=Is(1,a)[0]);const f=ID(d.shape,u,i),h=pe([d.shape[u]]),p=ge({inputs:{x:d},backend:n,attrs:{shape:[-1,h]}});l.push(p);const m=cx(s.dtype),v=(_,N,E,R,P)=>{const B=_.shape[0],F=_.shape[1],H=kD(F,P),ee={windowSize:H,inSize:F,batchSize:B,numSegments:P},oe=new Mme(ee,N),de=n.compileAndRun(oe,[_,E],R);if(l.push(de),de.shape[1]===P)return de;const V=i3({backend:n,attrs:{start:0,stop:P,step:1,dtype:"float32"}}),W=a3({inputs:{x:V},backend:n,attrs:{reps:[F/H]}});return l.push(V),l.push(W),v(de,N,W,R,P)},g=v(p,"unsortedSegmentSum",o,m,i),x=ge({inputs:{x:g},backend:n,attrs:{shape:f}});let b=x;if(c!=null){l.push(x);const _=yx(c);b=Jn({inputs:{x:b},backend:n,attrs:{perm:_}})}return l.forEach(_=>n.disposeIntermediateTensorInfo(_)),b}const Bme={kernelName:tO,backendName:"webgl",kernelFunc:jme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ume=[_ae,Tae,kae,Rae,Aae,Fae,jae,Uae,Gae,qae,Yae,Jae,nle,ile,ule,dle,hle,yle,xle,wle,Ele,Rle,Ale,Mle,Ble,Hle,Kle,Zle,aae,tue,iue,cue,gue,xue,wue,Cue,Eue,kue,Rue,Pue,Fue,jue,Uue,Vue,Hue,Yue,Zue,tce,sce,ice,cce,pce,vce,wce,_ce,Ece,Nce,kce,Oce,Dce,Pce,jce,zce,Gce,qce,Yce,Jce,rde,ade,iae,ude,sue,fde,mde,vde,uae,Sde,Tde,$de,Rde,Pde,jde,zde,Hde,Yde,Jde,tfe,ofe,afe,ufe,hfe,mfe,yfe,xfe,wfe,Efe,kfe,Dfe,Ufe,fae,Gfe,Kfe,Qfe,ehe,zle,rhe,ohe,ahe,che,phe,dae,ghe,vhe,bhe,She,Che,Wle,Ffe,The,Ihe,Ahe,pae,Mhe,Uhe,Ghe,Khe,Zhe,epe,rpe,ipe,upe,fpe,mpe,vpe,Spe,Epe,kpe,Rpe,Ile,jfe,Ppe,Fpe,jpe,Upe,Wpe,Gpe,qpe,Xpe,Qpe,eme,nme,sme,ime,ume,dme,hme,mme,Mfe,wae,vme,wme,Cme,Tme,Ime,Dme,Sae,Pme,Fme,Bme,she];for(const t of Ume)VU(t);const zme=()=>{const t=Ns(),e=Zp(),n=ei().token,[r,s]=L.useState(!0),o=L.useRef(),i=L.useRef(),a={piecesModelRef:o,xcornersModelRef:i};return L.useEffect(()=>{n===""&&iU(e,t),s(!1)},[]),w.jsx(w.Fragment,{children:!r&&w.jsx(YM,{context:a})})};var l3,XE=Ru;l3=XE.createRoot,XE.hydrateRoot;var Tb="persist:",Nb="persist/FLUSH",Jm="persist/REHYDRATE",$b="persist/PAUSE",kb="persist/PERSIST",Ib="persist/PURGE",Ob="persist/REGISTER",Wme=-1;function Th(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Th=function(n){return typeof n}:Th=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Th(t)}function YE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Vme(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?YE(n,!0).forEach(function(r){Gme(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YE(n).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Gme(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hme(t,e,n,r){r.debug;var s=Vme({},n);return t&&Th(t)==="object"&&Object.keys(t).forEach(function(o){o!=="_persist"&&e[o]===n[o]&&(s[o]=t[o])}),s}function qme(t){var e=t.blacklist||null,n=t.whitelist||null,r=t.transforms||[],s=t.throttle||0,o="".concat(t.keyPrefix!==void 0?t.keyPrefix:Tb).concat(t.key),i=t.storage,a;t.serialize===!1?a=function(N){return N}:typeof t.serialize=="function"?a=t.serialize:a=Kme;var l=t.writeFailHandler||null,u={},c={},d=[],f=null,h=null,p=function(N){Object.keys(N).forEach(function(E){g(E)&&u[E]!==N[E]&&d.indexOf(E)===-1&&d.push(E)}),Object.keys(u).forEach(function(E){N[E]===void 0&&g(E)&&d.indexOf(E)===-1&&u[E]!==void 0&&d.push(E)}),f===null&&(f=setInterval(m,s)),u=N};function m(){if(d.length===0){f&&clearInterval(f),f=null;return}var _=d.shift(),N=r.reduce(function(E,R){return R.in(E,_,u)},u[_]);if(N!==void 0)try{c[_]=a(N)}catch(E){console.error("redux-persist/createPersistoid: error serializing state",E)}else delete c[_];d.length===0&&v()}function v(){Object.keys(c).forEach(function(_){u[_]===void 0&&delete c[_]}),h=i.setItem(o,a(c)).catch(x)}function g(_){return!(n&&n.indexOf(_)===-1&&_!=="_persist"||e&&e.indexOf(_)!==-1)}function x(_){l&&l(_)}var b=function(){for(;d.length!==0;)m();return h||Promise.resolve()};return{update:p,flush:b}}function Kme(t){return JSON.stringify(t)}function Xme(t){var e=t.transforms||[],n="".concat(t.keyPrefix!==void 0?t.keyPrefix:Tb).concat(t.key),r=t.storage;t.debug;var s;return t.deserialize===!1?s=function(i){return i}:typeof t.deserialize=="function"?s=t.deserialize:s=Yme,r.getItem(n).then(function(o){if(o)try{var i={},a=s(o);return Object.keys(a).forEach(function(l){i[l]=e.reduceRight(function(u,c){return c.out(u,l,a)},s(a[l]))}),i}catch(l){throw l}else return})}function Yme(t){return JSON.parse(t)}function Qme(t){var e=t.storage,n="".concat(t.keyPrefix!==void 0?t.keyPrefix:Tb).concat(t.key);return e.removeItem(n,Zme)}function Zme(t){}function QE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Ao(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?QE(n,!0).forEach(function(r){Jme(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QE(n).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Jme(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ege(t,e){if(t==null)return{};var n=tge(t,e),r,s;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(s=0;s<o.length;s++)r=o[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function tge(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,o;for(o=0;o<r.length;o++)s=r[o],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}var nge=5e3;function rge(t,e){var n=t.version!==void 0?t.version:Wme;t.debug;var r=t.stateReconciler===void 0?Hme:t.stateReconciler,s=t.getStoredState||Xme,o=t.timeout!==void 0?t.timeout:nge,i=null,a=!1,l=!0,u=function(d){return d._persist.rehydrated&&i&&!l&&i.update(d),d};return function(c,d){var f=c||{},h=f._persist,p=ege(f,["_persist"]),m=p;if(d.type===kb){var v=!1,g=function(P,B){v||(d.rehydrate(t.key,P,B),v=!0)};if(o&&setTimeout(function(){!v&&g(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},o),l=!1,i||(i=qme(t)),h)return Ao({},e(m,d),{_persist:h});if(typeof d.rehydrate!="function"||typeof d.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return d.register(t.key),s(t).then(function(R){var P=t.migrate||function(B,F){return Promise.resolve(B)};P(R,n).then(function(B){g(B)},function(B){g(void 0,B)})},function(R){g(void 0,R)}),Ao({},e(m,d),{_persist:{version:n,rehydrated:!1}})}else{if(d.type===Ib)return a=!0,d.result(Qme(t)),Ao({},e(m,d),{_persist:h});if(d.type===Nb)return d.result(i&&i.flush()),Ao({},e(m,d),{_persist:h});if(d.type===$b)l=!0;else if(d.type===Jm){if(a)return Ao({},m,{_persist:Ao({},h,{rehydrated:!0})});if(d.key===t.key){var x=e(m,d),b=d.payload,_=r!==!1&&b!==void 0?r(b,c,x,t):x,N=Ao({},_,{_persist:Ao({},h,{rehydrated:!0})});return u(N)}}}if(!h)return e(c,d);var E=e(m,d);return E===m?c:u(Ao({},E,{_persist:h}))}}function ZE(t){return ige(t)||oge(t)||sge()}function sge(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function oge(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function ige(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}function JE(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Fv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?JE(n,!0).forEach(function(r){age(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):JE(n).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function age(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u3={registry:[],bootstrapped:!1},lge=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u3,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case Ob:return Fv({},e,{registry:[].concat(ZE(e.registry),[n.key])});case Jm:var r=e.registry.indexOf(n.key),s=ZE(e.registry);return s.splice(r,1),Fv({},e,{registry:s,bootstrapped:s.length===0});default:return e}};function uge(t,e,n){var r=n||!1,s=W1(lge,u3,e&&e.enhancer?e.enhancer:void 0),o=function(u){s.dispatch({type:Ob,key:u})},i=function(u,c,d){var f={type:Jm,payload:c,err:d,key:u};t.dispatch(f),s.dispatch(f),r&&a.getState().bootstrapped&&(r(),r=!1)},a=Fv({},s,{purge:function(){var u=[];return t.dispatch({type:Ib,result:function(d){u.push(d)}}),Promise.all(u)},flush:function(){var u=[];return t.dispatch({type:Nb,result:function(d){u.push(d)}}),Promise.all(u)},pause:function(){t.dispatch({type:$b})},persist:function(){t.dispatch({type:kb,register:o,rehydrate:i})}});return e&&e.manualPersist||a.persist(),a}var Rb={},Db={};Db.__esModule=!0;Db.default=fge;function Nh(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Nh=function(n){return typeof n}:Nh=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Nh(t)}function Oy(){}var cge={getItem:Oy,setItem:Oy,removeItem:Oy};function dge(t){if((typeof self>"u"?"undefined":Nh(self))!=="object"||!(t in self))return!1;try{var e=self[t],n="redux-persist ".concat(t," test");e.setItem(n,"test"),e.getItem(n),e.removeItem(n)}catch{return!1}return!0}function fge(t){var e="".concat(t,"Storage");return dge(e)?self[e]:cge}Rb.__esModule=!0;Rb.default=mge;var hge=pge(Db);function pge(t){return t&&t.__esModule?t:{default:t}}function mge(t){var e=(0,hge.default)(t);return{getItem:function(r){return new Promise(function(s,o){s(e.getItem(r))})},setItem:function(r,s){return new Promise(function(o,i){o(e.setItem(r,s))})},removeItem:function(r){return new Promise(function(s,o){s(e.removeItem(r))})}}}var c3=void 0,gge=yge(Rb);function yge(t){return t&&t.__esModule?t:{default:t}}var vge=(0,gge.default)("local");c3=vge;const xge=UN({game:dY,corners:PX,user:VB}),bge={key:"root",version:1,storage:c3,blacklist:[]},wge=rge(bge,xge),d3=Uj({reducer:wge,middleware:t=>t({serializableCheck:{ignoredActions:[Nb,Jm,$b,kb,Ib,Ob]}})});function $h(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$h=function(n){return typeof n}:$h=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},$h(t)}function Sge(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eT(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Cge(t,e,n){return e&&eT(t.prototype,e),n&&eT(t,n),t}function _ge(t,e){return e&&($h(e)==="object"||typeof e=="function")?e:kh(t)}function Mv(t){return Mv=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Mv(t)}function kh(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ege(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jv(t,e)}function jv(t,e){return jv=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},jv(t,e)}function Ih(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f3=function(t){Ege(e,t);function e(){var n,r;Sge(this,e);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return r=_ge(this,(n=Mv(e)).call.apply(n,[this].concat(o))),Ih(kh(r),"state",{bootstrapped:!1}),Ih(kh(r),"_unsubscribe",void 0),Ih(kh(r),"handlePersistorState",function(){var a=r.props.persistor,l=a.getState(),u=l.bootstrapped;u&&(r.props.onBeforeLift?Promise.resolve(r.props.onBeforeLift()).finally(function(){return r.setState({bootstrapped:!0})}):r.setState({bootstrapped:!0}),r._unsubscribe&&r._unsubscribe())}),r}return Cge(e,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),e}(L.PureComponent);Ih(f3,"defaultProps",{children:null,loading:null});const Tge="modulepreload",Nge=function(t,e){return new URL(t,e).href},tT={},$ge=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){const o=document.getElementsByTagName("link");s=Promise.all(n.map(i=>{if(i=Nge(i,r),i in tT)return;tT[i]=!0;const a=i.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(!!r)for(let d=o.length-1;d>=0;d--){const f=o[d];if(f.href===i&&(!a||f.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":Tge,a||(c.as="script",c.crossOrigin=""),c.href=i,document.head.appendChild(c),a)return new Promise((d,f)=>{c.addEventListener("load",d),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${i}`)))})}))}return s.then(()=>e()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};function kge(t={}){const{immediate:e=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:s,onRegisteredSW:o,onRegisterError:i}=t;let a,l,u;const c=async(f=!0)=>{await l,await(u==null?void 0:u())};async function d(){if("serviceWorker"in navigator){const{Workbox:f}=await $ge(()=>import("./workbox-window.prod.es5-prqDwDSL.js"),__vite__mapDeps([]),import.meta.url);a=new f("./sw.js",{scope:"./",type:"classic"}),u=async()=>{await(a==null?void 0:a.messageSkipWaiting())};{let h=!1;const p=()=>{h=!0,a==null||a.addEventListener("controlling",m=>{m.isUpdate&&window.location.reload()}),n==null||n()};a.addEventListener("installed",m=>{typeof m.isUpdate>"u"?typeof m.isExternal<"u"?m.isExternal?p():!h&&(r==null||r()):m.isExternal?window.location.reload():!h&&(r==null||r()):m.isUpdate||r==null||r()}),a.addEventListener("waiting",p),a.addEventListener("externalwaiting",p)}a.register({immediate:e}).then(h=>{o?o("./sw.js",h):s==null||s(h)}).catch(h=>{i==null||i(h)})}}return l=d(),c}const Ige=kge({onNeedRefresh(){confirm("New content available. Reload?")&&(localStorage.clear(),Ige(!0))}}),Oge=JM([{path:"/",element:w.jsx(zme,{}),children:[{path:"",element:w.jsx(hU,{})},{path:"/record",element:w.jsx(Kf,{mode:"record"})},{path:"/upload",element:w.jsx(Kf,{mode:"upload"})},{path:"/broadcast",element:w.jsx(Kf,{mode:"broadcast"})},{path:"/play",element:w.jsx(Kf,{mode:"play"})},{path:"/export",element:w.jsx(zne,{})},{path:"/privacy",element:w.jsx(Wne,{})},{path:"/faq",element:w.jsx(qne,{})}]}]),Rge=l3(document.getElementById("root")),Dge=uge(d3);Rge.render(w.jsx(MB,{store:d3,children:w.jsx(f3,{persistor:Dge,children:w.jsx(lj,{router:Oge})})}));
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = []
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
